(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function XS(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var zp={exports:{}},Tu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cv;function HC(){if(Cv)return Tu;Cv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,o,a){var u=null;if(a!==void 0&&(u=""+a),o.key!==void 0&&(u=""+o.key),"key"in o){a={};for(var d in o)d!=="key"&&(a[d]=o[d])}else a=o;return o=a.ref,{$$typeof:n,type:i,key:u,ref:o!==void 0?o:null,props:a}}return Tu.Fragment=e,Tu.jsx=t,Tu.jsxs=t,Tu}var xv;function GC(){return xv||(xv=1,zp.exports=HC()),zp.exports}var T=GC(),Fp={exports:{}},ze={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iv;function YC(){if(Iv)return ze;Iv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),S=Symbol.iterator;function C(F){return F===null||typeof F!="object"?null:(F=S&&F[S]||F["@@iterator"],typeof F=="function"?F:null)}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},V=Object.assign,z={};function J(F,ie,he){this.props=F,this.context=ie,this.refs=z,this.updater=he||k}J.prototype.isReactComponent={},J.prototype.setState=function(F,ie){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,ie,"setState")},J.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function j(){}j.prototype=J.prototype;function Z(F,ie,he){this.props=F,this.context=ie,this.refs=z,this.updater=he||k}var H=Z.prototype=new j;H.constructor=Z,V(H,J.prototype),H.isPureReactComponent=!0;var ae=Array.isArray;function oe(){}var x={H:null,A:null,T:null,S:null},M=Object.prototype.hasOwnProperty;function N(F,ie,he){var fe=he.ref;return{$$typeof:n,type:F,key:ie,ref:fe!==void 0?fe:null,props:he}}function P(F,ie){return N(F.type,ie,F.props)}function U(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function O(F){var ie={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(he){return ie[he]})}var D=/\/+/g;function ct(F,ie){return typeof F=="object"&&F!==null&&F.key!=null?O(""+F.key):ie.toString(36)}function rt(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(oe,oe):(F.status="pending",F.then(function(ie){F.status==="pending"&&(F.status="fulfilled",F.value=ie)},function(ie){F.status==="pending"&&(F.status="rejected",F.reason=ie)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function W(F,ie,he,fe,we){var ke=typeof F;(ke==="undefined"||ke==="boolean")&&(F=null);var ye=!1;if(F===null)ye=!0;else switch(ke){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(F.$$typeof){case n:case e:ye=!0;break;case _:return ye=F._init,W(ye(F._payload),ie,he,fe,we)}}if(ye)return we=we(F),ye=fe===""?"."+ct(F,0):fe,ae(we)?(he="",ye!=null&&(he=ye.replace(D,"$&/")+"/"),W(we,ie,he,"",function(Bs){return Bs})):we!=null&&(U(we)&&(we=P(we,he+(we.key==null||F&&F.key===we.key?"":(""+we.key).replace(D,"$&/")+"/")+ye)),ie.push(we)),1;ye=0;var jt=fe===""?".":fe+":";if(ae(F))for(var It=0;It<F.length;It++)fe=F[It],ke=jt+ct(fe,It),ye+=W(fe,ie,he,ke,we);else if(It=C(F),typeof It=="function")for(F=It.call(F),It=0;!(fe=F.next()).done;)fe=fe.value,ke=jt+ct(fe,It++),ye+=W(fe,ie,he,ke,we);else if(ke==="object"){if(typeof F.then=="function")return W(rt(F),ie,he,fe,we);throw ie=String(F),Error("Objects are not valid as a React child (found: "+(ie==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":ie)+"). If you meant to render a collection of children, use an array instead.")}return ye}function ce(F,ie,he){if(F==null)return F;var fe=[],we=0;return W(F,fe,"","",function(ke){return ie.call(he,ke,we++)}),fe}function Te(F){if(F._status===-1){var ie=F._result;ie=ie(),ie.then(function(he){(F._status===0||F._status===-1)&&(F._status=1,F._result=he)},function(he){(F._status===0||F._status===-1)&&(F._status=2,F._result=he)}),F._status===-1&&(F._status=0,F._result=ie)}if(F._status===1)return F._result.default;throw F._result}var Ge=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ie=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(ie))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)},tt={map:ce,forEach:function(F,ie,he){ce(F,function(){ie.apply(this,arguments)},he)},count:function(F){var ie=0;return ce(F,function(){ie++}),ie},toArray:function(F){return ce(F,function(ie){return ie})||[]},only:function(F){if(!U(F))throw Error("React.Children.only expected to receive a single React element child.");return F}};return ze.Activity=E,ze.Children=tt,ze.Component=J,ze.Fragment=t,ze.Profiler=o,ze.PureComponent=Z,ze.StrictMode=i,ze.Suspense=f,ze.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=x,ze.__COMPILER_RUNTIME={__proto__:null,c:function(F){return x.H.useMemoCache(F)}},ze.cache=function(F){return function(){return F.apply(null,arguments)}},ze.cacheSignal=function(){return null},ze.cloneElement=function(F,ie,he){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var fe=V({},F.props),we=F.key;if(ie!=null)for(ke in ie.key!==void 0&&(we=""+ie.key),ie)!M.call(ie,ke)||ke==="key"||ke==="__self"||ke==="__source"||ke==="ref"&&ie.ref===void 0||(fe[ke]=ie[ke]);var ke=arguments.length-2;if(ke===1)fe.children=he;else if(1<ke){for(var ye=Array(ke),jt=0;jt<ke;jt++)ye[jt]=arguments[jt+2];fe.children=ye}return N(F.type,we,fe)},ze.createContext=function(F){return F={$$typeof:u,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:a,_context:F},F},ze.createElement=function(F,ie,he){var fe,we={},ke=null;if(ie!=null)for(fe in ie.key!==void 0&&(ke=""+ie.key),ie)M.call(ie,fe)&&fe!=="key"&&fe!=="__self"&&fe!=="__source"&&(we[fe]=ie[fe]);var ye=arguments.length-2;if(ye===1)we.children=he;else if(1<ye){for(var jt=Array(ye),It=0;It<ye;It++)jt[It]=arguments[It+2];we.children=jt}if(F&&F.defaultProps)for(fe in ye=F.defaultProps,ye)we[fe]===void 0&&(we[fe]=ye[fe]);return N(F,ke,we)},ze.createRef=function(){return{current:null}},ze.forwardRef=function(F){return{$$typeof:d,render:F}},ze.isValidElement=U,ze.lazy=function(F){return{$$typeof:_,_payload:{_status:-1,_result:F},_init:Te}},ze.memo=function(F,ie){return{$$typeof:p,type:F,compare:ie===void 0?null:ie}},ze.startTransition=function(F){var ie=x.T,he={};x.T=he;try{var fe=F(),we=x.S;we!==null&&we(he,fe),typeof fe=="object"&&fe!==null&&typeof fe.then=="function"&&fe.then(oe,Ge)}catch(ke){Ge(ke)}finally{ie!==null&&he.types!==null&&(ie.types=he.types),x.T=ie}},ze.unstable_useCacheRefresh=function(){return x.H.useCacheRefresh()},ze.use=function(F){return x.H.use(F)},ze.useActionState=function(F,ie,he){return x.H.useActionState(F,ie,he)},ze.useCallback=function(F,ie){return x.H.useCallback(F,ie)},ze.useContext=function(F){return x.H.useContext(F)},ze.useDebugValue=function(){},ze.useDeferredValue=function(F,ie){return x.H.useDeferredValue(F,ie)},ze.useEffect=function(F,ie){return x.H.useEffect(F,ie)},ze.useEffectEvent=function(F){return x.H.useEffectEvent(F)},ze.useId=function(){return x.H.useId()},ze.useImperativeHandle=function(F,ie,he){return x.H.useImperativeHandle(F,ie,he)},ze.useInsertionEffect=function(F,ie){return x.H.useInsertionEffect(F,ie)},ze.useLayoutEffect=function(F,ie){return x.H.useLayoutEffect(F,ie)},ze.useMemo=function(F,ie){return x.H.useMemo(F,ie)},ze.useOptimistic=function(F,ie){return x.H.useOptimistic(F,ie)},ze.useReducer=function(F,ie,he){return x.H.useReducer(F,ie,he)},ze.useRef=function(F){return x.H.useRef(F)},ze.useState=function(F){return x.H.useState(F)},ze.useSyncExternalStore=function(F,ie,he){return x.H.useSyncExternalStore(F,ie,he)},ze.useTransition=function(){return x.H.useTransition()},ze.version="19.2.0",ze}var Rv;function Xm(){return Rv||(Rv=1,Fp.exports=YC()),Fp.exports}var ee=Xm();const QS=XS(ee);var Bp={exports:{}},Su={},qp={exports:{}},Hp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nv;function $C(){return Nv||(Nv=1,(function(n){function e(W,ce){var Te=W.length;W.push(ce);e:for(;0<Te;){var Ge=Te-1>>>1,tt=W[Ge];if(0<o(tt,ce))W[Ge]=ce,W[Te]=tt,Te=Ge;else break e}}function t(W){return W.length===0?null:W[0]}function i(W){if(W.length===0)return null;var ce=W[0],Te=W.pop();if(Te!==ce){W[0]=Te;e:for(var Ge=0,tt=W.length,F=tt>>>1;Ge<F;){var ie=2*(Ge+1)-1,he=W[ie],fe=ie+1,we=W[fe];if(0>o(he,Te))fe<tt&&0>o(we,he)?(W[Ge]=we,W[fe]=Te,Ge=fe):(W[Ge]=he,W[ie]=Te,Ge=ie);else if(fe<tt&&0>o(we,Te))W[Ge]=we,W[fe]=Te,Ge=fe;else break e}}return ce}function o(W,ce){var Te=W.sortIndex-ce.sortIndex;return Te!==0?Te:W.id-ce.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var u=Date,d=u.now();n.unstable_now=function(){return u.now()-d}}var f=[],p=[],_=1,E=null,S=3,C=!1,k=!1,V=!1,z=!1,J=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;function H(W){for(var ce=t(p);ce!==null;){if(ce.callback===null)i(p);else if(ce.startTime<=W)i(p),ce.sortIndex=ce.expirationTime,e(f,ce);else break;ce=t(p)}}function ae(W){if(V=!1,H(W),!k)if(t(f)!==null)k=!0,oe||(oe=!0,O());else{var ce=t(p);ce!==null&&rt(ae,ce.startTime-W)}}var oe=!1,x=-1,M=5,N=-1;function P(){return z?!0:!(n.unstable_now()-N<M)}function U(){if(z=!1,oe){var W=n.unstable_now();N=W;var ce=!0;try{e:{k=!1,V&&(V=!1,j(x),x=-1),C=!0;var Te=S;try{t:{for(H(W),E=t(f);E!==null&&!(E.expirationTime>W&&P());){var Ge=E.callback;if(typeof Ge=="function"){E.callback=null,S=E.priorityLevel;var tt=Ge(E.expirationTime<=W);if(W=n.unstable_now(),typeof tt=="function"){E.callback=tt,H(W),ce=!0;break t}E===t(f)&&i(f),H(W)}else i(f);E=t(f)}if(E!==null)ce=!0;else{var F=t(p);F!==null&&rt(ae,F.startTime-W),ce=!1}}break e}finally{E=null,S=Te,C=!1}ce=void 0}}finally{ce?O():oe=!1}}}var O;if(typeof Z=="function")O=function(){Z(U)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,ct=D.port2;D.port1.onmessage=U,O=function(){ct.postMessage(null)}}else O=function(){J(U,0)};function rt(W,ce){x=J(function(){W(n.unstable_now())},ce)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_next=function(W){switch(S){case 1:case 2:case 3:var ce=3;break;default:ce=S}var Te=S;S=ce;try{return W()}finally{S=Te}},n.unstable_requestPaint=function(){z=!0},n.unstable_runWithPriority=function(W,ce){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Te=S;S=W;try{return ce()}finally{S=Te}},n.unstable_scheduleCallback=function(W,ce,Te){var Ge=n.unstable_now();switch(typeof Te=="object"&&Te!==null?(Te=Te.delay,Te=typeof Te=="number"&&0<Te?Ge+Te:Ge):Te=Ge,W){case 1:var tt=-1;break;case 2:tt=250;break;case 5:tt=1073741823;break;case 4:tt=1e4;break;default:tt=5e3}return tt=Te+tt,W={id:_++,callback:ce,priorityLevel:W,startTime:Te,expirationTime:tt,sortIndex:-1},Te>Ge?(W.sortIndex=Te,e(p,W),t(f)===null&&W===t(p)&&(V?(j(x),x=-1):V=!0,rt(ae,Te-Ge))):(W.sortIndex=tt,e(f,W),k||C||(k=!0,oe||(oe=!0,O()))),W},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(W){var ce=S;return function(){var Te=S;S=ce;try{return W.apply(this,arguments)}finally{S=Te}}}})(Hp)),Hp}var Mv;function KC(){return Mv||(Mv=1,qp.exports=$C()),qp.exports}var Gp={exports:{}},Ln={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pv;function JC(){if(Pv)return Ln;Pv=1;var n=Xm();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function a(f,p,_){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:E==null?null:""+E,children:f,containerInfo:p,implementation:_}}var u=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return Ln.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Ln.createPortal=function(f,p){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return a(f,p,null,_)},Ln.flushSync=function(f){var p=u.T,_=i.p;try{if(u.T=null,i.p=2,f)return f()}finally{u.T=p,i.p=_,i.d.f()}},Ln.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(f,p))},Ln.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},Ln.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var _=p.as,E=d(_,p.crossOrigin),S=typeof p.integrity=="string"?p.integrity:void 0,C=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;_==="style"?i.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:E,integrity:S,fetchPriority:C}):_==="script"&&i.d.X(f,{crossOrigin:E,integrity:S,fetchPriority:C,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},Ln.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var _=d(p.as,p.crossOrigin);i.d.M(f,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(f)},Ln.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var _=p.as,E=d(_,p.crossOrigin);i.d.L(f,_,{crossOrigin:E,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},Ln.preloadModule=function(f,p){if(typeof f=="string")if(p){var _=d(p.as,p.crossOrigin);i.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(f)},Ln.requestFormReset=function(f){i.d.r(f)},Ln.unstable_batchedUpdates=function(f,p){return f(p)},Ln.useFormState=function(f,p,_){return u.H.useFormState(f,p,_)},Ln.useFormStatus=function(){return u.H.useHostTransitionStatus()},Ln.version="19.2.0",Ln}var Dv;function jC(){if(Dv)return Gp.exports;Dv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Gp.exports=JC(),Gp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kv;function XC(){if(kv)return Su;kv=1;var n=KC(),e=Xm(),t=jC();function i(s){var r="https://react.dev/errors/"+s;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+s+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var r=s,l=s;if(s.alternate)for(;r.return;)r=r.return;else{s=r;do r=s,(r.flags&4098)!==0&&(l=r.return),s=r.return;while(s)}return r.tag===3?l:null}function u(s){if(s.tag===13){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function d(s){if(s.tag===31){var r=s.memoizedState;if(r===null&&(s=s.alternate,s!==null&&(r=s.memoizedState)),r!==null)return r.dehydrated}return null}function f(s){if(a(s)!==s)throw Error(i(188))}function p(s){var r=s.alternate;if(!r){if(r=a(s),r===null)throw Error(i(188));return r!==s?null:s}for(var l=s,c=r;;){var y=l.return;if(y===null)break;var v=y.alternate;if(v===null){if(c=y.return,c!==null){l=c;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===l)return f(y),s;if(v===c)return f(y),r;v=v.sibling}throw Error(i(188))}if(l.return!==c.return)l=y,c=v;else{for(var w=!1,I=y.child;I;){if(I===l){w=!0,l=y,c=v;break}if(I===c){w=!0,c=y,l=v;break}I=I.sibling}if(!w){for(I=v.child;I;){if(I===l){w=!0,l=v,c=y;break}if(I===c){w=!0,c=v,l=y;break}I=I.sibling}if(!w)throw Error(i(189))}}if(l.alternate!==c)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?s:r}function _(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s;for(s=s.child;s!==null;){if(r=_(s),r!==null)return r;s=s.sibling}return null}var E=Object.assign,S=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),k=Symbol.for("react.portal"),V=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),J=Symbol.for("react.profiler"),j=Symbol.for("react.consumer"),Z=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function O(s){return s===null||typeof s!="object"?null:(s=U&&s[U]||s["@@iterator"],typeof s=="function"?s:null)}var D=Symbol.for("react.client.reference");function ct(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===D?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case V:return"Fragment";case J:return"Profiler";case z:return"StrictMode";case ae:return"Suspense";case oe:return"SuspenseList";case N:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case k:return"Portal";case Z:return s.displayName||"Context";case j:return(s._context.displayName||"Context")+".Consumer";case H:var r=s.render;return s=s.displayName,s||(s=r.displayName||r.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case x:return r=s.displayName||null,r!==null?r:ct(s.type)||"Memo";case M:r=s._payload,s=s._init;try{return ct(s(r))}catch{}}return null}var rt=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te={pending:!1,data:null,method:null,action:null},Ge=[],tt=-1;function F(s){return{current:s}}function ie(s){0>tt||(s.current=Ge[tt],Ge[tt]=null,tt--)}function he(s,r){tt++,Ge[tt]=s.current,s.current=r}var fe=F(null),we=F(null),ke=F(null),ye=F(null);function jt(s,r){switch(he(ke,r),he(we,s),he(fe,null),r.nodeType){case 9:case 11:s=(s=r.documentElement)&&(s=s.namespaceURI)?j_(s):0;break;default:if(s=r.tagName,r=r.namespaceURI)r=j_(r),s=X_(r,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ie(fe),he(fe,s)}function It(){ie(fe),ie(we),ie(ke)}function Bs(s){s.memoizedState!==null&&he(ye,s);var r=fe.current,l=X_(r,s.type);r!==l&&(he(we,s),he(fe,l))}function di(s){we.current===s&&(ie(fe),ie(we)),ye.current===s&&(ie(ye),yu._currentValue=Te)}var qs,ds;function Xt(s){if(qs===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);qs=r&&r[1]||"",ds=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+qs+s+ds}var Yi=!1;function $i(s,r){if(!s||Yi)return"";Yi=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var se=function(){throw Error()};if(Object.defineProperty(se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(se,[])}catch(Q){var K=Q}Reflect.construct(s,[],se)}else{try{se.call()}catch(Q){K=Q}s.call(se.prototype)}}else{try{throw Error()}catch(Q){K=Q}(se=s())&&typeof se.catch=="function"&&se.catch(function(){})}}catch(Q){if(Q&&K&&typeof Q.stack=="string")return[Q.stack,K.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=c.DetermineComponentFrameRoot(),w=v[0],I=v[1];if(w&&I){var L=w.split(`
`),$=I.split(`
`);for(y=c=0;c<L.length&&!L[c].includes("DetermineComponentFrameRoot");)c++;for(;y<$.length&&!$[y].includes("DetermineComponentFrameRoot");)y++;if(c===L.length||y===$.length)for(c=L.length-1,y=$.length-1;1<=c&&0<=y&&L[c]!==$[y];)y--;for(;1<=c&&0<=y;c--,y--)if(L[c]!==$[y]){if(c!==1||y!==1)do if(c--,y--,0>y||L[c]!==$[y]){var te=`
`+L[c].replace(" at new "," at ");return s.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",s.displayName)),te}while(1<=c&&0<=y);break}}}finally{Yi=!1,Error.prepareStackTrace=l}return(l=s?s.displayName||s.name:"")?Xt(l):""}function br(s,r){switch(s.tag){case 26:case 27:case 5:return Xt(s.type);case 16:return Xt("Lazy");case 13:return s.child!==r&&r!==null?Xt("Suspense Fallback"):Xt("Suspense");case 19:return Xt("SuspenseList");case 0:case 15:return $i(s.type,!1);case 11:return $i(s.type.render,!1);case 1:return $i(s.type,!0);case 31:return Xt("Activity");default:return""}}function Ci(s){try{var r="",l=null;do r+=br(s,l),l=s,s=s.return;while(s);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var zt=Object.prototype.hasOwnProperty,Rt=n.unstable_scheduleCallback,Ki=n.unstable_cancelCallback,Ji=n.unstable_shouldYield,hs=n.unstable_requestPaint,fn=n.unstable_now,fs=n.unstable_getCurrentPriorityLevel,ji=n.unstable_ImmediatePriority,Ao=n.unstable_UserBlockingPriority,Xn=n.unstable_NormalPriority,Pl=n.unstable_LowPriority,ps=n.unstable_IdlePriority,fa=n.log,Hs=n.unstable_setDisableYieldValue,hi=null,Ut=null;function Qn(s){if(typeof fa=="function"&&Hs(s),Ut&&typeof Ut.setStrictMode=="function")try{Ut.setStrictMode(hi,s)}catch{}}var wt=Math.clz32?Math.clz32:fi,pa=Math.log,wr=Math.LN2;function fi(s){return s>>>=0,s===0?32:31-(pa(s)/wr|0)|0}var xi=256,Tn=262144,Yt=4194304;function pi(s){var r=s&42;if(r!==0)return r;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ii(s,r,l){var c=s.pendingLanes;if(c===0)return 0;var y=0,v=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var I=c&134217727;return I!==0?(c=I&~v,c!==0?y=pi(c):(w&=I,w!==0?y=pi(w):l||(l=I&~s,l!==0&&(y=pi(l))))):(I=c&~v,I!==0?y=pi(I):w!==0?y=pi(w):l||(l=c&~s,l!==0&&(y=pi(l)))),y===0?0:r!==0&&r!==y&&(r&v)===0&&(v=y&-y,l=r&-r,v>=l||v===32&&(l&4194048)!==0)?r:y}function mi(s,r){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&r)===0}function Co(s,r){switch(s){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ma(){var s=Yt;return Yt<<=1,(Yt&62914560)===0&&(Yt=4194304),s}function Ri(s){for(var r=[],l=0;31>l;l++)r.push(s);return r}function Gs(s,r){s.pendingLanes|=r,r!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function ga(s,r,l,c,y,v){var w=s.pendingLanes;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=l,s.entangledLanes&=l,s.errorRecoveryDisabledLanes&=l,s.shellSuspendCounter=0;var I=s.entanglements,L=s.expirationTimes,$=s.hiddenUpdates;for(l=w&~l;0<l;){var te=31-wt(l),se=1<<te;I[te]=0,L[te]=-1;var K=$[te];if(K!==null)for($[te]=null,te=0;te<K.length;te++){var Q=K[te];Q!==null&&(Q.lane&=-536870913)}l&=~se}c!==0&&ms(s,c,0),v!==0&&y===0&&s.tag!==0&&(s.suspendedLanes|=v&~(w&~r))}function ms(s,r,l){s.pendingLanes|=r,s.suspendedLanes&=~r;var c=31-wt(r);s.entangledLanes|=r,s.entanglements[c]=s.entanglements[c]|1073741824|l&261930}function Ar(s,r){var l=s.entangledLanes|=r;for(s=s.entanglements;l;){var c=31-wt(l),y=1<<c;y&r|s[c]&r&&(s[c]|=r),l&=~y}}function ue(s,r){var l=r&-r;return l=(l&42)!==0?1:Se(l),(l&(s.suspendedLanes|r))!==0?0:l}function Se(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ne(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Je(){var s=ce.p;return s!==0?s:(s=window.event,s===void 0?32:vv(s.type))}function ot(s,r){var l=ce.p;try{return ce.p=s,r()}finally{ce.p=l}}var it=Math.random().toString(36).slice(2),Ce="__reactFiber$"+it,Ye="__reactProps$"+it,Sn="__reactContainer$"+it,Ft="__reactEvents$"+it,Wn="__reactListeners$"+it,Zn="__reactHandles$"+it,gs="__reactResources$"+it,_n="__reactMarker$"+it;function Ni(s){delete s[Ce],delete s[Ye],delete s[Ft],delete s[Wn],delete s[Zn]}function rn(s){var r=s[Ce];if(r)return r;for(var l=s.parentNode;l;){if(r=l[Sn]||l[Ce]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(s=iv(s);s!==null;){if(l=s[Ce])return l;s=iv(s)}return r}s=l,l=s.parentNode}return null}function Ue(s){if(s=s[Ce]||s[Sn]){var r=s.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return s}return null}function vt(s){var r=s.tag;if(r===5||r===26||r===27||r===6)return s.stateNode;throw Error(i(33))}function Gn(s){var r=s[gs];return r||(r=s[gs]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function At(s){s[_n]=!0}var Dn=new Set,ve={};function kn(s,r){De(s,r),De(s+"Capture",r)}function De(s,r){for(ve[s]=r,s=0;s<r.length;s++)Dn.add(r[s])}var Re=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ve={},st={};function Bt(s){return zt.call(st,s)?!0:zt.call(Ve,s)?!1:Re.test(s)?st[s]=!0:(Ve[s]=!0,!1)}function Yn(s,r,l){if(Bt(r))if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":s.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){s.removeAttribute(r);return}}s.setAttribute(r,""+l)}}function Nt(s,r,l){if(l===null)s.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(r);return}s.setAttribute(r,""+l)}}function dt(s,r,l,c){if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttributeNS(r,l,""+c)}}function Lt(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function $n(s){var r=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Qt(s,r,l){var c=Object.getOwnPropertyDescriptor(s.constructor.prototype,r);if(!s.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var y=c.get,v=c.set;return Object.defineProperty(s,r,{configurable:!0,get:function(){return y.call(this)},set:function(w){l=""+w,v.call(this,w)}}),Object.defineProperty(s,r,{enumerable:c.enumerable}),{getValue:function(){return l},setValue:function(w){l=""+w},stopTracking:function(){s._valueTracker=null,delete s[r]}}}}function Oe(s){if(!s._valueTracker){var r=$n(s)?"checked":"value";s._valueTracker=Qt(s,r,""+s[r])}}function Wt(s){if(!s)return!1;var r=s._valueTracker;if(!r)return!0;var l=r.getValue(),c="";return s&&(c=$n(s)?s.checked?"true":"false":s.value),s=c,s!==l?(r.setValue(s),!0):!1}function bn(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var Un=/[\n"\\]/g;function $t(s){return s.replace(Un,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function pt(s,r,l,c,y,v,w,I){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),r!=null?w==="number"?(r===0&&s.value===""||s.value!=r)&&(s.value=""+Lt(r)):s.value!==""+Lt(r)&&(s.value=""+Lt(r)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),r!=null?ei(s,w,Lt(r)):l!=null?ei(s,w,Lt(l)):c!=null&&s.removeAttribute("value"),y==null&&v!=null&&(s.defaultChecked=!!v),y!=null&&(s.checked=y&&typeof y!="function"&&typeof y!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+Lt(I):s.removeAttribute("name")}function wn(s,r,l,c,y,v,w,I){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.type=v),r!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||r!=null)){Oe(s);return}l=l!=null?""+Lt(l):"",r=r!=null?""+Lt(r):l,I||r===s.value||(s.value=r),s.defaultValue=r}c=c??y,c=typeof c!="function"&&typeof c!="symbol"&&!!c,s.checked=I?s.checked:!!c,s.defaultChecked=!!c,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w),Oe(s)}function ei(s,r,l){r==="number"&&bn(s.ownerDocument)===s||s.defaultValue===""+l||(s.defaultValue=""+l)}function Zt(s,r,l,c){if(s=s.options,r){r={};for(var y=0;y<l.length;y++)r["$"+l[y]]=!0;for(l=0;l<s.length;l++)y=r.hasOwnProperty("$"+s[l].value),s[l].selected!==y&&(s[l].selected=y),y&&c&&(s[l].defaultSelected=!0)}else{for(l=""+Lt(l),r=null,y=0;y<s.length;y++){if(s[y].value===l){s[y].selected=!0,c&&(s[y].defaultSelected=!0);return}r!==null||s[y].disabled||(r=s[y])}r!==null&&(r.selected=!0)}}function gi(s,r,l){if(r!=null&&(r=""+Lt(r),r!==s.value&&(s.value=r),l==null)){s.defaultValue!==r&&(s.defaultValue=r);return}s.defaultValue=l!=null?""+Lt(l):""}function qt(s,r,l,c){if(r==null){if(c!=null){if(l!=null)throw Error(i(92));if(rt(c)){if(1<c.length)throw Error(i(93));c=c[0]}l=c}l==null&&(l=""),r=l}l=Lt(r),s.defaultValue=l,c=s.textContent,c===l&&c!==""&&c!==null&&(s.value=c),Oe(s)}function gt(s,r){if(r){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=r;return}}s.textContent=r}var yi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ys(s,r,l){var c=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?s.setProperty(r,""):r==="float"?s.cssFloat="":s[r]="":c?s.setProperty(r,l):typeof l!="number"||l===0||yi.has(r)?r==="float"?s.cssFloat=l:s[r]=(""+l).trim():s[r]=l+"px"}function Xi(s,r,l){if(r!=null&&typeof r!="object")throw Error(i(62));if(s=s.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?s.setProperty(c,""):c==="float"?s.cssFloat="":s[c]="");for(var y in r)c=r[y],r.hasOwnProperty(y)&&l[y]!==c&&Ys(s,y,c)}else for(var v in r)r.hasOwnProperty(v)&&Ys(s,v,r[v])}function ti(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qi=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ys=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ya(s){return ys.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Wi(){}var Dl=null;function Mi(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Cr=null,_s=null;function xo(s){var r=Ue(s);if(r&&(s=r.stateNode)){var l=s[Ye]||null;e:switch(s=r.stateNode,r.type){case"input":if(pt(s,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+$t(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var c=l[r];if(c!==s&&c.form===s.form){var y=c[Ye]||null;if(!y)throw Error(i(90));pt(c,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(r=0;r<l.length;r++)c=l[r],c.form===s.form&&Wt(c)}break e;case"textarea":gi(s,l.value,l.defaultValue);break e;case"select":r=l.value,r!=null&&Zt(s,!!l.multiple,r,!1)}}}var _a=!1;function xr(s,r,l){if(_a)return s(r,l);_a=!0;try{var c=s(r);return c}finally{if(_a=!1,(Cr!==null||_s!==null)&&(Zc(),Cr&&(r=Cr,s=_s,_s=Cr=null,xo(r),s)))for(r=0;r<s.length;r++)xo(s[r])}}function Zi(s,r){var l=s.stateNode;if(l===null)return null;var c=l[Ye]||null;if(c===null)return null;l=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(s=s.type,c=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!c;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var Pi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Io=!1;if(Pi)try{var Et={};Object.defineProperty(Et,"passive",{get:function(){Io=!0}}),window.addEventListener("test",Et,Et),window.removeEventListener("test",Et,Et)}catch{Io=!1}var vs=null,kl=null,Ro=null;function Ul(){if(Ro)return Ro;var s,r=kl,l=r.length,c,y="value"in vs?vs.value:vs.textContent,v=y.length;for(s=0;s<l&&r[s]===y[s];s++);var w=l-s;for(c=1;c<=w&&r[l-c]===y[v-c];c++);return Ro=y.slice(s,1<c?1-c:void 0)}function No(s){var r=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&r===13&&(s=13)):s=r,s===10&&(s=13),32<=s||s===13?s:0}function $s(){return!0}function es(){return!1}function An(s){function r(l,c,y,v,w){this._reactName=l,this._targetInst=y,this.type=c,this.nativeEvent=v,this.target=w,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(l=s[I],this[I]=l?l(v):v[I]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?$s:es,this.isPropagationStopped=es,this}return E(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=$s)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=$s)},persist:function(){},isPersistent:$s}),r}var Ks={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Es=An(Ks),Ir=E({},Ks,{view:0,detail:0}),Ll=An(Ir),Rr,va,Ts,Ea=E({},Ir,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ts&&(Ts&&s.type==="mousemove"?(Rr=s.screenX-Ts.screenX,va=s.screenY-Ts.screenY):va=Rr=0,Ts=s),Rr)},movementY:function(s){return"movementY"in s?s.movementY:va}}),Vl=An(Ea),Mo=E({},Ea,{dataTransfer:0}),ac=An(Mo),lc=E({},Ir,{relatedTarget:0}),Po=An(lc),Ol=E({},Ks,{animationName:0,elapsedTime:0,pseudoElement:0}),uc=An(Ol),Ta=E({},Ks,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),cc=An(Ta),dc=E({},Ks,{data:0}),Ss=An(dc),hc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mc(s){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(s):(s=pc[s])?!!r[s]:!1}function Nr(){return mc}var Kn=E({},Ir,{key:function(s){if(s.key){var r=hc[s.key]||s.key;if(r!=="Unidentified")return r}return s.type==="keypress"?(s=No(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?fc[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nr,charCode:function(s){return s.type==="keypress"?No(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?No(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),gc=An(Kn),yc=E({},Ea,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Js=An(yc),g=E({},Ir,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nr}),b=An(g),A=E({},Ks,{propertyName:0,elapsedTime:0,pseudoElement:0}),R=An(A),G=E({},Ea,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),X=An(G),de=E({},Ks,{newState:0,oldState:0}),Be=An(de),en=[9,13,27,32],ht=Pi&&"CompositionEvent"in window,Vt=null;Pi&&"documentMode"in document&&(Vt=document.documentMode);var Di=Pi&&"TextEvent"in window&&!Vt,bs=Pi&&(!ht||Vt&&8<Vt&&11>=Vt),ts=" ",ns=!1;function Do(s,r){switch(s){case"keyup":return en.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sa(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ba=!1;function fA(s,r){switch(s){case"compositionend":return Sa(r);case"keypress":return r.which!==32?null:(ns=!0,ts);case"textInput":return s=r.data,s===ts&&ns?null:s;default:return null}}function pA(s,r){if(ba)return s==="compositionend"||!ht&&Do(s,r)?(s=Ul(),Ro=kl=vs=null,ba=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return bs&&r.locale!=="ko"?null:r.data;default:return null}}var mA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function oy(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r==="input"?!!mA[s.type]:r==="textarea"}function ay(s,r,l,c){Cr?_s?_s.push(c):_s=[c]:Cr=c,r=od(r,"onChange"),0<r.length&&(l=new Es("onChange","change",null,l,c),s.push({event:l,listeners:r}))}var zl=null,Fl=null;function gA(s){H_(s,0)}function _c(s){var r=vt(s);if(Wt(r))return s}function ly(s,r){if(s==="change")return r}var uy=!1;if(Pi){var Yh;if(Pi){var $h="oninput"in document;if(!$h){var cy=document.createElement("div");cy.setAttribute("oninput","return;"),$h=typeof cy.oninput=="function"}Yh=$h}else Yh=!1;uy=Yh&&(!document.documentMode||9<document.documentMode)}function dy(){zl&&(zl.detachEvent("onpropertychange",hy),Fl=zl=null)}function hy(s){if(s.propertyName==="value"&&_c(Fl)){var r=[];ay(r,Fl,s,Mi(s)),xr(gA,r)}}function yA(s,r,l){s==="focusin"?(dy(),zl=r,Fl=l,zl.attachEvent("onpropertychange",hy)):s==="focusout"&&dy()}function _A(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return _c(Fl)}function vA(s,r){if(s==="click")return _c(r)}function EA(s,r){if(s==="input"||s==="change")return _c(r)}function TA(s,r){return s===r&&(s!==0||1/s===1/r)||s!==s&&r!==r}var _i=typeof Object.is=="function"?Object.is:TA;function Bl(s,r){if(_i(s,r))return!0;if(typeof s!="object"||s===null||typeof r!="object"||r===null)return!1;var l=Object.keys(s),c=Object.keys(r);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var y=l[c];if(!zt.call(r,y)||!_i(s[y],r[y]))return!1}return!0}function fy(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function py(s,r){var l=fy(s);s=0;for(var c;l;){if(l.nodeType===3){if(c=s+l.textContent.length,s<=r&&c>=r)return{node:l,offset:r-s};s=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=fy(l)}}function my(s,r){return s&&r?s===r?!0:s&&s.nodeType===3?!1:r&&r.nodeType===3?my(s,r.parentNode):"contains"in s?s.contains(r):s.compareDocumentPosition?!!(s.compareDocumentPosition(r)&16):!1:!1}function gy(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var r=bn(s.document);r instanceof s.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)s=r.contentWindow;else break;r=bn(s.document)}return r}function Kh(s){var r=s&&s.nodeName&&s.nodeName.toLowerCase();return r&&(r==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||r==="textarea"||s.contentEditable==="true")}var SA=Pi&&"documentMode"in document&&11>=document.documentMode,wa=null,Jh=null,ql=null,jh=!1;function yy(s,r,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;jh||wa==null||wa!==bn(c)||(c=wa,"selectionStart"in c&&Kh(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),ql&&Bl(ql,c)||(ql=c,c=od(Jh,"onSelect"),0<c.length&&(r=new Es("onSelect","select",null,r,l),s.push({event:r,listeners:c}),r.target=wa)))}function ko(s,r){var l={};return l[s.toLowerCase()]=r.toLowerCase(),l["Webkit"+s]="webkit"+r,l["Moz"+s]="moz"+r,l}var Aa={animationend:ko("Animation","AnimationEnd"),animationiteration:ko("Animation","AnimationIteration"),animationstart:ko("Animation","AnimationStart"),transitionrun:ko("Transition","TransitionRun"),transitionstart:ko("Transition","TransitionStart"),transitioncancel:ko("Transition","TransitionCancel"),transitionend:ko("Transition","TransitionEnd")},Xh={},_y={};Pi&&(_y=document.createElement("div").style,"AnimationEvent"in window||(delete Aa.animationend.animation,delete Aa.animationiteration.animation,delete Aa.animationstart.animation),"TransitionEvent"in window||delete Aa.transitionend.transition);function Uo(s){if(Xh[s])return Xh[s];if(!Aa[s])return s;var r=Aa[s],l;for(l in r)if(r.hasOwnProperty(l)&&l in _y)return Xh[s]=r[l];return s}var vy=Uo("animationend"),Ey=Uo("animationiteration"),Ty=Uo("animationstart"),bA=Uo("transitionrun"),wA=Uo("transitionstart"),AA=Uo("transitioncancel"),Sy=Uo("transitionend"),by=new Map,Qh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Qh.push("scrollEnd");function is(s,r){by.set(s,r),kn(r,[s])}var vc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},ki=[],Ca=0,Wh=0;function Ec(){for(var s=Ca,r=Wh=Ca=0;r<s;){var l=ki[r];ki[r++]=null;var c=ki[r];ki[r++]=null;var y=ki[r];ki[r++]=null;var v=ki[r];if(ki[r++]=null,c!==null&&y!==null){var w=c.pending;w===null?y.next=y:(y.next=w.next,w.next=y),c.pending=y}v!==0&&wy(l,y,v)}}function Tc(s,r,l,c){ki[Ca++]=s,ki[Ca++]=r,ki[Ca++]=l,ki[Ca++]=c,Wh|=c,s.lanes|=c,s=s.alternate,s!==null&&(s.lanes|=c)}function Zh(s,r,l,c){return Tc(s,r,l,c),Sc(s)}function Lo(s,r){return Tc(s,null,null,r),Sc(s)}function wy(s,r,l){s.lanes|=l;var c=s.alternate;c!==null&&(c.lanes|=l);for(var y=!1,v=s.return;v!==null;)v.childLanes|=l,c=v.alternate,c!==null&&(c.childLanes|=l),v.tag===22&&(s=v.stateNode,s===null||s._visibility&1||(y=!0)),s=v,v=v.return;return s.tag===3?(v=s.stateNode,y&&r!==null&&(y=31-wt(l),s=v.hiddenUpdates,c=s[y],c===null?s[y]=[r]:c.push(r),r.lane=l|536870912),v):null}function Sc(s){if(50<cu)throw cu=0,up=null,Error(i(185));for(var r=s.return;r!==null;)s=r,r=s.return;return s.tag===3?s.stateNode:null}var xa={};function CA(s,r,l,c){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vi(s,r,l,c){return new CA(s,r,l,c)}function ef(s){return s=s.prototype,!(!s||!s.isReactComponent)}function js(s,r){var l=s.alternate;return l===null?(l=vi(s.tag,r,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=r,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&65011712,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,r=s.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l.refCleanup=s.refCleanup,l}function Ay(s,r){s.flags&=65011714;var l=s.alternate;return l===null?(s.childLanes=0,s.lanes=r,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,r=l.dependencies,s.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),s}function bc(s,r,l,c,y,v){var w=0;if(c=s,typeof s=="function")ef(s)&&(w=1);else if(typeof s=="string")w=MC(s,l,fe.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case N:return s=vi(31,l,r,y),s.elementType=N,s.lanes=v,s;case V:return Vo(l.children,y,v,r);case z:w=8,y|=24;break;case J:return s=vi(12,l,r,y|2),s.elementType=J,s.lanes=v,s;case ae:return s=vi(13,l,r,y),s.elementType=ae,s.lanes=v,s;case oe:return s=vi(19,l,r,y),s.elementType=oe,s.lanes=v,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case Z:w=10;break e;case j:w=9;break e;case H:w=11;break e;case x:w=14;break e;case M:w=16,c=null;break e}w=29,l=Error(i(130,s===null?"null":typeof s,"")),c=null}return r=vi(w,l,r,y),r.elementType=s,r.type=c,r.lanes=v,r}function Vo(s,r,l,c){return s=vi(7,s,c,r),s.lanes=l,s}function tf(s,r,l){return s=vi(6,s,null,r),s.lanes=l,s}function Cy(s){var r=vi(18,null,null,0);return r.stateNode=s,r}function nf(s,r,l){return r=vi(4,s.children!==null?s.children:[],s.key,r),r.lanes=l,r.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},r}var xy=new WeakMap;function Ui(s,r){if(typeof s=="object"&&s!==null){var l=xy.get(s);return l!==void 0?l:(r={value:s,source:r,stack:Ci(r)},xy.set(s,r),r)}return{value:s,source:r,stack:Ci(r)}}var Ia=[],Ra=0,wc=null,Hl=0,Li=[],Vi=0,Mr=null,ws=1,As="";function Xs(s,r){Ia[Ra++]=Hl,Ia[Ra++]=wc,wc=s,Hl=r}function Iy(s,r,l){Li[Vi++]=ws,Li[Vi++]=As,Li[Vi++]=Mr,Mr=s;var c=ws;s=As;var y=32-wt(c)-1;c&=~(1<<y),l+=1;var v=32-wt(r)+y;if(30<v){var w=y-y%5;v=(c&(1<<w)-1).toString(32),c>>=w,y-=w,ws=1<<32-wt(r)+y|l<<y|c,As=v+s}else ws=1<<v|l<<y|c,As=s}function sf(s){s.return!==null&&(Xs(s,1),Iy(s,1,0))}function rf(s){for(;s===wc;)wc=Ia[--Ra],Ia[Ra]=null,Hl=Ia[--Ra],Ia[Ra]=null;for(;s===Mr;)Mr=Li[--Vi],Li[Vi]=null,As=Li[--Vi],Li[Vi]=null,ws=Li[--Vi],Li[Vi]=null}function Ry(s,r){Li[Vi++]=ws,Li[Vi++]=As,Li[Vi++]=Mr,ws=r.id,As=r.overflow,Mr=s}var Cn=null,Mt=null,et=!1,Pr=null,Oi=!1,of=Error(i(519));function Dr(s){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Gl(Ui(r,s)),of}function Ny(s){var r=s.stateNode,l=s.type,c=s.memoizedProps;switch(r[Ce]=s,r[Ye]=c,l){case"dialog":Ke("cancel",r),Ke("close",r);break;case"iframe":case"object":case"embed":Ke("load",r);break;case"video":case"audio":for(l=0;l<hu.length;l++)Ke(hu[l],r);break;case"source":Ke("error",r);break;case"img":case"image":case"link":Ke("error",r),Ke("load",r);break;case"details":Ke("toggle",r);break;case"input":Ke("invalid",r),wn(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Ke("invalid",r);break;case"textarea":Ke("invalid",r),qt(r,c.value,c.defaultValue,c.children)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||c.suppressHydrationWarning===!0||K_(r.textContent,l)?(c.popover!=null&&(Ke("beforetoggle",r),Ke("toggle",r)),c.onScroll!=null&&Ke("scroll",r),c.onScrollEnd!=null&&Ke("scrollend",r),c.onClick!=null&&(r.onclick=Wi),r=!0):r=!1,r||Dr(s,!0)}function My(s){for(Cn=s.return;Cn;)switch(Cn.tag){case 5:case 31:case 13:Oi=!1;return;case 27:case 3:Oi=!0;return;default:Cn=Cn.return}}function Na(s){if(s!==Cn)return!1;if(!et)return My(s),et=!0,!1;var r=s.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=s.type,l=!(l!=="form"&&l!=="button")||wp(s.type,s.memoizedProps)),l=!l),l&&Mt&&Dr(s),My(s),r===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Mt=nv(s)}else if(r===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Mt=nv(s)}else r===27?(r=Mt,Kr(s.type)?(s=Rp,Rp=null,Mt=s):Mt=r):Mt=Cn?Fi(s.stateNode.nextSibling):null;return!0}function Oo(){Mt=Cn=null,et=!1}function af(){var s=Pr;return s!==null&&(ri===null?ri=s:ri.push.apply(ri,s),Pr=null),s}function Gl(s){Pr===null?Pr=[s]:Pr.push(s)}var lf=F(null),zo=null,Qs=null;function kr(s,r,l){he(lf,r._currentValue),r._currentValue=l}function Ws(s){s._currentValue=lf.current,ie(lf)}function uf(s,r,l){for(;s!==null;){var c=s.alternate;if((s.childLanes&r)!==r?(s.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),s===l)break;s=s.return}}function cf(s,r,l,c){var y=s.child;for(y!==null&&(y.return=s);y!==null;){var v=y.dependencies;if(v!==null){var w=y.child;v=v.firstContext;e:for(;v!==null;){var I=v;v=y;for(var L=0;L<r.length;L++)if(I.context===r[L]){v.lanes|=l,I=v.alternate,I!==null&&(I.lanes|=l),uf(v.return,l,s),c||(w=null);break e}v=I.next}}else if(y.tag===18){if(w=y.return,w===null)throw Error(i(341));w.lanes|=l,v=w.alternate,v!==null&&(v.lanes|=l),uf(w,l,s),w=null}else w=y.child;if(w!==null)w.return=y;else for(w=y;w!==null;){if(w===s){w=null;break}if(y=w.sibling,y!==null){y.return=w.return,w=y;break}w=w.return}y=w}}function Ma(s,r,l,c){s=null;for(var y=r,v=!1;y!==null;){if(!v){if((y.flags&524288)!==0)v=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var w=y.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var I=y.type;_i(y.pendingProps.value,w.value)||(s!==null?s.push(I):s=[I])}}else if(y===ye.current){if(w=y.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(s!==null?s.push(yu):s=[yu])}y=y.return}s!==null&&cf(r,s,l,c),r.flags|=262144}function Ac(s){for(s=s.firstContext;s!==null;){if(!_i(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Fo(s){zo=s,Qs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function xn(s){return Py(zo,s)}function Cc(s,r){return zo===null&&Fo(s),Py(s,r)}function Py(s,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},Qs===null){if(s===null)throw Error(i(308));Qs=r,s.dependencies={lanes:0,firstContext:r},s.flags|=524288}else Qs=Qs.next=r;return l}var xA=typeof AbortController<"u"?AbortController:function(){var s=[],r=this.signal={aborted:!1,addEventListener:function(l,c){s.push(c)}};this.abort=function(){r.aborted=!0,s.forEach(function(l){return l()})}},IA=n.unstable_scheduleCallback,RA=n.unstable_NormalPriority,on={$$typeof:Z,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function df(){return{controller:new xA,data:new Map,refCount:0}}function Yl(s){s.refCount--,s.refCount===0&&IA(RA,function(){s.controller.abort()})}var $l=null,hf=0,Pa=0,Da=null;function NA(s,r){if($l===null){var l=$l=[];hf=0,Pa=mp(),Da={status:"pending",value:void 0,then:function(c){l.push(c)}}}return hf++,r.then(Dy,Dy),r}function Dy(){if(--hf===0&&$l!==null){Da!==null&&(Da.status="fulfilled");var s=$l;$l=null,Pa=0,Da=null;for(var r=0;r<s.length;r++)(0,s[r])()}}function MA(s,r){var l=[],c={status:"pending",value:null,reason:null,then:function(y){l.push(y)}};return s.then(function(){c.status="fulfilled",c.value=r;for(var y=0;y<l.length;y++)(0,l[y])(r)},function(y){for(c.status="rejected",c.reason=y,y=0;y<l.length;y++)(0,l[y])(void 0)}),c}var ky=W.S;W.S=function(s,r){y_=fn(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&NA(s,r),ky!==null&&ky(s,r)};var Bo=F(null);function ff(){var s=Bo.current;return s!==null?s:Ct.pooledCache}function xc(s,r){r===null?he(Bo,Bo.current):he(Bo,r.pool)}function Uy(){var s=ff();return s===null?null:{parent:on._currentValue,pool:s}}var ka=Error(i(460)),pf=Error(i(474)),Ic=Error(i(542)),Rc={then:function(){}};function Ly(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Vy(s,r,l){switch(l=s[l],l===void 0?s.push(r):l!==r&&(r.then(Wi,Wi),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,zy(s),s;default:if(typeof r.status=="string")r.then(Wi,Wi);else{if(s=Ct,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=r,s.status="pending",s.then(function(c){if(r.status==="pending"){var y=r;y.status="fulfilled",y.value=c}},function(c){if(r.status==="pending"){var y=r;y.status="rejected",y.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw s=r.reason,zy(s),s}throw Ho=r,ka}}function qo(s){try{var r=s._init;return r(s._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Ho=l,ka):l}}var Ho=null;function Oy(){if(Ho===null)throw Error(i(459));var s=Ho;return Ho=null,s}function zy(s){if(s===ka||s===Ic)throw Error(i(483))}var Ua=null,Kl=0;function Nc(s){var r=Kl;return Kl+=1,Ua===null&&(Ua=[]),Vy(Ua,s,r)}function Jl(s,r){r=r.props.ref,s.ref=r!==void 0?r:null}function Mc(s,r){throw r.$$typeof===S?Error(i(525)):(s=Object.prototype.toString.call(r),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":s)))}function Fy(s){function r(q,B){if(s){var Y=q.deletions;Y===null?(q.deletions=[B],q.flags|=16):Y.push(B)}}function l(q,B){if(!s)return null;for(;B!==null;)r(q,B),B=B.sibling;return null}function c(q){for(var B=new Map;q!==null;)q.key!==null?B.set(q.key,q):B.set(q.index,q),q=q.sibling;return B}function y(q,B){return q=js(q,B),q.index=0,q.sibling=null,q}function v(q,B,Y){return q.index=Y,s?(Y=q.alternate,Y!==null?(Y=Y.index,Y<B?(q.flags|=67108866,B):Y):(q.flags|=67108866,B)):(q.flags|=1048576,B)}function w(q){return s&&q.alternate===null&&(q.flags|=67108866),q}function I(q,B,Y,ne){return B===null||B.tag!==6?(B=tf(Y,q.mode,ne),B.return=q,B):(B=y(B,Y),B.return=q,B)}function L(q,B,Y,ne){var be=Y.type;return be===V?te(q,B,Y.props.children,ne,Y.key):B!==null&&(B.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===M&&qo(be)===B.type)?(B=y(B,Y.props),Jl(B,Y),B.return=q,B):(B=bc(Y.type,Y.key,Y.props,null,q.mode,ne),Jl(B,Y),B.return=q,B)}function $(q,B,Y,ne){return B===null||B.tag!==4||B.stateNode.containerInfo!==Y.containerInfo||B.stateNode.implementation!==Y.implementation?(B=nf(Y,q.mode,ne),B.return=q,B):(B=y(B,Y.children||[]),B.return=q,B)}function te(q,B,Y,ne,be){return B===null||B.tag!==7?(B=Vo(Y,q.mode,ne,be),B.return=q,B):(B=y(B,Y),B.return=q,B)}function se(q,B,Y){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=tf(""+B,q.mode,Y),B.return=q,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case C:return Y=bc(B.type,B.key,B.props,null,q.mode,Y),Jl(Y,B),Y.return=q,Y;case k:return B=nf(B,q.mode,Y),B.return=q,B;case M:return B=qo(B),se(q,B,Y)}if(rt(B)||O(B))return B=Vo(B,q.mode,Y,null),B.return=q,B;if(typeof B.then=="function")return se(q,Nc(B),Y);if(B.$$typeof===Z)return se(q,Cc(q,B),Y);Mc(q,B)}return null}function K(q,B,Y,ne){var be=B!==null?B.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return be!==null?null:I(q,B,""+Y,ne);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case C:return Y.key===be?L(q,B,Y,ne):null;case k:return Y.key===be?$(q,B,Y,ne):null;case M:return Y=qo(Y),K(q,B,Y,ne)}if(rt(Y)||O(Y))return be!==null?null:te(q,B,Y,ne,null);if(typeof Y.then=="function")return K(q,B,Nc(Y),ne);if(Y.$$typeof===Z)return K(q,B,Cc(q,Y),ne);Mc(q,Y)}return null}function Q(q,B,Y,ne,be){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return q=q.get(Y)||null,I(B,q,""+ne,be);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case C:return q=q.get(ne.key===null?Y:ne.key)||null,L(B,q,ne,be);case k:return q=q.get(ne.key===null?Y:ne.key)||null,$(B,q,ne,be);case M:return ne=qo(ne),Q(q,B,Y,ne,be)}if(rt(ne)||O(ne))return q=q.get(Y)||null,te(B,q,ne,be,null);if(typeof ne.then=="function")return Q(q,B,Y,Nc(ne),be);if(ne.$$typeof===Z)return Q(q,B,Y,Cc(B,ne),be);Mc(B,ne)}return null}function ge(q,B,Y,ne){for(var be=null,at=null,_e=B,He=B=0,Xe=null;_e!==null&&He<Y.length;He++){_e.index>He?(Xe=_e,_e=null):Xe=_e.sibling;var lt=K(q,_e,Y[He],ne);if(lt===null){_e===null&&(_e=Xe);break}s&&_e&&lt.alternate===null&&r(q,_e),B=v(lt,B,He),at===null?be=lt:at.sibling=lt,at=lt,_e=Xe}if(He===Y.length)return l(q,_e),et&&Xs(q,He),be;if(_e===null){for(;He<Y.length;He++)_e=se(q,Y[He],ne),_e!==null&&(B=v(_e,B,He),at===null?be=_e:at.sibling=_e,at=_e);return et&&Xs(q,He),be}for(_e=c(_e);He<Y.length;He++)Xe=Q(_e,q,He,Y[He],ne),Xe!==null&&(s&&Xe.alternate!==null&&_e.delete(Xe.key===null?He:Xe.key),B=v(Xe,B,He),at===null?be=Xe:at.sibling=Xe,at=Xe);return s&&_e.forEach(function(Wr){return r(q,Wr)}),et&&Xs(q,He),be}function Ie(q,B,Y,ne){if(Y==null)throw Error(i(151));for(var be=null,at=null,_e=B,He=B=0,Xe=null,lt=Y.next();_e!==null&&!lt.done;He++,lt=Y.next()){_e.index>He?(Xe=_e,_e=null):Xe=_e.sibling;var Wr=K(q,_e,lt.value,ne);if(Wr===null){_e===null&&(_e=Xe);break}s&&_e&&Wr.alternate===null&&r(q,_e),B=v(Wr,B,He),at===null?be=Wr:at.sibling=Wr,at=Wr,_e=Xe}if(lt.done)return l(q,_e),et&&Xs(q,He),be;if(_e===null){for(;!lt.done;He++,lt=Y.next())lt=se(q,lt.value,ne),lt!==null&&(B=v(lt,B,He),at===null?be=lt:at.sibling=lt,at=lt);return et&&Xs(q,He),be}for(_e=c(_e);!lt.done;He++,lt=Y.next())lt=Q(_e,q,He,lt.value,ne),lt!==null&&(s&&lt.alternate!==null&&_e.delete(lt.key===null?He:lt.key),B=v(lt,B,He),at===null?be=lt:at.sibling=lt,at=lt);return s&&_e.forEach(function(qC){return r(q,qC)}),et&&Xs(q,He),be}function bt(q,B,Y,ne){if(typeof Y=="object"&&Y!==null&&Y.type===V&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case C:e:{for(var be=Y.key;B!==null;){if(B.key===be){if(be=Y.type,be===V){if(B.tag===7){l(q,B.sibling),ne=y(B,Y.props.children),ne.return=q,q=ne;break e}}else if(B.elementType===be||typeof be=="object"&&be!==null&&be.$$typeof===M&&qo(be)===B.type){l(q,B.sibling),ne=y(B,Y.props),Jl(ne,Y),ne.return=q,q=ne;break e}l(q,B);break}else r(q,B);B=B.sibling}Y.type===V?(ne=Vo(Y.props.children,q.mode,ne,Y.key),ne.return=q,q=ne):(ne=bc(Y.type,Y.key,Y.props,null,q.mode,ne),Jl(ne,Y),ne.return=q,q=ne)}return w(q);case k:e:{for(be=Y.key;B!==null;){if(B.key===be)if(B.tag===4&&B.stateNode.containerInfo===Y.containerInfo&&B.stateNode.implementation===Y.implementation){l(q,B.sibling),ne=y(B,Y.children||[]),ne.return=q,q=ne;break e}else{l(q,B);break}else r(q,B);B=B.sibling}ne=nf(Y,q.mode,ne),ne.return=q,q=ne}return w(q);case M:return Y=qo(Y),bt(q,B,Y,ne)}if(rt(Y))return ge(q,B,Y,ne);if(O(Y)){if(be=O(Y),typeof be!="function")throw Error(i(150));return Y=be.call(Y),Ie(q,B,Y,ne)}if(typeof Y.then=="function")return bt(q,B,Nc(Y),ne);if(Y.$$typeof===Z)return bt(q,B,Cc(q,Y),ne);Mc(q,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,B!==null&&B.tag===6?(l(q,B.sibling),ne=y(B,Y),ne.return=q,q=ne):(l(q,B),ne=tf(Y,q.mode,ne),ne.return=q,q=ne),w(q)):l(q,B)}return function(q,B,Y,ne){try{Kl=0;var be=bt(q,B,Y,ne);return Ua=null,be}catch(_e){if(_e===ka||_e===Ic)throw _e;var at=vi(29,_e,null,q.mode);return at.lanes=ne,at.return=q,at}finally{}}}var Go=Fy(!0),By=Fy(!1),Ur=!1;function mf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function gf(s,r){s=s.updateQueue,r.updateQueue===s&&(r.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Lr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Vr(s,r,l){var c=s.updateQueue;if(c===null)return null;if(c=c.shared,(ft&2)!==0){var y=c.pending;return y===null?r.next=r:(r.next=y.next,y.next=r),c.pending=r,r=Sc(s),wy(s,null,l),r}return Tc(s,c,r,l),Sc(s)}function jl(s,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var c=r.lanes;c&=s.pendingLanes,l|=c,r.lanes=l,Ar(s,l)}}function yf(s,r){var l=s.updateQueue,c=s.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var y=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var w={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?y=v=w:v=v.next=w,l=l.next}while(l!==null);v===null?y=v=r:v=v.next=r}else y=v=r;l={baseState:c.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:c.shared,callbacks:c.callbacks},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=r:s.next=r,l.lastBaseUpdate=r}var _f=!1;function Xl(){if(_f){var s=Da;if(s!==null)throw s}}function Ql(s,r,l,c){_f=!1;var y=s.updateQueue;Ur=!1;var v=y.firstBaseUpdate,w=y.lastBaseUpdate,I=y.shared.pending;if(I!==null){y.shared.pending=null;var L=I,$=L.next;L.next=null,w===null?v=$:w.next=$,w=L;var te=s.alternate;te!==null&&(te=te.updateQueue,I=te.lastBaseUpdate,I!==w&&(I===null?te.firstBaseUpdate=$:I.next=$,te.lastBaseUpdate=L))}if(v!==null){var se=y.baseState;w=0,te=$=L=null,I=v;do{var K=I.lane&-536870913,Q=K!==I.lane;if(Q?(je&K)===K:(c&K)===K){K!==0&&K===Pa&&(_f=!0),te!==null&&(te=te.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var ge=s,Ie=I;K=r;var bt=l;switch(Ie.tag){case 1:if(ge=Ie.payload,typeof ge=="function"){se=ge.call(bt,se,K);break e}se=ge;break e;case 3:ge.flags=ge.flags&-65537|128;case 0:if(ge=Ie.payload,K=typeof ge=="function"?ge.call(bt,se,K):ge,K==null)break e;se=E({},se,K);break e;case 2:Ur=!0}}K=I.callback,K!==null&&(s.flags|=64,Q&&(s.flags|=8192),Q=y.callbacks,Q===null?y.callbacks=[K]:Q.push(K))}else Q={lane:K,tag:I.tag,payload:I.payload,callback:I.callback,next:null},te===null?($=te=Q,L=se):te=te.next=Q,w|=K;if(I=I.next,I===null){if(I=y.shared.pending,I===null)break;Q=I,I=Q.next,Q.next=null,y.lastBaseUpdate=Q,y.shared.pending=null}}while(!0);te===null&&(L=se),y.baseState=L,y.firstBaseUpdate=$,y.lastBaseUpdate=te,v===null&&(y.shared.lanes=0),qr|=w,s.lanes=w,s.memoizedState=se}}function qy(s,r){if(typeof s!="function")throw Error(i(191,s));s.call(r)}function Hy(s,r){var l=s.callbacks;if(l!==null)for(s.callbacks=null,s=0;s<l.length;s++)qy(l[s],r)}var La=F(null),Pc=F(0);function Gy(s,r){s=ar,he(Pc,s),he(La,r),ar=s|r.baseLanes}function vf(){he(Pc,ar),he(La,La.current)}function Ef(){ar=Pc.current,ie(La),ie(Pc)}var Ei=F(null),zi=null;function Or(s){var r=s.alternate;he(tn,tn.current&1),he(Ei,s),zi===null&&(r===null||La.current!==null||r.memoizedState!==null)&&(zi=s)}function Tf(s){he(tn,tn.current),he(Ei,s),zi===null&&(zi=s)}function Yy(s){s.tag===22?(he(tn,tn.current),he(Ei,s),zi===null&&(zi=s)):zr()}function zr(){he(tn,tn.current),he(Ei,Ei.current)}function Ti(s){ie(Ei),zi===s&&(zi=null),ie(tn)}var tn=F(0);function Dc(s){for(var r=s;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||xp(l)||Ip(l)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Zs=0,qe=null,Tt=null,an=null,kc=!1,Va=!1,Yo=!1,Uc=0,Wl=0,Oa=null,PA=0;function Kt(){throw Error(i(321))}function Sf(s,r){if(r===null)return!1;for(var l=0;l<r.length&&l<s.length;l++)if(!_i(s[l],r[l]))return!1;return!0}function bf(s,r,l,c,y,v){return Zs=v,qe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,W.H=s===null||s.memoizedState===null?I0:Of,Yo=!1,v=l(c,y),Yo=!1,Va&&(v=Ky(r,l,c,y)),$y(s),v}function $y(s){W.H=tu;var r=Tt!==null&&Tt.next!==null;if(Zs=0,an=Tt=qe=null,kc=!1,Wl=0,Oa=null,r)throw Error(i(300));s===null||ln||(s=s.dependencies,s!==null&&Ac(s)&&(ln=!0))}function Ky(s,r,l,c){qe=s;var y=0;do{if(Va&&(Oa=null),Wl=0,Va=!1,25<=y)throw Error(i(301));if(y+=1,an=Tt=null,s.updateQueue!=null){var v=s.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}W.H=R0,v=r(l,c)}while(Va);return v}function DA(){var s=W.H,r=s.useState()[0];return r=typeof r.then=="function"?Zl(r):r,s=s.useState()[0],(Tt!==null?Tt.memoizedState:null)!==s&&(qe.flags|=1024),r}function wf(){var s=Uc!==0;return Uc=0,s}function Af(s,r,l){r.updateQueue=s.updateQueue,r.flags&=-2053,s.lanes&=~l}function Cf(s){if(kc){for(s=s.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}kc=!1}Zs=0,an=Tt=qe=null,Va=!1,Wl=Uc=0,Oa=null}function Jn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?qe.memoizedState=an=s:an=an.next=s,an}function nn(){if(Tt===null){var s=qe.alternate;s=s!==null?s.memoizedState:null}else s=Tt.next;var r=an===null?qe.memoizedState:an.next;if(r!==null)an=r,Tt=s;else{if(s===null)throw qe.alternate===null?Error(i(467)):Error(i(310));Tt=s,s={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},an===null?qe.memoizedState=an=s:an=an.next=s}return an}function Lc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zl(s){var r=Wl;return Wl+=1,Oa===null&&(Oa=[]),s=Vy(Oa,s,r),r=qe,(an===null?r.memoizedState:an.next)===null&&(r=r.alternate,W.H=r===null||r.memoizedState===null?I0:Of),s}function Vc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Zl(s);if(s.$$typeof===Z)return xn(s)}throw Error(i(438,String(s)))}function xf(s){var r=null,l=qe.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var c=qe.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(y){return y.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=Lc(),qe.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(s),c=0;c<s;c++)l[c]=P;return r.index++,l}function er(s,r){return typeof r=="function"?r(s):r}function Oc(s){var r=nn();return If(r,Tt,s)}function If(s,r,l){var c=s.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=l;var y=s.baseQueue,v=c.pending;if(v!==null){if(y!==null){var w=y.next;y.next=v.next,v.next=w}r.baseQueue=y=v,c.pending=null}if(v=s.baseState,y===null)s.memoizedState=v;else{r=y.next;var I=w=null,L=null,$=r,te=!1;do{var se=$.lane&-536870913;if(se!==$.lane?(je&se)===se:(Zs&se)===se){var K=$.revertLane;if(K===0)L!==null&&(L=L.next={lane:0,revertLane:0,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null}),se===Pa&&(te=!0);else if((Zs&K)===K){$=$.next,K===Pa&&(te=!0);continue}else se={lane:0,revertLane:$.revertLane,gesture:null,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},L===null?(I=L=se,w=v):L=L.next=se,qe.lanes|=K,qr|=K;se=$.action,Yo&&l(v,se),v=$.hasEagerState?$.eagerState:l(v,se)}else K={lane:se,revertLane:$.revertLane,gesture:$.gesture,action:$.action,hasEagerState:$.hasEagerState,eagerState:$.eagerState,next:null},L===null?(I=L=K,w=v):L=L.next=K,qe.lanes|=se,qr|=se;$=$.next}while($!==null&&$!==r);if(L===null?w=v:L.next=I,!_i(v,s.memoizedState)&&(ln=!0,te&&(l=Da,l!==null)))throw l;s.memoizedState=v,s.baseState=w,s.baseQueue=L,c.lastRenderedState=v}return y===null&&(c.lanes=0),[s.memoizedState,c.dispatch]}function Rf(s){var r=nn(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=s;var c=l.dispatch,y=l.pending,v=r.memoizedState;if(y!==null){l.pending=null;var w=y=y.next;do v=s(v,w.action),w=w.next;while(w!==y);_i(v,r.memoizedState)||(ln=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),l.lastRenderedState=v}return[v,c]}function Jy(s,r,l){var c=qe,y=nn(),v=et;if(v){if(l===void 0)throw Error(i(407));l=l()}else l=r();var w=!_i((Tt||y).memoizedState,l);if(w&&(y.memoizedState=l,ln=!0),y=y.queue,Pf(Qy.bind(null,c,y,s),[s]),y.getSnapshot!==r||w||an!==null&&an.memoizedState.tag&1){if(c.flags|=2048,za(9,{destroy:void 0},Xy.bind(null,c,y,l,r),null),Ct===null)throw Error(i(349));v||(Zs&127)!==0||jy(c,r,l)}return l}function jy(s,r,l){s.flags|=16384,s={getSnapshot:r,value:l},r=qe.updateQueue,r===null?(r=Lc(),qe.updateQueue=r,r.stores=[s]):(l=r.stores,l===null?r.stores=[s]:l.push(s))}function Xy(s,r,l,c){r.value=l,r.getSnapshot=c,Wy(r)&&Zy(s)}function Qy(s,r,l){return l(function(){Wy(r)&&Zy(s)})}function Wy(s){var r=s.getSnapshot;s=s.value;try{var l=r();return!_i(s,l)}catch{return!0}}function Zy(s){var r=Lo(s,2);r!==null&&oi(r,s,2)}function Nf(s){var r=Jn();if(typeof s=="function"){var l=s;if(s=l(),Yo){Qn(!0);try{l()}finally{Qn(!1)}}}return r.memoizedState=r.baseState=s,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:er,lastRenderedState:s},r}function e0(s,r,l,c){return s.baseState=l,If(s,Tt,typeof c=="function"?c:er)}function kA(s,r,l,c,y){if(Bc(s))throw Error(i(485));if(s=r.action,s!==null){var v={payload:y,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){v.listeners.push(w)}};W.T!==null?l(!0):v.isTransition=!1,c(v),l=r.pending,l===null?(v.next=r.pending=v,t0(r,v)):(v.next=l.next,r.pending=l.next=v)}}function t0(s,r){var l=r.action,c=r.payload,y=s.state;if(r.isTransition){var v=W.T,w={};W.T=w;try{var I=l(y,c),L=W.S;L!==null&&L(w,I),n0(s,r,I)}catch($){Mf(s,r,$)}finally{v!==null&&w.types!==null&&(v.types=w.types),W.T=v}}else try{v=l(y,c),n0(s,r,v)}catch($){Mf(s,r,$)}}function n0(s,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){i0(s,r,c)},function(c){return Mf(s,r,c)}):i0(s,r,l)}function i0(s,r,l){r.status="fulfilled",r.value=l,s0(r),s.state=l,r=s.pending,r!==null&&(l=r.next,l===r?s.pending=null:(l=l.next,r.next=l,t0(s,l)))}function Mf(s,r,l){var c=s.pending;if(s.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=l,s0(r),r=r.next;while(r!==c)}s.action=null}function s0(s){s=s.listeners;for(var r=0;r<s.length;r++)(0,s[r])()}function r0(s,r){return r}function o0(s,r){if(et){var l=Ct.formState;if(l!==null){e:{var c=qe;if(et){if(Mt){t:{for(var y=Mt,v=Oi;y.nodeType!==8;){if(!v){y=null;break t}if(y=Fi(y.nextSibling),y===null){y=null;break t}}v=y.data,y=v==="F!"||v==="F"?y:null}if(y){Mt=Fi(y.nextSibling),c=y.data==="F!";break e}}Dr(c)}c=!1}c&&(r=l[0])}}return l=Jn(),l.memoizedState=l.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r0,lastRenderedState:r},l.queue=c,l=A0.bind(null,qe,c),c.dispatch=l,c=Nf(!1),v=Vf.bind(null,qe,!1,c.queue),c=Jn(),y={state:r,dispatch:null,action:s,pending:null},c.queue=y,l=kA.bind(null,qe,y,v,l),y.dispatch=l,c.memoizedState=s,[r,l,!1]}function a0(s){var r=nn();return l0(r,Tt,s)}function l0(s,r,l){if(r=If(s,r,r0)[0],s=Oc(er)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Zl(r)}catch(w){throw w===ka?Ic:w}else c=r;r=nn();var y=r.queue,v=y.dispatch;return l!==r.memoizedState&&(qe.flags|=2048,za(9,{destroy:void 0},UA.bind(null,y,l),null)),[c,v,s]}function UA(s,r){s.action=r}function u0(s){var r=nn(),l=Tt;if(l!==null)return l0(r,l,s);nn(),r=r.memoizedState,l=nn();var c=l.queue.dispatch;return l.memoizedState=s,[r,c,!1]}function za(s,r,l,c){return s={tag:s,create:l,deps:c,inst:r,next:null},r=qe.updateQueue,r===null&&(r=Lc(),qe.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=s.next=s:(c=l.next,l.next=s,s.next=c,r.lastEffect=s),s}function c0(){return nn().memoizedState}function zc(s,r,l,c){var y=Jn();qe.flags|=s,y.memoizedState=za(1|r,{destroy:void 0},l,c===void 0?null:c)}function Fc(s,r,l,c){var y=nn();c=c===void 0?null:c;var v=y.memoizedState.inst;Tt!==null&&c!==null&&Sf(c,Tt.memoizedState.deps)?y.memoizedState=za(r,v,l,c):(qe.flags|=s,y.memoizedState=za(1|r,v,l,c))}function d0(s,r){zc(8390656,8,s,r)}function Pf(s,r){Fc(2048,8,s,r)}function LA(s){qe.flags|=4;var r=qe.updateQueue;if(r===null)r=Lc(),qe.updateQueue=r,r.events=[s];else{var l=r.events;l===null?r.events=[s]:l.push(s)}}function h0(s){var r=nn().memoizedState;return LA({ref:r,nextImpl:s}),function(){if((ft&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function f0(s,r){return Fc(4,2,s,r)}function p0(s,r){return Fc(4,4,s,r)}function m0(s,r){if(typeof r=="function"){s=s();var l=r(s);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return s=s(),r.current=s,function(){r.current=null}}function g0(s,r,l){l=l!=null?l.concat([s]):null,Fc(4,4,m0.bind(null,r,s),l)}function Df(){}function y0(s,r){var l=nn();r=r===void 0?null:r;var c=l.memoizedState;return r!==null&&Sf(r,c[1])?c[0]:(l.memoizedState=[s,r],s)}function _0(s,r){var l=nn();r=r===void 0?null:r;var c=l.memoizedState;if(r!==null&&Sf(r,c[1]))return c[0];if(c=s(),Yo){Qn(!0);try{s()}finally{Qn(!1)}}return l.memoizedState=[c,r],c}function kf(s,r,l){return l===void 0||(Zs&1073741824)!==0&&(je&261930)===0?s.memoizedState=r:(s.memoizedState=l,s=v_(),qe.lanes|=s,qr|=s,l)}function v0(s,r,l,c){return _i(l,r)?l:La.current!==null?(s=kf(s,l,c),_i(s,r)||(ln=!0),s):(Zs&42)===0||(Zs&1073741824)!==0&&(je&261930)===0?(ln=!0,s.memoizedState=l):(s=v_(),qe.lanes|=s,qr|=s,r)}function E0(s,r,l,c,y){var v=ce.p;ce.p=v!==0&&8>v?v:8;var w=W.T,I={};W.T=I,Vf(s,!1,r,l);try{var L=y(),$=W.S;if($!==null&&$(I,L),L!==null&&typeof L=="object"&&typeof L.then=="function"){var te=MA(L,c);eu(s,r,te,wi(s))}else eu(s,r,c,wi(s))}catch(se){eu(s,r,{then:function(){},status:"rejected",reason:se},wi())}finally{ce.p=v,w!==null&&I.types!==null&&(w.types=I.types),W.T=w}}function VA(){}function Uf(s,r,l,c){if(s.tag!==5)throw Error(i(476));var y=T0(s).queue;E0(s,y,r,Te,l===null?VA:function(){return S0(s),l(c)})}function T0(s){var r=s.memoizedState;if(r!==null)return r;r={memoizedState:Te,baseState:Te,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:er,lastRenderedState:Te},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:er,lastRenderedState:l},next:null},s.memoizedState=r,s=s.alternate,s!==null&&(s.memoizedState=r),r}function S0(s){var r=T0(s);r.next===null&&(r=s.alternate.memoizedState),eu(s,r.next.queue,{},wi())}function Lf(){return xn(yu)}function b0(){return nn().memoizedState}function w0(){return nn().memoizedState}function OA(s){for(var r=s.return;r!==null;){switch(r.tag){case 24:case 3:var l=wi();s=Lr(l);var c=Vr(r,s,l);c!==null&&(oi(c,r,l),jl(c,r,l)),r={cache:df()},s.payload=r;return}r=r.return}}function zA(s,r,l){var c=wi();l={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Bc(s)?C0(r,l):(l=Zh(s,r,l,c),l!==null&&(oi(l,s,c),x0(l,r,c)))}function A0(s,r,l){var c=wi();eu(s,r,l,c)}function eu(s,r,l,c){var y={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Bc(s))C0(r,y);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var w=r.lastRenderedState,I=v(w,l);if(y.hasEagerState=!0,y.eagerState=I,_i(I,w))return Tc(s,r,y,0),Ct===null&&Ec(),!1}catch{}finally{}if(l=Zh(s,r,y,c),l!==null)return oi(l,s,c),x0(l,r,c),!0}return!1}function Vf(s,r,l,c){if(c={lane:2,revertLane:mp(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Bc(s)){if(r)throw Error(i(479))}else r=Zh(s,l,c,2),r!==null&&oi(r,s,2)}function Bc(s){var r=s.alternate;return s===qe||r!==null&&r===qe}function C0(s,r){Va=kc=!0;var l=s.pending;l===null?r.next=r:(r.next=l.next,l.next=r),s.pending=r}function x0(s,r,l){if((l&4194048)!==0){var c=r.lanes;c&=s.pendingLanes,l|=c,r.lanes=l,Ar(s,l)}}var tu={readContext:xn,use:Vc,useCallback:Kt,useContext:Kt,useEffect:Kt,useImperativeHandle:Kt,useLayoutEffect:Kt,useInsertionEffect:Kt,useMemo:Kt,useReducer:Kt,useRef:Kt,useState:Kt,useDebugValue:Kt,useDeferredValue:Kt,useTransition:Kt,useSyncExternalStore:Kt,useId:Kt,useHostTransitionStatus:Kt,useFormState:Kt,useActionState:Kt,useOptimistic:Kt,useMemoCache:Kt,useCacheRefresh:Kt};tu.useEffectEvent=Kt;var I0={readContext:xn,use:Vc,useCallback:function(s,r){return Jn().memoizedState=[s,r===void 0?null:r],s},useContext:xn,useEffect:d0,useImperativeHandle:function(s,r,l){l=l!=null?l.concat([s]):null,zc(4194308,4,m0.bind(null,r,s),l)},useLayoutEffect:function(s,r){return zc(4194308,4,s,r)},useInsertionEffect:function(s,r){zc(4,2,s,r)},useMemo:function(s,r){var l=Jn();r=r===void 0?null:r;var c=s();if(Yo){Qn(!0);try{s()}finally{Qn(!1)}}return l.memoizedState=[c,r],c},useReducer:function(s,r,l){var c=Jn();if(l!==void 0){var y=l(r);if(Yo){Qn(!0);try{l(r)}finally{Qn(!1)}}}else y=r;return c.memoizedState=c.baseState=y,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:y},c.queue=s,s=s.dispatch=zA.bind(null,qe,s),[c.memoizedState,s]},useRef:function(s){var r=Jn();return s={current:s},r.memoizedState=s},useState:function(s){s=Nf(s);var r=s.queue,l=A0.bind(null,qe,r);return r.dispatch=l,[s.memoizedState,l]},useDebugValue:Df,useDeferredValue:function(s,r){var l=Jn();return kf(l,s,r)},useTransition:function(){var s=Nf(!1);return s=E0.bind(null,qe,s.queue,!0,!1),Jn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,r,l){var c=qe,y=Jn();if(et){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),Ct===null)throw Error(i(349));(je&127)!==0||jy(c,r,l)}y.memoizedState=l;var v={value:l,getSnapshot:r};return y.queue=v,d0(Qy.bind(null,c,v,s),[s]),c.flags|=2048,za(9,{destroy:void 0},Xy.bind(null,c,v,l,r),null),l},useId:function(){var s=Jn(),r=Ct.identifierPrefix;if(et){var l=As,c=ws;l=(c&~(1<<32-wt(c)-1)).toString(32)+l,r="_"+r+"R_"+l,l=Uc++,0<l&&(r+="H"+l.toString(32)),r+="_"}else l=PA++,r="_"+r+"r_"+l.toString(32)+"_";return s.memoizedState=r},useHostTransitionStatus:Lf,useFormState:o0,useActionState:o0,useOptimistic:function(s){var r=Jn();r.memoizedState=r.baseState=s;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=Vf.bind(null,qe,!0,l),l.dispatch=r,[s,r]},useMemoCache:xf,useCacheRefresh:function(){return Jn().memoizedState=OA.bind(null,qe)},useEffectEvent:function(s){var r=Jn(),l={impl:s};return r.memoizedState=l,function(){if((ft&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},Of={readContext:xn,use:Vc,useCallback:y0,useContext:xn,useEffect:Pf,useImperativeHandle:g0,useInsertionEffect:f0,useLayoutEffect:p0,useMemo:_0,useReducer:Oc,useRef:c0,useState:function(){return Oc(er)},useDebugValue:Df,useDeferredValue:function(s,r){var l=nn();return v0(l,Tt.memoizedState,s,r)},useTransition:function(){var s=Oc(er)[0],r=nn().memoizedState;return[typeof s=="boolean"?s:Zl(s),r]},useSyncExternalStore:Jy,useId:b0,useHostTransitionStatus:Lf,useFormState:a0,useActionState:a0,useOptimistic:function(s,r){var l=nn();return e0(l,Tt,s,r)},useMemoCache:xf,useCacheRefresh:w0};Of.useEffectEvent=h0;var R0={readContext:xn,use:Vc,useCallback:y0,useContext:xn,useEffect:Pf,useImperativeHandle:g0,useInsertionEffect:f0,useLayoutEffect:p0,useMemo:_0,useReducer:Rf,useRef:c0,useState:function(){return Rf(er)},useDebugValue:Df,useDeferredValue:function(s,r){var l=nn();return Tt===null?kf(l,s,r):v0(l,Tt.memoizedState,s,r)},useTransition:function(){var s=Rf(er)[0],r=nn().memoizedState;return[typeof s=="boolean"?s:Zl(s),r]},useSyncExternalStore:Jy,useId:b0,useHostTransitionStatus:Lf,useFormState:u0,useActionState:u0,useOptimistic:function(s,r){var l=nn();return Tt!==null?e0(l,Tt,s,r):(l.baseState=s,[s,l.queue.dispatch])},useMemoCache:xf,useCacheRefresh:w0};R0.useEffectEvent=h0;function zf(s,r,l,c){r=s.memoizedState,l=l(c,r),l=l==null?r:E({},r,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var Ff={enqueueSetState:function(s,r,l){s=s._reactInternals;var c=wi(),y=Lr(c);y.payload=r,l!=null&&(y.callback=l),r=Vr(s,y,c),r!==null&&(oi(r,s,c),jl(r,s,c))},enqueueReplaceState:function(s,r,l){s=s._reactInternals;var c=wi(),y=Lr(c);y.tag=1,y.payload=r,l!=null&&(y.callback=l),r=Vr(s,y,c),r!==null&&(oi(r,s,c),jl(r,s,c))},enqueueForceUpdate:function(s,r){s=s._reactInternals;var l=wi(),c=Lr(l);c.tag=2,r!=null&&(c.callback=r),r=Vr(s,c,l),r!==null&&(oi(r,s,l),jl(r,s,l))}};function N0(s,r,l,c,y,v,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(c,v,w):r.prototype&&r.prototype.isPureReactComponent?!Bl(l,c)||!Bl(y,v):!0}function M0(s,r,l,c){s=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,c),r.state!==s&&Ff.enqueueReplaceState(r,r.state,null)}function $o(s,r){var l=r;if("ref"in r){l={};for(var c in r)c!=="ref"&&(l[c]=r[c])}if(s=s.defaultProps){l===r&&(l=E({},l));for(var y in s)l[y]===void 0&&(l[y]=s[y])}return l}function P0(s){vc(s)}function D0(s){console.error(s)}function k0(s){vc(s)}function qc(s,r){try{var l=s.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function U0(s,r,l){try{var c=s.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Bf(s,r,l){return l=Lr(l),l.tag=3,l.payload={element:null},l.callback=function(){qc(s,r)},l}function L0(s){return s=Lr(s),s.tag=3,s}function V0(s,r,l,c){var y=l.type.getDerivedStateFromError;if(typeof y=="function"){var v=c.value;s.payload=function(){return y(v)},s.callback=function(){U0(r,l,c)}}var w=l.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){U0(r,l,c),typeof y!="function"&&(Hr===null?Hr=new Set([this]):Hr.add(this));var I=c.stack;this.componentDidCatch(c.value,{componentStack:I!==null?I:""})})}function FA(s,r,l,c,y){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=l.alternate,r!==null&&Ma(r,l,y,!0),l=Ei.current,l!==null){switch(l.tag){case 31:case 13:return zi===null?ed():l.alternate===null&&Jt===0&&(Jt=3),l.flags&=-257,l.flags|=65536,l.lanes=y,c===Rc?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([c]):r.add(c),hp(s,c,y)),!1;case 22:return l.flags|=65536,c===Rc?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([c]):l.add(c)),hp(s,c,y)),!1}throw Error(i(435,l.tag))}return hp(s,c,y),ed(),!1}if(et)return r=Ei.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=y,c!==of&&(s=Error(i(422),{cause:c}),Gl(Ui(s,l)))):(c!==of&&(r=Error(i(423),{cause:c}),Gl(Ui(r,l))),s=s.current.alternate,s.flags|=65536,y&=-y,s.lanes|=y,c=Ui(c,l),y=Bf(s.stateNode,c,y),yf(s,y),Jt!==4&&(Jt=2)),!1;var v=Error(i(520),{cause:c});if(v=Ui(v,l),uu===null?uu=[v]:uu.push(v),Jt!==4&&(Jt=2),r===null)return!0;c=Ui(c,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,s=y&-y,l.lanes|=s,s=Bf(l.stateNode,c,s),yf(l,s),!1;case 1:if(r=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Hr===null||!Hr.has(v))))return l.flags|=65536,y&=-y,l.lanes|=y,y=L0(y),V0(y,s,l,c),yf(l,y),!1}l=l.return}while(l!==null);return!1}var qf=Error(i(461)),ln=!1;function In(s,r,l,c){r.child=s===null?By(r,null,l,c):Go(r,s.child,l,c)}function O0(s,r,l,c,y){l=l.render;var v=r.ref;if("ref"in c){var w={};for(var I in c)I!=="ref"&&(w[I]=c[I])}else w=c;return Fo(r),c=bf(s,r,l,w,v,y),I=wf(),s!==null&&!ln?(Af(s,r,y),tr(s,r,y)):(et&&I&&sf(r),r.flags|=1,In(s,r,c,y),r.child)}function z0(s,r,l,c,y){if(s===null){var v=l.type;return typeof v=="function"&&!ef(v)&&v.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=v,F0(s,r,v,c,y)):(s=bc(l.type,null,c,r,r.mode,y),s.ref=r.ref,s.return=r,r.child=s)}if(v=s.child,!Xf(s,y)){var w=v.memoizedProps;if(l=l.compare,l=l!==null?l:Bl,l(w,c)&&s.ref===r.ref)return tr(s,r,y)}return r.flags|=1,s=js(v,c),s.ref=r.ref,s.return=r,r.child=s}function F0(s,r,l,c,y){if(s!==null){var v=s.memoizedProps;if(Bl(v,c)&&s.ref===r.ref)if(ln=!1,r.pendingProps=c=v,Xf(s,y))(s.flags&131072)!==0&&(ln=!0);else return r.lanes=s.lanes,tr(s,r,y)}return Hf(s,r,l,c,y)}function B0(s,r,l,c){var y=c.children,v=s!==null?s.memoizedState:null;if(s===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(v=v!==null?v.baseLanes|l:l,s!==null){for(c=r.child=s.child,y=0;c!==null;)y=y|c.lanes|c.childLanes,c=c.sibling;c=y&~v}else c=0,r.child=null;return q0(s,r,v,l,c)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},s!==null&&xc(r,v!==null?v.cachePool:null),v!==null?Gy(r,v):vf(),Yy(r);else return c=r.lanes=536870912,q0(s,r,v!==null?v.baseLanes|l:l,l,c)}else v!==null?(xc(r,v.cachePool),Gy(r,v),zr(),r.memoizedState=null):(s!==null&&xc(r,null),vf(),zr());return In(s,r,y,l),r.child}function nu(s,r){return s!==null&&s.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function q0(s,r,l,c,y){var v=ff();return v=v===null?null:{parent:on._currentValue,pool:v},r.memoizedState={baseLanes:l,cachePool:v},s!==null&&xc(r,null),vf(),Yy(r),s!==null&&Ma(s,r,c,!0),r.childLanes=y,null}function Hc(s,r){return r=Yc({mode:r.mode,children:r.children},s.mode),r.ref=s.ref,s.child=r,r.return=s,r}function H0(s,r,l){return Go(r,s.child,null,l),s=Hc(r,r.pendingProps),s.flags|=2,Ti(r),r.memoizedState=null,s}function BA(s,r,l){var c=r.pendingProps,y=(r.flags&128)!==0;if(r.flags&=-129,s===null){if(et){if(c.mode==="hidden")return s=Hc(r,c),r.lanes=536870912,nu(null,s);if(Tf(r),(s=Mt)?(s=tv(s,Oi),s=s!==null&&s.data==="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Mr!==null?{id:ws,overflow:As}:null,retryLane:536870912,hydrationErrors:null},l=Cy(s),l.return=r,r.child=l,Cn=r,Mt=null)):s=null,s===null)throw Dr(r);return r.lanes=536870912,null}return Hc(r,c)}var v=s.memoizedState;if(v!==null){var w=v.dehydrated;if(Tf(r),y)if(r.flags&256)r.flags&=-257,r=H0(s,r,l);else if(r.memoizedState!==null)r.child=s.child,r.flags|=128,r=null;else throw Error(i(558));else if(ln||Ma(s,r,l,!1),y=(l&s.childLanes)!==0,ln||y){if(c=Ct,c!==null&&(w=ue(c,l),w!==0&&w!==v.retryLane))throw v.retryLane=w,Lo(s,w),oi(c,s,w),qf;ed(),r=H0(s,r,l)}else s=v.treeContext,Mt=Fi(w.nextSibling),Cn=r,et=!0,Pr=null,Oi=!1,s!==null&&Ry(r,s),r=Hc(r,c),r.flags|=4096;return r}return s=js(s.child,{mode:c.mode,children:c.children}),s.ref=r.ref,r.child=s,s.return=r,s}function Gc(s,r){var l=r.ref;if(l===null)s!==null&&s.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(s===null||s.ref!==l)&&(r.flags|=4194816)}}function Hf(s,r,l,c,y){return Fo(r),l=bf(s,r,l,c,void 0,y),c=wf(),s!==null&&!ln?(Af(s,r,y),tr(s,r,y)):(et&&c&&sf(r),r.flags|=1,In(s,r,l,y),r.child)}function G0(s,r,l,c,y,v){return Fo(r),r.updateQueue=null,l=Ky(r,c,l,y),$y(s),c=wf(),s!==null&&!ln?(Af(s,r,v),tr(s,r,v)):(et&&c&&sf(r),r.flags|=1,In(s,r,l,v),r.child)}function Y0(s,r,l,c,y){if(Fo(r),r.stateNode===null){var v=xa,w=l.contextType;typeof w=="object"&&w!==null&&(v=xn(w)),v=new l(c,v),r.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Ff,r.stateNode=v,v._reactInternals=r,v=r.stateNode,v.props=c,v.state=r.memoizedState,v.refs={},mf(r),w=l.contextType,v.context=typeof w=="object"&&w!==null?xn(w):xa,v.state=r.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(zf(r,l,w,c),v.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(w=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),w!==v.state&&Ff.enqueueReplaceState(v,v.state,null),Ql(r,c,v,y),Xl(),v.state=r.memoizedState),typeof v.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(s===null){v=r.stateNode;var I=r.memoizedProps,L=$o(l,I);v.props=L;var $=v.context,te=l.contextType;w=xa,typeof te=="object"&&te!==null&&(w=xn(te));var se=l.getDerivedStateFromProps;te=typeof se=="function"||typeof v.getSnapshotBeforeUpdate=="function",I=r.pendingProps!==I,te||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(I||$!==w)&&M0(r,v,c,w),Ur=!1;var K=r.memoizedState;v.state=K,Ql(r,c,v,y),Xl(),$=r.memoizedState,I||K!==$||Ur?(typeof se=="function"&&(zf(r,l,se,c),$=r.memoizedState),(L=Ur||N0(r,l,L,c,K,$,w))?(te||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(r.flags|=4194308)):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=$),v.props=c,v.state=$,v.context=w,c=L):(typeof v.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{v=r.stateNode,gf(s,r),w=r.memoizedProps,te=$o(l,w),v.props=te,se=r.pendingProps,K=v.context,$=l.contextType,L=xa,typeof $=="object"&&$!==null&&(L=xn($)),I=l.getDerivedStateFromProps,($=typeof I=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(w!==se||K!==L)&&M0(r,v,c,L),Ur=!1,K=r.memoizedState,v.state=K,Ql(r,c,v,y),Xl();var Q=r.memoizedState;w!==se||K!==Q||Ur||s!==null&&s.dependencies!==null&&Ac(s.dependencies)?(typeof I=="function"&&(zf(r,l,I,c),Q=r.memoizedState),(te=Ur||N0(r,l,te,c,K,Q,L)||s!==null&&s.dependencies!==null&&Ac(s.dependencies))?($||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,Q,L),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,Q,L)),typeof v.componentDidUpdate=="function"&&(r.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof v.componentDidUpdate!="function"||w===s.memoizedProps&&K===s.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&K===s.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=Q),v.props=c,v.state=Q,v.context=L,c=te):(typeof v.componentDidUpdate!="function"||w===s.memoizedProps&&K===s.memoizedState||(r.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&K===s.memoizedState||(r.flags|=1024),c=!1)}return v=c,Gc(s,r),c=(r.flags&128)!==0,v||c?(v=r.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:v.render(),r.flags|=1,s!==null&&c?(r.child=Go(r,s.child,null,y),r.child=Go(r,null,l,y)):In(s,r,l,y),r.memoizedState=v.state,s=r.child):s=tr(s,r,y),s}function $0(s,r,l,c){return Oo(),r.flags|=256,In(s,r,l,c),r.child}var Gf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yf(s){return{baseLanes:s,cachePool:Uy()}}function $f(s,r,l){return s=s!==null?s.childLanes&~l:0,r&&(s|=bi),s}function K0(s,r,l){var c=r.pendingProps,y=!1,v=(r.flags&128)!==0,w;if((w=v)||(w=s!==null&&s.memoizedState===null?!1:(tn.current&2)!==0),w&&(y=!0,r.flags&=-129),w=(r.flags&32)!==0,r.flags&=-33,s===null){if(et){if(y?Or(r):zr(),(s=Mt)?(s=tv(s,Oi),s=s!==null&&s.data!=="&"?s:null,s!==null&&(r.memoizedState={dehydrated:s,treeContext:Mr!==null?{id:ws,overflow:As}:null,retryLane:536870912,hydrationErrors:null},l=Cy(s),l.return=r,r.child=l,Cn=r,Mt=null)):s=null,s===null)throw Dr(r);return Ip(s)?r.lanes=32:r.lanes=536870912,null}var I=c.children;return c=c.fallback,y?(zr(),y=r.mode,I=Yc({mode:"hidden",children:I},y),c=Vo(c,y,l,null),I.return=r,c.return=r,I.sibling=c,r.child=I,c=r.child,c.memoizedState=Yf(l),c.childLanes=$f(s,w,l),r.memoizedState=Gf,nu(null,c)):(Or(r),Kf(r,I))}var L=s.memoizedState;if(L!==null&&(I=L.dehydrated,I!==null)){if(v)r.flags&256?(Or(r),r.flags&=-257,r=Jf(s,r,l)):r.memoizedState!==null?(zr(),r.child=s.child,r.flags|=128,r=null):(zr(),I=c.fallback,y=r.mode,c=Yc({mode:"visible",children:c.children},y),I=Vo(I,y,l,null),I.flags|=2,c.return=r,I.return=r,c.sibling=I,r.child=c,Go(r,s.child,null,l),c=r.child,c.memoizedState=Yf(l),c.childLanes=$f(s,w,l),r.memoizedState=Gf,r=nu(null,c));else if(Or(r),Ip(I)){if(w=I.nextSibling&&I.nextSibling.dataset,w)var $=w.dgst;w=$,c=Error(i(419)),c.stack="",c.digest=w,Gl({value:c,source:null,stack:null}),r=Jf(s,r,l)}else if(ln||Ma(s,r,l,!1),w=(l&s.childLanes)!==0,ln||w){if(w=Ct,w!==null&&(c=ue(w,l),c!==0&&c!==L.retryLane))throw L.retryLane=c,Lo(s,c),oi(w,s,c),qf;xp(I)||ed(),r=Jf(s,r,l)}else xp(I)?(r.flags|=192,r.child=s.child,r=null):(s=L.treeContext,Mt=Fi(I.nextSibling),Cn=r,et=!0,Pr=null,Oi=!1,s!==null&&Ry(r,s),r=Kf(r,c.children),r.flags|=4096);return r}return y?(zr(),I=c.fallback,y=r.mode,L=s.child,$=L.sibling,c=js(L,{mode:"hidden",children:c.children}),c.subtreeFlags=L.subtreeFlags&65011712,$!==null?I=js($,I):(I=Vo(I,y,l,null),I.flags|=2),I.return=r,c.return=r,c.sibling=I,r.child=c,nu(null,c),c=r.child,I=s.child.memoizedState,I===null?I=Yf(l):(y=I.cachePool,y!==null?(L=on._currentValue,y=y.parent!==L?{parent:L,pool:L}:y):y=Uy(),I={baseLanes:I.baseLanes|l,cachePool:y}),c.memoizedState=I,c.childLanes=$f(s,w,l),r.memoizedState=Gf,nu(s.child,c)):(Or(r),l=s.child,s=l.sibling,l=js(l,{mode:"visible",children:c.children}),l.return=r,l.sibling=null,s!==null&&(w=r.deletions,w===null?(r.deletions=[s],r.flags|=16):w.push(s)),r.child=l,r.memoizedState=null,l)}function Kf(s,r){return r=Yc({mode:"visible",children:r},s.mode),r.return=s,s.child=r}function Yc(s,r){return s=vi(22,s,null,r),s.lanes=0,s}function Jf(s,r,l){return Go(r,s.child,null,l),s=Kf(r,r.pendingProps.children),s.flags|=2,r.memoizedState=null,s}function J0(s,r,l){s.lanes|=r;var c=s.alternate;c!==null&&(c.lanes|=r),uf(s.return,r,l)}function jf(s,r,l,c,y,v){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:y,treeForkCount:v}:(w.isBackwards=r,w.rendering=null,w.renderingStartTime=0,w.last=c,w.tail=l,w.tailMode=y,w.treeForkCount=v)}function j0(s,r,l){var c=r.pendingProps,y=c.revealOrder,v=c.tail;c=c.children;var w=tn.current,I=(w&2)!==0;if(I?(w=w&1|2,r.flags|=128):w&=1,he(tn,w),In(s,r,c,l),c=et?Hl:0,!I&&s!==null&&(s.flags&128)!==0)e:for(s=r.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&J0(s,l,r);else if(s.tag===19)J0(s,l,r);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(y){case"forwards":for(l=r.child,y=null;l!==null;)s=l.alternate,s!==null&&Dc(s)===null&&(y=l),l=l.sibling;l=y,l===null?(y=r.child,r.child=null):(y=l.sibling,l.sibling=null),jf(r,!1,y,l,v,c);break;case"backwards":case"unstable_legacy-backwards":for(l=null,y=r.child,r.child=null;y!==null;){if(s=y.alternate,s!==null&&Dc(s)===null){r.child=y;break}s=y.sibling,y.sibling=l,l=y,y=s}jf(r,!0,l,null,v,c);break;case"together":jf(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function tr(s,r,l){if(s!==null&&(r.dependencies=s.dependencies),qr|=r.lanes,(l&r.childLanes)===0)if(s!==null){if(Ma(s,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(s!==null&&r.child!==s.child)throw Error(i(153));if(r.child!==null){for(s=r.child,l=js(s,s.pendingProps),r.child=l,l.return=r;s.sibling!==null;)s=s.sibling,l=l.sibling=js(s,s.pendingProps),l.return=r;l.sibling=null}return r.child}function Xf(s,r){return(s.lanes&r)!==0?!0:(s=s.dependencies,!!(s!==null&&Ac(s)))}function qA(s,r,l){switch(r.tag){case 3:jt(r,r.stateNode.containerInfo),kr(r,on,s.memoizedState.cache),Oo();break;case 27:case 5:Bs(r);break;case 4:jt(r,r.stateNode.containerInfo);break;case 10:kr(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Tf(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Or(r),r.flags|=128,null):(l&r.child.childLanes)!==0?K0(s,r,l):(Or(r),s=tr(s,r,l),s!==null?s.sibling:null);Or(r);break;case 19:var y=(s.flags&128)!==0;if(c=(l&r.childLanes)!==0,c||(Ma(s,r,l,!1),c=(l&r.childLanes)!==0),y){if(c)return j0(s,r,l);r.flags|=128}if(y=r.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),he(tn,tn.current),c)break;return null;case 22:return r.lanes=0,B0(s,r,l,r.pendingProps);case 24:kr(r,on,s.memoizedState.cache)}return tr(s,r,l)}function X0(s,r,l){if(s!==null)if(s.memoizedProps!==r.pendingProps)ln=!0;else{if(!Xf(s,l)&&(r.flags&128)===0)return ln=!1,qA(s,r,l);ln=(s.flags&131072)!==0}else ln=!1,et&&(r.flags&1048576)!==0&&Iy(r,Hl,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(s=qo(r.elementType),r.type=s,typeof s=="function")ef(s)?(c=$o(s,c),r.tag=1,r=Y0(null,r,s,c,l)):(r.tag=0,r=Hf(null,r,s,c,l));else{if(s!=null){var y=s.$$typeof;if(y===H){r.tag=11,r=O0(null,r,s,c,l);break e}else if(y===x){r.tag=14,r=z0(null,r,s,c,l);break e}}throw r=ct(s)||s,Error(i(306,r,""))}}return r;case 0:return Hf(s,r,r.type,r.pendingProps,l);case 1:return c=r.type,y=$o(c,r.pendingProps),Y0(s,r,c,y,l);case 3:e:{if(jt(r,r.stateNode.containerInfo),s===null)throw Error(i(387));c=r.pendingProps;var v=r.memoizedState;y=v.element,gf(s,r),Ql(r,c,null,l);var w=r.memoizedState;if(c=w.cache,kr(r,on,c),c!==v.cache&&cf(r,[on],l,!0),Xl(),c=w.element,v.isDehydrated)if(v={element:c,isDehydrated:!1,cache:w.cache},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){r=$0(s,r,c,l);break e}else if(c!==y){y=Ui(Error(i(424)),r),Gl(y),r=$0(s,r,c,l);break e}else{switch(s=r.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Mt=Fi(s.firstChild),Cn=r,et=!0,Pr=null,Oi=!0,l=By(r,null,c,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Oo(),c===y){r=tr(s,r,l);break e}In(s,r,c,l)}r=r.child}return r;case 26:return Gc(s,r),s===null?(l=av(r.type,null,r.pendingProps,null))?r.memoizedState=l:et||(l=r.type,s=r.pendingProps,c=ad(ke.current).createElement(l),c[Ce]=r,c[Ye]=s,Rn(c,l,s),At(c),r.stateNode=c):r.memoizedState=av(r.type,s.memoizedProps,r.pendingProps,s.memoizedState),null;case 27:return Bs(r),s===null&&et&&(c=r.stateNode=sv(r.type,r.pendingProps,ke.current),Cn=r,Oi=!0,y=Mt,Kr(r.type)?(Rp=y,Mt=Fi(c.firstChild)):Mt=y),In(s,r,r.pendingProps.children,l),Gc(s,r),s===null&&(r.flags|=4194304),r.child;case 5:return s===null&&et&&((y=c=Mt)&&(c=_C(c,r.type,r.pendingProps,Oi),c!==null?(r.stateNode=c,Cn=r,Mt=Fi(c.firstChild),Oi=!1,y=!0):y=!1),y||Dr(r)),Bs(r),y=r.type,v=r.pendingProps,w=s!==null?s.memoizedProps:null,c=v.children,wp(y,v)?c=null:w!==null&&wp(y,w)&&(r.flags|=32),r.memoizedState!==null&&(y=bf(s,r,DA,null,null,l),yu._currentValue=y),Gc(s,r),In(s,r,c,l),r.child;case 6:return s===null&&et&&((s=l=Mt)&&(l=vC(l,r.pendingProps,Oi),l!==null?(r.stateNode=l,Cn=r,Mt=null,s=!0):s=!1),s||Dr(r)),null;case 13:return K0(s,r,l);case 4:return jt(r,r.stateNode.containerInfo),c=r.pendingProps,s===null?r.child=Go(r,null,c,l):In(s,r,c,l),r.child;case 11:return O0(s,r,r.type,r.pendingProps,l);case 7:return In(s,r,r.pendingProps,l),r.child;case 8:return In(s,r,r.pendingProps.children,l),r.child;case 12:return In(s,r,r.pendingProps.children,l),r.child;case 10:return c=r.pendingProps,kr(r,r.type,c.value),In(s,r,c.children,l),r.child;case 9:return y=r.type._context,c=r.pendingProps.children,Fo(r),y=xn(y),c=c(y),r.flags|=1,In(s,r,c,l),r.child;case 14:return z0(s,r,r.type,r.pendingProps,l);case 15:return F0(s,r,r.type,r.pendingProps,l);case 19:return j0(s,r,l);case 31:return BA(s,r,l);case 22:return B0(s,r,l,r.pendingProps);case 24:return Fo(r),c=xn(on),s===null?(y=ff(),y===null&&(y=Ct,v=df(),y.pooledCache=v,v.refCount++,v!==null&&(y.pooledCacheLanes|=l),y=v),r.memoizedState={parent:c,cache:y},mf(r),kr(r,on,y)):((s.lanes&l)!==0&&(gf(s,r),Ql(r,null,null,l),Xl()),y=s.memoizedState,v=r.memoizedState,y.parent!==c?(y={parent:c,cache:c},r.memoizedState=y,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=y),kr(r,on,c)):(c=v.cache,kr(r,on,c),c!==y.cache&&cf(r,[on],l,!0))),In(s,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function nr(s){s.flags|=4}function Qf(s,r,l,c,y){if((r=(s.mode&32)!==0)&&(r=!1),r){if(s.flags|=16777216,(y&335544128)===y)if(s.stateNode.complete)s.flags|=8192;else if(b_())s.flags|=8192;else throw Ho=Rc,pf}else s.flags&=-16777217}function Q0(s,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!hv(r))if(b_())s.flags|=8192;else throw Ho=Rc,pf}function $c(s,r){r!==null&&(s.flags|=4),s.flags&16384&&(r=s.tag!==22?ma():536870912,s.lanes|=r,Ha|=r)}function iu(s,r){if(!et)switch(s.tailMode){case"hidden":r=s.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?r||s.tail===null?s.tail=null:s.tail.sibling=null:c.sibling=null}}function Pt(s){var r=s.alternate!==null&&s.alternate.child===s.child,l=0,c=0;if(r)for(var y=s.child;y!==null;)l|=y.lanes|y.childLanes,c|=y.subtreeFlags&65011712,c|=y.flags&65011712,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)l|=y.lanes|y.childLanes,c|=y.subtreeFlags,c|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=c,s.childLanes=l,r}function HA(s,r,l){var c=r.pendingProps;switch(rf(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pt(r),null;case 1:return Pt(r),null;case 3:return l=r.stateNode,c=null,s!==null&&(c=s.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Ws(on),It(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(s===null||s.child===null)&&(Na(r)?nr(r):s===null||s.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,af())),Pt(r),null;case 26:var y=r.type,v=r.memoizedState;return s===null?(nr(r),v!==null?(Pt(r),Q0(r,v)):(Pt(r),Qf(r,y,null,c,l))):v?v!==s.memoizedState?(nr(r),Pt(r),Q0(r,v)):(Pt(r),r.flags&=-16777217):(s=s.memoizedProps,s!==c&&nr(r),Pt(r),Qf(r,y,s,c,l)),null;case 27:if(di(r),l=ke.current,y=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&nr(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Pt(r),null}s=fe.current,Na(r)?Ny(r):(s=sv(y,c,l),r.stateNode=s,nr(r))}return Pt(r),null;case 5:if(di(r),y=r.type,s!==null&&r.stateNode!=null)s.memoizedProps!==c&&nr(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Pt(r),null}if(v=fe.current,Na(r))Ny(r);else{var w=ad(ke.current);switch(v){case 1:v=w.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:v=w.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":v=w.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":v=w.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":v=w.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof c.is=="string"?w.createElement("select",{is:c.is}):w.createElement("select"),c.multiple?v.multiple=!0:c.size&&(v.size=c.size);break;default:v=typeof c.is=="string"?w.createElement(y,{is:c.is}):w.createElement(y)}}v[Ce]=r,v[Ye]=c;e:for(w=r.child;w!==null;){if(w.tag===5||w.tag===6)v.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===r)break e;for(;w.sibling===null;){if(w.return===null||w.return===r)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}r.stateNode=v;e:switch(Rn(v,y,c),y){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&nr(r)}}return Pt(r),Qf(r,r.type,s===null?null:s.memoizedProps,r.pendingProps,l),null;case 6:if(s&&r.stateNode!=null)s.memoizedProps!==c&&nr(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(s=ke.current,Na(r)){if(s=r.stateNode,l=r.memoizedProps,c=null,y=Cn,y!==null)switch(y.tag){case 27:case 5:c=y.memoizedProps}s[Ce]=r,s=!!(s.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||K_(s.nodeValue,l)),s||Dr(r,!0)}else s=ad(s).createTextNode(c),s[Ce]=r,r.stateNode=s}return Pt(r),null;case 31:if(l=r.memoizedState,s===null||s.memoizedState!==null){if(c=Na(r),l!==null){if(s===null){if(!c)throw Error(i(318));if(s=r.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Ce]=r}else Oo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Pt(r),s=!1}else l=af(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=l),s=!0;if(!s)return r.flags&256?(Ti(r),r):(Ti(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Pt(r),null;case 13:if(c=r.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(y=Na(r),c!==null&&c.dehydrated!==null){if(s===null){if(!y)throw Error(i(318));if(y=r.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));y[Ce]=r}else Oo(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Pt(r),y=!1}else y=af(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=y),y=!0;if(!y)return r.flags&256?(Ti(r),r):(Ti(r),null)}return Ti(r),(r.flags&128)!==0?(r.lanes=l,r):(l=c!==null,s=s!==null&&s.memoizedState!==null,l&&(c=r.child,y=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(y=c.alternate.memoizedState.cachePool.pool),v=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(v=c.memoizedState.cachePool.pool),v!==y&&(c.flags|=2048)),l!==s&&l&&(r.child.flags|=8192),$c(r,r.updateQueue),Pt(r),null);case 4:return It(),s===null&&vp(r.stateNode.containerInfo),Pt(r),null;case 10:return Ws(r.type),Pt(r),null;case 19:if(ie(tn),c=r.memoizedState,c===null)return Pt(r),null;if(y=(r.flags&128)!==0,v=c.rendering,v===null)if(y)iu(c,!1);else{if(Jt!==0||s!==null&&(s.flags&128)!==0)for(s=r.child;s!==null;){if(v=Dc(s),v!==null){for(r.flags|=128,iu(c,!1),s=v.updateQueue,r.updateQueue=s,$c(r,s),r.subtreeFlags=0,s=l,l=r.child;l!==null;)Ay(l,s),l=l.sibling;return he(tn,tn.current&1|2),et&&Xs(r,c.treeForkCount),r.child}s=s.sibling}c.tail!==null&&fn()>Qc&&(r.flags|=128,y=!0,iu(c,!1),r.lanes=4194304)}else{if(!y)if(s=Dc(v),s!==null){if(r.flags|=128,y=!0,s=s.updateQueue,r.updateQueue=s,$c(r,s),iu(c,!0),c.tail===null&&c.tailMode==="hidden"&&!v.alternate&&!et)return Pt(r),null}else 2*fn()-c.renderingStartTime>Qc&&l!==536870912&&(r.flags|=128,y=!0,iu(c,!1),r.lanes=4194304);c.isBackwards?(v.sibling=r.child,r.child=v):(s=c.last,s!==null?s.sibling=v:r.child=v,c.last=v)}return c.tail!==null?(s=c.tail,c.rendering=s,c.tail=s.sibling,c.renderingStartTime=fn(),s.sibling=null,l=tn.current,he(tn,y?l&1|2:l&1),et&&Xs(r,c.treeForkCount),s):(Pt(r),null);case 22:case 23:return Ti(r),Ef(),c=r.memoizedState!==null,s!==null?s.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(l&536870912)!==0&&(r.flags&128)===0&&(Pt(r),r.subtreeFlags&6&&(r.flags|=8192)):Pt(r),l=r.updateQueue,l!==null&&$c(r,l.retryQueue),l=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==l&&(r.flags|=2048),s!==null&&ie(Bo),null;case 24:return l=null,s!==null&&(l=s.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),Ws(on),Pt(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function GA(s,r){switch(rf(r),r.tag){case 1:return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 3:return Ws(on),It(),s=r.flags,(s&65536)!==0&&(s&128)===0?(r.flags=s&-65537|128,r):null;case 26:case 27:case 5:return di(r),null;case 31:if(r.memoizedState!==null){if(Ti(r),r.alternate===null)throw Error(i(340));Oo()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 13:if(Ti(r),s=r.memoizedState,s!==null&&s.dehydrated!==null){if(r.alternate===null)throw Error(i(340));Oo()}return s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 19:return ie(tn),null;case 4:return It(),null;case 10:return Ws(r.type),null;case 22:case 23:return Ti(r),Ef(),s!==null&&ie(Bo),s=r.flags,s&65536?(r.flags=s&-65537|128,r):null;case 24:return Ws(on),null;case 25:return null;default:return null}}function W0(s,r){switch(rf(r),r.tag){case 3:Ws(on),It();break;case 26:case 27:case 5:di(r);break;case 4:It();break;case 31:r.memoizedState!==null&&Ti(r);break;case 13:Ti(r);break;case 19:ie(tn);break;case 10:Ws(r.type);break;case 22:case 23:Ti(r),Ef(),s!==null&&ie(Bo);break;case 24:Ws(on)}}function su(s,r){try{var l=r.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var y=c.next;l=y;do{if((l.tag&s)===s){c=void 0;var v=l.create,w=l.inst;c=v(),w.destroy=c}l=l.next}while(l!==y)}}catch(I){_t(r,r.return,I)}}function Fr(s,r,l){try{var c=r.updateQueue,y=c!==null?c.lastEffect:null;if(y!==null){var v=y.next;c=v;do{if((c.tag&s)===s){var w=c.inst,I=w.destroy;if(I!==void 0){w.destroy=void 0,y=r;var L=l,$=I;try{$()}catch(te){_t(y,L,te)}}}c=c.next}while(c!==v)}}catch(te){_t(r,r.return,te)}}function Z0(s){var r=s.updateQueue;if(r!==null){var l=s.stateNode;try{Hy(r,l)}catch(c){_t(s,s.return,c)}}}function e_(s,r,l){l.props=$o(s.type,s.memoizedProps),l.state=s.memoizedState;try{l.componentWillUnmount()}catch(c){_t(s,r,c)}}function ru(s,r){try{var l=s.ref;if(l!==null){switch(s.tag){case 26:case 27:case 5:var c=s.stateNode;break;case 30:c=s.stateNode;break;default:c=s.stateNode}typeof l=="function"?s.refCleanup=l(c):l.current=c}}catch(y){_t(s,r,y)}}function Cs(s,r){var l=s.ref,c=s.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(y){_t(s,r,y)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(y){_t(s,r,y)}else l.current=null}function t_(s){var r=s.type,l=s.memoizedProps,c=s.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(y){_t(s,s.return,y)}}function Wf(s,r,l){try{var c=s.stateNode;hC(c,s.type,l,r),c[Ye]=r}catch(y){_t(s,s.return,y)}}function n_(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Kr(s.type)||s.tag===4}function Zf(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||n_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Kr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function ep(s,r,l){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(s,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(s),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=Wi));else if(c!==4&&(c===27&&Kr(s.type)&&(l=s.stateNode,r=null),s=s.child,s!==null))for(ep(s,r,l),s=s.sibling;s!==null;)ep(s,r,l),s=s.sibling}function Kc(s,r,l){var c=s.tag;if(c===5||c===6)s=s.stateNode,r?l.insertBefore(s,r):l.appendChild(s);else if(c!==4&&(c===27&&Kr(s.type)&&(l=s.stateNode),s=s.child,s!==null))for(Kc(s,r,l),s=s.sibling;s!==null;)Kc(s,r,l),s=s.sibling}function i_(s){var r=s.stateNode,l=s.memoizedProps;try{for(var c=s.type,y=r.attributes;y.length;)r.removeAttributeNode(y[0]);Rn(r,c,l),r[Ce]=s,r[Ye]=l}catch(v){_t(s,s.return,v)}}var ir=!1,un=!1,tp=!1,s_=typeof WeakSet=="function"?WeakSet:Set,vn=null;function YA(s,r){if(s=s.containerInfo,Sp=pd,s=gy(s),Kh(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var y=c.anchorOffset,v=c.focusNode;c=c.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var w=0,I=-1,L=-1,$=0,te=0,se=s,K=null;t:for(;;){for(var Q;se!==l||y!==0&&se.nodeType!==3||(I=w+y),se!==v||c!==0&&se.nodeType!==3||(L=w+c),se.nodeType===3&&(w+=se.nodeValue.length),(Q=se.firstChild)!==null;)K=se,se=Q;for(;;){if(se===s)break t;if(K===l&&++$===y&&(I=w),K===v&&++te===c&&(L=w),(Q=se.nextSibling)!==null)break;se=K,K=se.parentNode}se=Q}l=I===-1||L===-1?null:{start:I,end:L}}else l=null}l=l||{start:0,end:0}}else l=null;for(bp={focusedElem:s,selectionRange:l},pd=!1,vn=r;vn!==null;)if(r=vn,s=r.child,(r.subtreeFlags&1028)!==0&&s!==null)s.return=r,vn=s;else for(;vn!==null;){switch(r=vn,v=r.alternate,s=r.flags,r.tag){case 0:if((s&4)!==0&&(s=r.updateQueue,s=s!==null?s.events:null,s!==null))for(l=0;l<s.length;l++)y=s[l],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&v!==null){s=void 0,l=r,y=v.memoizedProps,v=v.memoizedState,c=l.stateNode;try{var ge=$o(l.type,y);s=c.getSnapshotBeforeUpdate(ge,v),c.__reactInternalSnapshotBeforeUpdate=s}catch(Ie){_t(l,l.return,Ie)}}break;case 3:if((s&1024)!==0){if(s=r.stateNode.containerInfo,l=s.nodeType,l===9)Cp(s);else if(l===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Cp(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=r.sibling,s!==null){s.return=r.return,vn=s;break}vn=r.return}}function r_(s,r,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:rr(s,l),c&4&&su(5,l);break;case 1:if(rr(s,l),c&4)if(s=l.stateNode,r===null)try{s.componentDidMount()}catch(w){_t(l,l.return,w)}else{var y=$o(l.type,r.memoizedProps);r=r.memoizedState;try{s.componentDidUpdate(y,r,s.__reactInternalSnapshotBeforeUpdate)}catch(w){_t(l,l.return,w)}}c&64&&Z0(l),c&512&&ru(l,l.return);break;case 3:if(rr(s,l),c&64&&(s=l.updateQueue,s!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{Hy(s,r)}catch(w){_t(l,l.return,w)}}break;case 27:r===null&&c&4&&i_(l);case 26:case 5:rr(s,l),r===null&&c&4&&t_(l),c&512&&ru(l,l.return);break;case 12:rr(s,l);break;case 31:rr(s,l),c&4&&l_(s,l);break;case 13:rr(s,l),c&4&&u_(s,l),c&64&&(s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(l=eC.bind(null,l),EC(s,l))));break;case 22:if(c=l.memoizedState!==null||ir,!c){r=r!==null&&r.memoizedState!==null||un,y=ir;var v=un;ir=c,(un=r)&&!v?or(s,l,(l.subtreeFlags&8772)!==0):rr(s,l),ir=y,un=v}break;case 30:break;default:rr(s,l)}}function o_(s){var r=s.alternate;r!==null&&(s.alternate=null,o_(r)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(r=s.stateNode,r!==null&&Ni(r)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Ot=null,ni=!1;function sr(s,r,l){for(l=l.child;l!==null;)a_(s,r,l),l=l.sibling}function a_(s,r,l){if(Ut&&typeof Ut.onCommitFiberUnmount=="function")try{Ut.onCommitFiberUnmount(hi,l)}catch{}switch(l.tag){case 26:un||Cs(l,r),sr(s,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:un||Cs(l,r);var c=Ot,y=ni;Kr(l.type)&&(Ot=l.stateNode,ni=!1),sr(s,r,l),pu(l.stateNode),Ot=c,ni=y;break;case 5:un||Cs(l,r);case 6:if(c=Ot,y=ni,Ot=null,sr(s,r,l),Ot=c,ni=y,Ot!==null)if(ni)try{(Ot.nodeType===9?Ot.body:Ot.nodeName==="HTML"?Ot.ownerDocument.body:Ot).removeChild(l.stateNode)}catch(v){_t(l,r,v)}else try{Ot.removeChild(l.stateNode)}catch(v){_t(l,r,v)}break;case 18:Ot!==null&&(ni?(s=Ot,Z_(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,l.stateNode),Qa(s)):Z_(Ot,l.stateNode));break;case 4:c=Ot,y=ni,Ot=l.stateNode.containerInfo,ni=!0,sr(s,r,l),Ot=c,ni=y;break;case 0:case 11:case 14:case 15:Fr(2,l,r),un||Fr(4,l,r),sr(s,r,l);break;case 1:un||(Cs(l,r),c=l.stateNode,typeof c.componentWillUnmount=="function"&&e_(l,r,c)),sr(s,r,l);break;case 21:sr(s,r,l);break;case 22:un=(c=un)||l.memoizedState!==null,sr(s,r,l),un=c;break;default:sr(s,r,l)}}function l_(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Qa(s)}catch(l){_t(r,r.return,l)}}}function u_(s,r){if(r.memoizedState===null&&(s=r.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Qa(s)}catch(l){_t(r,r.return,l)}}function $A(s){switch(s.tag){case 31:case 13:case 19:var r=s.stateNode;return r===null&&(r=s.stateNode=new s_),r;case 22:return s=s.stateNode,r=s._retryCache,r===null&&(r=s._retryCache=new s_),r;default:throw Error(i(435,s.tag))}}function Jc(s,r){var l=$A(s);r.forEach(function(c){if(!l.has(c)){l.add(c);var y=tC.bind(null,s,c);c.then(y,y)}})}function ii(s,r){var l=r.deletions;if(l!==null)for(var c=0;c<l.length;c++){var y=l[c],v=s,w=r,I=w;e:for(;I!==null;){switch(I.tag){case 27:if(Kr(I.type)){Ot=I.stateNode,ni=!1;break e}break;case 5:Ot=I.stateNode,ni=!1;break e;case 3:case 4:Ot=I.stateNode.containerInfo,ni=!0;break e}I=I.return}if(Ot===null)throw Error(i(160));a_(v,w,y),Ot=null,ni=!1,v=y.alternate,v!==null&&(v.return=null),y.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)c_(r,s),r=r.sibling}var ss=null;function c_(s,r){var l=s.alternate,c=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ii(r,s),si(s),c&4&&(Fr(3,s,s.return),su(3,s),Fr(5,s,s.return));break;case 1:ii(r,s),si(s),c&512&&(un||l===null||Cs(l,l.return)),c&64&&ir&&(s=s.updateQueue,s!==null&&(c=s.callbacks,c!==null&&(l=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var y=ss;if(ii(r,s),si(s),c&512&&(un||l===null||Cs(l,l.return)),c&4){var v=l!==null?l.memoizedState:null;if(c=s.memoizedState,l===null)if(c===null)if(s.stateNode===null){e:{c=s.type,l=s.memoizedProps,y=y.ownerDocument||y;t:switch(c){case"title":v=y.getElementsByTagName("title")[0],(!v||v[_n]||v[Ce]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=y.createElement(c),y.head.insertBefore(v,y.querySelector("head > title"))),Rn(v,c,l),v[Ce]=s,At(v),c=v;break e;case"link":var w=cv("link","href",y).get(c+(l.href||""));if(w){for(var I=0;I<w.length;I++)if(v=w[I],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){w.splice(I,1);break t}}v=y.createElement(c),Rn(v,c,l),y.head.appendChild(v);break;case"meta":if(w=cv("meta","content",y).get(c+(l.content||""))){for(I=0;I<w.length;I++)if(v=w[I],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){w.splice(I,1);break t}}v=y.createElement(c),Rn(v,c,l),y.head.appendChild(v);break;default:throw Error(i(468,c))}v[Ce]=s,At(v),c=v}s.stateNode=c}else dv(y,s.type,s.stateNode);else s.stateNode=uv(y,c,s.memoizedProps);else v!==c?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,c===null?dv(y,s.type,s.stateNode):uv(y,c,s.memoizedProps)):c===null&&s.stateNode!==null&&Wf(s,s.memoizedProps,l.memoizedProps)}break;case 27:ii(r,s),si(s),c&512&&(un||l===null||Cs(l,l.return)),l!==null&&c&4&&Wf(s,s.memoizedProps,l.memoizedProps);break;case 5:if(ii(r,s),si(s),c&512&&(un||l===null||Cs(l,l.return)),s.flags&32){y=s.stateNode;try{gt(y,"")}catch(ge){_t(s,s.return,ge)}}c&4&&s.stateNode!=null&&(y=s.memoizedProps,Wf(s,y,l!==null?l.memoizedProps:y)),c&1024&&(tp=!0);break;case 6:if(ii(r,s),si(s),c&4){if(s.stateNode===null)throw Error(i(162));c=s.memoizedProps,l=s.stateNode;try{l.nodeValue=c}catch(ge){_t(s,s.return,ge)}}break;case 3:if(cd=null,y=ss,ss=ld(r.containerInfo),ii(r,s),ss=y,si(s),c&4&&l!==null&&l.memoizedState.isDehydrated)try{Qa(r.containerInfo)}catch(ge){_t(s,s.return,ge)}tp&&(tp=!1,d_(s));break;case 4:c=ss,ss=ld(s.stateNode.containerInfo),ii(r,s),si(s),ss=c;break;case 12:ii(r,s),si(s);break;case 31:ii(r,s),si(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Jc(s,c)));break;case 13:ii(r,s),si(s),s.child.flags&8192&&s.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Xc=fn()),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Jc(s,c)));break;case 22:y=s.memoizedState!==null;var L=l!==null&&l.memoizedState!==null,$=ir,te=un;if(ir=$||y,un=te||L,ii(r,s),un=te,ir=$,si(s),c&8192)e:for(r=s.stateNode,r._visibility=y?r._visibility&-2:r._visibility|1,y&&(l===null||L||ir||un||Ko(s)),l=null,r=s;;){if(r.tag===5||r.tag===26){if(l===null){L=l=r;try{if(v=L.stateNode,y)w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{I=L.stateNode;var se=L.memoizedProps.style,K=se!=null&&se.hasOwnProperty("display")?se.display:null;I.style.display=K==null||typeof K=="boolean"?"":(""+K).trim()}}catch(ge){_t(L,L.return,ge)}}}else if(r.tag===6){if(l===null){L=r;try{L.stateNode.nodeValue=y?"":L.memoizedProps}catch(ge){_t(L,L.return,ge)}}}else if(r.tag===18){if(l===null){L=r;try{var Q=L.stateNode;y?ev(Q,!0):ev(L.stateNode,!1)}catch(ge){_t(L,L.return,ge)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===s)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=s.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,Jc(s,l))));break;case 19:ii(r,s),si(s),c&4&&(c=s.updateQueue,c!==null&&(s.updateQueue=null,Jc(s,c)));break;case 30:break;case 21:break;default:ii(r,s),si(s)}}function si(s){var r=s.flags;if(r&2){try{for(var l,c=s.return;c!==null;){if(n_(c)){l=c;break}c=c.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var y=l.stateNode,v=Zf(s);Kc(s,v,y);break;case 5:var w=l.stateNode;l.flags&32&&(gt(w,""),l.flags&=-33);var I=Zf(s);Kc(s,I,w);break;case 3:case 4:var L=l.stateNode.containerInfo,$=Zf(s);ep(s,$,L);break;default:throw Error(i(161))}}catch(te){_t(s,s.return,te)}s.flags&=-3}r&4096&&(s.flags&=-4097)}function d_(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var r=s;d_(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),s=s.sibling}}function rr(s,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)r_(s,r.alternate,r),r=r.sibling}function Ko(s){for(s=s.child;s!==null;){var r=s;switch(r.tag){case 0:case 11:case 14:case 15:Fr(4,r,r.return),Ko(r);break;case 1:Cs(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&e_(r,r.return,l),Ko(r);break;case 27:pu(r.stateNode);case 26:case 5:Cs(r,r.return),Ko(r);break;case 22:r.memoizedState===null&&Ko(r);break;case 30:Ko(r);break;default:Ko(r)}s=s.sibling}}function or(s,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,y=s,v=r,w=v.flags;switch(v.tag){case 0:case 11:case 15:or(y,v,l),su(4,v);break;case 1:if(or(y,v,l),c=v,y=c.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch($){_t(c,c.return,$)}if(c=v,y=c.updateQueue,y!==null){var I=c.stateNode;try{var L=y.shared.hiddenCallbacks;if(L!==null)for(y.shared.hiddenCallbacks=null,y=0;y<L.length;y++)qy(L[y],I)}catch($){_t(c,c.return,$)}}l&&w&64&&Z0(v),ru(v,v.return);break;case 27:i_(v);case 26:case 5:or(y,v,l),l&&c===null&&w&4&&t_(v),ru(v,v.return);break;case 12:or(y,v,l);break;case 31:or(y,v,l),l&&w&4&&l_(y,v);break;case 13:or(y,v,l),l&&w&4&&u_(y,v);break;case 22:v.memoizedState===null&&or(y,v,l),ru(v,v.return);break;case 30:break;default:or(y,v,l)}r=r.sibling}}function np(s,r){var l=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),s=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(s=r.memoizedState.cachePool.pool),s!==l&&(s!=null&&s.refCount++,l!=null&&Yl(l))}function ip(s,r){s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Yl(s))}function rs(s,r,l,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)h_(s,r,l,c),r=r.sibling}function h_(s,r,l,c){var y=r.flags;switch(r.tag){case 0:case 11:case 15:rs(s,r,l,c),y&2048&&su(9,r);break;case 1:rs(s,r,l,c);break;case 3:rs(s,r,l,c),y&2048&&(s=null,r.alternate!==null&&(s=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==s&&(r.refCount++,s!=null&&Yl(s)));break;case 12:if(y&2048){rs(s,r,l,c),s=r.stateNode;try{var v=r.memoizedProps,w=v.id,I=v.onPostCommit;typeof I=="function"&&I(w,r.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(L){_t(r,r.return,L)}}else rs(s,r,l,c);break;case 31:rs(s,r,l,c);break;case 13:rs(s,r,l,c);break;case 23:break;case 22:v=r.stateNode,w=r.alternate,r.memoizedState!==null?v._visibility&2?rs(s,r,l,c):ou(s,r):v._visibility&2?rs(s,r,l,c):(v._visibility|=2,Fa(s,r,l,c,(r.subtreeFlags&10256)!==0||!1)),y&2048&&np(w,r);break;case 24:rs(s,r,l,c),y&2048&&ip(r.alternate,r);break;default:rs(s,r,l,c)}}function Fa(s,r,l,c,y){for(y=y&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var v=s,w=r,I=l,L=c,$=w.flags;switch(w.tag){case 0:case 11:case 15:Fa(v,w,I,L,y),su(8,w);break;case 23:break;case 22:var te=w.stateNode;w.memoizedState!==null?te._visibility&2?Fa(v,w,I,L,y):ou(v,w):(te._visibility|=2,Fa(v,w,I,L,y)),y&&$&2048&&np(w.alternate,w);break;case 24:Fa(v,w,I,L,y),y&&$&2048&&ip(w.alternate,w);break;default:Fa(v,w,I,L,y)}r=r.sibling}}function ou(s,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=s,c=r,y=c.flags;switch(c.tag){case 22:ou(l,c),y&2048&&np(c.alternate,c);break;case 24:ou(l,c),y&2048&&ip(c.alternate,c);break;default:ou(l,c)}r=r.sibling}}var au=8192;function Ba(s,r,l){if(s.subtreeFlags&au)for(s=s.child;s!==null;)f_(s,r,l),s=s.sibling}function f_(s,r,l){switch(s.tag){case 26:Ba(s,r,l),s.flags&au&&s.memoizedState!==null&&PC(l,ss,s.memoizedState,s.memoizedProps);break;case 5:Ba(s,r,l);break;case 3:case 4:var c=ss;ss=ld(s.stateNode.containerInfo),Ba(s,r,l),ss=c;break;case 22:s.memoizedState===null&&(c=s.alternate,c!==null&&c.memoizedState!==null?(c=au,au=16777216,Ba(s,r,l),au=c):Ba(s,r,l));break;default:Ba(s,r,l)}}function p_(s){var r=s.alternate;if(r!==null&&(s=r.child,s!==null)){r.child=null;do r=s.sibling,s.sibling=null,s=r;while(s!==null)}}function lu(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var c=r[l];vn=c,g_(c,s)}p_(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)m_(s),s=s.sibling}function m_(s){switch(s.tag){case 0:case 11:case 15:lu(s),s.flags&2048&&Fr(9,s,s.return);break;case 3:lu(s);break;case 12:lu(s);break;case 22:var r=s.stateNode;s.memoizedState!==null&&r._visibility&2&&(s.return===null||s.return.tag!==13)?(r._visibility&=-3,jc(s)):lu(s);break;default:lu(s)}}function jc(s){var r=s.deletions;if((s.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var c=r[l];vn=c,g_(c,s)}p_(s)}for(s=s.child;s!==null;){switch(r=s,r.tag){case 0:case 11:case 15:Fr(8,r,r.return),jc(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,jc(r));break;default:jc(r)}s=s.sibling}}function g_(s,r){for(;vn!==null;){var l=vn;switch(l.tag){case 0:case 11:case 15:Fr(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Yl(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,vn=c;else e:for(l=s;vn!==null;){c=vn;var y=c.sibling,v=c.return;if(o_(c),c===l){vn=null;break e}if(y!==null){y.return=v,vn=y;break e}vn=v}}}var KA={getCacheForType:function(s){var r=xn(on),l=r.data.get(s);return l===void 0&&(l=s(),r.data.set(s,l)),l},cacheSignal:function(){return xn(on).controller.signal}},JA=typeof WeakMap=="function"?WeakMap:Map,ft=0,Ct=null,$e=null,je=0,yt=0,Si=null,Br=!1,qa=!1,sp=!1,ar=0,Jt=0,qr=0,Jo=0,rp=0,bi=0,Ha=0,uu=null,ri=null,op=!1,Xc=0,y_=0,Qc=1/0,Wc=null,Hr=null,pn=0,Gr=null,Ga=null,lr=0,ap=0,lp=null,__=null,cu=0,up=null;function wi(){return(ft&2)!==0&&je!==0?je&-je:W.T!==null?mp():Je()}function v_(){if(bi===0)if((je&536870912)===0||et){var s=Tn;Tn<<=1,(Tn&3932160)===0&&(Tn=262144),bi=s}else bi=536870912;return s=Ei.current,s!==null&&(s.flags|=32),bi}function oi(s,r,l){(s===Ct&&(yt===2||yt===9)||s.cancelPendingCommit!==null)&&(Ya(s,0),Yr(s,je,bi,!1)),Gs(s,l),((ft&2)===0||s!==Ct)&&(s===Ct&&((ft&2)===0&&(Jo|=l),Jt===4&&Yr(s,je,bi,!1)),xs(s))}function E_(s,r,l){if((ft&6)!==0)throw Error(i(327));var c=!l&&(r&127)===0&&(r&s.expiredLanes)===0||mi(s,r),y=c?QA(s,r):dp(s,r,!0),v=c;do{if(y===0){qa&&!c&&Yr(s,r,0,!1);break}else{if(l=s.current.alternate,v&&!jA(l)){y=dp(s,r,!1),v=!1;continue}if(y===2){if(v=r,s.errorRecoveryDisabledLanes&v)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){r=w;e:{var I=s;y=uu;var L=I.current.memoizedState.isDehydrated;if(L&&(Ya(I,w).flags|=256),w=dp(I,w,!1),w!==2){if(sp&&!L){I.errorRecoveryDisabledLanes|=v,Jo|=v,y=4;break e}v=ri,ri=y,v!==null&&(ri===null?ri=v:ri.push.apply(ri,v))}y=w}if(v=!1,y!==2)continue}}if(y===1){Ya(s,0),Yr(s,r,0,!0);break}e:{switch(c=s,v=y,v){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Yr(c,r,bi,!Br);break e;case 2:ri=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(y=Xc+300-fn(),10<y)){if(Yr(c,r,bi,!Br),Ii(c,0,!0)!==0)break e;lr=r,c.timeoutHandle=Q_(T_.bind(null,c,l,ri,Wc,op,r,bi,Jo,Ha,Br,v,"Throttled",-0,0),y);break e}T_(c,l,ri,Wc,op,r,bi,Jo,Ha,Br,v,null,-0,0)}}break}while(!0);xs(s)}function T_(s,r,l,c,y,v,w,I,L,$,te,se,K,Q){if(s.timeoutHandle=-1,se=r.subtreeFlags,se&8192||(se&16785408)===16785408){se={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Wi},f_(r,v,se);var ge=(v&62914560)===v?Xc-fn():(v&4194048)===v?y_-fn():0;if(ge=DC(se,ge),ge!==null){lr=v,s.cancelPendingCommit=ge(R_.bind(null,s,r,v,l,c,y,w,I,L,te,se,null,K,Q)),Yr(s,v,w,!$);return}}R_(s,r,v,l,c,y,w,I,L)}function jA(s){for(var r=s;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var y=l[c],v=y.getSnapshot;y=y.value;try{if(!_i(v(),y))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Yr(s,r,l,c){r&=~rp,r&=~Jo,s.suspendedLanes|=r,s.pingedLanes&=~r,c&&(s.warmLanes|=r),c=s.expirationTimes;for(var y=r;0<y;){var v=31-wt(y),w=1<<v;c[v]=-1,y&=~w}l!==0&&ms(s,l,r)}function Zc(){return(ft&6)===0?(du(0),!1):!0}function cp(){if($e!==null){if(yt===0)var s=$e.return;else s=$e,Qs=zo=null,Cf(s),Ua=null,Kl=0,s=$e;for(;s!==null;)W0(s.alternate,s),s=s.return;$e=null}}function Ya(s,r){var l=s.timeoutHandle;l!==-1&&(s.timeoutHandle=-1,mC(l)),l=s.cancelPendingCommit,l!==null&&(s.cancelPendingCommit=null,l()),lr=0,cp(),Ct=s,$e=l=js(s.current,null),je=r,yt=0,Si=null,Br=!1,qa=mi(s,r),sp=!1,Ha=bi=rp=Jo=qr=Jt=0,ri=uu=null,op=!1,(r&8)!==0&&(r|=r&32);var c=s.entangledLanes;if(c!==0)for(s=s.entanglements,c&=r;0<c;){var y=31-wt(c),v=1<<y;r|=s[y],c&=~v}return ar=r,Ec(),l}function S_(s,r){qe=null,W.H=tu,r===ka||r===Ic?(r=Oy(),yt=3):r===pf?(r=Oy(),yt=4):yt=r===qf?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Si=r,$e===null&&(Jt=1,qc(s,Ui(r,s.current)))}function b_(){var s=Ei.current;return s===null?!0:(je&4194048)===je?zi===null:(je&62914560)===je||(je&536870912)!==0?s===zi:!1}function w_(){var s=W.H;return W.H=tu,s===null?tu:s}function A_(){var s=W.A;return W.A=KA,s}function ed(){Jt=4,Br||(je&4194048)!==je&&Ei.current!==null||(qa=!0),(qr&134217727)===0&&(Jo&134217727)===0||Ct===null||Yr(Ct,je,bi,!1)}function dp(s,r,l){var c=ft;ft|=2;var y=w_(),v=A_();(Ct!==s||je!==r)&&(Wc=null,Ya(s,r)),r=!1;var w=Jt;e:do try{if(yt!==0&&$e!==null){var I=$e,L=Si;switch(yt){case 8:cp(),w=6;break e;case 3:case 2:case 9:case 6:Ei.current===null&&(r=!0);var $=yt;if(yt=0,Si=null,$a(s,I,L,$),l&&qa){w=0;break e}break;default:$=yt,yt=0,Si=null,$a(s,I,L,$)}}XA(),w=Jt;break}catch(te){S_(s,te)}while(!0);return r&&s.shellSuspendCounter++,Qs=zo=null,ft=c,W.H=y,W.A=v,$e===null&&(Ct=null,je=0,Ec()),w}function XA(){for(;$e!==null;)C_($e)}function QA(s,r){var l=ft;ft|=2;var c=w_(),y=A_();Ct!==s||je!==r?(Wc=null,Qc=fn()+500,Ya(s,r)):qa=mi(s,r);e:do try{if(yt!==0&&$e!==null){r=$e;var v=Si;t:switch(yt){case 1:yt=0,Si=null,$a(s,r,v,1);break;case 2:case 9:if(Ly(v)){yt=0,Si=null,x_(r);break}r=function(){yt!==2&&yt!==9||Ct!==s||(yt=7),xs(s)},v.then(r,r);break e;case 3:yt=7;break e;case 4:yt=5;break e;case 7:Ly(v)?(yt=0,Si=null,x_(r)):(yt=0,Si=null,$a(s,r,v,7));break;case 5:var w=null;switch($e.tag){case 26:w=$e.memoizedState;case 5:case 27:var I=$e;if(w?hv(w):I.stateNode.complete){yt=0,Si=null;var L=I.sibling;if(L!==null)$e=L;else{var $=I.return;$!==null?($e=$,td($)):$e=null}break t}}yt=0,Si=null,$a(s,r,v,5);break;case 6:yt=0,Si=null,$a(s,r,v,6);break;case 8:cp(),Jt=6;break e;default:throw Error(i(462))}}WA();break}catch(te){S_(s,te)}while(!0);return Qs=zo=null,W.H=c,W.A=y,ft=l,$e!==null?0:(Ct=null,je=0,Ec(),Jt)}function WA(){for(;$e!==null&&!Ji();)C_($e)}function C_(s){var r=X0(s.alternate,s,ar);s.memoizedProps=s.pendingProps,r===null?td(s):$e=r}function x_(s){var r=s,l=r.alternate;switch(r.tag){case 15:case 0:r=G0(l,r,r.pendingProps,r.type,void 0,je);break;case 11:r=G0(l,r,r.pendingProps,r.type.render,r.ref,je);break;case 5:Cf(r);default:W0(l,r),r=$e=Ay(r,ar),r=X0(l,r,ar)}s.memoizedProps=s.pendingProps,r===null?td(s):$e=r}function $a(s,r,l,c){Qs=zo=null,Cf(r),Ua=null,Kl=0;var y=r.return;try{if(FA(s,y,r,l,je)){Jt=1,qc(s,Ui(l,s.current)),$e=null;return}}catch(v){if(y!==null)throw $e=y,v;Jt=1,qc(s,Ui(l,s.current)),$e=null;return}r.flags&32768?(et||c===1?s=!0:qa||(je&536870912)!==0?s=!1:(Br=s=!0,(c===2||c===9||c===3||c===6)&&(c=Ei.current,c!==null&&c.tag===13&&(c.flags|=16384))),I_(r,s)):td(r)}function td(s){var r=s;do{if((r.flags&32768)!==0){I_(r,Br);return}s=r.return;var l=HA(r.alternate,r,ar);if(l!==null){$e=l;return}if(r=r.sibling,r!==null){$e=r;return}$e=r=s}while(r!==null);Jt===0&&(Jt=5)}function I_(s,r){do{var l=GA(s.alternate,s);if(l!==null){l.flags&=32767,$e=l;return}if(l=s.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(s=s.sibling,s!==null)){$e=s;return}$e=s=l}while(s!==null);Jt=6,$e=null}function R_(s,r,l,c,y,v,w,I,L){s.cancelPendingCommit=null;do nd();while(pn!==0);if((ft&6)!==0)throw Error(i(327));if(r!==null){if(r===s.current)throw Error(i(177));if(v=r.lanes|r.childLanes,v|=Wh,ga(s,l,v,w,I,L),s===Ct&&($e=Ct=null,je=0),Ga=r,Gr=s,lr=l,ap=v,lp=y,__=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,nC(Xn,function(){return k_(),null})):(s.callbackNode=null,s.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=W.T,W.T=null,y=ce.p,ce.p=2,w=ft,ft|=4;try{YA(s,r,l)}finally{ft=w,ce.p=y,W.T=c}}pn=1,N_(),M_(),P_()}}function N_(){if(pn===1){pn=0;var s=Gr,r=Ga,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=W.T,W.T=null;var c=ce.p;ce.p=2;var y=ft;ft|=4;try{c_(r,s);var v=bp,w=gy(s.containerInfo),I=v.focusedElem,L=v.selectionRange;if(w!==I&&I&&I.ownerDocument&&my(I.ownerDocument.documentElement,I)){if(L!==null&&Kh(I)){var $=L.start,te=L.end;if(te===void 0&&(te=$),"selectionStart"in I)I.selectionStart=$,I.selectionEnd=Math.min(te,I.value.length);else{var se=I.ownerDocument||document,K=se&&se.defaultView||window;if(K.getSelection){var Q=K.getSelection(),ge=I.textContent.length,Ie=Math.min(L.start,ge),bt=L.end===void 0?Ie:Math.min(L.end,ge);!Q.extend&&Ie>bt&&(w=bt,bt=Ie,Ie=w);var q=py(I,Ie),B=py(I,bt);if(q&&B&&(Q.rangeCount!==1||Q.anchorNode!==q.node||Q.anchorOffset!==q.offset||Q.focusNode!==B.node||Q.focusOffset!==B.offset)){var Y=se.createRange();Y.setStart(q.node,q.offset),Q.removeAllRanges(),Ie>bt?(Q.addRange(Y),Q.extend(B.node,B.offset)):(Y.setEnd(B.node,B.offset),Q.addRange(Y))}}}}for(se=[],Q=I;Q=Q.parentNode;)Q.nodeType===1&&se.push({element:Q,left:Q.scrollLeft,top:Q.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<se.length;I++){var ne=se[I];ne.element.scrollLeft=ne.left,ne.element.scrollTop=ne.top}}pd=!!Sp,bp=Sp=null}finally{ft=y,ce.p=c,W.T=l}}s.current=r,pn=2}}function M_(){if(pn===2){pn=0;var s=Gr,r=Ga,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=W.T,W.T=null;var c=ce.p;ce.p=2;var y=ft;ft|=4;try{r_(s,r.alternate,r)}finally{ft=y,ce.p=c,W.T=l}}pn=3}}function P_(){if(pn===4||pn===3){pn=0,hs();var s=Gr,r=Ga,l=lr,c=__;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?pn=5:(pn=0,Ga=Gr=null,D_(s,s.pendingLanes));var y=s.pendingLanes;if(y===0&&(Hr=null),Ne(l),r=r.stateNode,Ut&&typeof Ut.onCommitFiberRoot=="function")try{Ut.onCommitFiberRoot(hi,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=W.T,y=ce.p,ce.p=2,W.T=null;try{for(var v=s.onRecoverableError,w=0;w<c.length;w++){var I=c[w];v(I.value,{componentStack:I.stack})}}finally{W.T=r,ce.p=y}}(lr&3)!==0&&nd(),xs(s),y=s.pendingLanes,(l&261930)!==0&&(y&42)!==0?s===up?cu++:(cu=0,up=s):cu=0,du(0)}}function D_(s,r){(s.pooledCacheLanes&=r)===0&&(r=s.pooledCache,r!=null&&(s.pooledCache=null,Yl(r)))}function nd(){return N_(),M_(),P_(),k_()}function k_(){if(pn!==5)return!1;var s=Gr,r=ap;ap=0;var l=Ne(lr),c=W.T,y=ce.p;try{ce.p=32>l?32:l,W.T=null,l=lp,lp=null;var v=Gr,w=lr;if(pn=0,Ga=Gr=null,lr=0,(ft&6)!==0)throw Error(i(331));var I=ft;if(ft|=4,m_(v.current),h_(v,v.current,w,l),ft=I,du(0,!1),Ut&&typeof Ut.onPostCommitFiberRoot=="function")try{Ut.onPostCommitFiberRoot(hi,v)}catch{}return!0}finally{ce.p=y,W.T=c,D_(s,r)}}function U_(s,r,l){r=Ui(l,r),r=Bf(s.stateNode,r,2),s=Vr(s,r,2),s!==null&&(Gs(s,2),xs(s))}function _t(s,r,l){if(s.tag===3)U_(s,s,l);else for(;r!==null;){if(r.tag===3){U_(r,s,l);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Hr===null||!Hr.has(c))){s=Ui(l,s),l=L0(2),c=Vr(r,l,2),c!==null&&(V0(l,c,r,s),Gs(c,2),xs(c));break}}r=r.return}}function hp(s,r,l){var c=s.pingCache;if(c===null){c=s.pingCache=new JA;var y=new Set;c.set(r,y)}else y=c.get(r),y===void 0&&(y=new Set,c.set(r,y));y.has(l)||(sp=!0,y.add(l),s=ZA.bind(null,s,r,l),r.then(s,s))}function ZA(s,r,l){var c=s.pingCache;c!==null&&c.delete(r),s.pingedLanes|=s.suspendedLanes&l,s.warmLanes&=~l,Ct===s&&(je&l)===l&&(Jt===4||Jt===3&&(je&62914560)===je&&300>fn()-Xc?(ft&2)===0&&Ya(s,0):rp|=l,Ha===je&&(Ha=0)),xs(s)}function L_(s,r){r===0&&(r=ma()),s=Lo(s,r),s!==null&&(Gs(s,r),xs(s))}function eC(s){var r=s.memoizedState,l=0;r!==null&&(l=r.retryLane),L_(s,l)}function tC(s,r){var l=0;switch(s.tag){case 31:case 13:var c=s.stateNode,y=s.memoizedState;y!==null&&(l=y.retryLane);break;case 19:c=s.stateNode;break;case 22:c=s.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),L_(s,l)}function nC(s,r){return Rt(s,r)}var id=null,Ka=null,fp=!1,sd=!1,pp=!1,$r=0;function xs(s){s!==Ka&&s.next===null&&(Ka===null?id=Ka=s:Ka=Ka.next=s),sd=!0,fp||(fp=!0,sC())}function du(s,r){if(!pp&&sd){pp=!0;do for(var l=!1,c=id;c!==null;){if(s!==0){var y=c.pendingLanes;if(y===0)var v=0;else{var w=c.suspendedLanes,I=c.pingedLanes;v=(1<<31-wt(42|s)+1)-1,v&=y&~(w&~I),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,F_(c,v))}else v=je,v=Ii(c,c===Ct?v:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(v&3)===0||mi(c,v)||(l=!0,F_(c,v));c=c.next}while(l);pp=!1}}function iC(){V_()}function V_(){sd=fp=!1;var s=0;$r!==0&&pC()&&(s=$r);for(var r=fn(),l=null,c=id;c!==null;){var y=c.next,v=O_(c,r);v===0?(c.next=null,l===null?id=y:l.next=y,y===null&&(Ka=l)):(l=c,(s!==0||(v&3)!==0)&&(sd=!0)),c=y}pn!==0&&pn!==5||du(s),$r!==0&&($r=0)}function O_(s,r){for(var l=s.suspendedLanes,c=s.pingedLanes,y=s.expirationTimes,v=s.pendingLanes&-62914561;0<v;){var w=31-wt(v),I=1<<w,L=y[w];L===-1?((I&l)===0||(I&c)!==0)&&(y[w]=Co(I,r)):L<=r&&(s.expiredLanes|=I),v&=~I}if(r=Ct,l=je,l=Ii(s,s===r?l:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c=s.callbackNode,l===0||s===r&&(yt===2||yt===9)||s.cancelPendingCommit!==null)return c!==null&&c!==null&&Ki(c),s.callbackNode=null,s.callbackPriority=0;if((l&3)===0||mi(s,l)){if(r=l&-l,r===s.callbackPriority)return r;switch(c!==null&&Ki(c),Ne(l)){case 2:case 8:l=Ao;break;case 32:l=Xn;break;case 268435456:l=ps;break;default:l=Xn}return c=z_.bind(null,s),l=Rt(l,c),s.callbackPriority=r,s.callbackNode=l,r}return c!==null&&c!==null&&Ki(c),s.callbackPriority=2,s.callbackNode=null,2}function z_(s,r){if(pn!==0&&pn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var l=s.callbackNode;if(nd()&&s.callbackNode!==l)return null;var c=je;return c=Ii(s,s===Ct?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),c===0?null:(E_(s,c,r),O_(s,fn()),s.callbackNode!=null&&s.callbackNode===l?z_.bind(null,s):null)}function F_(s,r){if(nd())return null;E_(s,r,!0)}function sC(){gC(function(){(ft&6)!==0?Rt(ji,iC):V_()})}function mp(){if($r===0){var s=Pa;s===0&&(s=xi,xi<<=1,(xi&261888)===0&&(xi=256)),$r=s}return $r}function B_(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ya(""+s)}function q_(s,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,s.id&&l.setAttribute("form",s.id),r.parentNode.insertBefore(l,r),s=new FormData(s),l.parentNode.removeChild(l),s}function rC(s,r,l,c,y){if(r==="submit"&&l&&l.stateNode===y){var v=B_((y[Ye]||null).action),w=c.submitter;w&&(r=(r=w[Ye]||null)?B_(r.formAction):w.getAttribute("formAction"),r!==null&&(v=r,w=null));var I=new Es("action","action",null,c,y);s.push({event:I,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if($r!==0){var L=w?q_(y,w):new FormData(y);Uf(l,{pending:!0,data:L,method:y.method,action:v},null,L)}}else typeof v=="function"&&(I.preventDefault(),L=w?q_(y,w):new FormData(y),Uf(l,{pending:!0,data:L,method:y.method,action:v},v,L))},currentTarget:y}]})}}for(var gp=0;gp<Qh.length;gp++){var yp=Qh[gp],oC=yp.toLowerCase(),aC=yp[0].toUpperCase()+yp.slice(1);is(oC,"on"+aC)}is(vy,"onAnimationEnd"),is(Ey,"onAnimationIteration"),is(Ty,"onAnimationStart"),is("dblclick","onDoubleClick"),is("focusin","onFocus"),is("focusout","onBlur"),is(bA,"onTransitionRun"),is(wA,"onTransitionStart"),is(AA,"onTransitionCancel"),is(Sy,"onTransitionEnd"),De("onMouseEnter",["mouseout","mouseover"]),De("onMouseLeave",["mouseout","mouseover"]),De("onPointerEnter",["pointerout","pointerover"]),De("onPointerLeave",["pointerout","pointerover"]),kn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),kn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),kn("onBeforeInput",["compositionend","keypress","textInput","paste"]),kn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),kn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),kn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(hu));function H_(s,r){r=(r&4)!==0;for(var l=0;l<s.length;l++){var c=s[l],y=c.event;c=c.listeners;e:{var v=void 0;if(r)for(var w=c.length-1;0<=w;w--){var I=c[w],L=I.instance,$=I.currentTarget;if(I=I.listener,L!==v&&y.isPropagationStopped())break e;v=I,y.currentTarget=$;try{v(y)}catch(te){vc(te)}y.currentTarget=null,v=L}else for(w=0;w<c.length;w++){if(I=c[w],L=I.instance,$=I.currentTarget,I=I.listener,L!==v&&y.isPropagationStopped())break e;v=I,y.currentTarget=$;try{v(y)}catch(te){vc(te)}y.currentTarget=null,v=L}}}}function Ke(s,r){var l=r[Ft];l===void 0&&(l=r[Ft]=new Set);var c=s+"__bubble";l.has(c)||(G_(r,s,2,!1),l.add(c))}function _p(s,r,l){var c=0;r&&(c|=4),G_(l,s,c,r)}var rd="_reactListening"+Math.random().toString(36).slice(2);function vp(s){if(!s[rd]){s[rd]=!0,Dn.forEach(function(l){l!=="selectionchange"&&(lC.has(l)||_p(l,!1,s),_p(l,!0,s))});var r=s.nodeType===9?s:s.ownerDocument;r===null||r[rd]||(r[rd]=!0,_p("selectionchange",!1,r))}}function G_(s,r,l,c){switch(vv(r)){case 2:var y=LC;break;case 8:y=VC;break;default:y=kp}l=y.bind(null,r,l,s),y=void 0,!Io||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(y=!0),c?y!==void 0?s.addEventListener(r,l,{capture:!0,passive:y}):s.addEventListener(r,l,!0):y!==void 0?s.addEventListener(r,l,{passive:y}):s.addEventListener(r,l,!1)}function Ep(s,r,l,c,y){var v=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var w=c.tag;if(w===3||w===4){var I=c.stateNode.containerInfo;if(I===y)break;if(w===4)for(w=c.return;w!==null;){var L=w.tag;if((L===3||L===4)&&w.stateNode.containerInfo===y)return;w=w.return}for(;I!==null;){if(w=rn(I),w===null)return;if(L=w.tag,L===5||L===6||L===26||L===27){c=v=w;continue e}I=I.parentNode}}c=c.return}xr(function(){var $=v,te=Mi(l),se=[];e:{var K=by.get(s);if(K!==void 0){var Q=Es,ge=s;switch(s){case"keypress":if(No(l)===0)break e;case"keydown":case"keyup":Q=gc;break;case"focusin":ge="focus",Q=Po;break;case"focusout":ge="blur",Q=Po;break;case"beforeblur":case"afterblur":Q=Po;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Q=Vl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Q=ac;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Q=b;break;case vy:case Ey:case Ty:Q=uc;break;case Sy:Q=R;break;case"scroll":case"scrollend":Q=Ll;break;case"wheel":Q=X;break;case"copy":case"cut":case"paste":Q=cc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Q=Js;break;case"toggle":case"beforetoggle":Q=Be}var Ie=(r&4)!==0,bt=!Ie&&(s==="scroll"||s==="scrollend"),q=Ie?K!==null?K+"Capture":null:K;Ie=[];for(var B=$,Y;B!==null;){var ne=B;if(Y=ne.stateNode,ne=ne.tag,ne!==5&&ne!==26&&ne!==27||Y===null||q===null||(ne=Zi(B,q),ne!=null&&Ie.push(fu(B,ne,Y))),bt)break;B=B.return}0<Ie.length&&(K=new Q(K,ge,null,l,te),se.push({event:K,listeners:Ie}))}}if((r&7)===0){e:{if(K=s==="mouseover"||s==="pointerover",Q=s==="mouseout"||s==="pointerout",K&&l!==Dl&&(ge=l.relatedTarget||l.fromElement)&&(rn(ge)||ge[Sn]))break e;if((Q||K)&&(K=te.window===te?te:(K=te.ownerDocument)?K.defaultView||K.parentWindow:window,Q?(ge=l.relatedTarget||l.toElement,Q=$,ge=ge?rn(ge):null,ge!==null&&(bt=a(ge),Ie=ge.tag,ge!==bt||Ie!==5&&Ie!==27&&Ie!==6)&&(ge=null)):(Q=null,ge=$),Q!==ge)){if(Ie=Vl,ne="onMouseLeave",q="onMouseEnter",B="mouse",(s==="pointerout"||s==="pointerover")&&(Ie=Js,ne="onPointerLeave",q="onPointerEnter",B="pointer"),bt=Q==null?K:vt(Q),Y=ge==null?K:vt(ge),K=new Ie(ne,B+"leave",Q,l,te),K.target=bt,K.relatedTarget=Y,ne=null,rn(te)===$&&(Ie=new Ie(q,B+"enter",ge,l,te),Ie.target=Y,Ie.relatedTarget=bt,ne=Ie),bt=ne,Q&&ge)t:{for(Ie=uC,q=Q,B=ge,Y=0,ne=q;ne;ne=Ie(ne))Y++;ne=0;for(var be=B;be;be=Ie(be))ne++;for(;0<Y-ne;)q=Ie(q),Y--;for(;0<ne-Y;)B=Ie(B),ne--;for(;Y--;){if(q===B||B!==null&&q===B.alternate){Ie=q;break t}q=Ie(q),B=Ie(B)}Ie=null}else Ie=null;Q!==null&&Y_(se,K,Q,Ie,!1),ge!==null&&bt!==null&&Y_(se,bt,ge,Ie,!0)}}e:{if(K=$?vt($):window,Q=K.nodeName&&K.nodeName.toLowerCase(),Q==="select"||Q==="input"&&K.type==="file")var at=ly;else if(oy(K))if(uy)at=EA;else{at=_A;var _e=yA}else Q=K.nodeName,!Q||Q.toLowerCase()!=="input"||K.type!=="checkbox"&&K.type!=="radio"?$&&ti($.elementType)&&(at=ly):at=vA;if(at&&(at=at(s,$))){ay(se,at,l,te);break e}_e&&_e(s,K,$),s==="focusout"&&$&&K.type==="number"&&$.memoizedProps.value!=null&&ei(K,"number",K.value)}switch(_e=$?vt($):window,s){case"focusin":(oy(_e)||_e.contentEditable==="true")&&(wa=_e,Jh=$,ql=null);break;case"focusout":ql=Jh=wa=null;break;case"mousedown":jh=!0;break;case"contextmenu":case"mouseup":case"dragend":jh=!1,yy(se,l,te);break;case"selectionchange":if(SA)break;case"keydown":case"keyup":yy(se,l,te)}var He;if(ht)e:{switch(s){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else ba?Do(s,l)&&(Xe="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Xe="onCompositionStart");Xe&&(bs&&l.locale!=="ko"&&(ba||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&ba&&(He=Ul()):(vs=te,kl="value"in vs?vs.value:vs.textContent,ba=!0)),_e=od($,Xe),0<_e.length&&(Xe=new Ss(Xe,s,null,l,te),se.push({event:Xe,listeners:_e}),He?Xe.data=He:(He=Sa(l),He!==null&&(Xe.data=He)))),(He=Di?fA(s,l):pA(s,l))&&(Xe=od($,"onBeforeInput"),0<Xe.length&&(_e=new Ss("onBeforeInput","beforeinput",null,l,te),se.push({event:_e,listeners:Xe}),_e.data=He)),rC(se,s,$,l,te)}H_(se,r)})}function fu(s,r,l){return{instance:s,listener:r,currentTarget:l}}function od(s,r){for(var l=r+"Capture",c=[];s!==null;){var y=s,v=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||v===null||(y=Zi(s,l),y!=null&&c.unshift(fu(s,y,v)),y=Zi(s,r),y!=null&&c.push(fu(s,y,v))),s.tag===3)return c;s=s.return}return[]}function uC(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Y_(s,r,l,c,y){for(var v=r._reactName,w=[];l!==null&&l!==c;){var I=l,L=I.alternate,$=I.stateNode;if(I=I.tag,L!==null&&L===c)break;I!==5&&I!==26&&I!==27||$===null||(L=$,y?($=Zi(l,v),$!=null&&w.unshift(fu(l,$,L))):y||($=Zi(l,v),$!=null&&w.push(fu(l,$,L)))),l=l.return}w.length!==0&&s.push({event:r,listeners:w})}var cC=/\r\n?/g,dC=/\u0000|\uFFFD/g;function $_(s){return(typeof s=="string"?s:""+s).replace(cC,`
`).replace(dC,"")}function K_(s,r){return r=$_(r),$_(s)===r}function St(s,r,l,c,y,v){switch(l){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||gt(s,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&gt(s,""+c);break;case"className":Nt(s,"class",c);break;case"tabIndex":Nt(s,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Nt(s,l,c);break;case"style":Xi(s,c,v);break;case"data":if(r!=="object"){Nt(s,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||l!=="href")){s.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(l);break}c=ya(""+c),s.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){s.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(r!=="input"&&St(s,r,"name",y.name,y,null),St(s,r,"formEncType",y.formEncType,y,null),St(s,r,"formMethod",y.formMethod,y,null),St(s,r,"formTarget",y.formTarget,y,null)):(St(s,r,"encType",y.encType,y,null),St(s,r,"method",y.method,y,null),St(s,r,"target",y.target,y,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){s.removeAttribute(l);break}c=ya(""+c),s.setAttribute(l,c);break;case"onClick":c!=null&&(s.onclick=Wi);break;case"onScroll":c!=null&&Ke("scroll",s);break;case"onScrollEnd":c!=null&&Ke("scrollend",s);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(y.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"multiple":s.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":s.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){s.removeAttribute("xlink:href");break}l=ya(""+c),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(l,""+c):s.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(l,""):s.removeAttribute(l);break;case"capture":case"download":c===!0?s.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?s.setAttribute(l,c):s.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?s.setAttribute(l,c):s.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?s.removeAttribute(l):s.setAttribute(l,c);break;case"popover":Ke("beforetoggle",s),Ke("toggle",s),Yn(s,"popover",c);break;case"xlinkActuate":dt(s,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":dt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":dt(s,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":dt(s,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":dt(s,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":dt(s,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":dt(s,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":dt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":dt(s,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Yn(s,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Qi.get(l)||l,Yn(s,l,c))}}function Tp(s,r,l,c,y,v){switch(l){case"style":Xi(s,c,v);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(y.children!=null)throw Error(i(60));s.innerHTML=l}}break;case"children":typeof c=="string"?gt(s,c):(typeof c=="number"||typeof c=="bigint")&&gt(s,""+c);break;case"onScroll":c!=null&&Ke("scroll",s);break;case"onScrollEnd":c!=null&&Ke("scrollend",s);break;case"onClick":c!=null&&(s.onclick=Wi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ve.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(y=l.endsWith("Capture"),r=l.slice(2,y?l.length-7:void 0),v=s[Ye]||null,v=v!=null?v[l]:null,typeof v=="function"&&s.removeEventListener(r,v,y),typeof c=="function")){typeof v!="function"&&v!==null&&(l in s?s[l]=null:s.hasAttribute(l)&&s.removeAttribute(l)),s.addEventListener(r,c,y);break e}l in s?s[l]=c:c===!0?s.setAttribute(l,""):Yn(s,l,c)}}}function Rn(s,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ke("error",s),Ke("load",s);var c=!1,y=!1,v;for(v in l)if(l.hasOwnProperty(v)){var w=l[v];if(w!=null)switch(v){case"src":c=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:St(s,r,v,w,l,null)}}y&&St(s,r,"srcSet",l.srcSet,l,null),c&&St(s,r,"src",l.src,l,null);return;case"input":Ke("invalid",s);var I=v=w=y=null,L=null,$=null;for(c in l)if(l.hasOwnProperty(c)){var te=l[c];if(te!=null)switch(c){case"name":y=te;break;case"type":w=te;break;case"checked":L=te;break;case"defaultChecked":$=te;break;case"value":v=te;break;case"defaultValue":I=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(i(137,r));break;default:St(s,r,c,te,l,null)}}wn(s,v,I,L,$,w,y,!1);return;case"select":Ke("invalid",s),c=w=v=null;for(y in l)if(l.hasOwnProperty(y)&&(I=l[y],I!=null))switch(y){case"value":v=I;break;case"defaultValue":w=I;break;case"multiple":c=I;default:St(s,r,y,I,l,null)}r=v,l=w,s.multiple=!!c,r!=null?Zt(s,!!c,r,!1):l!=null&&Zt(s,!!c,l,!0);return;case"textarea":Ke("invalid",s),v=y=c=null;for(w in l)if(l.hasOwnProperty(w)&&(I=l[w],I!=null))switch(w){case"value":c=I;break;case"defaultValue":y=I;break;case"children":v=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(91));break;default:St(s,r,w,I,l,null)}qt(s,c,y,v);return;case"option":for(L in l)if(l.hasOwnProperty(L)&&(c=l[L],c!=null))switch(L){case"selected":s.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:St(s,r,L,c,l,null)}return;case"dialog":Ke("beforetoggle",s),Ke("toggle",s),Ke("cancel",s),Ke("close",s);break;case"iframe":case"object":Ke("load",s);break;case"video":case"audio":for(c=0;c<hu.length;c++)Ke(hu[c],s);break;case"image":Ke("error",s),Ke("load",s);break;case"details":Ke("toggle",s);break;case"embed":case"source":case"link":Ke("error",s),Ke("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for($ in l)if(l.hasOwnProperty($)&&(c=l[$],c!=null))switch($){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:St(s,r,$,c,l,null)}return;default:if(ti(r)){for(te in l)l.hasOwnProperty(te)&&(c=l[te],c!==void 0&&Tp(s,r,te,c,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(c=l[I],c!=null&&St(s,r,I,c,l,null))}function hC(s,r,l,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,v=null,w=null,I=null,L=null,$=null,te=null;for(Q in l){var se=l[Q];if(l.hasOwnProperty(Q)&&se!=null)switch(Q){case"checked":break;case"value":break;case"defaultValue":L=se;default:c.hasOwnProperty(Q)||St(s,r,Q,null,c,se)}}for(var K in c){var Q=c[K];if(se=l[K],c.hasOwnProperty(K)&&(Q!=null||se!=null))switch(K){case"type":v=Q;break;case"name":y=Q;break;case"checked":$=Q;break;case"defaultChecked":te=Q;break;case"value":w=Q;break;case"defaultValue":I=Q;break;case"children":case"dangerouslySetInnerHTML":if(Q!=null)throw Error(i(137,r));break;default:Q!==se&&St(s,r,K,Q,c,se)}}pt(s,w,I,L,$,te,v,y);return;case"select":Q=w=I=K=null;for(v in l)if(L=l[v],l.hasOwnProperty(v)&&L!=null)switch(v){case"value":break;case"multiple":Q=L;default:c.hasOwnProperty(v)||St(s,r,v,null,c,L)}for(y in c)if(v=c[y],L=l[y],c.hasOwnProperty(y)&&(v!=null||L!=null))switch(y){case"value":K=v;break;case"defaultValue":I=v;break;case"multiple":w=v;default:v!==L&&St(s,r,y,v,c,L)}r=I,l=w,c=Q,K!=null?Zt(s,!!l,K,!1):!!c!=!!l&&(r!=null?Zt(s,!!l,r,!0):Zt(s,!!l,l?[]:"",!1));return;case"textarea":Q=K=null;for(I in l)if(y=l[I],l.hasOwnProperty(I)&&y!=null&&!c.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:St(s,r,I,null,c,y)}for(w in c)if(y=c[w],v=l[w],c.hasOwnProperty(w)&&(y!=null||v!=null))switch(w){case"value":K=y;break;case"defaultValue":Q=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(i(91));break;default:y!==v&&St(s,r,w,y,c,v)}gi(s,K,Q);return;case"option":for(var ge in l)if(K=l[ge],l.hasOwnProperty(ge)&&K!=null&&!c.hasOwnProperty(ge))switch(ge){case"selected":s.selected=!1;break;default:St(s,r,ge,null,c,K)}for(L in c)if(K=c[L],Q=l[L],c.hasOwnProperty(L)&&K!==Q&&(K!=null||Q!=null))switch(L){case"selected":s.selected=K&&typeof K!="function"&&typeof K!="symbol";break;default:St(s,r,L,K,c,Q)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ie in l)K=l[Ie],l.hasOwnProperty(Ie)&&K!=null&&!c.hasOwnProperty(Ie)&&St(s,r,Ie,null,c,K);for($ in c)if(K=c[$],Q=l[$],c.hasOwnProperty($)&&K!==Q&&(K!=null||Q!=null))switch($){case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(i(137,r));break;default:St(s,r,$,K,c,Q)}return;default:if(ti(r)){for(var bt in l)K=l[bt],l.hasOwnProperty(bt)&&K!==void 0&&!c.hasOwnProperty(bt)&&Tp(s,r,bt,void 0,c,K);for(te in c)K=c[te],Q=l[te],!c.hasOwnProperty(te)||K===Q||K===void 0&&Q===void 0||Tp(s,r,te,K,c,Q);return}}for(var q in l)K=l[q],l.hasOwnProperty(q)&&K!=null&&!c.hasOwnProperty(q)&&St(s,r,q,null,c,K);for(se in c)K=c[se],Q=l[se],!c.hasOwnProperty(se)||K===Q||K==null&&Q==null||St(s,r,se,K,c,Q)}function J_(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function fC(){if(typeof performance.getEntriesByType=="function"){for(var s=0,r=0,l=performance.getEntriesByType("resource"),c=0;c<l.length;c++){var y=l[c],v=y.transferSize,w=y.initiatorType,I=y.duration;if(v&&I&&J_(w)){for(w=0,I=y.responseEnd,c+=1;c<l.length;c++){var L=l[c],$=L.startTime;if($>I)break;var te=L.transferSize,se=L.initiatorType;te&&J_(se)&&(L=L.responseEnd,w+=te*(L<I?1:(I-$)/(L-$)))}if(--c,r+=8*(v+w)/(y.duration/1e3),s++,10<s)break}}if(0<s)return r/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Sp=null,bp=null;function ad(s){return s.nodeType===9?s:s.ownerDocument}function j_(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function X_(s,r){if(s===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&r==="foreignObject"?0:s}function wp(s,r){return s==="textarea"||s==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Ap=null;function pC(){var s=window.event;return s&&s.type==="popstate"?s===Ap?!1:(Ap=s,!0):(Ap=null,!1)}var Q_=typeof setTimeout=="function"?setTimeout:void 0,mC=typeof clearTimeout=="function"?clearTimeout:void 0,W_=typeof Promise=="function"?Promise:void 0,gC=typeof queueMicrotask=="function"?queueMicrotask:typeof W_<"u"?function(s){return W_.resolve(null).then(s).catch(yC)}:Q_;function yC(s){setTimeout(function(){throw s})}function Kr(s){return s==="head"}function Z_(s,r){var l=r,c=0;do{var y=l.nextSibling;if(s.removeChild(l),y&&y.nodeType===8)if(l=y.data,l==="/$"||l==="/&"){if(c===0){s.removeChild(y),Qa(r);return}c--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")c++;else if(l==="html")pu(s.ownerDocument.documentElement);else if(l==="head"){l=s.ownerDocument.head,pu(l);for(var v=l.firstChild;v;){var w=v.nextSibling,I=v.nodeName;v[_n]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&v.rel.toLowerCase()==="stylesheet"||l.removeChild(v),v=w}}else l==="body"&&pu(s.ownerDocument.body);l=y}while(l);Qa(r)}function ev(s,r){var l=s;s=0;do{var c=l.nextSibling;if(l.nodeType===1?r?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(r?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),c&&c.nodeType===8)if(l=c.data,l==="/$"){if(s===0)break;s--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||s++;l=c}while(l)}function Cp(s){var r=s.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Cp(l),Ni(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}s.removeChild(l)}}function _C(s,r,l,c){for(;s.nodeType===1;){var y=l;if(s.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(c){if(!s[_n])switch(r){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(v=s.getAttribute("rel"),v==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(v!==y.rel||s.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||s.getAttribute("title")!==(y.title==null?null:y.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(v=s.getAttribute("src"),(v!==(y.src==null?null:y.src)||s.getAttribute("type")!==(y.type==null?null:y.type)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&v&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(r==="input"&&s.type==="hidden"){var v=y.name==null?null:""+y.name;if(y.type==="hidden"&&s.getAttribute("name")===v)return s}else return s;if(s=Fi(s.nextSibling),s===null)break}return null}function vC(s,r,l){if(r==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Fi(s.nextSibling),s===null))return null;return s}function tv(s,r){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!r||(s=Fi(s.nextSibling),s===null))return null;return s}function xp(s){return s.data==="$?"||s.data==="$~"}function Ip(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function EC(s,r){var l=s.ownerDocument;if(s.data==="$~")s._reactRetry=r;else if(s.data!=="$?"||l.readyState!=="loading")r();else{var c=function(){r(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),s._reactRetry=c}}function Fi(s){for(;s!=null;s=s.nextSibling){var r=s.nodeType;if(r===1||r===3)break;if(r===8){if(r=s.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return s}var Rp=null;function nv(s){s=s.nextSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"||l==="/&"){if(r===0)return Fi(s.nextSibling);r--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||r++}s=s.nextSibling}return null}function iv(s){s=s.previousSibling;for(var r=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(r===0)return s;r--}else l!=="/$"&&l!=="/&"||r++}s=s.previousSibling}return null}function sv(s,r,l){switch(r=ad(l),s){case"html":if(s=r.documentElement,!s)throw Error(i(452));return s;case"head":if(s=r.head,!s)throw Error(i(453));return s;case"body":if(s=r.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function pu(s){for(var r=s.attributes;r.length;)s.removeAttributeNode(r[0]);Ni(s)}var Bi=new Map,rv=new Set;function ld(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ur=ce.d;ce.d={f:TC,r:SC,D:bC,C:wC,L:AC,m:CC,X:IC,S:xC,M:RC};function TC(){var s=ur.f(),r=Zc();return s||r}function SC(s){var r=Ue(s);r!==null&&r.tag===5&&r.type==="form"?S0(r):ur.r(s)}var Ja=typeof document>"u"?null:document;function ov(s,r,l){var c=Ja;if(c&&typeof r=="string"&&r){var y=$t(r);y='link[rel="'+s+'"][href="'+y+'"]',typeof l=="string"&&(y+='[crossorigin="'+l+'"]'),rv.has(y)||(rv.add(y),s={rel:s,crossOrigin:l,href:r},c.querySelector(y)===null&&(r=c.createElement("link"),Rn(r,"link",s),At(r),c.head.appendChild(r)))}}function bC(s){ur.D(s),ov("dns-prefetch",s,null)}function wC(s,r){ur.C(s,r),ov("preconnect",s,r)}function AC(s,r,l){ur.L(s,r,l);var c=Ja;if(c&&s&&r){var y='link[rel="preload"][as="'+$t(r)+'"]';r==="image"&&l&&l.imageSrcSet?(y+='[imagesrcset="'+$t(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(y+='[imagesizes="'+$t(l.imageSizes)+'"]')):y+='[href="'+$t(s)+'"]';var v=y;switch(r){case"style":v=ja(s);break;case"script":v=Xa(s)}Bi.has(v)||(s=E({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:s,as:r},l),Bi.set(v,s),c.querySelector(y)!==null||r==="style"&&c.querySelector(mu(v))||r==="script"&&c.querySelector(gu(v))||(r=c.createElement("link"),Rn(r,"link",s),At(r),c.head.appendChild(r)))}}function CC(s,r){ur.m(s,r);var l=Ja;if(l&&s){var c=r&&typeof r.as=="string"?r.as:"script",y='link[rel="modulepreload"][as="'+$t(c)+'"][href="'+$t(s)+'"]',v=y;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Xa(s)}if(!Bi.has(v)&&(s=E({rel:"modulepreload",href:s},r),Bi.set(v,s),l.querySelector(y)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(gu(v)))return}c=l.createElement("link"),Rn(c,"link",s),At(c),l.head.appendChild(c)}}}function xC(s,r,l){ur.S(s,r,l);var c=Ja;if(c&&s){var y=Gn(c).hoistableStyles,v=ja(s);r=r||"default";var w=y.get(v);if(!w){var I={loading:0,preload:null};if(w=c.querySelector(mu(v)))I.loading=5;else{s=E({rel:"stylesheet",href:s,"data-precedence":r},l),(l=Bi.get(v))&&Np(s,l);var L=w=c.createElement("link");At(L),Rn(L,"link",s),L._p=new Promise(function($,te){L.onload=$,L.onerror=te}),L.addEventListener("load",function(){I.loading|=1}),L.addEventListener("error",function(){I.loading|=2}),I.loading|=4,ud(w,r,c)}w={type:"stylesheet",instance:w,count:1,state:I},y.set(v,w)}}}function IC(s,r){ur.X(s,r);var l=Ja;if(l&&s){var c=Gn(l).hoistableScripts,y=Xa(s),v=c.get(y);v||(v=l.querySelector(gu(y)),v||(s=E({src:s,async:!0},r),(r=Bi.get(y))&&Mp(s,r),v=l.createElement("script"),At(v),Rn(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(y,v))}}function RC(s,r){ur.M(s,r);var l=Ja;if(l&&s){var c=Gn(l).hoistableScripts,y=Xa(s),v=c.get(y);v||(v=l.querySelector(gu(y)),v||(s=E({src:s,async:!0,type:"module"},r),(r=Bi.get(y))&&Mp(s,r),v=l.createElement("script"),At(v),Rn(v,"link",s),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(y,v))}}function av(s,r,l,c){var y=(y=ke.current)?ld(y):null;if(!y)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=ja(l.href),l=Gn(y).hoistableStyles,c=l.get(r),c||(c={type:"style",instance:null,count:0,state:null},l.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){s=ja(l.href);var v=Gn(y).hoistableStyles,w=v.get(s);if(w||(y=y.ownerDocument||y,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(s,w),(v=y.querySelector(mu(s)))&&!v._p&&(w.instance=v,w.state.loading=5),Bi.has(s)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Bi.set(s,l),v||NC(y,s,l,w.state))),r&&c===null)throw Error(i(528,""));return w}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Xa(l),l=Gn(y).hoistableScripts,c=l.get(r),c||(c={type:"script",instance:null,count:0,state:null},l.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function ja(s){return'href="'+$t(s)+'"'}function mu(s){return'link[rel="stylesheet"]['+s+"]"}function lv(s){return E({},s,{"data-precedence":s.precedence,precedence:null})}function NC(s,r,l,c){s.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=s.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Rn(r,"link",l),At(r),s.head.appendChild(r))}function Xa(s){return'[src="'+$t(s)+'"]'}function gu(s){return"script[async]"+s}function uv(s,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var c=s.querySelector('style[data-href~="'+$t(l.href)+'"]');if(c)return r.instance=c,At(c),c;var y=E({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(s.ownerDocument||s).createElement("style"),At(c),Rn(c,"style",y),ud(c,l.precedence,s),r.instance=c;case"stylesheet":y=ja(l.href);var v=s.querySelector(mu(y));if(v)return r.state.loading|=4,r.instance=v,At(v),v;c=lv(l),(y=Bi.get(y))&&Np(c,y),v=(s.ownerDocument||s).createElement("link"),At(v);var w=v;return w._p=new Promise(function(I,L){w.onload=I,w.onerror=L}),Rn(v,"link",c),r.state.loading|=4,ud(v,l.precedence,s),r.instance=v;case"script":return v=Xa(l.src),(y=s.querySelector(gu(v)))?(r.instance=y,At(y),y):(c=l,(y=Bi.get(v))&&(c=E({},l),Mp(c,y)),s=s.ownerDocument||s,y=s.createElement("script"),At(y),Rn(y,"link",c),s.head.appendChild(y),r.instance=y);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,ud(c,l.precedence,s));return r.instance}function ud(s,r,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=c.length?c[c.length-1]:null,v=y,w=0;w<c.length;w++){var I=c[w];if(I.dataset.precedence===r)v=I;else if(v!==y)break}v?v.parentNode.insertBefore(s,v.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(s,r.firstChild))}function Np(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.title==null&&(s.title=r.title)}function Mp(s,r){s.crossOrigin==null&&(s.crossOrigin=r.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=r.referrerPolicy),s.integrity==null&&(s.integrity=r.integrity)}var cd=null;function cv(s,r,l){if(cd===null){var c=new Map,y=cd=new Map;y.set(l,c)}else y=cd,c=y.get(l),c||(c=new Map,y.set(l,c));if(c.has(s))return c;for(c.set(s,null),l=l.getElementsByTagName(s),y=0;y<l.length;y++){var v=l[y];if(!(v[_n]||v[Ce]||s==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var w=v.getAttribute(r)||"";w=s+w;var I=c.get(w);I?I.push(v):c.set(w,[v])}}return c}function dv(s,r,l){s=s.ownerDocument||s,s.head.insertBefore(l,r==="title"?s.querySelector("head > title"):null)}function MC(s,r,l){if(l===1||r.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return s=r.disabled,typeof r.precedence=="string"&&s==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function hv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function PC(s,r,l,c){if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var y=ja(c.href),v=r.querySelector(mu(y));if(v){r=v._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(s.count++,s=dd.bind(s),r.then(s,s)),l.state.loading|=4,l.instance=v,At(v);return}v=r.ownerDocument||r,c=lv(c),(y=Bi.get(y))&&Np(c,y),v=v.createElement("link"),At(v);var w=v;w._p=new Promise(function(I,L){w.onload=I,w.onerror=L}),Rn(v,"link",c),l.instance=v}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(l,r),(r=l.state.preload)&&(l.state.loading&3)===0&&(s.count++,l=dd.bind(s),r.addEventListener("load",l),r.addEventListener("error",l))}}var Pp=0;function DC(s,r){return s.stylesheets&&s.count===0&&fd(s,s.stylesheets),0<s.count||0<s.imgCount?function(l){var c=setTimeout(function(){if(s.stylesheets&&fd(s,s.stylesheets),s.unsuspend){var v=s.unsuspend;s.unsuspend=null,v()}},6e4+r);0<s.imgBytes&&Pp===0&&(Pp=62500*fC());var y=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&fd(s,s.stylesheets),s.unsuspend)){var v=s.unsuspend;s.unsuspend=null,v()}},(s.imgBytes>Pp?50:800)+r);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(c),clearTimeout(y)}}:null}function dd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)fd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var hd=null;function fd(s,r){s.stylesheets=null,s.unsuspend!==null&&(s.count++,hd=new Map,r.forEach(kC,s),hd=null,dd.call(s))}function kC(s,r){if(!(r.state.loading&4)){var l=hd.get(s);if(l)var c=l.get(null);else{l=new Map,hd.set(s,l);for(var y=s.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<y.length;v++){var w=y[v];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(l.set(w.dataset.precedence,w),c=w)}c&&l.set(null,c)}y=r.instance,w=y.getAttribute("data-precedence"),v=l.get(w)||c,v===c&&l.set(null,y),l.set(w,y),this.count++,c=dd.bind(this),y.addEventListener("load",c),y.addEventListener("error",c),v?v.parentNode.insertBefore(y,v.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(y,s.firstChild)),r.state.loading|=4}}var yu={$$typeof:Z,Provider:null,Consumer:null,_currentValue:Te,_currentValue2:Te,_threadCount:0};function UC(s,r,l,c,y,v,w,I,L){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ri(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ri(0),this.hiddenUpdates=Ri(null),this.identifierPrefix=c,this.onUncaughtError=y,this.onCaughtError=v,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=L,this.incompleteTransitions=new Map}function fv(s,r,l,c,y,v,w,I,L,$,te,se){return s=new UC(s,r,l,w,L,$,te,se,I),r=1,v===!0&&(r|=24),v=vi(3,null,null,r),s.current=v,v.stateNode=s,r=df(),r.refCount++,s.pooledCache=r,r.refCount++,v.memoizedState={element:c,isDehydrated:l,cache:r},mf(v),s}function pv(s){return s?(s=xa,s):xa}function mv(s,r,l,c,y,v){y=pv(y),c.context===null?c.context=y:c.pendingContext=y,c=Lr(r),c.payload={element:l},v=v===void 0?null:v,v!==null&&(c.callback=v),l=Vr(s,c,r),l!==null&&(oi(l,s,r),jl(l,s,r))}function gv(s,r){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<r?l:r}}function Dp(s,r){gv(s,r),(s=s.alternate)&&gv(s,r)}function yv(s){if(s.tag===13||s.tag===31){var r=Lo(s,67108864);r!==null&&oi(r,s,67108864),Dp(s,67108864)}}function _v(s){if(s.tag===13||s.tag===31){var r=wi();r=Se(r);var l=Lo(s,r);l!==null&&oi(l,s,r),Dp(s,r)}}var pd=!0;function LC(s,r,l,c){var y=W.T;W.T=null;var v=ce.p;try{ce.p=2,kp(s,r,l,c)}finally{ce.p=v,W.T=y}}function VC(s,r,l,c){var y=W.T;W.T=null;var v=ce.p;try{ce.p=8,kp(s,r,l,c)}finally{ce.p=v,W.T=y}}function kp(s,r,l,c){if(pd){var y=Up(c);if(y===null)Ep(s,r,c,md,l),Ev(s,c);else if(zC(y,s,r,l,c))c.stopPropagation();else if(Ev(s,c),r&4&&-1<OC.indexOf(s)){for(;y!==null;){var v=Ue(y);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var w=pi(v.pendingLanes);if(w!==0){var I=v;for(I.pendingLanes|=2,I.entangledLanes|=2;w;){var L=1<<31-wt(w);I.entanglements[1]|=L,w&=~L}xs(v),(ft&6)===0&&(Qc=fn()+500,du(0))}}break;case 31:case 13:I=Lo(v,2),I!==null&&oi(I,v,2),Zc(),Dp(v,2)}if(v=Up(c),v===null&&Ep(s,r,c,md,l),v===y)break;y=v}y!==null&&c.stopPropagation()}else Ep(s,r,c,null,l)}}function Up(s){return s=Mi(s),Lp(s)}var md=null;function Lp(s){if(md=null,s=rn(s),s!==null){var r=a(s);if(r===null)s=null;else{var l=r.tag;if(l===13){if(s=u(r),s!==null)return s;s=null}else if(l===31){if(s=d(r),s!==null)return s;s=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;s=null}else r!==s&&(s=null)}}return md=s,null}function vv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(fs()){case ji:return 2;case Ao:return 8;case Xn:case Pl:return 32;case ps:return 268435456;default:return 32}default:return 32}}var Vp=!1,Jr=null,jr=null,Xr=null,_u=new Map,vu=new Map,Qr=[],OC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ev(s,r){switch(s){case"focusin":case"focusout":Jr=null;break;case"dragenter":case"dragleave":jr=null;break;case"mouseover":case"mouseout":Xr=null;break;case"pointerover":case"pointerout":_u.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":vu.delete(r.pointerId)}}function Eu(s,r,l,c,y,v){return s===null||s.nativeEvent!==v?(s={blockedOn:r,domEventName:l,eventSystemFlags:c,nativeEvent:v,targetContainers:[y]},r!==null&&(r=Ue(r),r!==null&&yv(r)),s):(s.eventSystemFlags|=c,r=s.targetContainers,y!==null&&r.indexOf(y)===-1&&r.push(y),s)}function zC(s,r,l,c,y){switch(r){case"focusin":return Jr=Eu(Jr,s,r,l,c,y),!0;case"dragenter":return jr=Eu(jr,s,r,l,c,y),!0;case"mouseover":return Xr=Eu(Xr,s,r,l,c,y),!0;case"pointerover":var v=y.pointerId;return _u.set(v,Eu(_u.get(v)||null,s,r,l,c,y)),!0;case"gotpointercapture":return v=y.pointerId,vu.set(v,Eu(vu.get(v)||null,s,r,l,c,y)),!0}return!1}function Tv(s){var r=rn(s.target);if(r!==null){var l=a(r);if(l!==null){if(r=l.tag,r===13){if(r=u(l),r!==null){s.blockedOn=r,ot(s.priority,function(){_v(l)});return}}else if(r===31){if(r=d(l),r!==null){s.blockedOn=r,ot(s.priority,function(){_v(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function gd(s){if(s.blockedOn!==null)return!1;for(var r=s.targetContainers;0<r.length;){var l=Up(s.nativeEvent);if(l===null){l=s.nativeEvent;var c=new l.constructor(l.type,l);Dl=c,l.target.dispatchEvent(c),Dl=null}else return r=Ue(l),r!==null&&yv(r),s.blockedOn=l,!1;r.shift()}return!0}function Sv(s,r,l){gd(s)&&l.delete(r)}function FC(){Vp=!1,Jr!==null&&gd(Jr)&&(Jr=null),jr!==null&&gd(jr)&&(jr=null),Xr!==null&&gd(Xr)&&(Xr=null),_u.forEach(Sv),vu.forEach(Sv)}function yd(s,r){s.blockedOn===r&&(s.blockedOn=null,Vp||(Vp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,FC)))}var _d=null;function bv(s){_d!==s&&(_d=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){_d===s&&(_d=null);for(var r=0;r<s.length;r+=3){var l=s[r],c=s[r+1],y=s[r+2];if(typeof c!="function"){if(Lp(c||l)===null)continue;break}var v=Ue(l);v!==null&&(s.splice(r,3),r-=3,Uf(v,{pending:!0,data:y,method:l.method,action:c},c,y))}}))}function Qa(s){function r(L){return yd(L,s)}Jr!==null&&yd(Jr,s),jr!==null&&yd(jr,s),Xr!==null&&yd(Xr,s),_u.forEach(r),vu.forEach(r);for(var l=0;l<Qr.length;l++){var c=Qr[l];c.blockedOn===s&&(c.blockedOn=null)}for(;0<Qr.length&&(l=Qr[0],l.blockedOn===null);)Tv(l),l.blockedOn===null&&Qr.shift();if(l=(s.ownerDocument||s).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var y=l[c],v=l[c+1],w=y[Ye]||null;if(typeof v=="function")w||bv(l);else if(w){var I=null;if(v&&v.hasAttribute("formAction")){if(y=v,w=v[Ye]||null)I=w.formAction;else if(Lp(y)!==null)continue}else I=w.action;typeof I=="function"?l[c+1]=I:(l.splice(c,3),c-=3),bv(l)}}}function wv(){function s(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(w){return y=w})},focusReset:"manual",scroll:"manual"})}function r(){y!==null&&(y(),y=null),c||setTimeout(l,20)}function l(){if(!c&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,y=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(l,100),function(){c=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),y!==null&&(y(),y=null)}}}function Op(s){this._internalRoot=s}vd.prototype.render=Op.prototype.render=function(s){var r=this._internalRoot;if(r===null)throw Error(i(409));var l=r.current,c=wi();mv(l,c,s,r,null,null)},vd.prototype.unmount=Op.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var r=s.containerInfo;mv(s.current,2,null,s,null,null),Zc(),r[Sn]=null}};function vd(s){this._internalRoot=s}vd.prototype.unstable_scheduleHydration=function(s){if(s){var r=Je();s={blockedOn:null,target:s,priority:r};for(var l=0;l<Qr.length&&r!==0&&r<Qr[l].priority;l++);Qr.splice(l,0,s),l===0&&Tv(s)}};var Av=e.version;if(Av!=="19.2.0")throw Error(i(527,Av,"19.2.0"));ce.findDOMNode=function(s){var r=s._reactInternals;if(r===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=p(r),s=s!==null?_(s):null,s=s===null?null:s.stateNode,s};var BC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ed=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ed.isDisabled&&Ed.supportsFiber)try{hi=Ed.inject(BC),Ut=Ed}catch{}}return Su.createRoot=function(s,r){if(!o(s))throw Error(i(299));var l=!1,c="",y=P0,v=D0,w=k0;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(y=r.onUncaughtError),r.onCaughtError!==void 0&&(v=r.onCaughtError),r.onRecoverableError!==void 0&&(w=r.onRecoverableError)),r=fv(s,1,!1,null,null,l,c,null,y,v,w,wv),s[Sn]=r.current,vp(s),new Op(r)},Su.hydrateRoot=function(s,r,l){if(!o(s))throw Error(i(299));var c=!1,y="",v=P0,w=D0,I=k0,L=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(y=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.formState!==void 0&&(L=l.formState)),r=fv(s,1,!0,r,l??null,c,y,L,v,w,I,wv),r.context=pv(null),l=r.current,c=wi(),c=Se(c),y=Lr(c),y.callback=null,Vr(l,y,c),l=c,r.current.lanes=l,Gs(r,l),xs(r),s[Sn]=r.current,vp(s),new vd(r)},Su.version="19.2.0",Su}var Uv;function QC(){if(Uv)return Bp.exports;Uv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Bp.exports=XC(),Bp.exports}var WC=QC();const ZC=XS(WC);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ex=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),tx=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),Lv=n=>{const e=tx(n);return e.charAt(0).toUpperCase()+e.slice(1)},WS=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),nx=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ix={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sx=ee.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:o="",children:a,iconNode:u,...d},f)=>ee.createElement("svg",{ref:f,...ix,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:WS("lucide",o),...!a&&!nx(d)&&{"aria-hidden":"true"},...d},[...u.map(([p,_])=>ee.createElement(p,_)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=(n,e)=>{const t=ee.forwardRef(({className:i,...o},a)=>ee.createElement(sx,{ref:a,iconNode:e,className:WS(`lucide-${ex(Lv(n))}`,`lucide-${n}`,i),...o}));return t.displayName=Lv(n),t};/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rx=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],ZS=Ae("activity",rx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ox=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],eb=Ae("arrow-left",ox);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ax=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],lx=Ae("arrow-up",ax);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ux=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],cx=Ae("bot",ux);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dx=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],hx=Ae("chart-no-axes-column",dx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fx=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Vv=Ae("check",fx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const px=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Yp=Ae("chevron-down",px);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mx=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],gx=Ae("chevron-left",mx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yx=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Qm=Ae("chevron-right",yx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _x=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],vx=Ae("chevron-up",_x);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ex=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],sm=Ae("circle-alert",Ex);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tx=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],rm=Ae("circle-check-big",Tx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sx=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],tb=Ae("circle-question-mark",Sx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bx=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],wx=Ae("credit-card",bx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ax=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],qd=Ae("crown",Ax);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cx=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],nb=Ae("download",Cx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xx=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Ix=Ae("external-link",xx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rx=[["path",{d:"M12 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 12 18z",key:"b19h5q"}],["path",{d:"M2 6a2 2 0 0 1 3.414-1.414l6 6a2 2 0 0 1 0 2.828l-6 6A2 2 0 0 1 2 18z",key:"h7h5ge"}]],Nx=Ae("fast-forward",Rx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mx=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],Px=Ae("file-braces",Mx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dx=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M15.033 13.44a.647.647 0 0 1 0 1.12l-4.065 2.352a.645.645 0 0 1-.968-.56v-4.704a.645.645 0 0 1 .967-.56z",key:"1tzo1f"}]],kx=Ae("file-play",Dx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ux=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],Lx=Ae("film",Ux);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],om=Ae("gift",Vx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ox=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],zx=Ae("house",Ox);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fx=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Ov=Ae("image",Fx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bx=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],qx=Ae("layers",Bx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hx=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Hd=Ae("loader-circle",Hx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gx=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],am=Ae("log-in",Gx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yx=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],$x=Ae("lock",Yx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kx=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Jx=Ae("mail",Kx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jx=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Xx=Ae("maximize-2",jx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qx=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],Wx=Ae("mic-off",Qx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zx=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],ib=Ae("mic",Zx);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],tI=Ae("minimize-2",eI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],na=Ae("music",nI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],sI=Ae("package",iI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],oI=Ae("palette",rI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],sb=Ae("pause",aI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],mh=Ae("play",lI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],cI=Ae("refresh-cw",uI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],hI=Ae("rocket",dI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],zv=Ae("save",fI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],mI=Ae("settings",pI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Fv=Ae("share-2",gI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yI=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],_I=Ae("shuffle",yI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]],lm=Ae("sliders-vertical",vI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],uo=Ae("sparkles",EI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],fl=Ae("star",TI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],bI=Ae("trash-2",SI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Wm=Ae("upload",wI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AI=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],CI=Ae("user",AI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Bv=Ae("wand-sparkles",xI);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],so=Ae("x",II);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],pl=Ae("zap",RI);var xt=(n=>(n[n.ASSETS=1]="ASSETS",n[n.DIRECTOR=2]="DIRECTOR",n[n.PREVIEW=3]="PREVIEW",n))(xt||{});const qv={step:1,user:null,showAuthModal:!1,showPaymentModal:!1,userTier:"free",imageFile:null,imagePreviewUrl:null,audioFile:null,audioPreviewUrl:null,selectedStyleId:"natural",secondaryStyleId:"",morphIntensity:0,reactivity:80,motionPrompt:"",motionPreset:"auto",superModeMotionPreset:"triplet-flow",useTurbo:!1,superMode:!1,intensity:80,duration:30,smoothness:20,stutter:50,stutterPreset:"auto",generatedFrames:[],subjectCategory:"CHARACTER",isGenerating:!1,credits:0,savedDirectorPresets:[]},Is={TURBO:1,QUALITY:2,SUPER_MODE:4,RE_EXPORT:1,WIDGET_PURCHASE:20},Td={"15s-mid":{label:"15s (Middle)",durationSec:15,position:"middle",credits:1},"30s-start":{label:"30s (Start)",durationSec:30,position:"start",credits:1},"59s-end":{label:"59s (End)",durationSec:59,position:"end",credits:1},full:{label:"Full Song",durationSec:null,position:"full",credits:2}},Hv=[{id:"pack_1",credits:1,price:1,label:"1 Credit",priceId:"price_1cr"},{id:"pack_10",credits:10,price:5,label:"10 Credits",priceId:"price_10cr",popular:!0},{id:"pack_25",credits:25,price:10,label:"25 Credits",priceId:"price_25cr"},{id:"pack_60",credits:60,price:20,label:"60 Credits",priceId:"price_60cr",bestValue:!0},{id:"pack_100",credits:100,price:30,label:"100 Credits",priceId:"price_100cr"}],Wa={id:"sub_pro",price:8,dailyCredits:2,features:["No Watermarks on Exports","Unlimited Re-Exports (Super Mode)","2 Free Credits Daily","Priority Generation","No Ads"]},Zm={signupCredits:5,dailyCredits:1},Gv=[{id:"triplet-flow",label:"Triplet Flow (3/4)",description:"Choreography locked to triplets. Good for Trap/Waltz."},{id:"vocal-chop",label:"Vocal Chop / Lip Sync",description:"Heavy emphasis on face close-ups during vocal runs."},{id:"char-spin",label:"Character Spin",description:"Full 360-degree rotation simulation poses."},{id:"slow-mo-impact",label:"Slow-Mo Impact",description:"Fast buildups with sudden half-time drops."},{id:"liquid-morph",label:"Liquid Morph",description:"Constant fluid motion between poses."}],as=[{id:"neon-cyber",name:"Neon Cyberpunk",category:"Cinematic",description:"Glowing neon lights, dark tech aesthetic.",promptModifier:"cyberpunk style, neon lights, glowing edges, futuristic city atmosphere, dark background with vibrant cyan and magenta highlights. High contrast. Sharp details.",thumbnail:"/assets/style-thumbs/neon-cyber.png",hologramParams:{geometryType:0,hue:280,chaos:.3,density:1.2,speed:.8,intensity:.7}},{id:"noir",name:"Neo Noir",category:"Cinematic",description:"Black and white, high contrast, dramatic.",promptModifier:"film noir style, black and white, dramatic lighting, volumetric fog, wet streets, moody, cinematic composition, 4k.",thumbnail:"/assets/style-thumbs/noir.png",hologramParams:{geometryType:6,hue:0,saturation:0,chaos:.1,density:.5,speed:.2,intensity:.8}},{id:"natural",name:"Cinematic Realism",category:"Cinematic",description:"Preserves original aesthetic. Just motion.",promptModifier:"photorealistic, unchanged art style, preserve original aesthetic, high fidelity, natural lighting, 8k resolution.",thumbnail:"/assets/style-thumbs/natural.png",hologramParams:{geometryType:6,hue:200,chaos:0,density:.5,speed:.3,intensity:.3}},{id:"vintage-film",name:"Vintage Film",category:"Cinematic",description:"Warm 70s Kodak look, film grain.",promptModifier:"vintage 70s film look, kodak portra style, warm colors, film grain, soft focus, nostalgic atmosphere, cinematic.",thumbnail:"/assets/style-thumbs/vintage-film.png",hologramParams:{geometryType:6,hue:30,chaos:.2,density:.7,speed:.1,intensity:.4}},{id:"retro-anime",name:"Retro Anime (90s)",category:"Anime/2D",description:"Vintage cel-shaded look, grain, VHS.",promptModifier:"90s anime style, cel shaded, vhs glitch effect, retro aesthetic, lo-fi anime screenshot, hand drawn look, Cowboy Bebop aesthetic.",thumbnail:"/assets/style-thumbs/retro-anime.png",hologramParams:{geometryType:1,hue:340,chaos:.1,density:.8,speed:.4,intensity:.5,saturation:.6}},{id:"cyber-samurai",name:"Cyber Samurai",category:"Anime/2D",description:"Sharp lines, manga style, ink, red & black.",promptModifier:"manga art style, ink lines, stark black and white with red accents, aggressive strokes, dynamic shading, Akira style.",thumbnail:"/assets/style-thumbs/cyber-samurai.png",hologramParams:{geometryType:0,hue:0,chaos:.4,density:1,speed:1.5,intensity:.9}},{id:"pixel-art",name:"16-Bit Pixel",category:"Anime/2D",description:"Retro game sprite aesthetic.",promptModifier:"pixel art, 16-bit game sprite, limited color palette, dithering, retro video game style, blocky edges.",thumbnail:"/assets/style-thumbs/pixel-art.png",hologramParams:{geometryType:1,hue:120,chaos:0,density:2,speed:.8,intensity:.6}},{id:"vector-flat",name:"Vector Flat",category:"Anime/2D",description:"Clean, minimal, flat colors.",promptModifier:"flat vector art, kurzgesagt style, clean lines, minimal shading, vibrant flat colors, modern graphic design.",thumbnail:"/assets/style-thumbs/vector-flat.png",hologramParams:{geometryType:2,hue:180,chaos:0,density:.3,speed:.2,intensity:.7}},{id:"acid-glitch",name:"Acid Glitch",category:"Digital/Glitch",description:"Distorted visuals, digital noise.",promptModifier:"glitch art, datamosh, chromatic aberration, distorted digital noise, acid colors, psychedelic, raw aesthetics.",thumbnail:"/assets/style-thumbs/acid-glitch.png",hologramParams:{geometryType:4,hue:120,chaos:.8,density:1.5,speed:1.2,intensity:.8,morph:.5}},{id:"vaporwave",name:"Vaporwave",category:"Digital/Glitch",description:"Pink/Blue pastels, statues, grid.",promptModifier:"vaporwave aesthetic, pastel pink and blue gradient, greek statue elements, 80s computer graphics, grid background, nostalgic.",thumbnail:"/assets/style-thumbs/vaporwave.png",hologramParams:{geometryType:3,hue:300,chaos:0,density:.6,speed:.2,intensity:.5}},{id:"crt-terminal",name:"CRT Terminal",category:"Digital/Glitch",description:"Green phosphor, scanlines, retro monitor.",promptModifier:"crt monitor effect, green phosphor screen, scanlines, digital terminal aesthetic, matrix code style, retro computing.",thumbnail:"/assets/style-thumbs/crt-terminal.png",hologramParams:{geometryType:1,hue:100,chaos:.2,density:1.8,speed:.5,intensity:.8}},{id:"low-poly",name:"Low Poly",category:"Digital/Glitch",description:"PS1 aesthetic, jagged edges.",promptModifier:"ps1 aesthetics, low poly 3d model, jagged edges, low resolution texture, retro 3d graphics, playstation 1 style.",thumbnail:"/assets/style-thumbs/low-poly.png",hologramParams:{geometryType:0,hue:240,chaos:.1,density:.5,speed:.4,intensity:.6}},{id:"oil-painting",name:"Dreamy Oil",category:"Artistic",description:"Fluid strokes, vivid colors.",promptModifier:"impasto oil painting, thick brush strokes, vivid colors, dreamy atmosphere, swirling patterns, expressionist art.",thumbnail:"/assets/style-thumbs/oil-painting.png",hologramParams:{geometryType:3,hue:200,chaos:0,density:.6,speed:.2,intensity:.6,morph:.8}},{id:"claymation",name:"Claymation",category:"Artistic",description:"Stop-motion plasticine look.",promptModifier:"claymation style, plasticine texture, stop motion look, soft lighting, fingerprint textures, aardman style.",thumbnail:"/assets/style-thumbs/claymation.png",hologramParams:{geometryType:2,hue:40,chaos:0,density:.4,speed:.3,intensity:.5}},{id:"street-graffiti",name:"Street Graffiti",category:"Artistic",description:"Spray paint, urban, drip effects.",promptModifier:"street art graffiti, spray paint texture, drip effects, vibrant urban colors, mural style, rough wall texture.",thumbnail:"/assets/style-thumbs/street-graffiti.png",hologramParams:{geometryType:4,hue:320,chaos:.6,density:.9,speed:.7,intensity:.8}},{id:"ukiyo-e",name:"Ukiyo-e",category:"Artistic",description:"Japanese woodblock print style.",promptModifier:"ukiyo-e style, japanese woodblock print, hokusai style, flat perspective, outlined waves, textured paper.",thumbnail:"/assets/style-thumbs/ukiyo-e.png",hologramParams:{geometryType:5,hue:210,chaos:0,density:.4,speed:.2,intensity:.4}}],On=(n,e=1)=>{const t=new CustomEvent("ui-interaction",{detail:{type:n,intensity:e}});window.dispatchEvent(t)},Yv=n=>{const e=new CustomEvent("color-shift",{detail:{hue:n}});window.dispatchEvent(e)},NI=({state:n,onUploadImage:e,onUploadAudio:t})=>{const i=ee.useRef(null),o=ee.useRef(null),[a,u]=ee.useState(!1),d=ee.useRef(null),f=ee.useRef(null),p=ee.useRef(null),_=()=>{On("click",.5),d.current&&(a?d.current.pause():d.current.play(),u(!a))};return T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 h-full max-w-6xl mx-auto py-10 perspective-1000",children:[T.jsxs("div",{ref:f,className:"flex flex-col animate-zoom-out transition-all duration-500",style:{animationDelay:"0ms",opacity:n.imagePreviewUrl?.9:1,transform:n.imagePreviewUrl?"scale(0.98)":"scale(1)"},onMouseEnter:()=>On("hover",.2),children:[T.jsxs("h3",{className:"text-2xl font-black text-white mb-6 flex items-center gap-3 drop-shadow-lg tracking-widest group cursor-default",children:[T.jsx("div",{className:`p-2 rounded-lg border transition-colors group-hover:animate-shake ${n.imagePreviewUrl?"bg-brand-500/50 border-brand-500":"bg-brand-500/20 border-brand-500/30"}`,children:T.jsx(Ov,{className:"text-brand-300"})}),T.jsx("span",{className:"group-hover:text-brand-300 transition-colors duration-300",children:"SOURCE_IDENTITY"})]}),T.jsxs("div",{className:`
              flex-1 relative rounded-3xl border-2 border-dashed flex flex-col items-center justify-center cursor-pointer transition-all duration-300 min-h-[350px] group overflow-hidden
              backdrop-blur-sm
              ${n.imagePreviewUrl?"border-brand-500/50 bg-brand-900/10 shadow-[0_0_30px_rgba(139,92,246,0.2)]":"border-white/10 hover:border-brand-400/50 bg-black/20 hover:bg-black/40 hover:scale-[1.02] hover:shadow-[0_0_20px_rgba(139,92,246,0.15)]"}
            `,onClick:()=>{var E;On("click",.8),(E=i.current)==null||E.click()},children:[T.jsx("div",{className:"absolute inset-0 pointer-events-none bg-gradient-to-b from-transparent via-brand-500/10 to-transparent opacity-0 group-hover:opacity-100 translate-y-[-100%] group-hover:translate-y-[100%] transition-transform duration-1000 ease-linear"}),n.imagePreviewUrl?T.jsxs("div",{className:"relative w-full h-full p-6 flex items-center justify-center",children:[T.jsx("img",{src:n.imagePreviewUrl,loading:"lazy",className:"max-w-full max-h-full object-contain rounded-2xl shadow-[0_0_30px_rgba(0,0,0,0.5)] z-10 will-change-transform"}),T.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-2xl backdrop-blur-sm z-20",children:T.jsx("span",{className:"text-white font-bold tracking-widest border border-white/30 px-6 py-3 rounded-full glass-button hover:scale-110 transition-transform bg-black/50",children:"REPLACE DATA"})}),T.jsx("div",{className:"absolute top-4 right-4 bg-brand-500 text-white p-2 rounded-full shadow-lg animate-in zoom-in border border-white/20",children:T.jsx(Vv,{size:20})})]}):T.jsxs("div",{className:"text-center p-8 relative z-10",children:[T.jsx("div",{className:"w-28 h-28 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:bg-brand-500/20 group-hover:scale-110 transition-all duration-300 border border-white/10 group-hover:border-brand-400/50 group-hover:shadow-[0_0_30px_rgba(139,92,246,0.3)]",children:T.jsx(Ov,{size:48,className:"text-gray-400 group-hover:text-brand-300 transition-colors"})}),T.jsx("p",{className:"text-white font-black text-2xl tracking-widest group-hover:text-brand-300 transition-colors glitch-hover",children:"UPLOAD TARGET"}),T.jsx("p",{className:"text-gray-500 text-xs mt-3 font-mono uppercase tracking-widest",children:"Supports .JPG .PNG .WEBP"})]}),T.jsx("input",{type:"file",ref:i,onChange:E=>{var S;(S=E.target.files)!=null&&S[0]&&(On("click",1.5),Yv(220),e(E.target.files[0]),E.target.value="",setTimeout(()=>{var C;(C=p.current)==null||C.scrollIntoView({behavior:"smooth",block:"center"})},300))},accept:"image/*",className:"hidden",onClick:E=>E.stopPropagation()})]})]}),T.jsxs("div",{ref:p,className:`flex flex-col animate-zoom-out transition-all duration-500 ${n.imagePreviewUrl?"opacity-100 blur-0 grayscale-0":"opacity-40 blur-[2px] grayscale"}`,style:{animationDelay:"150ms"},onMouseEnter:()=>On("hover",.2),children:[T.jsxs("h3",{className:"text-2xl font-black text-white mb-6 flex items-center gap-3 drop-shadow-lg tracking-widest group cursor-default",children:[T.jsx("div",{className:`p-2 rounded-lg border transition-colors group-hover:animate-shake ${n.audioFile?"bg-green-500/50 border-green-500":"bg-green-500/20 border-green-500/30"}`,children:T.jsx(na,{className:"text-green-300"})}),T.jsx("span",{className:"group-hover:text-green-300 transition-colors duration-300",children:"AUDIO_STREAM"}),T.jsx("span",{className:"text-xs bg-white/10 px-2 py-1 rounded text-gray-400 font-mono tracking-widest",children:"(OPTIONAL)"})]}),T.jsxs("div",{className:`
              flex-1 relative rounded-3xl border-2 border-dashed flex flex-col items-center justify-center cursor-pointer transition-all duration-300 min-h-[350px] group overflow-hidden
              backdrop-blur-sm
              ${n.audioFile?"border-green-500/50 bg-green-900/10 shadow-[0_0_30px_rgba(34,197,94,0.2)]":"border-white/10 hover:border-green-400/50 bg-black/20 hover:bg-black/40 hover:scale-[1.02] hover:shadow-[0_0_20px_rgba(34,197,94,0.15)]"}
            `,onClick:()=>{var E;n.audioFile||(On("click",.8),(E=o.current)==null||E.click())},children:[T.jsx("div",{className:"absolute inset-0 pointer-events-none bg-gradient-to-b from-transparent via-green-500/10 to-transparent opacity-0 group-hover:opacity-100 translate-y-[-100%] group-hover:translate-y-[100%] transition-transform duration-1000 ease-linear"}),n.audioFile?T.jsxs("div",{className:"text-center p-6 w-full relative z-10",children:[T.jsx("div",{className:"w-32 h-32 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-8 shadow-[0_0_50px_rgba(34,197,94,0.4)] animate-pulse-fast border-4 border-black/30 group-hover:scale-110 transition-transform",children:T.jsx(na,{size:50,className:"text-white drop-shadow-md"})}),T.jsx("p",{className:"text-white font-bold text-xl mb-6 truncate px-8 drop-shadow-md font-mono",children:n.audioFile.name}),T.jsxs("div",{className:"flex gap-4 justify-center",children:[T.jsxs("button",{onClick:E=>{E.stopPropagation(),_()},className:"px-8 py-3 bg-green-600 hover:bg-green-500 text-white rounded-full font-bold flex items-center gap-2 transition-all hover:scale-105 shadow-lg border border-green-400/30 hover:shadow-[0_0_20px_rgba(34,197,94,0.4)]",children:[a?T.jsx(sb,{size:18,fill:"currentColor"}):T.jsx(mh,{size:18,fill:"currentColor"})," PREVIEW"]}),T.jsx("button",{onClick:E=>{E.stopPropagation(),On("click",.5),t(null)},className:"px-6 py-3 bg-white/5 hover:bg-white/20 text-white rounded-full font-bold transition-transform hover:scale-105 border border-white/10 backdrop-blur-md",children:"CHANGE"})]}),T.jsx("div",{className:"absolute top-4 right-4 bg-green-500 text-white p-2 rounded-full shadow-lg animate-in zoom-in border border-white/20",children:T.jsx(Vv,{size:20})}),T.jsx("audio",{ref:d,src:n.audioPreviewUrl||void 0,onEnded:()=>u(!1),className:"hidden"})]}):T.jsxs("div",{className:"text-center p-8 relative z-10",children:[T.jsx("div",{className:"w-28 h-28 bg-white/5 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:bg-green-500/20 group-hover:scale-110 transition-all duration-300 border border-white/10 group-hover:border-green-400/50 group-hover:shadow-[0_0_30px_rgba(34,197,94,0.3)]",children:T.jsx(na,{size:48,className:"text-gray-400 group-hover:text-green-300 transition-colors"})}),T.jsx("p",{className:"text-white font-black text-2xl tracking-widest group-hover:text-green-300 transition-colors glitch-hover",children:"UPLOAD AUDIO"}),T.jsx("p",{className:"text-gray-500 text-xs mt-3 font-mono uppercase tracking-widest",children:"MP3 / WAV / AAC"}),T.jsx("p",{className:"text-brand-300/50 text-[10px] mt-2 tracking-wide font-bold",children:"OR SKIP FOR LIVE / SYNTHETIC MODE"})]}),T.jsx("input",{type:"file",ref:o,onChange:E=>{var S;(S=E.target.files)!=null&&S[0]&&(On("click",1.5),Yv(140),t(E.target.files[0]),E.target.value="")},accept:"audio/*",className:"hidden",onClick:E=>E.stopPropagation()})]})]})]})},MI=({config:n,onUpdate:e,onBuyCredits:t,onTestMode:i,onBack:o})=>{var ae,oe;const[a,u]=ee.useState(!1),[d,f]=ee.useState("Cinematic"),[p,_]=ee.useState(""),[E,S]=ee.useState(!1),C=["Cinematic","Anime/2D","Digital/Glitch","Artistic"],k=ee.useMemo(()=>as.filter(x=>x.category===d),[d]),V=()=>{On("click",1);const x=as[Math.floor(Math.random()*as.length)];f(x.category),e("selectedStyleId",x.id)},z=()=>{if(!p.trim())return;On("click",1);const x={id:crypto.randomUUID(),name:p,createdAt:Date.now(),config:{selectedStyleId:n.selectedStyleId,intensity:n.intensity,duration:n.duration,smoothness:n.smoothness,stutter:n.stutter,stutterPreset:n.stutterPreset,motionPrompt:n.motionPrompt,motionPreset:n.motionPreset,useTurbo:n.useTurbo,superMode:n.superMode,reactivity:n.reactivity,secondaryStyleId:n.secondaryStyleId,morphIntensity:n.morphIntensity,superModeMotionPreset:n.superModeMotionPreset}},M=[...n.savedDirectorPresets||[],x];e("savedDirectorPresets",M),_(""),S(!1)},J=x=>{On("click",1),Object.entries(x.config).forEach(([M,N])=>{e(M,N)}),S(!1)},j=(x,M)=>{M.stopPropagation(),On("click",.5);const N=n.savedDirectorPresets.filter(P=>P.id!==x);e("savedDirectorPresets",N)},Z=[{id:"auto",label:" Auto (AI Decides)"},{id:"bounce",label:" Bounce & Groove"},{id:"flow",label:" Smooth Flow"},{id:"glitch",label:" Twitch & Glitch"},{id:"custom",label:" Custom Description"}],H=[{id:"auto",label:" Auto / Random"},{id:"shiver",label:" Shiver (Horizontal)"},{id:"jump",label:" Jump (Vertical)"},{id:"smash",label:" Smash (Zoom Pulse)"},{id:"slice",label:" Slice (Glitch/Tear)"}];return T.jsxs("div",{className:"max-w-6xl mx-auto py-4 md:py-8 px-3 md:px-4 perspective-1000",children:[T.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-end gap-4 mb-6 md:mb-8 animate-slide-in-right relative",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("button",{onClick:o,className:"p-2 md:p-3 bg-white/5 hover:bg-white/10 rounded-xl border border-white/10 hover:border-brand-500/50 transition-all group",title:"Back to Assets",children:T.jsx(eb,{size:20,className:"text-gray-400 group-hover:text-brand-300"})}),T.jsxs("div",{children:[T.jsxs("h2",{className:"text-2xl md:text-4xl font-black text-white flex items-center gap-2 md:gap-3 glitch-hover",children:[T.jsx("span",{className:"bg-brand-500/20 text-brand-300 p-1.5 md:p-2 rounded-lg border border-brand-500/30",children:T.jsx(Bv,{size:20,className:"md:w-7 md:h-7"})}),T.jsx("span",{className:"hidden sm:inline",children:"DIRECTOR_MODE"}),T.jsx("span",{className:"sm:hidden",children:"DIRECTOR"})]}),T.jsx("p",{className:"text-brand-100/60 mt-1 font-mono tracking-widest text-[10px] md:text-xs uppercase hidden sm:block",children:"Configure your simulation"})]})]}),T.jsxs("div",{className:"flex flex-col gap-2 items-stretch md:items-end",children:[T.jsxs("div",{className:"flex gap-2 items-center justify-between md:justify-end",children:[T.jsxs("div",{className:"flex items-center bg-black/40 backdrop-blur-md px-1 py-1 rounded-full border border-white/10",children:[T.jsxs("button",{onClick:()=>e("useTurbo",!0),className:`px-3 md:px-4 py-1.5 rounded-full text-[10px] md:text-xs font-bold transition-all flex items-center gap-1 md:gap-2 ${n.useTurbo?"bg-brand-500 text-white shadow-lg":"text-gray-400"}`,children:[T.jsx(hI,{size:12})," ",T.jsx("span",{className:"hidden xs:inline",children:"TURBO"})]}),T.jsxs("button",{onClick:()=>e("useTurbo",!1),className:`px-3 md:px-4 py-1.5 rounded-full text-[10px] md:text-xs font-bold transition-all flex items-center gap-1 md:gap-2 ${n.useTurbo?"text-gray-400":"bg-purple-600 text-white shadow-lg"}`,children:[T.jsx(uo,{size:12})," ",T.jsx("span",{className:"hidden xs:inline",children:"QUALITY"})]})]}),T.jsxs("button",{onClick:()=>e("superMode",!n.superMode),className:`
                        px-3 md:px-4 py-1.5 md:py-2 rounded-full text-[10px] md:text-xs font-bold transition-all flex items-center gap-1 md:gap-2 border
                        ${n.superMode?"bg-gradient-to-r from-yellow-500 to-amber-600 text-white border-yellow-400 shadow-[0_0_15px_rgba(234,179,8,0.5)]":"bg-black/40 text-gray-500 border-gray-700 hover:border-gray-500"}
                    `,children:[T.jsx(fl,{size:12,fill:n.superMode?"white":"none"}),n.superMode?"SUPER":"SUPER MODE"]})]}),T.jsxs("div",{className:"flex gap-2 items-center justify-between md:justify-end overflow-x-auto pb-1",children:[T.jsxs("button",{onClick:V,className:"glass-button px-3 md:px-5 py-2 rounded-full text-xs font-bold text-white flex items-center gap-2 hover:bg-white/10 whitespace-nowrap",children:[T.jsx(_I,{size:14})," ",T.jsx("span",{className:"hidden sm:inline",children:"SURPRISE"})]}),T.jsxs("button",{onClick:i,className:"px-3 md:px-4 py-2 rounded-full text-xs font-bold flex items-center gap-2 border bg-gray-800 text-gray-300 border-gray-600 hover:bg-gray-700 whitespace-nowrap",children:[T.jsx(cx,{size:14})," ",T.jsx("span",{className:"hidden sm:inline",children:"TEST (FREE)"}),T.jsx("span",{className:"sm:hidden",children:"TEST"})]}),T.jsxs("div",{className:"relative",children:[T.jsxs("button",{onClick:()=>S(!E),className:"flex items-center gap-1 text-xs font-bold text-gray-400 hover:text-white bg-black/40 px-3 py-2 rounded-full border border-white/10 hover:border-brand-500/50 transition-all",children:[T.jsx(zv,{size:12})," ",T.jsx("span",{className:"hidden md:inline",children:"PRESETS"})]}),E&&T.jsxs("div",{className:"absolute top-full right-0 mt-2 w-64 bg-black/95 backdrop-blur-xl border border-white/20 rounded-xl p-4 shadow-2xl z-50 animate-fade-in",children:[T.jsxs("div",{className:"mb-4",children:[T.jsx("label",{className:"text-[10px] text-gray-500 font-bold uppercase block mb-2",children:"Save Current Config"}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("input",{type:"text",value:p,onChange:x=>_(x.target.value),placeholder:"Preset Name...",className:"w-full bg-white/5 border border-white/10 rounded-lg px-2 py-1 text-xs text-white focus:border-brand-500 outline-none"}),T.jsx("button",{onClick:z,disabled:!p,className:"bg-brand-600 hover:bg-brand-500 text-white p-1.5 rounded-lg disabled:opacity-50",children:T.jsx(zv,{size:14})})]})]}),((ae=n.savedDirectorPresets)==null?void 0:ae.length)>0&&T.jsxs("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[T.jsx("label",{className:"text-[10px] text-gray-500 font-bold uppercase block mb-1",children:"Load Preset"}),n.savedDirectorPresets.map(x=>T.jsxs("div",{onClick:()=>J(x),className:"flex justify-between items-center p-2 rounded-lg bg-white/5 hover:bg-white/10 cursor-pointer group",children:[T.jsx("span",{className:"text-xs font-bold text-gray-300 group-hover:text-white truncate",children:x.name}),T.jsx("button",{onClick:M=>j(x.id,M),className:"text-gray-600 hover:text-red-400 p-1",children:T.jsx(bI,{size:12})})]},x.id))]}),(!n.savedDirectorPresets||n.savedDirectorPresets.length===0)&&T.jsx("p",{className:"text-[10px] text-gray-600 italic text-center py-2",children:"No saved presets yet."})]})]})]})]})]}),T.jsx("div",{className:"flex flex-wrap gap-2 mb-8 animate-fade-in",style:{animationDelay:"100ms"},children:C.map((x,M)=>T.jsxs("button",{onClick:()=>{On("click",.4),f(x)},onMouseEnter:()=>On("hover",.1),className:`
              px-6 py-3 rounded-xl font-bold text-sm tracking-wide transition-all duration-300 border relative overflow-hidden group
              ${d===x?"bg-white/10 border-white text-white shadow-[0_0_20px_rgba(255,255,255,0.2)]":"bg-black/20 border-white/5 text-gray-500 hover:border-white/20 hover:text-gray-300"}
            `,children:[T.jsxs("span",{className:"relative z-10 flex items-center gap-2",children:[x==="Cinematic"&&T.jsx(Lx,{size:14}),x==="Digital/Glitch"&&T.jsx(pl,{size:14}),x==="Artistic"&&T.jsx(Bv,{size:14}),x==="Anime/2D"&&T.jsx(qx,{size:14}),x.toUpperCase()]}),d===x&&T.jsx("div",{className:"absolute inset-0 bg-white/5 animate-pulse-fast"})]},x))}),T.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:k.map((x,M)=>T.jsxs("div",{onClick:()=>{On("click",.6),e("selectedStyleId",x.id)},onMouseEnter:()=>On("hover",.2),className:`
              group relative aspect-square rounded-2xl cursor-pointer overflow-hidden transition-all duration-500 border-2
              ${n.selectedStyleId===x.id?"border-brand-400 shadow-[0_0_40px_rgba(139,92,246,0.4)] scale-105 z-10":"border-white/5 hover:border-brand-500/50 hover:shadow-[0_0_20px_rgba(139,92,246,0.2)] hover:scale-[1.02] opacity-80 hover:opacity-100"}
            `,style:{animationDelay:`${M*50}ms`},children:[T.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-900 to-black z-0"}),T.jsx("img",{src:x.thumbnail,alt:x.name,loading:"lazy",className:"absolute inset-0 w-full h-full object-cover opacity-60 group-hover:opacity-80 transition-opacity duration-500 will-change-transform"}),T.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-90"}),n.selectedStyleId===x.id&&T.jsx("div",{className:"absolute inset-0 border-4 border-brand-400 rounded-xl animate-pulse"}),T.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-5 transform translate-y-2 group-hover:translate-y-0 transition-transform duration-300",children:[T.jsx("h3",{className:`font-black text-xl leading-none mb-1 ${n.selectedStyleId===x.id?"text-brand-300":"text-white"}`,children:x.name}),T.jsx("p",{className:"text-[10px] text-gray-400 font-mono opacity-0 group-hover:opacity-100 transition-opacity duration-300 line-clamp-2",children:x.description})]}),T.jsx("div",{className:"absolute inset-0 pointer-events-none bg-gradient-to-b from-transparent via-white/10 to-transparent h-1/4 w-full -translate-y-full group-hover:translate-y-[400%] transition-transform duration-1000 ease-in-out"})]},x.id))}),T.jsxs("div",{className:"glass-panel rounded-3xl overflow-hidden border border-white/10",children:[T.jsxs("button",{onClick:()=>u(!a),className:"w-full p-4 flex items-center justify-between bg-white/5 hover:bg-white/10 transition-colors",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx(lm,{size:20,className:"text-brand-300"}),T.jsx("span",{className:"font-bold text-white tracking-widest text-sm",children:"STUDIO CONTROLS"})]}),a?T.jsx(vx,{size:20,className:"text-gray-400"}):T.jsx(Yp,{size:20,className:"text-gray-400"})]}),T.jsx("div",{className:`transition-all duration-500 ease-in-out overflow-hidden ${a?"max-h-[70vh] md:max-h-[800px] opacity-100":"max-h-0 opacity-0"}`,children:T.jsx("div",{className:"overflow-y-auto max-h-[65vh] md:max-h-[700px] scrollbar-thin scrollbar-track-transparent scrollbar-thumb-white/20 hover:scrollbar-thumb-white/30",children:T.jsxs("div",{className:"p-4 md:p-8 grid grid-cols-1 gap-6 md:gap-8 border-t border-white/5 bg-black/20",children:[T.jsxs("div",{className:"space-y-6",children:[T.jsxs("div",{children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 mb-3 block uppercase tracking-wider",children:"Motion Preset"}),T.jsx("div",{className:"grid grid-cols-2 gap-2",children:Z.map(x=>T.jsx("button",{onClick:()=>e("motionPreset",x.id),className:`
                                        px-3 py-2 rounded-lg text-xs font-bold border transition-all text-left truncate
                                        ${n.motionPreset===x.id?"bg-brand-500/20 border-brand-500 text-white":"bg-black/20 border-white/5 text-gray-500 hover:border-white/20 hover:text-gray-300"}
                                    `,children:x.label},x.id))})]}),n.superMode&&T.jsxs("div",{className:"animate-fade-in p-3 rounded-xl border border-yellow-500/20 bg-yellow-900/10",children:[T.jsxs("label",{className:"text-xs font-bold text-yellow-500 mb-2 block uppercase tracking-wider flex items-center gap-2",children:[T.jsx(fl,{size:10,fill:"currentColor"})," Super Mode Choreography"]}),T.jsxs("div",{className:"relative",children:[T.jsx("select",{value:n.superModeMotionPreset||"triplet-flow",onChange:x=>e("superModeMotionPreset",x.target.value),className:"w-full bg-black/40 border border-yellow-500/30 text-white text-xs font-bold rounded-lg p-3 appearance-none focus:border-yellow-500 outline-none",children:Gv.map(x=>T.jsx("option",{value:x.id,children:x.label},x.id))}),T.jsx(Yp,{size:14,className:"absolute right-3 top-1/2 -translate-y-1/2 text-yellow-500/50 pointer-events-none"})]}),T.jsx("p",{className:"text-[10px] text-gray-400 mt-2 italic",children:(oe=Gv.find(x=>x.id===n.superModeMotionPreset))==null?void 0:oe.description})]}),n.motionPreset==="custom"&&T.jsxs("div",{className:"animate-fade-in",children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 mb-2 block uppercase tracking-wider",children:"Custom Prompt"}),T.jsx("textarea",{value:n.motionPrompt,onChange:x=>e("motionPrompt",x.target.value),placeholder:"Describe the dance moves...",className:"w-full bg-black/40 border border-white/10 rounded-xl p-3 text-sm text-white focus:border-brand-500 outline-none h-24 resize-none"})]}),T.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 mb-3 block uppercase tracking-wider",children:"Duration"}),T.jsx("input",{type:"range",min:"10",max:"60",value:n.duration,onChange:x=>e("duration",Number(x.target.value)),className:"w-full h-1.5 bg-white/10 rounded-full accent-brand-400 cursor-pointer"}),T.jsxs("div",{className:"text-right text-xs text-brand-300 font-mono mt-1",children:[n.duration,"s"]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 mb-3 block uppercase tracking-wider",children:"Energy"}),T.jsx("input",{type:"range",min:"0",max:"100",value:n.intensity,onChange:x=>e("intensity",Number(x.target.value)),className:"w-full h-1.5 bg-white/10 rounded-full accent-brand-400 cursor-pointer"}),T.jsxs("div",{className:"text-right text-xs text-brand-300 font-mono mt-1",children:[n.intensity,"%"]})]})]})]}),T.jsxs("div",{className:"space-y-6 border-l border-white/5 pl-8 md:pl-8",children:[T.jsxs("div",{children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 mb-3 block uppercase tracking-wider",children:"Style Morphing (Beta)"}),T.jsx("p",{className:"text-[10px] text-gray-500 mb-3",children:"Blend your chosen style with a secondary aesthetic."}),T.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 mb-4 scrollbar-hide",children:[T.jsx("button",{onClick:()=>e("secondaryStyleId",""),className:`flex-shrink-0 w-12 h-12 rounded-lg border ${n.secondaryStyleId?"border-white/10 bg-black/20":"border-brand-500 bg-brand-500/20"} flex items-center justify-center`,children:T.jsx(so,{size:16,className:n.secondaryStyleId?"text-gray-500":"text-brand-300"})}),as.map(x=>T.jsx("button",{onClick:()=>e("secondaryStyleId",x.id),className:`flex-shrink-0 w-12 h-12 rounded-lg border overflow-hidden relative ${n.secondaryStyleId===x.id?"border-brand-500":"border-white/10 opacity-50 hover:opacity-100"}`,children:T.jsx("img",{src:x.thumbnail,className:"w-full h-full object-cover"})},x.id))]}),n.secondaryStyleId&&T.jsxs("div",{className:"animate-fade-in",children:[T.jsxs("label",{className:"text-[10px] text-brand-300 font-bold mb-1 block",children:["MORPH INTENSITY: ",n.morphIntensity,"%"]}),T.jsx("input",{type:"range",min:"0",max:"100",value:n.morphIntensity,onChange:x=>e("morphIntensity",Number(x.target.value)),className:"w-full h-1.5 bg-white/10 rounded-full accent-purple-500 cursor-pointer"})]})]}),T.jsxs("div",{children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 mb-3 block uppercase tracking-wider",children:"Audio Reactivity"}),T.jsx("input",{type:"range",min:"0",max:"100",value:n.reactivity,onChange:x=>e("reactivity",Number(x.target.value)),className:"w-full h-1.5 bg-white/10 rounded-full accent-green-400 cursor-pointer"}),T.jsxs("div",{className:"text-right text-xs text-green-300 font-mono mt-1",children:[n.reactivity,"% Sensitivity"]})]}),T.jsxs("div",{className:"space-y-4 pt-4 border-t border-white/5",children:[T.jsxs("div",{children:[T.jsx("label",{className:"text-xs font-bold text-gray-400 mb-2 block uppercase tracking-wider",children:"Motion Smoothness"}),T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("span",{className:"text-[10px] text-gray-600",children:"CUTS"}),T.jsx("input",{type:"range",min:"0",max:"100",value:n.smoothness,onChange:x=>e("smoothness",Number(x.target.value)),className:"w-full h-1.5 bg-white/10 rounded-full accent-blue-400 cursor-pointer"}),T.jsx("span",{className:"text-[10px] text-gray-600",children:"BLEND"})]}),T.jsx("div",{className:"text-right text-xs text-blue-300 font-mono mt-1",children:n.smoothness<30?"Hard Cuts":n.smoothness>70?"Liquid Flow":"Standard"})]}),T.jsxs("div",{children:[T.jsxs("div",{className:"flex justify-between items-center mb-2",children:[T.jsxs("label",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider flex items-center gap-2",children:[T.jsx(hx,{size:12})," Stutter Rhythm"]}),T.jsxs("div",{className:"relative",children:[T.jsx("select",{value:n.stutterPreset||"auto",onChange:x=>e("stutterPreset",x.target.value),className:"bg-black/40 border border-white/10 text-[10px] text-white rounded px-2 py-1 appearance-none focus:border-red-400 outline-none pr-6 cursor-pointer",children:H.map(x=>T.jsx("option",{value:x.id,children:x.label},x.id))}),T.jsx(Yp,{size:10,className:"absolute right-1 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"})]})]}),T.jsx("input",{type:"range",min:"0",max:"100",value:n.stutter,onChange:x=>e("stutter",Number(x.target.value)),className:"w-full h-1.5 bg-white/10 rounded-full accent-red-400 cursor-pointer"}),T.jsxs("div",{className:"flex justify-between mt-1 text-[10px] font-mono",children:[T.jsx("span",{className:"text-gray-600",children:"RARE"}),T.jsxs("span",{className:"text-red-300",children:[n.stutter,"% Density"]}),T.jsx("span",{className:"text-gray-600",children:"FREQUENT"})]}),T.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Controls the interval between stutters. Higher = more frequent glitches."})]})]})]})]})})})]})]})},rb=`
    attribute vec2 a_position;
    void main() {
        gl_Position = vec4(a_position, 0.0, 1.0);
    }
`,ob=`
    precision highp float;
    
    uniform vec2 u_resolution;
    uniform float u_time;
    uniform vec2 u_mouse;
    
    // Params
    uniform float u_geometryType;
    uniform float u_density;
    uniform float u_speed;
    uniform vec3 u_color;
    uniform float u_intensity;
    uniform float u_chaos;
    uniform float u_morph;
    uniform float u_cameraZ; // NEW: Controls dolly zoom
    
    // Audio
    uniform float u_audioBass;
    uniform float u_audioMid;
    uniform float u_audioHigh;
    
    #define MAX_STEPS 80
    #define MAX_DIST 15.0
    #define SURF_DIST 0.001

    // --- MATH UTILS ---
    mat2 rot(float a) {
        float s = sin(a);
        float c = cos(a);
        return mat2(c, -s, s, c);
    }
    
    // Pseudo-random hash for sparkles
    float hash(vec3 p) {
        p  = fract( p*0.3183099+.1 );
        p *= 17.0;
        return fract( p.x*p.y*p.z*(p.x+p.y+p.z) );
    }

    // --- KIFS (Kaleidoscopic IFS) FRACTAL ---
    float sdQuantumFractal(vec3 p) {
        float s = 1.0;
        
        // REACTIVITY: Bass affects scale (Pulse), Mids affect structure (Breathing)
        float scale = 1.5 + (u_audioBass * 0.2) + (u_audioMid * 0.05); 
        
        // REACTIVITY: Mids shift the fractal offset, changing internal geometry
        vec3 offset = vec3(1.0, 1.0, 1.0) * (0.8 + u_morph + (u_audioMid * 0.15));
        
        // Interaction Rotation (4D Spin)
        // REACTIVITY: Highs add jitter/vibration to rotation
        float jitter = u_audioHigh * 0.1;
        p.xz *= rot(u_time * 0.1 + u_mouse.x * 2.0 + jitter);
        p.yz *= rot(u_mouse.y * 2.0 - jitter);

        // Fold Iterations
        for(int i=0; i<5; i++) {
            p = abs(p); // Fold space
            if(p.x < p.y) p.xy = p.yx;
            if(p.x < p.z) p.xz = p.zx;
            if(p.y < p.z) p.yz = p.zy;
            
            // Tetrahedral Symmetry
            p.z -= offset.z * 0.5;
            p.z = -abs(p.z);
            p.z += offset.z * 0.5;
            
            p = p * scale - offset * (scale - 1.0);
            s *= scale;
            
            // Add chaos twist on deeper levels
            // REACTIVITY: Chaos increases with energy
            if (i > 2) {
                p.xy *= rot(u_chaos + (u_audioHigh * 0.3));
            }
        }
        
        // Distance to fractal surface
        return length(p) / s;
    }

    // --- SCENE MAP ---
    float GetDist(vec3 p) {
        // REACTIVITY: Bass warps the domain significantly (Shockwave)
        float warp = sin(p.y * 4.0 + u_time * 2.0) * (u_audioBass * 0.15);
        p.z += warp;
        p.x += sin(p.z * 3.0) * (u_audioBass * 0.08);
        
        float d = sdQuantumFractal(p);
        return d;
    }

    // --- RAYMARCHER ---
    float RayMarch(vec3 ro, vec3 rd) {
        float dO = 0.0;
        
        for(int i=0; i<MAX_STEPS; i++) {
            vec3 p = ro + rd*dO;
            float dS = GetDist(p);
            
            // Volumetric Density Accumulation logic
            // If we are close to geometry, we slow down ray to accumulate glow
            dO += dS * 0.7; // Lower step size = denser fog
            
            if(dO>MAX_DIST || abs(dS)<SURF_DIST) break;
        }
        return dO;
    }

    void main() {
        vec2 uv = (gl_FragCoord.xy - 0.5 * u_resolution.xy) / u_resolution.y;
        
        // CAMERA LOGIC with Dolly Zoom support
        float baseZ = -2.8;
        vec3 ro = vec3(0.0, 0.0, baseZ + u_cameraZ); 
        vec3 rd = normalize(vec3(uv, 1.0));

        // Raymarch
        float d = RayMarch(ro, rd);
        
        vec3 col = vec3(0.0);
        
        // QUANTUM COLORING
        if(d < MAX_DIST) {
            vec3 p = ro + rd * d;
            
            // Facet Normals (Approx)
            vec2 e = vec2(0.01, 0.0);
            vec3 n = normalize(vec3(
                GetDist(p+e.xyy)-GetDist(p-e.xyy),
                GetDist(p+e.yxy)-GetDist(p-e.yxy),
                GetDist(p+e.yyx)-GetDist(p-e.yyx)
            ));
            
            // Iridescence based on normal and view angle
            float fresnel = pow(1.0 - max(dot(n, -rd), 0.0), 3.0);
            
            // REACTIVITY: Highs shift the base color (Spectral Shimmer)
            vec3 tint = u_color + (vec3(u_audioHigh) * 0.4);
            col = tint + (n * 0.1); 
            
            // Add Highlight (Gold/White)
            // REACTIVITY: Bass boosts specular highlights massively
            float shine = 2.0 + (u_audioBass * 6.0);
            col += vec3(1.0, 0.95, 0.8) * fresnel * shine;
            
            // Facet Edges
            // REACTIVITY: Mids make edges sharper/brighter
            float edgeWidth = 0.05 + (u_audioMid * 0.08);
            float edge = smoothstep(edgeWidth, 0.0, GetDist(p + n*0.02));
            col += vec3(0.0, 1.0, 1.0) * edge * (1.0 + u_audioHigh * 2.0);
            
            // Chromatic Aberration at edges based on Highs
            col.r += u_audioHigh * 0.2 * fresnel;
            col.b -= u_audioHigh * 0.2 * fresnel;
        }
        
        // QUANTUM FOAM (Volumetric Glow)
        float glow = 0.0;
        
        // Sample SDF at intervals
        float s = 0.0;
        for(int i=0; i<5; i++) {
            vec3 p = ro + rd * (s + 0.5);
            float dist = GetDist(p);
            float fog = 1.0 / (1.0 + abs(dist) * 20.0);
            
            // SPARKLES: High frequencies create energetic points in the fog
            float sparkleNoise = hash(p * 20.0 + u_time * 2.0);
            float sparkle = step(0.95, sparkleNoise) * u_audioHigh * 3.0;
            
            glow += fog + sparkle;
            s += 0.5;
        }
        
        // REACTIVITY: Inverse Density (Structure Reveal)
        // Music clears the thick fog, but energizes the remaining light
        float audioClear = u_audioMid * 1.5;
        float finalDensity = max(0.2, u_density - audioClear);
        
        glow *= finalDensity; 
        
        // REACTIVITY: Bass drives the global intensity of the glow
        col += u_color * glow * u_intensity * (0.6 + u_audioBass * 0.8);

        // Audio Flash (Global brightness kick on bass)
        col += u_color * u_audioBass * 0.15;

        // Final Tone Mapping
        col = pow(col, vec3(0.4545)); // Gamma correction
        
        // Vignette
        col *= 1.0 - length(uv) * 0.5;

        gl_FragColor = vec4(col, 1.0);
    }
`;class um{constructor(e){this.program=null,this.uniforms={},this.mouse={x:0,y:0},this.targetMouse={x:0,y:0},this.params={geometryType:0,density:2,speed:.1,chaos:.5,morph:0,hue:200,saturation:.8,intensity:.6,gridOpacity:0},this.audioData={bass:0,mid:0,high:0,energy:0},this.canvas=e;const t=this.canvas.getContext("webgl",{preserveDrawingBuffer:!0,alpha:!1,antialias:!0});if(t)this.gl=t;else{const i=this.canvas.getContext("experimental-webgl");if(!i)throw new Error("WebGL not supported");this.gl=i}this.startTime=Date.now(),this.initShaders(),this.initBuffers(),this.initInteraction(),this.resize()}initInteraction(){const e=(t,i)=>{this.targetMouse.x=t/window.innerWidth*2-1,this.targetMouse.y=-(i/window.innerHeight)*2+1};window.addEventListener("mousemove",t=>e(t.clientX,t.clientY)),window.addEventListener("touchmove",t=>{t.touches[0]&&e(t.touches[0].clientX,t.touches[0].clientY)})}resize(){if(this.canvas.clientWidth===0||this.canvas.clientHeight===0){this.gl.viewport(0,0,this.canvas.width,this.canvas.height);return}const e=Math.min(window.devicePixelRatio||1,1.5),t=Math.floor(this.canvas.clientWidth*e),i=Math.floor(this.canvas.clientHeight*e);(this.canvas.width!==t||this.canvas.height!==i)&&(this.canvas.width=t,this.canvas.height=i,this.gl.viewport(0,0,this.canvas.width,this.canvas.height))}updateAudio(e){this.audioData=e}initShaders(){this.program=this.createProgram(rb,ob),this.program&&(this.uniforms={resolution:this.gl.getUniformLocation(this.program,"u_resolution"),time:this.gl.getUniformLocation(this.program,"u_time"),mouse:this.gl.getUniformLocation(this.program,"u_mouse"),density:this.gl.getUniformLocation(this.program,"u_density"),speed:this.gl.getUniformLocation(this.program,"u_speed"),color:this.gl.getUniformLocation(this.program,"u_color"),intensity:this.gl.getUniformLocation(this.program,"u_intensity"),chaos:this.gl.getUniformLocation(this.program,"u_chaos"),morph:this.gl.getUniformLocation(this.program,"u_morph"),cameraZ:this.gl.getUniformLocation(this.program,"u_cameraZ"),audioBass:this.gl.getUniformLocation(this.program,"u_audioBass"),audioMid:this.gl.getUniformLocation(this.program,"u_audioMid"),audioHigh:this.gl.getUniformLocation(this.program,"u_audioHigh")})}createProgram(e,t){const i=this.createShader(this.gl.VERTEX_SHADER,e),o=this.createShader(this.gl.FRAGMENT_SHADER,t);if(!i||!o)return null;const a=this.gl.createProgram();return a?(this.gl.attachShader(a,i),this.gl.attachShader(a,o),this.gl.linkProgram(a),a):null}createShader(e,t){const i=this.gl.createShader(e);return i?(this.gl.shaderSource(i,t),this.gl.compileShader(i),this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS)?i:(console.error("Shader Compile Error:",this.gl.getShaderInfoLog(i)),this.gl.deleteShader(i),null)):null}initBuffers(){if(!this.program)return;const e=new Float32Array([-1,-1,1,-1,-1,1,1,1]),t=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW);const i=this.gl.getAttribLocation(this.program,"a_position");this.gl.enableVertexAttribArray(i),this.gl.vertexAttribPointer(i,2,this.gl.FLOAT,!1,0,0)}render(e=0){if(!this.program)return;this.resize(),this.gl.useProgram(this.program);const t=(Date.now()-this.startTime)/1e3;this.mouse.x+=(this.targetMouse.x-this.mouse.x)*.1,this.mouse.y+=(this.targetMouse.y-this.mouse.y)*.1;const i=(this.params.hue||0)/360,o=this.params.saturation||.8,a=.6,u=a+o-a*o,d=2*a-u,f=(S,C,k)=>(k<0&&(k+=1),k>1&&(k-=1),k<1/6?S+(C-S)*6*k:k<1/2?C:k<2/3?S+(C-S)*(2/3-k)*6:S),p=f(d,u,i+1/3),_=f(d,u,i),E=f(d,u,i-1/3);this.gl.uniform2f(this.uniforms.resolution,this.canvas.width,this.canvas.height),this.gl.uniform1f(this.uniforms.time,t),this.gl.uniform2f(this.uniforms.mouse,this.mouse.x,this.mouse.y),this.gl.uniform1f(this.uniforms.density,this.params.density||2),this.gl.uniform1f(this.uniforms.speed,this.params.speed||.1),this.gl.uniform3f(this.uniforms.color,p,_,E),this.gl.uniform1f(this.uniforms.intensity,this.params.intensity||.5),this.gl.uniform1f(this.uniforms.chaos,this.params.chaos||0),this.gl.uniform1f(this.uniforms.morph,this.params.morph||0),this.gl.uniform1f(this.uniforms.cameraZ,e),this.gl.uniform1f(this.uniforms.audioBass,this.audioData.bass),this.gl.uniform1f(this.uniforms.audioMid,this.audioData.mid),this.gl.uniform1f(this.uniforms.audioHigh,this.audioData.high),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}function PI(n){const e=n.slice(2,7).reduce((o,a)=>o+a,0)/5/255,t=n.slice(40,90).reduce((o,a)=>o+a,0)/50/255,i=n.slice(200,Math.min(400,n.length)).reduce((o,a)=>o+a,0)/200/255;return{bass:e,mid:t,high:i}}function DI(n,e,t,i,o,a,u){const d=20+o*40,f=.02+o*.01,p=a*.002;n.beginPath(),n.strokeStyle=u,n.lineWidth=2+o*6;const _=-t/2,E=200,S=t/E;for(let C=0;C<=E;C++){const k=_+C*S,V=C/E,z=Math.sin(k*f+p)*d,J=Math.sin(k*f*2.3+p*1.5)*d*.5,j=Math.sin(k*f*.7+p*.8)*d*.3,Z=Math.sin(a*.01+V*Math.PI*2)*o*15,H=i+z+J+j+Z;C===0?n.moveTo(k,H):n.lineTo(k,H)}n.stroke()}function kI(n,e,t,i,o){n.save(),n.translate(e/2,t/2),n.rotate(-Math.PI/4);const a=Math.max(e,t)*1.5,u=[{color:"rgba(255, 50, 50, 0.4)",audio:i.bass,baseOffset:-25},{color:"rgba(50, 255, 50, 0.4)",audio:i.mid,baseOffset:0},{color:"rgba(50, 50, 255, 0.4)",audio:i.high,baseOffset:25}];n.globalCompositeOperation="screen",u.forEach(p=>{const _=p.baseOffset+p.audio*15*Math.sign(p.baseOffset||1),E=.3+p.audio*.5;n.globalAlpha=E;for(let S=-2;S<=2;S++)DI(n,"jusDNCE",a,_+S*8,p.audio,o+S*100,p.color)}),n.globalCompositeOperation="source-over",n.globalAlpha=.15+(i.bass+i.mid+i.high)/3*.2;const d=Math.min(e,t)*.12;n.font=`bold ${d}px 'Rajdhani', sans-serif`,n.textAlign="center",n.textBaseline="middle",n.shadowColor="rgba(255, 255, 255, 0.8)",n.shadowBlur=10+i.bass*20;const f=2+i.high*5;n.fillStyle="rgba(255, 50, 50, 0.5)",n.fillText("jusDNCE",-f,-f),n.fillStyle="rgba(50, 255, 50, 0.5)",n.fillText("jusDNCE",0,0),n.fillStyle="rgba(50, 50, 255, 0.5)",n.fillText("jusDNCE",f,f),n.fillStyle="rgba(255, 255, 255, 0.6)",n.shadowBlur=5,n.fillText("jusDNCE",0,0),n.restore()}function UI(){return`
// jusDNCE Audio-Reactive Watermark
function extractAudioBands(freqData) {
  const bass = freqData.slice(2, 7).reduce((a, b) => a + b, 0) / 5 / 255;
  const mid = freqData.slice(40, 90).reduce((a, b) => a + b, 0) / 50 / 255;
  const high = freqData.slice(200, Math.min(400, freqData.length)).reduce((a, b) => a + b, 0) / 200 / 255;
  return { bass, mid, high };
}

function drawWaveformLine(ctx, width, yOffset, audioIntensity, time, color) {
  const amplitude = 20 + audioIntensity * 40;
  const frequency = 0.02 + audioIntensity * 0.01;
  const speed = time * 0.002;

  ctx.beginPath();
  ctx.strokeStyle = color;
  ctx.lineWidth = 2 + audioIntensity * 6;

  const startX = -width / 2;
  const steps = 200;
  const stepSize = width / steps;

  for (let i = 0; i <= steps; i++) {
    const x = startX + i * stepSize;
    const progress = i / steps;
    const wave1 = Math.sin(x * frequency + speed) * amplitude;
    const wave2 = Math.sin(x * frequency * 2.3 + speed * 1.5) * amplitude * 0.5;
    const wave3 = Math.sin(x * frequency * 0.7 + speed * 0.8) * amplitude * 0.3;
    const pulse = Math.sin(time * 0.01 + progress * Math.PI * 2) * audioIntensity * 15;
    const y = yOffset + wave1 + wave2 + wave3 + pulse;

    if (i === 0) ctx.moveTo(x, y);
    else ctx.lineTo(x, y);
  }
  ctx.stroke();
}

function drawAudioReactiveWatermark(ctx, width, height, audio, time) {
  ctx.save();
  ctx.translate(width / 2, height / 2);
  ctx.rotate(-Math.PI / 4);

  const waveWidth = Math.max(width, height) * 1.5;
  const channels = [
    { color: 'rgba(255, 50, 50, 0.4)', audio: audio.bass, baseOffset: -25 },
    { color: 'rgba(50, 255, 50, 0.4)', audio: audio.mid, baseOffset: 0 },
    { color: 'rgba(50, 50, 255, 0.4)', audio: audio.high, baseOffset: 25 },
  ];

  ctx.globalCompositeOperation = 'screen';

  channels.forEach((ch) => {
    const offset = ch.baseOffset + ch.audio * 15 * Math.sign(ch.baseOffset || 1);
    ctx.globalAlpha = 0.3 + ch.audio * 0.5;
    for (let line = -2; line <= 2; line++) {
      drawWaveformLine(ctx, waveWidth, offset + line * 8, ch.audio, time + line * 100, ch.color);
    }
  });

  ctx.globalCompositeOperation = 'source-over';
  ctx.globalAlpha = 0.15 + (audio.bass + audio.mid + audio.high) / 3 * 0.2;

  const fontSize = Math.min(width, height) * 0.12;
  ctx.font = 'bold ' + fontSize + 'px Rajdhani, sans-serif';
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';
  ctx.shadowColor = 'rgba(255, 255, 255, 0.8)';
  ctx.shadowBlur = 10 + audio.bass * 20;

  const textOffset = 2 + audio.high * 5;
  ctx.fillStyle = 'rgba(255, 50, 50, 0.5)';
  ctx.fillText('jusDNCE', -textOffset, -textOffset);
  ctx.fillStyle = 'rgba(50, 255, 50, 0.5)';
  ctx.fillText('jusDNCE', 0, 0);
  ctx.fillStyle = 'rgba(50, 50, 255, 0.5)';
  ctx.fillText('jusDNCE', textOffset, textOffset);
  ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
  ctx.shadowBlur = 5;
  ctx.fillText('jusDNCE', 0, 0);

  ctx.restore();
}
`}const LI=(n,e,t,i=!1)=>{const o=UI(),a=JSON.stringify(n),u=JSON.stringify(e);return`
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNCE-R Standalone Widget</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@600&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Courier New', monospace; user-select: none; }
        canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        #bgCanvas { z-index: 1; transition: opacity 0.3s; }
        #charCanvas { z-index: 2; pointer-events: none; }
        #watermarkCanvas { z-index: 3; pointer-events: none; }
        
        /* UI OVERLAY */
        #ui {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 10;
            display: flex; gap: 10px; padding: 10px;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(10px);
            border-radius: 20px; border: 1px solid rgba(255,255,255,0.1);
            transition: opacity 0.3s, transform 0.3s;
        }
        #ui.hidden { opacity: 0; pointer-events: none; transform: translateX(-50%) translateY(20px); }
        
        button {
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
            color: #ccc; padding: 8px 16px; border-radius: 12px;
            cursor: pointer; font-weight: bold; font-size: 12px;
            transition: all 0.2s; display: flex; align-items: center; gap: 6px;
        }
        button:hover { background: rgba(255,255,255,0.25); color: white; transform: scale(1.05); }
        button.active { background: #8b5cf6; border-color: #a78bfa; color: white; box-shadow: 0 0 10px rgba(139,92,246,0.5); }
        button.red { background: rgba(239,68,68,0.2); border-color: rgba(239,68,68,0.5); color: #fca5a5; }
        button.red.active { background: #ef4444; color: white; border-color: #ef4444; box-shadow: 0 0 10px rgba(239,68,68,0.5); }
        
        /* Loading Screen */
        #loader {
            position: absolute; inset: 0; background: #000; z-index: 100;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 0.5s;
        }
        .spinner {
            width: 40px; height: 40px; border: 4px solid #333; border-top-color: #8b5cf6;
            border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 20px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Drag Overlay */
        #dropOverlay {
            position: absolute; inset: 0; z-index: 50; background: rgba(139, 92, 246, 0.8);
            display: none; align-items: center; justify-content: center;
            font-size: 2em; color: white; font-weight: 900; letter-spacing: 2px;
            backdrop-filter: blur(5px);
        }
        .drag-over #dropOverlay { display: flex; }
        
        /* Header/Controls Hover Area */
        #hoverZone {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 100px; z-index: 5;
        }
        #hoverZone:hover + #ui { opacity: 1; transform: translateX(-50%) translateY(0); }
        
        /* Corner Info */
        #info {
            position: absolute; top: 20px; left: 20px; z-index: 5;
            color: rgba(255,255,255,0.3); font-size: 10px; pointer-events: none;
        }

        /* PRE-ROLL SPLASH */
        #preroll {
            position: absolute; inset: 0; z-index: 100;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f23 100%);
        }
        #preroll h1 {
            font-family: 'Rajdhani', sans-serif; font-size: 5em; font-weight: 700;
            background: linear-gradient(135deg, #8b5cf6, #ec4899, #8b5cf6);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            margin: 0 0 10px 0; letter-spacing: 0.1em;
            animation: pulse 2s ease-in-out infinite;
        }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        #preroll p { color: rgba(255,255,255,0.7); margin: 5px 0; font-size: 14px; }
        #preroll .promo {
            color: #10b981; font-weight: bold; font-size: 16px;
            background: rgba(16, 185, 129, 0.1); padding: 8px 16px; border-radius: 8px;
            border: 1px solid rgba(16, 185, 129, 0.3); margin-top: 10px;
        }
        #preroll button {
            margin-top: 30px; padding: 16px 48px; font-size: 18px;
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            border: none; border-radius: 16px; color: white; font-weight: bold;
            cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;
        }
        #preroll button:hover { transform: scale(1.05); box-shadow: 0 10px 40px rgba(139, 92, 246, 0.4); }

        /* CORNER BADGE */
        #badge {
            position: absolute; bottom: 20px; right: 20px; z-index: 20;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(10px);
            padding: 8px 16px; border-radius: 20px; border: 1px solid rgba(139, 92, 246, 0.3);
            color: rgba(255,255,255,0.8); text-decoration: none; font-size: 11px; font-weight: bold;
            transition: all 0.2s; display: flex; align-items: center; gap: 6px;
        }
        #badge:hover { background: rgba(139, 92, 246, 0.2); border-color: #8b5cf6; color: white; }
        #badge svg { width: 14px; height: 14px; fill: currentColor; }

        /* END SCREEN */
        #endscreen {
            position: absolute; inset: 0; z-index: 90;
            display: none; flex-direction: column; align-items: center; justify-content: center;
            background: rgba(0,0,0,0.9); backdrop-filter: blur(20px);
        }
        #endscreen.active { display: flex; }
        #endscreen h2 { font-family: 'Rajdhani', sans-serif; font-size: 2.5em; color: white; margin: 0 0 10px 0; }
        #endscreen p { color: rgba(255,255,255,0.7); margin: 5px 0 25px 0; font-size: 16px; }
        #endscreen a {
            padding: 16px 40px; font-size: 16px;
            background: linear-gradient(135deg, #8b5cf6, #7c3aed);
            border-radius: 14px; color: white; font-weight: bold;
            text-decoration: none; transition: transform 0.2s, box-shadow 0.2s;
        }
        #endscreen a:hover { transform: scale(1.05); box-shadow: 0 10px 40px rgba(139, 92, 246, 0.4); }
    </style>
</head>
<body class="drag-over-target">

    <!-- CANVAS LAYERS -->
    <canvas id="bgCanvas"></canvas>
    <canvas id="charCanvas"></canvas>
    <canvas id="watermarkCanvas"></canvas>

    <!-- PRE-ROLL SPLASH -->
    <div id="preroll">
        <h1>jusDNCE</h1>
        <p>Create your own AI dance animations</p>
        <p class="promo">Sign up now: 5 FREE credits!</p>
        <button onclick="startPlayback()"> Play</button>
    </div>

    <!-- CORNER BADGE (always visible for watermarked exports) -->
    ${i?"":`
    <a id="badge" href="https://jusdnce-ai.web.app?ref=widget" target="_blank">
        <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
        Made with jusDNCE
    </a>
    `}

    <!-- END SCREEN CTA -->
    <div id="endscreen">
        <h2>Like this vibe?</h2>
        <p>Create your own AI dance animation in seconds</p>
        <a href="https://jusdnce-ai.web.app?promo=SHARE5" target="_blank">Get 5 FREE Credits </a>
    </div>

    <!-- OVERLAYS -->
    <div id="loader">
        <div class="spinner"></div>
        <div style="color: #666; font-size: 12px; letter-spacing: 2px;">INITIALIZING DNCE-R RIG...</div>
    </div>

    <div id="dropOverlay">DROP AUDIO FILE HERE</div>

    <div id="info">
        DNCE-R // ${t}<br>
        <span id="fps">0 FPS</span>
    </div>

    <!-- UI -->
    <div id="hoverZone"></div>
    <div id="ui">
        <button id="btnMic"> LIVE</button>
        <button id="btnPlay" style="display:none"> PLAY</button>
        <div style="width: 1px; background: rgba(255,255,255,0.2); margin: 0 5px;"></div>
        <button id="btnCam"> DYNAMIC CAM</button>
        <button id="btnGreen"> TRANSPARENT</button>
        <button id="btnZen">Zen Mode</button>
    </div>

    <script>
        // --- CONFIG ---
        const FRAMES = ${a};
        const PARAMS = ${u};
        const SUBJECT = "${t}";
        const IS_WATERMARKED = ${!i};
        let playbackStarted = false;
        let playbackTime = 0;

        // --- WATERMARK SYSTEM ---
        ${o}
        
        // --- SHADER SOURCE ---
        const VERTEX = \`${rb}\`;
        const FRAGMENT = \`${ob}\`;
        
        // --- 1. QUANTUM VISUALIZER ENGINE ---
        class Visualizer {
            constructor(canvas) {
                this.canvas = canvas;
                this.gl = canvas.getContext('webgl', { alpha: true, preserveDrawingBuffer: true }); // Alpha true for green screen
                if(!this.gl) this.gl = canvas.getContext('experimental-webgl');
                this.startTime = Date.now();
                this.mouse = {x:0, y:0};
                this.init();
            }
            init() {
                const vs = this.createShader(this.gl.VERTEX_SHADER, VERTEX);
                const fs = this.createShader(this.gl.FRAGMENT_SHADER, FRAGMENT);
                this.program = this.gl.createProgram();
                this.gl.attachShader(this.program, vs);
                this.gl.attachShader(this.program, fs);
                this.gl.linkProgram(this.program);
                this.gl.useProgram(this.program);
                
                const buffer = this.gl.createBuffer();
                this.gl.bindBuffer(this.gl.ARRAY_BUFFER, buffer);
                this.gl.bufferData(this.gl.ARRAY_BUFFER, new Float32Array([-1,-1,1,-1,-1,1,1,1]), this.gl.STATIC_DRAW);
                const loc = this.gl.getAttribLocation(this.program, 'a_position');
                this.gl.enableVertexAttribArray(loc);
                this.gl.vertexAttribPointer(loc, 2, this.gl.FLOAT, false, 0, 0);
                
                this.locs = {
                    res: this.gl.getUniformLocation(this.program, 'u_resolution'),
                    time: this.gl.getUniformLocation(this.program, 'u_time'),
                    mouse: this.gl.getUniformLocation(this.program, 'u_mouse'),
                    bass: this.gl.getUniformLocation(this.program, 'u_audioBass'),
                    mid: this.gl.getUniformLocation(this.program, 'u_audioMid'),
                    high: this.gl.getUniformLocation(this.program, 'u_audioHigh'),
                    col: this.gl.getUniformLocation(this.program, 'u_color'),
                    den: this.gl.getUniformLocation(this.program, 'u_density'),
                    spd: this.gl.getUniformLocation(this.program, 'u_speed'),
                    int: this.gl.getUniformLocation(this.program, 'u_intensity'),
                    chs: this.gl.getUniformLocation(this.program, 'u_chaos'),
                    camZ: this.gl.getUniformLocation(this.program, 'u_cameraZ'),
                };
            }
            createShader(type, src) {
                const s = this.gl.createShader(type);
                this.gl.shaderSource(s, src);
                this.gl.compileShader(s);
                return s;
            }
            render(audio, camZ) {
                const w = window.innerWidth;
                const h = window.innerHeight;
                if(this.canvas.width!==w || this.canvas.height!==h) {
                    this.canvas.width=w; this.canvas.height=h;
                    this.gl.viewport(0,0,w,h);
                }
                
                // Color Logic (Simplified HSL to RGB for standalone)
                const hVal = (PARAMS.hue || 200) / 360;
                const sVal = 0.8, lVal = 0.6;
                // Helper
                const hue2rgb = (p, q, t) => {
                    if(t < 0) t += 1; if(t > 1) t -= 1;
                    if(t < 1/6) return p + (q - p) * 6 * t;
                    if(t < 1/2) return q;
                    if(t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                }
                const q = lVal < 0.5 ? lVal * (1 + sVal) : lVal + sVal - lVal * sVal;
                const p = 2 * lVal - q;
                const r = hue2rgb(p, q, hVal + 1/3);
                const g = hue2rgb(p, q, hVal);
                const b = hue2rgb(p, q, hVal - 1/3);

                this.gl.uniform2f(this.locs.res, w, h);
                this.gl.uniform1f(this.locs.time, (Date.now()-this.startTime)/1000);
                this.gl.uniform2f(this.locs.mouse, this.mouse.x, this.mouse.y);
                this.gl.uniform1f(this.locs.bass, audio.bass);
                this.gl.uniform1f(this.locs.mid, audio.mid);
                this.gl.uniform1f(this.locs.high, audio.high);
                
                this.gl.uniform3f(this.locs.col, r, g, b);
                this.gl.uniform1f(this.locs.den, PARAMS.density || 2.0);
                this.gl.uniform1f(this.locs.spd, PARAMS.speed || 0.1);
                this.gl.uniform1f(this.locs.int, PARAMS.intensity || 0.6);
                this.gl.uniform1f(this.locs.chs, PARAMS.chaos || 0.5);
                this.gl.uniform1f(this.locs.camZ, camZ);
                
                this.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 4);
            }
        }

        // --- 2. SETUP ---
        const bgC = document.getElementById('bgCanvas');
        const charC = document.getElementById('charCanvas');
        const wmC = document.getElementById('watermarkCanvas');
        const ctx = charC.getContext('2d');
        const wmCtx = wmC.getContext('2d');
        const loader = document.getElementById('loader');
        const preroll = document.getElementById('preroll');
        const endscreen = document.getElementById('endscreen');

        const viz = new Visualizer(bgC);

        // --- PRE-ROLL & END SCREEN LOGIC ---
        function startPlayback() {
            preroll.style.opacity = 0;
            setTimeout(() => preroll.remove(), 500);
            playbackStarted = true;
            playbackTime = Date.now();
        }

        function showEndScreen() {
            if (!playbackStarted) return;
            endscreen.classList.add('active');
        }

        // Show end screen after 60 seconds
        setTimeout(() => { if (playbackStarted) showEndScreen(); }, 60000);
        
        // Asset Management
        const IMAGES = {};
        const POOL = { low:[], mid:[], high:[] };
        const SHUFFLE_DECKS = { low:[], mid:[], high:[] }; // Shuffle bags to ensure no missing frames

        let readyCount = 0;
        let lastFrameTime = Date.now();
        
        // --- 3. PHYSICS ENGINE ---
        const PHYSICS = {
            camZoom: 1.0,
            camShake: {x:0, y:0},
            camPan: {x:0, y:0},
            camRot: 0,
            dollyZoom: 0,
            tear: 0,
            moire: 0,
            
            // Logic
            targetPose: 'base',
            lastDir: 'left',
            lastBeat: 0,
            lastSnare: 0,
            
            // Toggles
            dynamicCam: true,
            transparent: false
        };

        // --- 4. INIT ---
        function init() {
            // Load Images
            if(FRAMES.length === 0) {
                // Fallback if no frames
                hideLoader();
                return;
            }
            
            FRAMES.forEach(f => {
                const img = new Image();
                img.crossOrigin = "anonymous";
                img.src = f.url;
                img.onload = () => {
                    IMAGES[f.pose] = img;
                    readyCount++;
                    if(readyCount === FRAMES.length) hideLoader();
                };
                img.onerror = () => { // Proceed even if error
                    readyCount++;
                    if(readyCount === FRAMES.length) hideLoader();
                };
                
                if(!POOL[f.energy]) POOL[f.energy] = [];
                POOL[f.energy].push(f.pose);
            });
            
            // Fill gaps
            if(POOL.mid.length===0) POOL.mid = POOL.low;
            if(POOL.high.length===0) POOL.high = POOL.mid;
        }
        
        function hideLoader() {
            loader.style.opacity = 0;
            setTimeout(() => loader.remove(), 500);
            loop();
        }

        // --- 5. AUDIO SYSTEM ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const analyser = audioCtx.createAnalyser();
        analyser.fftSize = 1024;
        let sourceNode = null;
        let micStream = null;
        let audioEl = null;

        function connectSource(node) {
            if(sourceNode) sourceNode.disconnect();
            sourceNode = node;
            sourceNode.connect(analyser);
            if(node instanceof MediaElementAudioSourceNode) {
                analyser.connect(audioCtx.destination);
            } else {
                analyser.disconnect();
            }
        }

        // --- 6. SMART SHUFFLE ---
        function getNextPose(poolKey, dir) {
            let pool = POOL[poolKey];
            
            // Filter by direction if we have specific directional frames
            const dirFrames = pool.filter(p => p.toLowerCase().includes(dir));
            const activePool = (dirFrames.length > 0 && SUBJECT !== 'TEXT') ? dirFrames : pool;

            // Use a unique shuffle deck per pool key + direction combo for maximum variety
            const deckKey = poolKey + '_' + dir;
            if (!SHUFFLE_DECKS[deckKey] || SHUFFLE_DECKS[deckKey].length === 0) {
                 // Refill deck
                 SHUFFLE_DECKS[deckKey] = [...activePool];
                 // Fisher-Yates Shuffle
                 for (let i = SHUFFLE_DECKS[deckKey].length - 1; i > 0; i--) {
                     const j = Math.floor(Math.random() * (i + 1));
                     [SHUFFLE_DECKS[deckKey][i], SHUFFLE_DECKS[deckKey][j]] = [SHUFFLE_DECKS[deckKey][j], SHUFFLE_DECKS[deckKey][i]];
                 }
            }
            
            return SHUFFLE_DECKS[deckKey].pop() || 'base';
        }

        // --- 7. RENDER LOOP ---
        function loop() {
            requestAnimationFrame(loop);
            
            // DELTA TIME (Fixes "Too Fast" on high refresh rate monitors)
            const now = Date.now();
            const dt = (now - lastFrameTime) / 1000;
            lastFrameTime = now;
            
            const w = window.innerWidth;
            const h = window.innerHeight;
            
            // 1. Audio Analysis
            const freq = new Uint8Array(analyser.frequencyBinCount);
            analyser.getByteFrequencyData(freq);
            
            const bass = freq.slice(0,15).reduce((a,b)=>a+b,0)/15/255;
            const mid = freq.slice(15,100).reduce((a,b)=>a+b,0)/85/255;
            const high = freq.slice(100,300).reduce((a,b)=>a+b,0)/200/255;
            
            
            // 2. Choreography Brain
            // Slightly relaxed BPM detection (500ms debounce instead of 400ms)
            if(bass > 0.6 && now - PHYSICS.lastBeat > 500) {
                PHYSICS.lastBeat = now;
                const isHard = bass > 0.8;
                
                // Select Energy Pool
                let poolKey = 'low';
                if(isHard) poolKey = 'high';
                else if(bass > 0.6) poolKey = 'mid';
                
                // Ping Pong Direction
                let dir = PHYSICS.lastDir === 'left' ? 'right' : 'left';
                if(Math.random() < 0.25) dir = PHYSICS.lastDir; // Stutter
                PHYSICS.lastDir = dir;
                
                // Smart Selection
                PHYSICS.targetPose = getNextPose(poolKey, dir);
                
                // Impact Physics
                if(PHYSICS.dynamicCam) {
                    PHYSICS.camShake = {x: (Math.random()-0.5)*30*bass, y: (Math.random()-0.5)*30*bass};
                    PHYSICS.camZoom = isHard ? 1.15 : 1.05;
                    if(SUBJECT !== 'TEXT') PHYSICS.camRot = (Math.random()-0.5)*10;
                    if(isHard) PHYSICS.tear = 1.0;
                    if(bass > 0.7) PHYSICS.moire = 1.0;
                }
            }
            
            // Snare / Burst
            if(mid > 0.75 && now - PHYSICS.lastSnare > 2000 && Math.random() < 0.5) {
                PHYSICS.lastSnare = now;
                PHYSICS.dollyZoom = 1.0; // Trigger Vertigo
            }
            
            // 3. Physics Decay (Time-Based)
            // Use time-independent damping: value = lerp(value, target, 1 - exp(-speed * dt))
            const decayStrong = 1 - Math.exp(-8 * dt);  // Fast decay
            const decaySlow = 1 - Math.exp(-2 * dt);    // Slow decay
            const decayMedium = 1 - Math.exp(-5 * dt);
            
            PHYSICS.camZoom += (1.0 - PHYSICS.camZoom) * decayMedium;
            PHYSICS.camShake.x *= Math.exp(-10 * dt); 
            PHYSICS.camShake.y *= Math.exp(-10 * dt);
            PHYSICS.camRot *= Math.exp(-6 * dt);
            PHYSICS.tear *= Math.exp(-8 * dt);
            PHYSICS.moire *= Math.exp(-3 * dt);
            PHYSICS.dollyZoom *= Math.exp(-3 * dt);
            
            // 4. Render Background
            if(!PHYSICS.transparent) {
                // Dolly Zoom: If BG moves back (neg), Char scales up
                const dollyOffset = -(PHYSICS.dollyZoom * 1.5);
                viz.render({bass,mid,high}, dollyOffset);
                bgC.style.opacity = 1;
            } else {
                // Clear WebGL if transparent mode
                const gl = viz.gl;
                gl.clearColor(0,0,0,0);
                gl.clear(gl.COLOR_BUFFER_BIT);
                bgC.style.opacity = 0;
            }
            
            // 5. Render Character
            if(charC.width !== w || charC.height !== h) { charC.width=w; charC.height=h; }
            const img = IMAGES[PHYSICS.targetPose] || IMAGES['base'];
            
            if(img) {
                // Dolly Logic
                const dollyScale = 1.0 + (PHYSICS.dollyZoom * 0.2);
                const totalZoom = PHYSICS.camZoom * dollyScale;
                
                const cx = w/2 + PHYSICS.camShake.x + PHYSICS.camPan.x;
                const cy = h/2 + PHYSICS.camShake.y + PHYSICS.camPan.y;
                
                // Aspect Fit
                const aspect = img.width / img.height;
                let dw = w * 0.9;
                let dh = dw / aspect;
                if(dh > h*0.9) { dh = h*0.9; dw = dh*aspect; }
                
                // --- 3-PASS RGB DRAW (Ported from Step4Preview) ---
                const drawChannel = (color, ox, oy, rot, scl) => {
                    ctx.save();
                    ctx.translate(cx, cy);
                    ctx.rotate(((PHYSICS.camRot + rot) * Math.PI) / 180);
                    ctx.scale(totalZoom + scl, totalZoom + scl);
                    
                    if(color !== 'norm') {
                         ctx.globalCompositeOperation = 'screen';
                         ctx.globalAlpha = 0.8 * PHYSICS.moire;
                         ctx.fillStyle = color==='red'?'#f00':'#00f';
                    }
                    
                    // Tearing
                    if(PHYSICS.tear > 0.05) {
                        const slices = 10;
                        const slH = dh/slices;
                        const imH = img.height/slices;
                        for(let i=0; i<slices; i++) {
                            const shift = (Math.random()-0.5)*50*PHYSICS.tear;
                            ctx.drawImage(img, 0, i*imH, img.width, imH, -dw/2+ox+shift, -dh/2+(i*slH)+oy, dw, slH);
                        }
                    } else {
                        ctx.drawImage(img, -dw/2+ox, -dh/2+oy, dw, dh);
                    }
                    ctx.restore();
                };
                
                ctx.clearRect(0,0,w,h);
                
                if(PHYSICS.moire > 0.05) {
                    drawChannel('red', -4*PHYSICS.moire, 0, -1*PHYSICS.moire, 0.02*PHYSICS.moire);
                    drawChannel('blue', 4*PHYSICS.moire, 0, 1*PHYSICS.moire, -0.02*PHYSICS.moire);
                    drawChannel('norm', 0, 0, 0, 0);
                    
                    // Scanlines
                    ctx.save();
                    ctx.globalCompositeOperation = 'multiply';
                    ctx.fillStyle = 'rgba(0,0,0,0.5)';
                    for(let i=0; i<h; i+=4) ctx.fillRect(0,i,w,1);
                    ctx.restore();
                } else {
                    drawChannel('norm', 0, 0, 0, 0);
                }
            }

            // 6. Render Watermark (if not subscriber)
            if (IS_WATERMARKED && playbackStarted) {
                if(wmC.width !== w || wmC.height !== h) { wmC.width=w; wmC.height=h; }
                wmCtx.clearRect(0, 0, w, h);
                const audio = { bass, mid, high };
                drawAudioReactiveWatermark(wmCtx, w, h, audio, Date.now() - playbackTime);
            }

            // Stats
            document.getElementById('fps').innerText = Math.round(1/dt) + ' FPS';
        }

        init();

        // --- UI BINDINGS ---
        const btnMic = document.getElementById('btnMic');
        const btnPlay = document.getElementById('btnPlay');
        const btnCam = document.getElementById('btnCam');
        const btnGreen = document.getElementById('btnGreen');
        const btnZen = document.getElementById('btnZen');
        const ui = document.getElementById('ui');

        btnMic.onclick = async () => {
            audioCtx.resume();
            if(micStream) {
                micStream.getTracks().forEach(t=>t.stop()); micStream=null;
                btnMic.classList.remove('red', 'active');
                btnMic.innerText = ' LIVE';
            } else {
                micStream = await navigator.mediaDevices.getUserMedia({audio:true});
                connectSource(audioCtx.createMediaStreamSource(micStream));
                btnMic.classList.add('red', 'active');
                btnMic.innerText = ' ON AIR';
            }
        };
        
        btnCam.classList.add('active');
        btnCam.onclick = () => {
            PHYSICS.dynamicCam = !PHYSICS.dynamicCam;
            btnCam.classList.toggle('active');
        };
        
        btnGreen.onclick = () => {
            PHYSICS.transparent = !PHYSICS.transparent;
            btnGreen.classList.toggle('active');
            if(PHYSICS.transparent) {
                document.body.style.background = 'transparent'; // For OBS
            } else {
                document.body.style.background = '#000';
            }
        };
        
        btnZen.onclick = () => {
            ui.classList.add('hidden');
        };
        
        // Drag Drop
        window.addEventListener('dragover', e => { e.preventDefault(); document.body.classList.add('drag-over'); });
        window.addEventListener('dragleave', e => { e.preventDefault(); document.body.classList.remove('drag-over'); });
        window.addEventListener('drop', e => {
            e.preventDefault(); document.body.classList.remove('drag-over');
            const file = e.dataTransfer.files[0];
            if(file && file.type.startsWith('audio')) {
                const url = URL.createObjectURL(file);
                if(audioEl) audioEl.pause();
                audioEl = new Audio(url);
                audioEl.loop = true;
                audioCtx.resume();
                audioEl.play();
                connectSource(audioCtx.createMediaElementSource(audioEl));
                btnPlay.style.display = 'flex';
                btnPlay.classList.add('active');
            }
        });
        
        btnPlay.onclick = () => {
            if(audioEl.paused) { audioEl.play(); btnPlay.classList.add('active'); }
            else { audioEl.pause(); btnPlay.classList.remove('active'); }
        };

    <\/script>
</body>
</html>
    `};var Xo=(n=>(n.ZOOM_IN="zoom_in",n.ZOOM_OUT="zoom_out",n.PAN_LEFT="pan_left",n.PAN_RIGHT="pan_right",n.SWEEP_CIRCULAR="sweep_circular",n.DOLLY_ZOOM="dolly_zoom",n.SHAKE_BURST="shake_burst",n.TILT_HEADBANG="tilt_headbang",n.SPIN_CARD="spin_card",n.ZOOM_PUNCH="zoom_punch",n))(Xo||{}),Id=(n=>(n.REST="rest",n.BUILD="build",n.IMPACT="impact",n))(Id||{});class VI{constructor(){this.state={currentSequence:null,sequenceStartTime:0,activeKeyframe:this.createNeutralKeyframe(),interpolatedState:this.createNeutralKeyframe(),queuedSequences:[]},this.sequences=new Map,this.beatTiming={currentBeat:0,beatsPerSecond:2,lastBeatTime:0},this.initializeDefaultSequences()}createNeutralKeyframe(){return{time:0,zoom:1,panX:0,panY:0,shakeX:0,shakeY:0,rotation:0,tiltX:0,tiltY:0,dollyZoom:0,easeType:"linear"}}initializeDefaultSequences(){this.addSequence({id:"rest_zoom_breathe",type:"zoom_in",energyMode:"rest",duration:8,keyframes:[{time:0,zoom:1,panX:0,panY:0,shakeX:0,shakeY:0,rotation:0,tiltX:0,tiltY:0,dollyZoom:0,easeType:"ease-in-out"},{time:.5,zoom:1.1,panX:0,panY:0,shakeX:0,shakeY:0,rotation:0,tiltX:0,tiltY:0,dollyZoom:.1,easeType:"ease-in-out"},{time:1,zoom:1,panX:0,panY:0,shakeX:0,shakeY:0,rotation:0,tiltX:0,tiltY:0,dollyZoom:0,easeType:"ease-in-out"}],triggerConditions:{energyThreshold:.2},priority:1}),this.addSequence({id:"rest_gentle_sweep",type:"sweep_circular",energyMode:"rest",duration:6,keyframes:[{time:0,zoom:1,panX:0,panY:0,shakeX:0,shakeY:0,rotation:0,tiltX:0,tiltY:0,dollyZoom:0,easeType:"ease-in-out"},{time:.33,zoom:1.05,panX:30,panY:0,shakeX:0,shakeY:0,rotation:2,tiltX:0,tiltY:5,dollyZoom:.05,easeType:"ease-in-out"},{time:.66,zoom:1.05,panX:0,panY:20,shakeX:0,shakeY:0,rotation:-2,tiltX:5,tiltY:0,dollyZoom:.05,easeType:"ease-in-out"},{time:1,zoom:1,panX:0,panY:0,shakeX:0,shakeY:0,rotation:0,tiltX:0,tiltY:0,dollyZoom:0,easeType:"ease-in-out"}],triggerConditions:{energyThreshold:.3},priority:2}),this.addSequence({id:"build_zoom_intensify",type:"zoom_in",energyMode:"build",duration:4,keyframes:[{time:0,zoom:1,panX:0,panY:0,shakeX:0,shakeY:0,rotation:0,tiltX:0,tiltY:0,dollyZoom:0,easeType:"ease-in"},{time:.25,zoom:1.1,panX:0,panY:0,shakeX:2,shakeY:2,rotation:1,tiltX:5,tiltY:0,dollyZoom:.1,easeType:"ease-in"},{time:.75,zoom:1.3,panX:0,panY:0,shakeX:8,shakeY:8,rotation:3,tiltX:15,tiltY:5,dollyZoom:.3,easeType:"ease-out"},{time:1,zoom:1.4,panX:0,panY:0,shakeX:12,shakeY:12,rotation:5,tiltX:20,tiltY:10,dollyZoom:.4,easeType:"ease-out"}],triggerConditions:{energyThreshold:.6,onBeat:!0},priority:5}),this.addSequence({id:"build_dramatic_pan",type:"pan_left",energyMode:"build",duration:2,keyframes:[{time:0,zoom:1,panX:0,panY:0,shakeX:0,shakeY:0,rotation:0,tiltX:0,tiltY:0,dollyZoom:0,easeType:"ease-in"},{time:.5,zoom:1.15,panX:-60,panY:10,shakeX:5,shakeY:5,rotation:-8,tiltX:10,tiltY:-15,dollyZoom:.2,easeType:"ease-in-out"},{time:1,zoom:1.1,panX:-40,panY:0,shakeX:3,shakeY:3,rotation:-5,tiltX:8,tiltY:-10,dollyZoom:.1,easeType:"ease-out"}],triggerConditions:{energyThreshold:.7,onSnare:!0},priority:6}),this.addSequence({id:"impact_zoom_punch",type:"zoom_punch",energyMode:"impact",duration:1,keyframes:[{time:0,zoom:1,panX:0,panY:0,shakeX:0,shakeY:0,rotation:0,tiltX:0,tiltY:0,dollyZoom:0,easeType:"ease-out"},{time:.3,zoom:1.8,panX:0,panY:0,shakeX:25,shakeY:25,rotation:8,tiltX:30,tiltY:15,dollyZoom:.5,easeType:"bounce"},{time:1,zoom:1.2,panX:0,panY:0,shakeX:10,shakeY:10,rotation:3,tiltX:15,tiltY:8,dollyZoom:.2,easeType:"ease-out"}],triggerConditions:{onBeat:!0,energyThreshold:.8},priority:10}),this.addSequence({id:"impact_whip_pan",type:"pan_right",energyMode:"impact",duration:.5,keyframes:[{time:0,zoom:1,panX:0,panY:0,shakeX:0,shakeY:0,rotation:0,tiltX:0,tiltY:0,dollyZoom:0,easeType:"ease-in"},{time:.6,zoom:1.3,panX:120,panY:30,shakeX:40,shakeY:20,rotation:15,tiltX:25,tiltY:30,dollyZoom:.3,easeType:"ease-out"},{time:1,zoom:1.1,panX:80,panY:10,shakeX:15,shakeY:10,rotation:8,tiltX:12,tiltY:15,dollyZoom:.1,easeType:"bounce"}],triggerConditions:{onStutter:!0,energyThreshold:.9},priority:12}),this.addSequence({id:"impact_card_spin",type:"spin_card",energyMode:"impact",duration:1,keyframes:[{time:0,zoom:1,panX:0,panY:0,shakeX:0,shakeY:0,rotation:0,tiltX:0,tiltY:0,dollyZoom:0,easeType:"ease-in"},{time:.4,zoom:1.4,panX:0,panY:0,shakeX:20,shakeY:20,rotation:180,tiltX:45,tiltY:60,dollyZoom:.4,easeType:"ease-in-out"},{time:1,zoom:1.1,panX:0,panY:0,shakeX:8,shakeY:8,rotation:360,tiltX:15,tiltY:20,dollyZoom:.1,easeType:"bounce"}],triggerConditions:{onSnare:!0,energyThreshold:.85,beatPattern:["C"]},priority:11})}addSequence(e){this.sequences.set(e.id,e)}updateBeatTiming(e,t){this.beatTiming.currentBeat=e,this.beatTiming.beatsPerSecond=t/60,this.beatTiming.lastBeatTime=performance.now()}tryTriggerSequence(e){if(this.state.currentSequence&&this.state.currentSequence.priority>=8){const o=(performance.now()-this.state.sequenceStartTime)/1e3,a=this.state.currentSequence.duration/this.beatTiming.beatsPerSecond;if(o<a*.5)return!1}let t=null,i=0;for(const o of this.sequences.values()){let a=0;const u=o.triggerConditions;if(u.energyThreshold)if(e.energy>=u.energyThreshold)a+=5,o.energyMode==="rest"&&e.energy<=.4&&(a+=3),o.energyMode==="build"&&e.energy>=.4&&e.energy<=.8&&(a+=3),o.energyMode==="impact"&&e.energy>=.7&&(a+=3);else continue;u.onBeat&&e.onBeat&&(a+=4),u.onSnare&&e.onSnare&&(a+=6),u.onStutter&&e.onStutter&&(a+=8),u.beatPattern&&e.beatPattern&&u.beatPattern.includes(e.beatPattern)&&(a+=7),a+=o.priority,a>i&&(i=a,t=o)}return t&&i>=8?(this.startSequence(t),!0):!1}startSequence(e){this.state.currentSequence=e,this.state.sequenceStartTime=performance.now(),console.log(` Starting camera sequence: ${e.id} (${e.energyMode})`)}update(){if(!this.state.currentSequence)return this.state.interpolatedState;const e=(performance.now()-this.state.sequenceStartTime)/1e3,t=this.state.currentSequence.duration/this.beatTiming.beatsPerSecond,i=Math.min(e/t,1);if(i>=1)return this.state.currentSequence=null,this.state.interpolatedState=this.createNeutralKeyframe(),this.state.interpolatedState;const o=this.state.currentSequence.keyframes;let a=o[0],u=o[o.length-1];for(let p=0;p<o.length-1;p++)if(i>=o[p].time&&i<=o[p+1].time){a=o[p],u=o[p+1];break}const d=a.time===u.time?0:(i-a.time)/(u.time-a.time),f=this.applyEasing(d,u.easeType||"linear");return this.state.interpolatedState={time:i,zoom:this.lerp(a.zoom,u.zoom,f),panX:this.lerp(a.panX,u.panX,f),panY:this.lerp(a.panY,u.panY,f),shakeX:this.lerp(a.shakeX,u.shakeX,f),shakeY:this.lerp(a.shakeY,u.shakeY,f),rotation:this.lerp(a.rotation,u.rotation,f),tiltX:this.lerp(a.tiltX,u.tiltX,f),tiltY:this.lerp(a.tiltY,u.tiltY,f),dollyZoom:this.lerp(a.dollyZoom,u.dollyZoom,f)},this.state.interpolatedState}applyEasing(e,t){switch(t){case"ease-in":return e*e;case"ease-out":return 1-(1-e)*(1-e);case"ease-in-out":return e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2;case"bounce":return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:7.5625*(e-=2.25/2.75)*e+.9375;default:return e}}lerp(e,t,i){return e+(t-e)*i}getCurrentSequenceInfo(){if(!this.state.currentSequence)return null;const e=(performance.now()-this.state.sequenceStartTime)/1e3,t=this.state.currentSequence.duration/this.beatTiming.beatsPerSecond,i=Math.min(e/t,1);return{id:this.state.currentSequence.id,progress:i,energyMode:this.state.currentSequence.energyMode}}forceStop(){this.state.currentSequence=null,this.state.interpolatedState=this.createNeutralKeyframe()}}const Wo=new VI;class OI{constructor(){this.state={activeEffects:[],ambientLevel:.7,colorTemperature:.6,dynamicRange:.8,strobePhase:0},this.effects=new Map,this.frameContentAnalyzer=new zI,this.beatTiming={beatsPerSecond:2,lastBeatTime:0,currentBeat:0},this.initializeDefaultEffects()}initializeDefaultEffects(){this.addEffect({id:"muzzle_flash",type:"muzzle_flash",duration:.25,keyframes:[{time:0,intensity:0,color:[1,.8,.4],blur:0,position:{x:.3,y:.2},size:0,opacity:0,blendMode:"screen"},{time:.2,intensity:1,color:[1,1,.8],blur:8,position:{x:.3,y:.2},size:.4,opacity:.9,blendMode:"add"},{time:1,intensity:0,color:[.8,.4,.2],blur:2,position:{x:.3,y:.2},size:.1,opacity:0,blendMode:"screen"}],triggerConditions:{frameContent:["gun","weapon","pistol","rifle","action","combat"],onBeat:!0,energyThreshold:.6},priority:15,layered:!0}),this.addEffect({id:"dramatic_spotlight",type:"spotlight",duration:4,keyframes:[{time:0,intensity:0,color:[1,.95,.9],blur:15,position:{x:0,y:-.3},size:0,opacity:0,blendMode:"overlay"},{time:.3,intensity:.8,color:[1,.95,.9],blur:20,position:{x:0,y:-.3},size:.6,opacity:.7,blendMode:"overlay"},{time:1,intensity:.6,color:[1,.9,.8],blur:18,position:{x:0,y:-.3},size:.5,opacity:.5,blendMode:"overlay"}],triggerConditions:{frameContent:["closeup","face","portrait","dramatic"],energyThreshold:.7},priority:8}),this.addEffect({id:"impact_strobe",type:"strobe",duration:1,keyframes:[{time:0,intensity:0,color:[1,1,1],blur:0,position:{x:0,y:0},size:1,opacity:0,blendMode:"screen"},{time:.1,intensity:1,color:[1,1,1],blur:5,position:{x:0,y:0},size:1,opacity:.8,blendMode:"screen"},{time:.2,intensity:0,color:[1,1,1],blur:0,position:{x:0,y:0},size:1,opacity:0,blendMode:"screen"},{time:.3,intensity:1,color:[1,1,1],blur:5,position:{x:0,y:0},size:1,opacity:.6,blendMode:"screen"},{time:.4,intensity:0,color:[1,1,1],blur:0,position:{x:0,y:0},size:1,opacity:0,blendMode:"screen"},{time:1,intensity:0,color:[1,1,1],blur:0,position:{x:0,y:0},size:1,opacity:0,blendMode:"screen"}],triggerConditions:{onBeat:!0,energyThreshold:.8,cameraMotion:[Xo.ZOOM_PUNCH,Xo.SHAKE_BURST]},priority:12,layered:!0}),this.addEffect({id:"dance_color_wash",type:"color_wash",duration:2,keyframes:[{time:0,intensity:.3,color:[.8,.2,.9],blur:25,position:{x:0,y:0},size:1,opacity:0,blendMode:"overlay"},{time:.5,intensity:.7,color:[.2,.8,.9],blur:30,position:{x:0,y:0},size:1,opacity:.4,blendMode:"overlay"},{time:1,intensity:.4,color:[.9,.8,.2],blur:20,position:{x:0,y:0},size:1,opacity:.2,blendMode:"overlay"}],triggerConditions:{frameContent:["dance","movement","energy"],energyThreshold:.6,onSnare:!0},priority:6,layered:!0}),this.addEffect({id:"camera_sweep_light",type:"sweep_light",duration:2,keyframes:[{time:0,intensity:.6,color:[1,.9,.8],blur:15,position:{x:-.5,y:0},size:.3,opacity:.3,blendMode:"overlay"},{time:.5,intensity:.8,color:[1,.95,.9],blur:18,position:{x:0,y:0},size:.4,opacity:.5,blendMode:"overlay"},{time:1,intensity:.6,color:[1,.9,.8],blur:15,position:{x:.5,y:0},size:.3,opacity:.3,blendMode:"overlay"}],triggerConditions:{cameraMotion:[Xo.PAN_LEFT,Xo.PAN_RIGHT,Xo.SWEEP_CIRCULAR]},priority:7,layered:!0}),this.addEffect({id:"dramatic_blackout",type:"fade_to_black",duration:1,keyframes:[{time:0,intensity:0,color:[0,0,0],blur:0,position:{x:0,y:0},size:1,opacity:0,blendMode:"multiply"},{time:.3,intensity:1,color:[0,0,0],blur:0,position:{x:0,y:0},size:1,opacity:.8,blendMode:"multiply"},{time:1,intensity:0,color:[0,0,0],blur:0,position:{x:0,y:0},size:1,opacity:0,blendMode:"multiply"}],triggerConditions:{energyThreshold:.9,beatPattern:["C"],cameraMotion:[Xo.DOLLY_ZOOM]},priority:10}),this.addEffect({id:"neon_tech_pulse",type:"neon_pulse",duration:4,keyframes:[{time:0,intensity:.4,color:[0,1,1],blur:10,position:{x:0,y:0},size:.8,opacity:.2,blendMode:"screen"},{time:.25,intensity:.8,color:[.2,1,.8],blur:15,position:{x:0,y:0},size:.9,opacity:.4,blendMode:"screen"},{time:.5,intensity:.6,color:[.8,.2,1],blur:12,position:{x:0,y:0},size:.85,opacity:.3,blendMode:"screen"},{time:.75,intensity:.9,color:[1,.2,.8],blur:18,position:{x:0,y:0},size:.95,opacity:.5,blendMode:"screen"},{time:1,intensity:.4,color:[0,1,1],blur:10,position:{x:0,y:0},size:.8,opacity:.2,blendMode:"screen"}],triggerConditions:{frameContent:["cyber","neon","tech","futuristic"],energyThreshold:.5},priority:5,layered:!0})}addEffect(e){this.effects.set(e.id,e)}updateBeatTiming(e,t){this.beatTiming.currentBeat=e,this.beatTiming.beatsPerSecond=t/60,this.beatTiming.lastBeatTime=performance.now()}analyzeAndTrigger(e){let t=!1,i=[];e.frameUrl&&(i=this.frameContentAnalyzer.analyzeFrame(e.frameUrl,e.stylePreset));const o=[];for(const a of this.effects.values()){let u=0;const d=a.triggerConditions;if(d.frameContent&&i.length>0){const f=d.frameContent.filter(p=>i.some(_=>_.includes(p)));if(f.length>0)u+=f.length*8;else if(d.frameContent.length>0)continue}if(d.cameraMotion&&e.cameraMotion&&d.cameraMotion.includes(e.cameraMotion)&&(u+=6),d.energyThreshold)if(e.energy>=d.energyThreshold)u+=4;else continue;d.onBeat&&e.onBeat&&(u+=5),d.onSnare&&e.onSnare&&(u+=7),d.onStutter&&e.onStutter&&(u+=6),d.beatPattern&&e.beatPattern&&d.beatPattern.includes(e.beatPattern)&&(u+=5),u+=a.priority/2,u>=8&&o.push({effect:a,score:u})}o.sort((a,u)=>u.score-a.score);for(const a of o.slice(0,3))this.canStartEffect(a.effect)&&(this.startEffect(a.effect),t=!0);return t}canStartEffect(e){const t=this.state.activeEffects.length;if(!e.layered&&t>0||t>=4)return!1;for(const i of this.state.activeEffects)if(i.type===e.type&&!e.layered)return!1;return!0}startEffect(e){const t={...e,startTime:performance.now()};this.state.activeEffects.push(t),console.log(` Starting lighting effect: ${e.id} (${e.type})`)}update(){const e=performance.now(),t={time:0,intensity:this.state.ambientLevel,color:[1,1,1],blur:0,position:{x:0,y:0},size:1,opacity:this.state.ambientLevel,blendMode:"normal"};return this.state.activeEffects=this.state.activeEffects.filter(i=>{const o=(e-i.startTime)/1e3,a=i.duration/this.beatTiming.beatsPerSecond,u=Math.min(o/a,1);if(u>=1)return!1;const d=this.interpolateKeyframes(i.keyframes,u);return this.compositeLightingKeyframe(t,d,i.type),!0}),this.state.strobePhase=(this.state.strobePhase+.1)%(Math.PI*2),t}interpolateKeyframes(e,t){if(e.length===1)return e[0];let i=e[0],o=e[e.length-1];for(let u=0;u<e.length-1;u++)if(t>=e[u].time&&t<=e[u+1].time){i=e[u],o=e[u+1];break}const a=i.time===o.time?0:(t-i.time)/(o.time-i.time);return{time:t,intensity:this.lerp(i.intensity,o.intensity,a),color:[this.lerp(i.color[0],o.color[0],a),this.lerp(i.color[1],o.color[1],a),this.lerp(i.color[2],o.color[2],a)],blur:this.lerp(i.blur,o.blur,a),position:{x:this.lerp(i.position.x,o.position.x,a),y:this.lerp(i.position.y,o.position.y,a)},size:this.lerp(i.size,o.size,a),opacity:this.lerp(i.opacity,o.opacity,a),blendMode:o.blendMode}}compositeLightingKeyframe(e,t,i){switch(t.blendMode){case"screen":e.intensity=Math.min(1,e.intensity+t.intensity*t.opacity);break;case"multiply":e.intensity=e.intensity*(1-t.opacity+t.intensity*t.opacity);break;case"overlay":const a=t.opacity*t.intensity;e.intensity=e.intensity+a*(1-e.intensity);break;case"add":e.intensity=Math.min(1,e.intensity+t.intensity*t.opacity);break;default:e.intensity=e.intensity*(1-t.opacity)+t.intensity*t.opacity}const o=t.opacity*t.intensity;e.color[0]=Math.min(1,e.color[0]+t.color[0]*o),e.color[1]=Math.min(1,e.color[1]+t.color[1]*o),e.color[2]=Math.min(1,e.color[2]+t.color[2]*o),e.blur=Math.max(e.blur,t.blur*t.opacity)}lerp(e,t,i){return e+(t-e)*i}setAmbientLevel(e){this.state.ambientLevel=Math.max(0,Math.min(1,e))}setColorTemperature(e){this.state.colorTemperature=Math.max(0,Math.min(1,e))}getActiveLightingInfo(){return{effects:this.state.activeEffects.map(e=>`${e.id} (${e.type})`),ambientLevel:this.state.ambientLevel}}forceStopAll(){this.state.activeEffects=[]}}class zI{constructor(){this.contentKeywords={weapon:["gun","pistol","rifle","weapon","sword","knife","combat","action","fight"],tech:["cyber","neon","tech","futuristic","robot","digital","hologram","matrix"],dance:["dance","movement","energy","party","celebration","rhythm","groove"],dramatic:["closeup","face","portrait","dramatic","intense","emotion","serious"],nature:["outdoor","nature","landscape","sky","water","forest","mountain"],urban:["city","street","urban","building","neon","traffic","graffiti"]}}analyzeFrame(e,t){const i=[],o=e.toLowerCase();for(const[a,u]of Object.entries(this.contentKeywords))for(const d of u)if(o.includes(d)){i.push(a),i.push(d);break}if(t){const a=t.toLowerCase();(a.includes("cyber")||a.includes("neon"))&&i.push("tech","cyber"),(a.includes("noir")||a.includes("dramatic"))&&i.push("dramatic"),(a.includes("anime")||a.includes("character"))&&i.push("character")}return[...new Set(i)]}}const Zo=new OI;class FI{constructor(e={}){this.config={enableAnticipationMessages:!0,enableProgressPredictions:!0,enableBeatsNotifications:!0,messageUpdateInterval:500,maxUpcomingEvents:5,...e},this.status=this.createInitialStatus(),this.frameGenerationTimes=[],this.beatPredictions=[],this.messageTemplates=new BI,this.subscribers=[],this.startTime=0}createInitialStatus(){return{phase:"idle",progress:0,currentFrame:0,totalFrames:0,choreographyProgress:0,cameraSequenceProgress:0,lightingEffectProgress:0,estimatedCompletion:0,timeElapsed:0,anticipationLevel:"calm",currentMessage:"Ready to create your dance masterpiece! ",upcomingEvents:[],framesPerSecond:0,generationSpeed:0}}startGeneration(e,t){this.startTime=performance.now(),this.status.phase="analyzing_audio",this.status.totalFrames=e,this.status.currentFrame=0,this.status.progress=0,this.status.anticipationLevel="building",this.status.currentMessage=" Analyzing your music for the perfect choreography...",t&&(this.beatPredictions=this.generateBeatPredictions(t),this.updateUpcomingEvents()),this.notifySubscribers()}updatePhase(e,t){switch(this.status.phase=e,this.updateTimeElapsed(),t?this.status.currentMessage=t:this.status.currentMessage=this.messageTemplates.getPhaseMessage(e,this.status.anticipationLevel),e){case"planning_choreography":this.status.anticipationLevel="building";break;case"generating_frames":this.status.anticipationLevel="exciting";break;case"processing_camera":this.status.anticipationLevel="epic";break;case"applying_lighting":this.status.anticipationLevel="epic";break;case"complete":this.status.anticipationLevel="calm";break}this.updateProgress(),this.notifySubscribers()}updateFrameProgress(e,t){if(this.status.currentFrame=e,t!==void 0){this.frameGenerationTimes.push(t),this.frameGenerationTimes.length>10&&this.frameGenerationTimes.shift();const i=this.frameGenerationTimes.reduce((o,a)=>o+a,0)/this.frameGenerationTimes.length;this.status.framesPerSecond=1e3/i,this.status.generationSpeed=60*1e3/i}this.updateProgress(),this.updateTimeElapsed(),this.updateEstimatedCompletion(),this.config.enableAnticipationMessages&&this.updateProgressMessage(),this.notifySubscribers()}updateSystemProgress(e,t){switch(e){case"choreography":this.status.choreographyProgress=t;break;case"camera":this.status.cameraSequenceProgress=t;break;case"lighting":this.status.lightingEffectProgress=t;break}this.updateProgress(),this.notifySubscribers()}updateProgress(){let t={idle:0,analyzing_audio:.05,planning_choreography:.1,generating_frames:.6,processing_camera:.8,applying_lighting:.9,finalizing:.95,complete:1,error:0}[this.status.phase];this.status.phase==="generating_frames"&&this.status.totalFrames>0&&(t=.1+this.status.currentFrame/this.status.totalFrames*.5),this.status.progress=Math.min(1,t)}updateTimeElapsed(){this.startTime>0&&(this.status.timeElapsed=(performance.now()-this.startTime)/1e3)}updateEstimatedCompletion(){if(this.frameGenerationTimes.length>2&&this.status.totalFrames>0){const e=this.frameGenerationTimes.reduce((i,o)=>i+o,0)/this.frameGenerationTimes.length,t=this.status.totalFrames-this.status.currentFrame;this.status.estimatedCompletion=t*e/1e3}}updateProgressMessage(){this.status.progress;const e=this.status.currentFrame/this.status.totalFrames;this.status.phase==="generating_frames"&&(e<.25?this.status.currentMessage=this.messageTemplates.getProgressMessage("early",this.status.anticipationLevel):e<.5?this.status.currentMessage=this.messageTemplates.getProgressMessage("mid",this.status.anticipationLevel):e<.75?this.status.currentMessage=this.messageTemplates.getProgressMessage("late",this.status.anticipationLevel):this.status.currentMessage=this.messageTemplates.getProgressMessage("final",this.status.anticipationLevel))}generateBeatPredictions(e){const t=[];for(let i=0;i<64;i+=4)i%16===0?t.push({beatNumber:i,eventType:"energy_peak",intensity:.8+Math.random()*.2,description:"Major energy peak incoming!"}):i%8===0&&t.push({beatNumber:i,eventType:"beat_drop",intensity:.6+Math.random()*.3,description:"Beat drop sequence"});return t}updateUpcomingEvents(){if(!this.config.enableBeatsNotifications)return;const e=this.status.timeElapsed,t=[];for(const i of this.beatPredictions){const a=i.beatNumber*.5-e;a>0&&a<10&&t.length<this.config.maxUpcomingEvents&&t.push({type:i.eventType,description:i.description,beatNumber:i.beatNumber,timeUntil:a,excitement:this.getExcitementLevel(i.intensity),icon:this.getEventIcon(i.eventType)})}t.sort((i,o)=>i.timeUntil-o.timeUntil),this.status.upcomingEvents=t.slice(0,this.config.maxUpcomingEvents)}getExcitementLevel(e){return e>=.8?"epic":e>=.6?"exciting":e>=.4?"building":"calm"}getEventIcon(e){switch(e){case"energy_peak":return"";case"beat_drop":return"";case"camera_sequence":return"";case"lighting_effect":return"";default:return""}}subscribe(e){return this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);t>-1&&this.subscribers.splice(t,1)}}notifySubscribers(){for(const e of this.subscribers)e(this.status)}getStatus(){return{...this.status}}reset(){this.status=this.createInitialStatus(),this.frameGenerationTimes=[],this.beatPredictions=[],this.startTime=0,this.notifySubscribers()}setError(e){this.status.phase="error",this.status.currentMessage=` ${e}`,this.status.anticipationLevel="calm",this.notifySubscribers()}}class BI{constructor(){this.phaseMessages={analyzing_audio:{calm:" Analyzing your music...",building:" Discovering the rhythm in your track...",exciting:" Finding the perfect beats for your dance!",epic:" Unlocking the musical magic!"},planning_choreography:{calm:" Planning your choreography...",building:" Crafting the perfect dance sequence...",exciting:" Designing epic dance moves!",epic:" Creating choreography magic!"},generating_frames:{calm:" Generating your dance frames...",building:" Bringing your dancer to life...",exciting:" Creating stunning dance poses!",epic:" Manifesting pure dance energy!"},processing_camera:{calm:" Adding camera effects...",building:" Creating cinematic magic...",exciting:" Perfecting dynamic camera work!",epic:" Unleashing Hollywood-level cinematography!"},applying_lighting:{calm:" Applying lighting effects...",building:" Setting the perfect mood...",exciting:" Adding spectacular lighting!",epic:" Creating a visual masterpiece!"},complete:{calm:" Your dance is ready!",building:" Dance masterpiece complete!",exciting:" Your epic dance is ready to rock!",epic:" LEGENDARY dance sequence complete!"}},this.progressMessages={early:{calm:" Getting started...",building:" The magic is beginning...",exciting:" Epic moves incoming!",epic:" Prepare for greatness!"},mid:{calm:" Making good progress...",building:" The energy is building...",exciting:" Amazing sequences forming!",epic:" Mind-blowing choreography emerging!"},late:{calm:" Almost there...",building:" The climax approaches...",exciting:" The best moves are coming!",epic:" LEGENDARY finale incoming!"},final:{calm:" Finishing touches...",building:" Perfecting the masterpiece...",exciting:" Adding the final magic!",epic:" ULTIMATE perfection achieved!"}}}getPhaseMessage(e,t){var i;return((i=this.phaseMessages[e])==null?void 0:i[t])||" Creating something amazing..."}getProgressMessage(e,t){var i;return((i=this.progressMessages[e])==null?void 0:i[t])||" Working on your masterpiece..."}}const Za=new FI;class qI{constructor(){this.plan={currentBeat:0,lookaheadBeats:16,predictedBeats:[],energyAnalysis:{currentEnergy:0,energyTrend:"stable",trendStrength:0,nextPredictedPeak:0,peakIntensity:0,confidenceLevel:0},activeEvents:[],queuedEvents:[]},this.audioHistory=[],this.energyHistory=[],this.beatHistory=[],this.bpm=120,this.beatInterval=60/this.bpm*1e3,this.lastBeatTime=0,this.analysisWindowSize=120,this.predictionHorizon=16,console.log(" Predictive Choreography Engine initialized")}updateBPM(e){this.bpm=e,this.beatInterval=60/e*1e3,Wo.updateBeatTiming(this.plan.currentBeat,e),Zo.updateBeatTiming(this.plan.currentBeat,e)}processAudioFrame(e){const t={...e,energy:(e.bass+e.mid+e.high)/3,timestamp:performance.now()};this.audioHistory.push(t),this.energyHistory.push(t.energy),this.audioHistory.length>this.analysisWindowSize&&(this.audioHistory.shift(),this.energyHistory.shift()),this.updateEnergyAnalysis(),this.detectBeat(e)&&this.onBeatDetected(e),this.executeScheduledEvents()}updateEnergyAnalysis(){if(this.energyHistory.length<10)return;const e=this.energyHistory.slice(-10),t=this.energyHistory.slice(-20,-10),i=e.reduce((d,f)=>d+f,0)/e.length,o=t.length>0?t.reduce((d,f)=>d+f,0)/t.length:i;this.plan.energyAnalysis.currentEnergy=i;const a=i-o,u=.05;a>u?(this.plan.energyAnalysis.energyTrend="building",this.plan.energyAnalysis.trendStrength=Math.min(1,a/.2)):a<-u?(this.plan.energyAnalysis.energyTrend="dropping",this.plan.energyAnalysis.trendStrength=Math.min(1,Math.abs(a)/.2)):i>.7?(this.plan.energyAnalysis.energyTrend="sustaining",this.plan.energyAnalysis.trendStrength=i):(this.plan.energyAnalysis.energyTrend="stable",this.plan.energyAnalysis.trendStrength=1-Math.abs(a)),this.predictNextEnergyPeak()}predictNextEnergyPeak(){const e=this.plan.energyAnalysis;if(e.energyTrend==="building"){const t=4+(1-e.trendStrength)*4;e.nextPredictedPeak=t,e.peakIntensity=Math.min(1,e.currentEnergy+e.trendStrength*.3),e.confidenceLevel=e.trendStrength*.8}else e.energyTrend==="sustaining"?(e.nextPredictedPeak=2,e.peakIntensity=e.currentEnergy,e.confidenceLevel=.6):(e.nextPredictedPeak=8,e.peakIntensity=.7,e.confidenceLevel=.4);this.planEventsForPredictedPeak()}planEventsForPredictedPeak(){const e=this.plan.energyAnalysis,t=this.plan.currentBeat+e.nextPredictedPeak;e.confidenceLevel<.5||e.nextPredictedPeak>12||(e.peakIntensity>.7&&(this.queueEvent({type:"camera",action:"build_zoom_intensify",triggerBeat:t-4,duration:4,priority:8}),this.queueEvent({type:"camera",action:"impact_zoom_punch",triggerBeat:t,duration:1,priority:10})),e.peakIntensity>.6&&this.queueEvent({type:"lighting",action:"impact_strobe",triggerBeat:t,duration:1,priority:12}),Za.updateSystemProgress("choreography",e.confidenceLevel))}detectBeat(e){const t=performance.now(),i=.6,o=t-this.lastBeatTime,a=this.beatInterval*.7,u=this.beatInterval*1.3;return e.bass>i&&o>a&&o<u*2||o>this.beatInterval*.9&&o<this.beatInterval*1.1&&e.bass>.4}onBeatDetected(e){const t=performance.now();this.lastBeatTime=t,this.plan.currentBeat++,this.beatHistory.push({beatNumber:this.plan.currentBeat,timestamp:t,energy:this.plan.energyAnalysis.currentEnergy,type:e.bass>.7?"kick":e.mid>.7?"snare":"normal"}),this.beatHistory.length>64&&this.beatHistory.shift(),console.log(` Beat ${this.plan.currentBeat} detected (${this.plan.energyAnalysis.energyTrend})`),this.triggerImmediateChoreography(e),this.updateBeatPredictions()}triggerImmediateChoreography(e){const t=this.plan.energyAnalysis;t.currentEnergy<.4?Id.REST:t.currentEnergy<.7?Id.BUILD:Id.IMPACT;const i=Wo.tryTriggerSequence({energy:t.currentEnergy,onBeat:!0,onSnare:e.mid>.7,onStutter:!1}),o=Zo.analyzeAndTrigger({energy:t.currentEnergy,onBeat:!0,onSnare:e.mid>.7,beatPattern:this.getCurrentBeatPattern()});(i||o)&&console.log(` Triggered choreography: camera=${i}, lighting=${o}`)}getCurrentBeatPattern(){const e=this.plan.currentBeat%4;return["A","B","A","C"][e]||"A"}updateBeatPredictions(){this.plan.predictedBeats=[];for(let e=1;e<=this.predictionHorizon;e++){const t=this.plan.currentBeat+e,i=this.lastBeatTime+e*this.beatInterval;let o=this.plan.energyAnalysis.currentEnergy;const a=this.plan.energyAnalysis.energyTrend,u=this.plan.energyAnalysis.trendStrength;switch(a){case"building":o=Math.min(1,o+u*.1*e);break;case"dropping":o=Math.max(0,o-u*.05*e);break;case"sustaining":o=o*(.95+u*.05);break}let d="kick";e===this.plan.energyAnalysis.nextPredictedPeak?d="peak":t%4===2?d="snare":o<.3?d="drop":Math.abs(o-this.plan.energyAnalysis.currentEnergy)>.2&&(d="transition"),this.plan.predictedBeats.push({beatNumber:t,timestamp:i,energy:o,type:d,confidence:Math.max(.3,this.plan.energyAnalysis.confidenceLevel-e*.05),plannedEvents:[]})}}queueEvent(e){this.plan.queuedEvents.some(i=>i.type===e.type&&i.action===e.action&&Math.abs(i.triggerBeat-e.triggerBeat)<2)||(this.plan.queuedEvents.push(e),console.log(` Queued ${e.type} event: ${e.action} at beat ${e.triggerBeat}`))}executeScheduledEvents(){performance.now();const e=this.plan.currentBeat;this.plan.queuedEvents=this.plan.queuedEvents.filter(t=>{const i=t.triggerBeat-e;return i<=.5&&i>=-.5?(this.executeEvent(t),this.plan.activeEvents.push(t),!1):i>-1}),this.plan.activeEvents=this.plan.activeEvents.filter(t=>e-t.triggerBeat<t.duration)}executeEvent(e){switch(console.log(` Executing planned ${e.type} event: ${e.action}`),e.type){case"camera":Wo.tryTriggerSequence({energy:this.plan.energyAnalysis.currentEnergy,onBeat:!0});break;case"lighting":Zo.analyzeAndTrigger({energy:this.plan.energyAnalysis.currentEnergy,onBeat:!0});break}}getCurrentPlan(){return{...this.plan}}getEnergyAnalysis(){return{...this.plan.energyAnalysis}}reset(){this.plan.currentBeat=0,this.plan.predictedBeats=[],this.plan.activeEvents=[],this.plan.queuedEvents=[],this.audioHistory=[],this.energyHistory=[],this.beatHistory=[],this.lastBeatTime=0}}const $v=new qI;class ab{constructor(e){this.patterns=new Map,this.style_presets=e,this.current_context={},this.initializeUniversalPatterns()}initializeUniversalPatterns(){this.addPattern({id:"flow_harmony",name:"Flowing Harmony",triggers:{content_types:["CHARACTER","SYMBOL"],energy_range:[0,.6],style_affinities:["vintage-film","natural","dreamy-oil","ethereal"],musical_contexts:["ambient","emotional","building"]},camera_personality:{base_motion_style:"smooth",zoom_behavior:"breathing",pan_tendency:"sweeping",shake_response:"subtle",intensity_multiplier:.7,energy_responsiveness:.3,duration_preference:"long"},lighting_personality:{base_mood:"intimate",color_strategy:"style_driven",effect_density:"moderate",timing_sync:"energy",hologram_integration:!0,style_color_influence:.8},timing_modifiers:{beat_alignment:"loose",sequence_length_bias:.3,overlap_tolerance:.7,energy_lag:.2},frame_count_scaling:{turbo:.9,quality:1,super:.8}}),this.addPattern({id:"rhythmic_pulse",name:"Rhythmic Pulse",triggers:{content_types:["CHARACTER","TEXT"],energy_range:[.3,.8],style_affinities:["neon-cyber","retro-anime","acid-glitch"],musical_contexts:["electronic","dance","rhythmic"]},camera_personality:{base_motion_style:"rhythmic",zoom_behavior:"pulse",pan_tendency:"asymmetric",shake_response:"rhythmic",intensity_multiplier:1,energy_responsiveness:.8,duration_preference:"medium"},lighting_personality:{base_mood:"party",color_strategy:"complement",effect_density:"rich",timing_sync:"beat",hologram_integration:!0,style_color_influence:.6},timing_modifiers:{beat_alignment:"strict",sequence_length_bias:-.2,overlap_tolerance:.4,energy_lag:0},frame_count_scaling:{turbo:1,quality:1,super:1}}),this.addPattern({id:"dramatic_impact",name:"Dramatic Impact",triggers:{content_types:["CHARACTER","SYMBOL","TEXT"],energy_range:[.7,1],style_affinities:["noir","cyber-samurai","street-graffiti"],musical_contexts:["aggressive","climax","drop","explosive"]},camera_personality:{base_motion_style:"dramatic",zoom_behavior:"impact",pan_tendency:"asymmetric",shake_response:"explosive",intensity_multiplier:1.4,energy_responsiveness:1,duration_preference:"short"},lighting_personality:{base_mood:"epic",color_strategy:"contrast",effect_density:"overwhelming",timing_sync:"beat",hologram_integration:!1,style_color_influence:.4},timing_modifiers:{beat_alignment:"strict",sequence_length_bias:-.5,overlap_tolerance:.2,energy_lag:0},frame_count_scaling:{turbo:.8,quality:.9,super:1}}),this.addPattern({id:"ethereal_drift",name:"Ethereal Drift",triggers:{content_types:["CHARACTER","SYMBOL"],energy_range:[0,.5],style_affinities:["dreamy-oil","vaporwave","ukiyo-e"],musical_contexts:["ambient","ethereal","calm","mystical"]},camera_personality:{base_motion_style:"smooth",zoom_behavior:"flow",pan_tendency:"following",shake_response:"none",intensity_multiplier:.5,energy_responsiveness:.2,duration_preference:"long"},lighting_personality:{base_mood:"ethereal",color_strategy:"style_driven",effect_density:"minimal",timing_sync:"content",hologram_integration:!0,style_color_influence:1},timing_modifiers:{beat_alignment:"free",sequence_length_bias:.5,overlap_tolerance:.9,energy_lag:.5},frame_count_scaling:{turbo:.6,quality:.8,super:1}}),this.addPattern({id:"chaotic_glitch",name:"Chaotic Glitch",triggers:{content_types:["TEXT","SYMBOL"],energy_range:[.6,1],style_affinities:["acid-glitch","crt-terminal","16bit-pixel"],musical_contexts:["glitch","experimental","chaotic","breakdown"]},camera_personality:{base_motion_style:"chaotic",zoom_behavior:"impact",pan_tendency:"asymmetric",shake_response:"explosive",intensity_multiplier:1.2,energy_responsiveness:1,duration_preference:"short"},lighting_personality:{base_mood:"epic",color_strategy:"contrast",effect_density:"overwhelming",timing_sync:"content",hologram_integration:!1,style_color_influence:.3},timing_modifiers:{beat_alignment:"syncopated",sequence_length_bias:-.3,overlap_tolerance:.1,energy_lag:0},frame_count_scaling:{turbo:.7,quality:1,super:1}})}addPattern(e){this.patterns.set(e.id,e)}analyzeAndSelectPattern(e,t,i,o,a){this.current_context={content:e,musical:t,style:i,credit_tier:o};let u=null,d=0;for(const f of this.patterns.values()){let p=0;f.triggers.content_types.includes(a)&&(p+=30);const[_,E]=f.triggers.energy_range;if(t.energy_level>=_&&t.energy_level<=E){p+=25;const V=(_+E)/2,z=Math.abs(t.energy_level-V);p+=(1-z)*10}f.triggers.style_affinities.includes(i.id)&&(p+=20);const S=t.genre_markers.concat([t.structure_phase]),C=f.triggers.musical_contexts.filter(V=>S.some(z=>z.includes(V)||V.includes(z)));p+=C.length*8;const k=f.frame_count_scaling[o];p*=k,e.complexity>.7&&f.lighting_personality.effect_density==="rich"&&(p+=5),e.motion_implied>.6&&f.camera_personality.base_motion_style==="dramatic"&&(p+=5),p>d&&(d=p,u=f)}return u||this.patterns.get("rhythmic_pulse")}adaptPatternToContext(e){const t=this.current_context;if(!t.content||!t.musical||!t.style)throw new Error("Context not set");const i=this.adaptCameraPersonality(e.camera_personality,t),o=this.adaptLightingPersonality(e.lighting_personality,t),a=this.adaptTimingProfile(e.timing_modifiers,t);return{pattern_id:e.id,camera_config:i,lighting_config:o,timing_config:a,hologram_sync:o.hologram_integration}}adaptCameraPersonality(e,t){const i=t.musical.energy_level,o=t.content.complexity;return{motion_intensity:e.intensity_multiplier*(.5+i*.5),zoom_range:this.calculateZoomRange(e.zoom_behavior,i),pan_amplitude:this.calculatePanAmplitude(e.pan_tendency,i,o),shake_intensity:this.calculateShakeIntensity(e.shake_response,i),sequence_duration:this.calculateDuration(e.duration_preference,t.musical.rhythmic_density),easing_style:this.selectEasingForStyle(e.base_motion_style)}}adaptLightingPersonality(e,t){const i=t.style.hologramParams.hue||200,o=t.musical.energy_level;return{base_color_palette:this.generateColorPalette(e.color_strategy,i),effect_intensity:o*(e.effect_density==="overwhelming"?1:.7),sync_mode:e.timing_sync,hologram_integration:e.hologram_integration,blend_modes:this.selectBlendModes(e.base_mood),effect_count:this.calculateEffectCount(e.effect_density,t.credit_tier)}}adaptTimingProfile(e,t){return{beat_sync_strength:e.beat_alignment==="strict"?1:.6,sequence_overlap:e.overlap_tolerance,response_delay:e.energy_lag*1e3,length_multiplier:1+e.sequence_length_bias}}calculateZoomRange(e,t){const i={breathing:[.95,1.1],pulse:[.9,1.2],impact:[.8,1.5],flow:[.98,1.05]},[o,a]=i[e]||i.pulse,u=.5+t*.5;return[o*u,a*u]}calculatePanAmplitude(e,t,i){return({centered:10,sweeping:40,asymmetric:60,following:25}[e]||30)*(.3+t*.7)*(.5+i*.5)}calculateShakeIntensity(e,t){return({none:0,subtle:2,rhythmic:8,explosive:20}[e]||5)*t}calculateDuration(e,t){return({short:1,medium:2,long:4}[e]||2)*(1.5-t*.5)}selectEasingForStyle(e){return{smooth:"ease-in-out",rhythmic:"ease-out",dramatic:"ease-in",chaotic:"linear"}[e]||"ease-in-out"}generateColorPalette(e,t){switch(e){case"complement":return[t,(t+180)%360];case"monochrome":return[t,t,t];case"contrast":return[t,(t+120)%360,(t+240)%360];case"style_driven":default:return[t,(t+30)%360,(t-30+360)%360]}}selectBlendModes(e){return{cinematic:["overlay","multiply"],party:["screen","add"],intimate:["overlay","soft-light"],epic:["screen","add","overlay"],ethereal:["screen","overlay"]}[e]||["overlay"]}calculateEffectCount(e,t){const i={minimal:1,moderate:2,rich:3,overwhelming:4},o={turbo:.7,quality:1,super:1.3};return Math.round((i[e]||2)*(o[t]||1))}analyzeContentFromFrames(e,t){const i={low:e.filter(S=>S.energy==="low").length,mid:e.filter(S=>S.energy==="mid").length,high:e.filter(S=>S.energy==="high").length},o=e.length,a=e.some(S=>S.type==="closeup"),u=(i.mid+i.high*2)/(o*2),d=i.high/o,f=a?.8:.5;let p=.5,_="center",E=.7;switch(t){case"CHARACTER":p=.6,E=.8,_="center";break;case"TEXT":p=.9,E=.6,_="center";break;case"SYMBOL":p=.8,E=.7,_="center";break}return{complexity:u,contrast:f,motion_implied:d,symmetry:p,focus_point:_,visual_weight:E}}}const eg=new ab([]);class HI{constructor(){this.active_sequence=null,this.brain=eg,this.beat_timing={current_beat:0,beats_per_second:2,last_beat_time:0}}updateBeatTiming(e,t){this.beat_timing.current_beat=e,this.beat_timing.beats_per_second=t/60,this.beat_timing.last_beat_time=performance.now()}shouldTriggerSequence(e,t){const i=performance.now();if(this.active_sequence){const o=(i-this.active_sequence.start_time)/1e3,a=this.active_sequence.duration*.3;if(o<a&&e.energy_level<.8)return!1}return!!(e.energy_level>.6&&e.beat_detected||e.energy_level>.8&&e.snare_detected||e.time_since_last_motion>4e3)}generateDynamicSequence(e){const t=e.sequence_duration/this.beat_timing.beats_per_second,i=this.generateAdaptiveKeyframes(e,t);return{id:`dynamic_${Date.now()}`,config:e,start_time:performance.now(),duration:t,current_phase:0,keyframes:i}}generateAdaptiveKeyframes(e,t){const i=[],o=Math.max(3,Math.round(t*2));for(let a=0;a<o;a++){const u=a/(o-1),d=this.applyEasing(u,e.easing_style);i.push({time:u,zoom:this.interpolateZoom(d,e),panX:this.interpolatePan(d,e,"x"),panY:this.interpolatePan(d,e,"y"),shakeX:this.interpolateShake(d,e,"x"),shakeY:this.interpolateShake(d,e,"y"),rotation:this.interpolateRotation(d,e),tiltX:this.interpolateTilt(d,e,"x"),tiltY:this.interpolateTilt(d,e,"y"),dollyZoom:this.interpolateDollyZoom(d,e),easeType:e.easing_style})}return i}interpolateZoom(e,t){const[i,o]=t.zoom_range;if(t.motion_intensity>.8){if(e<=.3)return 1+(o-1)*(e/.3);{const u=(e-.3)/.7;return o+(i-o)*u}}else return t.motion_intensity>.5?1+(o-1)*Math.sin(e*Math.PI):1+(o-1)*Math.sin(e*Math.PI*2)*.5}interpolatePan(e,t,i){const o=t.pan_amplitude;return t.motion_intensity>.7?o*Math.sin(e*Math.PI*3+(i==="x"?0:Math.PI/2)):o*.5*Math.sin(e*Math.PI*2+(i==="x"?0:Math.PI/4))}interpolateShake(e,t,i){const o=t.shake_intensity;if(o===0)return 0;const a=Math.sin(e*Math.PI),u=Math.sin(e*Math.PI*20+(i==="x"?0:1.5))*a;return o*u}interpolateRotation(e,t){return t.motion_intensity*10*Math.sin(e*Math.PI*2)}interpolateTilt(e,t,i){const o=t.motion_intensity*15;return i==="x"?o*Math.cos(e*Math.PI*2):o*.5*Math.sin(e*Math.PI*3)}interpolateDollyZoom(e,t){return t.motion_intensity>.8?.3*Math.sin(e*Math.PI):0}applyEasing(e,t){switch(t){case"ease-in":return e*e;case"ease-out":return 1-(1-e)*(1-e);case"ease-in-out":return e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2;case"linear":default:return e}}update(){if(!this.active_sequence)return null;const t=(performance.now()-this.active_sequence.start_time)/1e3,i=Math.min(t/this.active_sequence.duration,1);return i>=1?(this.active_sequence=null,null):(this.active_sequence.current_phase=i,this.interpolateKeyframes(this.active_sequence.keyframes,i))}interpolateKeyframes(e,t){if(e.length===1)return e[0];let i=e[0],o=e[e.length-1];for(let d=0;d<e.length-1;d++)if(t>=e[d].time&&t<=e[d+1].time){i=e[d],o=e[d+1];break}const a=o.time-i.time,u=a===0?0:(t-i.time)/a;return{time:t,zoom:this.lerp(i.zoom,o.zoom,u),panX:this.lerp(i.panX,o.panX,u),panY:this.lerp(i.panY,o.panY,u),shakeX:this.lerp(i.shakeX,o.shakeX,u),shakeY:this.lerp(i.shakeY,o.shakeY,u),rotation:this.lerp(i.rotation,o.rotation,u),tiltX:this.lerp(i.tiltX,o.tiltX,u),tiltY:this.lerp(i.tiltY,o.tiltY,u),dollyZoom:this.lerp(i.dollyZoom,o.dollyZoom,u),easeType:o.easeType}}lerp(e,t,i){return e+(t-e)*i}startSequence(e){this.active_sequence=this.generateDynamicSequence(e),console.log(` Starting adaptive camera sequence with intensity ${e.motion_intensity.toFixed(2)}`)}forceStop(){this.active_sequence=null}getActiveSequenceInfo(){return this.active_sequence?{config:this.active_sequence.config,progress:this.active_sequence.current_phase}:null}}const GI=new HI;class YI{constructor(){this.active_effects=[],this.effect_counter=0,this.brain=eg,this.beat_timing={current_beat:0,beats_per_second:2,last_beat_time:0}}updateBeatTiming(e,t){this.beat_timing.current_beat=e,this.beat_timing.beats_per_second=t/60,this.beat_timing.last_beat_time=performance.now()}shouldTriggerEffect(e,t){return performance.now(),this.active_effects.length>=t.effect_count?!1:!!(e.energy_level>.6&&e.beat_detected||e.energy_level>.7&&e.snare_detected||t.sync_mode==="camera"&&e.camera_motion_active||t.sync_mode==="content"&&this.active_effects.length===0&&this.getTimeSinceLastEffect()>2e3)}getTimeSinceLastEffect(){if(this.active_effects.length===0)return 1/0;const e=this.active_effects.reduce((t,i)=>i.start_time>t.start_time?i:t);return performance.now()-e.start_time}generateDynamicEffect(e,t){const i=this.calculateEffectDuration(e,t),o=this.generateAdaptiveKeyframes(e,t,i),a=this.calculateEffectPriority(e,t);return{id:`adaptive_${this.effect_counter++}`,config:e,start_time:performance.now(),duration:i,current_phase:0,keyframes:o,priority:a}}calculateEffectDuration(e,t){let i=2;switch(e.sync_mode){case"beat":i=1/this.beat_timing.beats_per_second;break;case"energy":i=t.energy_level>.8?.5:2;break;case"camera":i=1.5;break;case"content":i=3;break}return i*(.5+e.effect_intensity*.5)}calculateEffectPriority(e,t){let i=5;return i+=t.energy_level*10,t.beat_detected&&(i+=5),t.snare_detected&&(i+=8),t.camera_motion_active&&e.sync_mode==="camera"&&(i+=7),i}generateAdaptiveKeyframes(e,t,i){const o=[],a=Math.max(3,Math.round(i*3)),u=this.selectColorsForContext(e,t),d=this.generatePositions(e,t);for(let f=0;f<a;f++){const p=f/(a-1),_=Math.floor(p*u.length)%u.length,E=Math.floor(p*d.length)%d.length;o.push({time:p,intensity:this.calculateIntensityCurve(p,e),color:this.hslToRgb(u[_],.8,.6),blur:this.calculateBlurCurve(p,e),position:d[E],size:this.calculateSizeCurve(p,e),opacity:this.calculateOpacityCurve(p,e),blendMode:this.selectBlendModeForPhase(p,e)})}return o}selectColorsForContext(e,t){const i=e.base_color_palette;return e.hologram_integration&&t.hologram_params?[t.hologram_params.hue||200,...i.slice(0,2)]:i}generatePositions(e,t){const i=[];return t.camera_motion_active?i.push({x:.2,y:-.1},{x:-.2,y:.1},{x:0,y:.3}):i.push({x:0,y:0},{x:.1,y:-.2},{x:-.1,y:.2}),i}calculateIntensityCurve(e,t){const i=t.effect_intensity;switch(t.sync_mode){case"beat":return i*Math.exp(-e*4);case"energy":return i*(.7+.3*Math.sin(e*Math.PI));case"camera":return i*Math.sin(e*Math.PI);case"content":default:return i*Math.sin(e*Math.PI)}}calculateBlurCurve(e,t){return t.effect_intensity*20*Math.sin(e*Math.PI)}calculateSizeCurve(e,t){return(.5+t.effect_intensity*.5)*(.3+.7*Math.sin(e*Math.PI))}calculateOpacityCurve(e,t){return t.effect_intensity*Math.sin(e*Math.PI)}selectBlendModeForPhase(e,t){const i=t.blend_modes;if(i.length===1)return i[0];const o=Math.floor(e*i.length);return i[o%i.length]}hslToRgb(e,t,i){e=e/360;const o=(1-Math.abs(2*i-1))*t,a=o*(1-Math.abs(e*6%2-1)),u=i-o/2;let d=0,f=0,p=0;return 0<=e&&e<1/6?(d=o,f=a,p=0):1/6<=e&&e<2/6?(d=a,f=o,p=0):2/6<=e&&e<3/6?(d=0,f=o,p=a):3/6<=e&&e<4/6?(d=0,f=a,p=o):4/6<=e&&e<5/6?(d=a,f=0,p=o):5/6<=e&&e<1&&(d=o,f=0,p=a),[d+u,f+u,p+u]}update(){const e=performance.now();return this.active_effects=this.active_effects.filter(t=>{const i=(e-t.start_time)/1e3,o=Math.min(i/t.duration,1);return o>=1?!1:(t.current_phase=o,!0)}),this.compositeEffects()}compositeEffects(){if(this.active_effects.length===0)return{time:0,intensity:.3,color:[1,1,1],blur:0,position:{x:0,y:0},size:1,opacity:.3,blendMode:"normal"};const e=[...this.active_effects].sort((d,f)=>f.priority-d.priority),t=e[0],i=this.interpolateKeyframes(t.keyframes,t.current_phase);let o=i.intensity,a=[...i.color],u=i.blur;for(let d=1;d<Math.min(e.length,3);d++){const f=e[d],p=this.interpolateKeyframes(f.keyframes,f.current_phase),_=.3/d;o=Math.min(1,o+p.intensity*_),a[0]=Math.min(1,a[0]+p.color[0]*_),a[1]=Math.min(1,a[1]+p.color[1]*_),a[2]=Math.min(1,a[2]+p.color[2]*_),u=Math.max(u,p.blur*_)}return{...i,intensity:o,color:a,blur:u}}interpolateKeyframes(e,t){if(e.length===1)return e[0];let i=e[0],o=e[e.length-1];for(let d=0;d<e.length-1;d++)if(t>=e[d].time&&t<=e[d+1].time){i=e[d],o=e[d+1];break}const a=o.time-i.time,u=a===0?0:(t-i.time)/a;return{time:t,intensity:this.lerp(i.intensity,o.intensity,u),color:[this.lerp(i.color[0],o.color[0],u),this.lerp(i.color[1],o.color[1],u),this.lerp(i.color[2],o.color[2],u)],blur:this.lerp(i.blur,o.blur,u),position:{x:this.lerp(i.position.x,o.position.x,u),y:this.lerp(i.position.y,o.position.y,u)},size:this.lerp(i.size,o.size,u),opacity:this.lerp(i.opacity,o.opacity,u),blendMode:o.blendMode}}lerp(e,t,i){return e+(t-e)*i}startEffect(e,t){const i=this.generateDynamicEffect(e,t);this.active_effects.push(i),this.active_effects.length>e.effect_count&&(this.active_effects.sort((o,a)=>a.priority-o.priority),this.active_effects=this.active_effects.slice(0,e.effect_count)),console.log(` Starting adaptive lighting effect with intensity ${e.effect_intensity.toFixed(2)}`)}forceStopAll(){this.active_effects=[]}getActiveLightingInfo(){const e=this.active_effects.map(i=>`${i.id} (${i.config.sync_mode})`),t=this.active_effects.reduce((i,o)=>i+o.config.effect_intensity*(1-o.current_phase),0);return{effects:e,total_intensity:t}}}const $I=new YI;class KI{constructor(){this.current_session=null,this.audio_history=[],this.brain=eg,this.brain=new ab(as),this.camera_manager=GI,this.lighting_manager=$I,this.beat_detection={last_beat_time:0,last_snare_time:0,detected_bpm:120,energy_trend:"stable"}}startChoreographySession(e,t,i,o){const a=as.find(d=>d.id===e);if(!a)throw new Error(`Style preset not found: ${e}`);const u=this.brain.analyzeContentFromFrames(o,t);this.current_session={style_preset:a,subject_category:t,credit_tier:i,frames:o,content_signature:u,current_choreography:null,last_analysis_time:0},console.log(` Started adaptive choreography session: ${a.name} (${i})`),console.log(" Content analysis:",u)}processAudioFrame(e){if(!this.current_session)return;const t=performance.now(),i=(e.bass+e.mid+e.high)/3,o={...e,energy:i,timestamp:t};this.audio_history.push(o),this.audio_history.length>300&&this.audio_history.shift(),this.updateBeatDetection(e,t),this.updateEnergyTrend(),this.shouldAnalyzeChoreography(t)&&this.analyzeAndUpdateChoreography()}updateBeatDetection(e,t){if(e.bass>.65&&t-this.beat_detection.last_beat_time>250&&(this.beat_detection.last_beat_time=t,this.audio_history.length>2)){const u=this.audio_history.filter(d=>d.bass>.65).slice(-5);if(u.length>=2){const d=u.slice(1).map((p,_)=>p.timestamp-u[_].timestamp),f=d.reduce((p,_)=>p+_,0)/d.length;this.beat_detection.detected_bpm=6e4/f}}e.mid>.5&&t-this.beat_detection.last_snare_time>250&&(this.beat_detection.last_snare_time=t),this.camera_manager.updateBeatTiming(0,this.beat_detection.detected_bpm),this.lighting_manager.updateBeatTiming(0,this.beat_detection.detected_bpm)}updateEnergyTrend(){if(this.audio_history.length<30)return;const e=this.audio_history.slice(-15).map(d=>d.energy),t=this.audio_history.slice(-30,-15).map(d=>d.energy),i=e.reduce((d,f)=>d+f,0)/e.length,o=t.reduce((d,f)=>d+f,0)/t.length,a=i-o,u=.05;if(a>u)this.beat_detection.energy_trend="rising";else if(a<-u)this.beat_detection.energy_trend="falling";else if(i>.7)this.beat_detection.energy_trend="stable";else{const d=e.reduce((f,p)=>f+Math.pow(p-i,2),0)/e.length;this.beat_detection.energy_trend=d>.1?"chaotic":"stable"}}shouldAnalyzeChoreography(e){return this.current_session?e-this.current_session.last_analysis_time>1e3:!1}analyzeAndUpdateChoreography(){if(!this.current_session)return;const e=performance.now(),t=this.createMusicalContext(),i=this.brain.analyzeAndSelectPattern(this.current_session.content_signature,t,this.current_session.style_preset,this.current_session.credit_tier,this.current_session.subject_category),o=this.brain.adaptPatternToContext(i);this.current_session.current_choreography=o,this.current_session.last_analysis_time=e,console.log(` Selected choreography pattern: ${i.name}`),console.log(" Camera config:",o.camera_config),console.log(" Lighting config:",o.lighting_config)}createMusicalContext(){var d;if(this.audio_history.length===0)return{energy_level:.3,energy_trend:"stable",rhythmic_density:.5,harmonic_tension:.3,genre_markers:["ambient"],structure_phase:"verse"};const e=this.audio_history.slice(-60),t=((d=e[e.length-1])==null?void 0:d.energy)||0,i=this.analyzeBeatDensity(e),o=this.analyzeHarmonicTension(e),a=this.analyzeGenreMarkers(e),u=this.estimateStructuralPhase(t,this.beat_detection.energy_trend);return{energy_level:t,energy_trend:this.beat_detection.energy_trend,rhythmic_density:i,harmonic_tension:o,genre_markers:a,structure_phase:u}}analyzeBeatDensity(e){const i=e.filter(o=>o.bass>.6);return Math.min(i.length/e.length*4,1)}analyzeHarmonicTension(e){const t=e.reduce((o,a)=>o+a.mid,0)/e.length,i=e.reduce((o,a)=>o+a.high,0)/e.length;return Math.min((t+i)*.7,1)}analyzeGenreMarkers(e){const t=[],i=e.reduce((d,f)=>d+f.bass,0)/e.length,o=e.reduce((d,f)=>d+f.mid,0)/e.length,a=e.reduce((d,f)=>d+f.high,0)/e.length;return i>.7&&t.push("electronic","dance"),a>.6&&t.push("bright","energetic"),o>.6&&i>.5&&t.push("aggressive"),i<.3&&o<.4&&t.push("ambient","calm"),this.calculateVariance(e.map(d=>d.bass))>.1&&t.push("rhythmic"),t.length>0?t:["general"]}estimateStructuralPhase(e,t){return e<.3?"intro":e>.8&&t==="rising"?"chorus":e>.7&&t==="falling"?"breakdown":t==="chaotic"?"bridge":"verse"}calculateVariance(e){const t=e.reduce((i,o)=>i+o,0)/e.length;return e.reduce((i,o)=>i+Math.pow(o-t,2),0)/e.length}shouldTriggerCameraMotion(e){var a;if(!((a=this.current_session)!=null&&a.current_choreography))return!1;const t=this.current_session.current_choreography.camera_config,i=performance.now(),o={energy_level:e.energy,beat_detected:e.onBeat,snare_detected:e.onSnare,musical_phase:this.createMusicalContext().structure_phase,time_since_last_motion:i-this.beat_detection.last_beat_time};return this.camera_manager.shouldTriggerSequence(o,t)}triggerCameraMotion(){var t;if(!((t=this.current_session)!=null&&t.current_choreography))return;const e=this.current_session.current_choreography.camera_config;this.camera_manager.startSequence(e)}shouldTriggerLighting(e){var o;if(!((o=this.current_session)!=null&&o.current_choreography))return!1;const t=this.current_session.current_choreography.lighting_config,i={energy_level:e.energy,beat_detected:e.onBeat,snare_detected:e.onSnare,camera_motion_active:e.cameraActive,hologram_params:this.current_session.style_preset.hologramParams,style_hue:this.current_session.style_preset.hologramParams.hue||200};return this.lighting_manager.shouldTriggerEffect(i,t)}triggerLighting(e){var o,a;if(!((o=this.current_session)!=null&&o.current_choreography))return;const t=this.current_session.current_choreography.lighting_config,i={energy_level:((a=this.audio_history[this.audio_history.length-1])==null?void 0:a.energy)||.5,beat_detected:performance.now()-this.beat_detection.last_beat_time<100,snare_detected:performance.now()-this.beat_detection.last_snare_time<100,camera_motion_active:e.cameraActive,hologram_params:this.current_session.style_preset.hologramParams,style_hue:this.current_session.style_preset.hologramParams.hue||200};this.lighting_manager.startEffect(t,i)}getCameraUpdate(){return this.camera_manager.update()}getLightingUpdate(){return this.lighting_manager.update()}getCurrentPattern(){var e,t;return((t=(e=this.current_session)==null?void 0:e.current_choreography)==null?void 0:t.pattern_id)||null}getSessionInfo(){var e;return this.current_session?{pattern:(e=this.current_session.current_choreography)==null?void 0:e.pattern_id,content_complexity:this.current_session.content_signature.complexity,energy_trend:this.beat_detection.energy_trend,detected_bpm:this.beat_detection.detected_bpm,camera_info:this.camera_manager.getActiveSequenceInfo(),lighting_info:this.lighting_manager.getActiveLightingInfo()}:null}reset(){this.current_session=null,this.audio_history=[],this.camera_manager.forceStop(),this.lighting_manager.forceStopAll(),this.beat_detection={last_beat_time:0,last_snare_time:0,detected_bpm:120,energy_trend:"stable"}}}const cr=new KI,Kv={ABAB:["A","B","A","B"],AABB:["A","A","B","B"],ABAC:["A","B","A","C"],SNARE_ROLL:["B","B","B","B"],CHAOS:["A","C","B","C"]},JI=({state:n,onGenerateMore:e,onSpendCredit:t,onUploadAudio:i,onSaveProject:o,onNewDance:a,onBackToDirector:u,onOpenAuth:d})=>{var ga,ms,Ar;const f=ee.useRef(null),p=ee.useRef(null),_=ee.useRef(null),E=ee.useRef(null),S=ee.useRef(null),C=ee.useRef(null),k=ee.useRef(null),V=ee.useRef(null),z=ee.useRef(null),J=ee.useRef(0),j=ee.useRef(0),Z=ee.useRef(0),H=ee.useRef(0),ae=ee.useRef(0),oe=ee.useRef(0),x=ee.useRef(0);ee.useRef([]);const M=ee.useRef(0),N=ee.useRef("auto"),[P,U]=ee.useState({intention:"IDLE",currentPattern:"ABAB",activePoseName:"BASE",confidence:0}),O=ee.useRef("base"),D=ee.useRef(0),ct=ee.useRef("ABAB"),rt=ee.useRef(1),W=ee.useRef(0),ce=ee.useRef(0),Te=ee.useRef(0),Ge=ee.useRef(0),tt=ee.useRef(0),F=ee.useRef(0),ie=ee.useRef(0),he=ee.useRef(0),fe=ee.useRef(0),we=ee.useRef(0),ke=ee.useRef(0),[ye,jt]=ee.useState({low:[],mid:[],high:[]}),[It,Bs]=ee.useState([]),di=ee.useRef({}),[qs,ds]=ee.useState(!1),[Xt,Yi]=ee.useState(!1),[$i,br]=ee.useState(!1),[Ci,zt]=ee.useState(!1),[Rt,Ki]=ee.useState(!1),[Ji,hs]=ee.useState({active:!1,progress:0,status:"Idle"}),[fn,fs]=ee.useState(!1),[ji,Ao]=ee.useState("15s-mid"),[Xn,Pl]=ee.useState(30),[ps,fa]=ee.useState("720p"),[Hs,hi]=ee.useState(5e6),[Ut,Qn]=ee.useState(!1),wt=ee.useRef(null),[pa,wr]=ee.useState(n.smoothness),[fi,xi]=ee.useState(n.stutter),[Tn,Yt]=ee.useState(n.stutterPreset||"auto");ee.useEffect(()=>{if(f.current&&!S.current)try{S.current=new um(f.current);const Ce=as.find(Ye=>Ye.id===n.selectedStyleId);Ce&&Ce.hologramParams&&(S.current.params={...Ce.hologramParams})}catch(Ce){console.error("Failed to init hologram:",Ce)}if(n.generatedFrames.length>0){const Ce=n.superMode?"super":n.useTurbo?"turbo":"quality";cr.startChoreographySession(n.selectedStyleId,n.subjectCategory,Ce,n.generatedFrames)}const ue={low:[],mid:[],high:[]},Se=[],Ne=n.generatedFrames.length>0?n.generatedFrames:n.imagePreviewUrl?[{url:n.imagePreviewUrl,pose:"base",energy:"low"}]:[];Ne.forEach(Ce=>{Ce.type==="closeup"?Se.push(Ce.pose):ue[Ce.energy]&&ue[Ce.energy].push(Ce.pose)}),ue.low.length===0&&Ne.length>0&&ue.low.push(Ne[0].pose),ue.mid.length===0&&(ue.mid=[...ue.low]),ue.high.length===0&&(ue.high=[...ue.mid]),jt(ue),Bs(Se);let Je=0;const ot={},it=Ne.length;if(it===0){ds(!0);return}Ne.forEach(Ce=>{const Ye=new Image;Ye.crossOrigin="anonymous",Ye.src=Ce.url,Ye.onload=()=>{ot[Ce.pose]=Ye,Je++,Je===it&&(di.current=ot,ds(!0))},Ye.onerror=()=>{console.warn(`Failed to load frame: ${Ce.pose}`),Je++,Je===it&&(di.current=ot,ds(!0))}})},[n.generatedFrames,n.imagePreviewUrl,n.selectedStyleId]),ee.useEffect(()=>()=>{z.current&&z.current.getTracks().forEach(ue=>ue.stop()),wt.current&&wt.current.abort(),J.current&&cancelAnimationFrame(J.current),k.current&&k.current.close()},[]),ee.useEffect(()=>{C.current&&(C.current.pause(),C.current=null),Yi(!1)},[n.audioPreviewUrl]);const pi=()=>{if(k.current)return k.current;const ue=window.AudioContext||window.webkitAudioContext,Se=new ue;k.current=Se;const Ne=Se.createAnalyser();return Ne.fftSize=1024,Ne.smoothingTimeConstant=.8,V.current=Ne,Ne.connect(Se.destination),Se},Ii=async()=>{var Se;const ue=pi();if(ue.state==="suspended"&&await ue.resume(),Ci)(Se=z.current)==null||Se.getTracks().forEach(Ne=>Ne.stop()),z.current=null,zt(!1);else try{const Ne=await navigator.mediaDevices.getUserMedia({audio:!0});z.current=Ne;const Je=ue.createMediaStreamSource(Ne);V.current&&(Je.connect(V.current),V.current.disconnect()),zt(!0),Yi(!0),C.current&&C.current.pause()}catch(Ne){console.error("Mic Access Denied",Ne),alert("Microphone access denied.")}},mi=async()=>{const ue=pi();if(ue.state==="suspended"&&await ue.resume(),Ci){Yi(!Xt);return}if(n.audioPreviewUrl){if(!C.current){const Se=new Audio;Se.crossOrigin="anonymous",Se.src=n.audioPreviewUrl,Se.loop=!0;const Ne=ue.createMediaElementSource(Se);V.current&&(V.current.disconnect(),V.current.connect(ue.destination),Ne.connect(V.current)),C.current=Se}Xt?C.current.pause():C.current.play(),Yi(!Xt)}else Yi(!Xt)},Co=ee.useCallback(ue=>{var kn;J.current=requestAnimationFrame(Co),j.current||(j.current=ue);let Se=0,Ne=0,Je=0,ot=0;if(Xt&&V.current){const De=V.current.frequencyBinCount,Re=new Uint8Array(De);V.current.getByteFrequencyData(Re),Se=Re.slice(0,3).reduce((Ve,st)=>Ve+st,0)/3/255,Ne=Re.slice(2,7).reduce((Ve,st)=>Ve+st,0)/5/255,Je=Re.slice(40,90).reduce((Ve,st)=>Ve+st,0)/50/255,ot=Re.slice(200,400).reduce((Ve,st)=>Ve+st,0)/200/255}else if(Xt&&!n.audioPreviewUrl&&!Ci){const Ve=ue/1e3,st=Ve%.46875/.46875;Ne=Math.pow(Math.max(0,1-st*4),2),Je=Ve%(.46875*2)>.46875&&st<.2?.8:0,ot=Math.random()*.2}const it=ue,Ce=it<D.current;$v.processAudioFrame({bass:Ne,mid:Je,high:ot,timestamp:it}),cr.processAudioFrame({bass:Ne,mid:Je,high:ot,timestamp:it});const Ye=Wo.update(),Ft=cr.getCameraUpdate()||Ye;Ft&&(rt.current=Math.max(.1,Ft.zoom*rt.current),Ge.current+=Ft.panX,tt.current+=Ft.panY,W.current+=Ft.shakeX,ce.current+=Ft.shakeY,Te.current+=Ft.rotation,F.current+=Ft.tiltX,ie.current+=Ft.tiltY,he.current=Math.max(-1,Math.min(1,he.current+(Ft.dollyZoom||0))));const Wn=Zo.update(),Zn=cr.getLightingUpdate(),gs=.65,_n=.5,Ni=250;if(Ne>gs&&it-Z.current>Ni){Z.current=it,M.current+=1,oe.current=(oe.current+1)%4;const De=(Ne+Je+ot)/3,Re=!!Ft;if(cr.shouldTriggerCameraMotion({energy:De,onBeat:!0,onSnare:!1})?cr.triggerCameraMotion():Wo.tryTriggerSequence({energy:De,onBeat:!0,onSnare:!1,beatPattern:["A","B","A","C"][oe.current]}),cr.shouldTriggerLighting({energy:De,onBeat:!0,onSnare:!1,frameUrl:O.current,cameraActive:Re})?cr.triggerLighting({cameraActive:Re,frameUrl:O.current}):Zo.analyzeAndTrigger({energy:De,onBeat:!0,frameUrl:O.current,stylePreset:n.selectedStyleId}),oe.current===0&&(x.current++,x.current%4===0)){const Ve=["ABAB","AABB","ABAC"];ct.current=Ve[Math.floor(Math.random()*Ve.length)]}if(!Ce){const st=Kv[ct.current][oe.current];let Bt=[];st==="A"?Bt=ye.low.length>0?ye.low:ye.mid:st==="B"?Bt=ye.mid.length>0?ye.mid:ye.high:st==="C"&&(Bt=ye.high),Bt.length===0&&(Bt=ye.low);const Yn=Bt.filter(dt=>dt!==O.current),Nt=Yn.length>0?Yn[Math.floor(Math.random()*Yn.length)]:Bt[Math.floor(Math.random()*Bt.length)];if(Nt&&Nt!==O.current){O.current=Nt,U(Lt=>({...Lt,intention:`PATTERN: ${ct.current}`,activePoseName:Nt,confidence:Math.round(Ne*100)}));const dt=n.superMode?1.15:1.08;rt.current=dt,F.current=n.superMode?20:15,ce.current=10,fe.current=.5}}}if(Je>_n&&it-H.current>Ni&&(H.current=it,Wo.tryTriggerSequence({energy:(Ne+Je+ot)/3,onBeat:!1,onSnare:!0,beatPattern:["A","B","A","C"][oe.current]}),Zo.analyzeAndTrigger({energy:(Ne+Je+ot)/3,onBeat:!1,onSnare:!0,frameUrl:O.current,stylePreset:n.selectedStyleId}),!Ce)){const De=ye.high.length>0?ye.high:ye.mid;if(De.length>0){const Ve=De[Math.floor(Math.random()*De.length)];O.current=Ve,U(st=>({...st,intention:"SNARE HIT",activePoseName:Ve}))}const Re=n.superMode?.9:.95;rt.current=Re,F.current=-15,we.current=.8}ot>.4&&Xt&&(W.current+=(Math.random()-.5)*4,Math.random()<.1&&(ke.current=.5));let rn=9999;if(fi>0&&(rn=Math.max(2,Math.round(32-fi/100*30))),Je>.6&&M.current>=rn&&!Ce){M.current=0,D.current=it+400;let De=Tn;if(De==="auto"){const Re=["shiver","jump","smash","slice"];De=Re[Math.floor(Math.random()*Re.length)]}N.current=De,U(Re=>({...Re,intention:`STUTTER: ${De.toUpperCase()}`})),ke.current=1,De==="jump"&&(F.current=-30),De==="smash"&&(rt.current=1.4),De==="slice"&&(we.current=1),De==="shiver"&&(Ge.current=50)}if(Ce&&it-ae.current>60){ae.current=it;const De=ye.high;switch(De.length>0&&(O.current=De[Math.floor(Math.random()*De.length)]),N.current){case"shiver":Ge.current=(Math.random()-.5)*150;break;case"jump":tt.current=(Math.random()-.5)*150;break;case"smash":rt.current=Math.random()>.5?1.3:.9;break;case"slice":we.current=1;break}}if(S.current){S.current.updateAudio({bass:Se,mid:Je,high:ot,energy:Se+Je});const De=-(he.current*1.5);S.current.render(De)}const Ue=(kn=p.current)==null?void 0:kn.getContext("2d"),vt=p.current;if(Ue&&vt){Ue.clearRect(0,0,vt.width,vt.height);const De=window.devicePixelRatio||1,Re=vt.getBoundingClientRect();(vt.width!==Re.width*De||vt.height!==Re.height*De)&&(vt.width=Re.width*De,vt.height=Re.height*De,Ue.scale(De,De));const Ve=di.current[O.current]||di.current.base;if(Ve){const st=1+he.current*.2,Bt=rt.current*st,Yn=Re.width,Nt=Re.height,dt=Yn/2,Lt=Nt/2,$n=(Oe,Wt,bn,Un,$t)=>{Ue.save(),Ue.translate(dt+W.current+Ge.current,Lt+ce.current+tt.current),Ue.rotate((Te.current+Un)*Math.PI/180);const pt=ie.current*Math.PI/180,wn=Math.abs(Math.cos(pt)),ei=F.current*Math.PI/180,Zt=Math.abs(Math.cos(ei));Ue.scale((Bt+$t)*wn,(Bt+$t)*Zt);const gi=Ve.width/Ve.height;let qt=Yn*.9,gt=qt/gi;if(gt>Nt*.9&&(gt=Nt*.9,qt=gt*gi),Oe!=="normal"&&(Ue.globalCompositeOperation="screen",Ue.globalAlpha=.8*fe.current),Oe==="red"?Ue.fillStyle="#FF0000":Oe==="blue"&&(Ue.fillStyle="#0000FF"),we.current>.05){const Ys=gt/10,Xi=Ve.height/10;for(let ti=0;ti<10;ti++){const Qi=(Math.random()-.5)*50*we.current;Ue.drawImage(Ve,0,ti*Xi,Ve.width,Xi,-qt/2+Qi+Wt,-gt/2+ti*Ys+bn,qt,Ys)}}else Ue.drawImage(Ve,-qt/2+Wt,-gt/2+bn,qt,gt);Ue.restore()};fe.current>.05&&($n("red",-4*fe.current,0,-1*fe.current,.02*fe.current),$n("blue",4*fe.current,0,1*fe.current,-.02*fe.current)),$n("normal",0,0,0,0);const Qt=Zn||Wn;if(Qt&&Qt.opacity>.05){Ue.save(),Ue.globalCompositeOperation=Qt.blendMode,Ue.globalAlpha=Qt.opacity;const[Oe,Wt,bn]=Qt.color.map($t=>Math.floor($t*255)),Un=Ue.createRadialGradient((Qt.position.x+1)*(Re.width/2),(Qt.position.y+1)*(Re.height/2),0,(Qt.position.x+1)*(Re.width/2),(Qt.position.y+1)*(Re.height/2),Qt.size*Re.width);Un.addColorStop(0,`rgba(${Oe}, ${Wt}, ${bn}, ${Qt.intensity})`),Un.addColorStop(1,`rgba(${Oe}, ${Wt}, ${bn}, 0)`),Ue.fillStyle=Un,Qt.blur>0&&(Ue.filter=`blur(${Qt.blur}px)`),Ue.fillRect(0,0,Re.width,Re.height),Ue.restore()}}}const Gn=16.6/1e3,At=n.superMode?14:10,Dn=1-Math.exp(-At*Gn),ve=1-Math.exp(-2*Gn);W.current*=1-Dn,ce.current*=1-Dn,rt.current=1+(rt.current-1)*(1-Dn),Te.current*=1-Dn,Ge.current*=1-Dn,tt.current*=1-Dn,F.current*=1-Dn,ie.current*=1-ve,we.current*=.8,ke.current*=.9,fe.current*=.95},[Xt,ye,It,fi,Tn,Ci,n.audioPreviewUrl,n.subjectCategory,n.superMode]);ee.useEffect(()=>(J.current=requestAnimationFrame(Co),()=>cancelAnimationFrame(J.current)),[Co]);const ma=ee.useCallback(async()=>{if(!qs){alert("Assets are still loading. Please wait a moment.");return}wt.current=new AbortController,hs({active:!0,progress:0,status:"Preparing Assets..."});try{const ue=ps==="4k"?3840:ps==="1080p"?1920:1280,Se=ps==="portrait"?1920:ue*9/16,Ne=document.createElement("canvas");Ne.width=ue,Ne.height=Se;const Je=Ne.getContext("2d");if(!Je)throw new Error("Could not create export canvas");const ot=document.createElement("canvas");ot.width=ue,ot.height=Se;const it=new um(ot);S.current&&(it.params={...S.current.params});const Ce=Ne.captureStream(Xn),Ye=new(window.AudioContext||window.webkitAudioContext),Sn=Ye.createMediaStreamDestination(),Ft=Ye.createAnalyser();Ft.fftSize=1024;let Wn=null,Zn=15;if(n.audioFile){const Re=await n.audioFile.arrayBuffer(),Ve=await Ye.decodeAudioData(Re);Zn=Ve.duration,Wn=Ye.createBufferSource(),Wn.buffer=Ve,Wn.connect(Sn),Wn.connect(Ft)}Sn.stream.getAudioTracks().length>0&&Ce.addTrack(Sn.stream.getAudioTracks()[0]);const gs=MediaRecorder.isTypeSupported("video/mp4; codecs=avc1")?"video/mp4; codecs=avc1":"video/webm",_n=new MediaRecorder(Ce,{mimeType:gs,videoBitsPerSecond:Hs}),Ni=[];_n.ondataavailable=Re=>{Re.data.size>0&&Ni.push(Re.data)},_n.onstop=()=>{const Re=new Blob(Ni,{type:gs}),Ve=URL.createObjectURL(Re),st=document.createElement("a");st.href=Ve,st.download=`jusDNCE-ai.web.app_${n.selectedStyleId}_${Date.now()}.${gs.includes("mp4")?"mp4":"webm"}`,document.body.appendChild(st),st.click(),document.body.removeChild(st),URL.revokeObjectURL(Ve),Za.updatePhase("complete","Video exported successfully! "),hs({active:!1,progress:100,status:"Done"}),Wn&&Wn.stop(),Ye.close()};const rn=Td[ji];let Ue,vt=0;rn.position==="full"?(Ue=Zn,vt=0):rn.position==="middle"?(Ue=Math.min(rn.durationSec,Zn),vt=Math.max(0,(Zn-Ue)/2)):rn.position==="end"?(Ue=Math.min(rn.durationSec,Zn),vt=Math.max(0,Zn-Ue)):(Ue=Math.min(rn.durationSec,Zn),vt=0),_n.start(),Wn&&Wn.start(0,vt,Ue);const Gn=performance.now(),At=Ue*1e3,Dn=Math.ceil(Ue*Xn);Za.startGeneration(Dn),Za.updatePhase("generating_frames","Processing video with enhanced choreography...");const ve={zoom:1,shake:{x:0,y:0},pan:{x:0,y:0},rot:0,tiltX:0,tiltY:0,lastBeat:0,lastSnare:0,targetPose:"base",tear:0,moire:0,dolly:0,beatsSinceStutter:0,beatCounter:0,barCounter:0,pattern:"ABAB"};let kn=9999;fi>0&&(kn=Math.max(2,Math.round(32-fi/100*30)));const De=()=>{var Un,$t;if((Un=wt.current)!=null&&Un.signal.aborted){_n.stop();return}const Re=performance.now(),Ve=Re-Gn;if(Ve>=At){_n.stop();return}hs(pt=>({...pt,progress:Math.floor(Ve/At*100),status:"Recording..."}));const st=Math.floor(Ve/At*Dn);Za.updateFrameProgress(st,Ve/st),Za.updateSystemProgress("choreography",Math.min(1,Ve/At));const Bt=new Uint8Array(Ft.frequencyBinCount);Ft.getByteFrequencyData(Bt);const Yn=Bt.slice(2,7).reduce((pt,wn)=>pt+wn,0)/5/255,Nt=Bt.slice(0,3).reduce((pt,wn)=>pt+wn,0)/3/255,dt=Bt.slice(40,90).reduce((pt,wn)=>pt+wn,0)/50/255,Lt=Bt.slice(200,400).reduce((pt,wn)=>pt+wn,0)/200/255;if(Yn>.65&&Re-ve.lastBeat>250){ve.lastBeat=Re,ve.beatsSinceStutter++,ve.beatCounter=(ve.beatCounter+1)%4;const pt=6e4/(Re-ve.lastBeat);if(Wo.updateBeatTiming(ve.beatCounter,pt),Zo.updateBeatTiming(ve.beatCounter,pt),$v.updateBPM(pt),ve.beatCounter===0&&(ve.barCounter++,ve.barCounter%4===0)){const qt=["ABAB","AABB","ABAC"];ve.pattern=qt[Math.floor(Math.random()*qt.length)]}const ei=Kv[ve.pattern][ve.beatCounter];let Zt=ye.low;ei==="A"?Zt=ye.low.length>0?ye.low:ye.mid:ei==="B"?Zt=ye.mid.length>0?ye.mid:ye.high:ei==="C"&&(Zt=ye.high),Zt.length===0&&(Zt=ye.low);const gi=Zt.filter(qt=>qt!==ve.targetPose);ve.targetPose=gi.length>0?gi[Math.floor(Math.random()*gi.length)]:Zt[Math.floor(Math.random()*Zt.length)],ve.shake={x:(Math.random()-.5)*15,y:(Math.random()-.5)*15},ve.zoom=n.superMode?1.15:1.08,ve.tiltX=n.superMode?20:15}if(dt>.5&&Re-ve.lastSnare>250){ve.lastSnare=Re;const pt=ye.high.length>0?ye.high:ye.mid;pt.length>0&&(ve.targetPose=pt[Math.floor(Math.random()*pt.length)]),ve.zoom=n.superMode?.9:.95,ve.tiltX=-15,ve.tear=.8}dt>.6&&ve.beatsSinceStutter>=kn&&(ve.beatsSinceStutter=0,(Tn==="shiver"||Tn==="auto")&&(ve.pan.x=50),Tn==="jump"&&(ve.pan.y=50),Tn==="smash"&&(ve.zoom=1.4),Tn==="slice"&&(ve.tear=1));const $n=1/Xn,Qt=n.superMode?14:10,Oe=1-Math.exp(-Qt*$n);ve.shake.x*=Oe,ve.shake.y*=Oe,ve.pan.x*=Oe,ve.pan.y*=Oe,ve.zoom+=(1-ve.zoom)*Oe,ve.tiltX*=Oe,ve.tiltY*=Oe,ve.tear*=.8,it.updateAudio({bass:Nt,mid:dt,high:Lt,energy:Nt+dt}),it.render(-(ve.dolly*1.5)),Je.drawImage(ot,0,0);const Wt=di.current[ve.targetPose]||di.current.base;if(Wt&&Je){const pt=ue/2+ve.shake.x+ve.pan.x,wn=Se/2+ve.shake.y+ve.pan.y,ei=ve.zoom;Je.save(),Je.translate(pt,wn);const Zt=Math.cos(ve.tiltY*Math.PI/180),gi=Math.cos(ve.tiltX*Math.PI/180);Je.scale(ei*Zt,ei*gi);const qt=Wt.width/Wt.height;let gt=ue*.9,yi=gt/qt;if(yi>Se*.9&&(yi=Se*.9,gt=yi*qt),ve.tear>.1){const Xi=yi/10,ti=Wt.height/10;for(let Qi=0;Qi<10;Qi++){const ys=(Math.random()-.5)*50*ve.tear;Je.drawImage(Wt,0,Qi*ti,Wt.width,ti,-gt/2+ys,-yi/2+Qi*Xi,gt,Xi)}}else Je.drawImage(Wt,-gt/2,-yi/2,gt,yi);Je.restore()}if(!(($t=n.user)!=null&&$t.isSubscriber)&&!Ut){const pt=PI(Bt);kI(Je,ue,Se,pt,Ve)}requestAnimationFrame(De)};De()}catch(ue){console.error(ue),hs({active:!1,progress:0,status:"Error"}),alert("Export failed: "+ue)}},[qs,ps,Xn,Hs,ji,n.audioFile,ye,n.selectedStyleId,fi,Tn,n.superMode,Ut,(ga=n.user)==null?void 0:ga.isSubscriber]),Ri=()=>{var ue;if(n.superMode){if(!((ue=n.user)!=null&&ue.isSubscriber)){alert("Super Mode re-exports require a Pro subscription. Upgrade to unlock unlimited re-exports!");return}u()}else{if(!t(Is.RE_EXPORT)){alert(`Re-export requires ${Is.RE_EXPORT} credit. Purchase credits to continue!`);return}u()}},Gs=()=>{var Ye;if(!t(Is.WIDGET_PURCHASE)){alert(`Widget export requires ${Is.WIDGET_PURCHASE} credits. Purchase credits to continue!`);return}const Se=as.find(Sn=>Sn.id===n.selectedStyleId),Ne=n.generatedFrames.length>0?n.generatedFrames:[{url:n.imagePreviewUrl||"",pose:"base",energy:"low",type:"body"}],Je=LI(Ne,(Se==null?void 0:Se.hologramParams)||{},n.subjectCategory,((Ye=n.user)==null?void 0:Ye.isSubscriber)||!1),ot=new Blob([Je],{type:"text/html"}),it=URL.createObjectURL(ot),Ce=document.createElement("a");Ce.href=it,Ce.download=`jusDNCE-ai.web.app_MyDancer_${Date.now()}.html`,document.body.appendChild(Ce),Ce.click(),document.body.removeChild(Ce),URL.revokeObjectURL(it)};return T.jsxs("div",{className:"flex flex-col h-full relative",ref:_,children:[!Rt&&T.jsxs("div",{className:"flex flex-col xl:flex-row items-center justify-between p-4 bg-black/80 border-b border-white/10 backdrop-blur-xl z-20 gap-4",children:[T.jsxs("div",{className:"flex items-center gap-2 w-full xl:w-auto justify-center",children:[T.jsxs("div",{className:"flex items-center gap-2 bg-black/40 p-1.5 rounded-xl border border-white/10",children:[T.jsxs("button",{onClick:a,className:"px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all flex items-center gap-2 font-bold text-xs",title:"Start fresh with new assets",children:[T.jsx(zx,{size:16})," ",T.jsx("span",{className:"hidden sm:inline",children:"NEW"})]}),T.jsxs("button",{onClick:Ri,className:"px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all flex items-center gap-2 font-bold text-xs",title:n.superMode?"Tweak (Pro subscribers only)":`Tweak (${Is.RE_EXPORT} credit)`,children:[T.jsx(cI,{size:16})," ",T.jsx("span",{className:"hidden sm:inline",children:"TWEAK"})]})]}),T.jsxs("div",{className:"flex items-center gap-2 bg-white/5 p-1.5 rounded-xl border border-white/5",children:[T.jsx("button",{onClick:Ii,className:`px-3 py-2 rounded-lg transition-all flex items-center gap-2 font-bold text-xs ${Ci?"bg-red-500 text-white shadow-lg animate-pulse":"text-gray-400 hover:text-white hover:bg-white/10"}`,children:Ci?T.jsxs(T.Fragment,{children:[T.jsx(Wx,{size:16})," ",T.jsx("span",{className:"hidden sm:inline",children:"MIC ON"})]}):T.jsxs(T.Fragment,{children:[T.jsx(ib,{size:16})," ",T.jsx("span",{className:"hidden sm:inline",children:"MIC"})]})}),T.jsxs("button",{onClick:()=>{var ue;return(ue=E.current)==null?void 0:ue.click()},className:"px-3 py-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all flex items-center gap-2 font-bold text-xs",children:[T.jsx(Wm,{size:16})," ",T.jsx("span",{className:"hidden sm:inline",children:"SONG"})]}),T.jsx("input",{type:"file",ref:E,onChange:ue=>{var Se;(Se=ue.target.files)!=null&&Se[0]&&i(ue.target.files[0])},className:"hidden",accept:"audio/*"})]})]}),T.jsxs("div",{className:"flex items-center gap-4 w-full xl:w-auto justify-center",children:[T.jsx("button",{onClick:mi,className:`
                        px-10 py-3 rounded-full font-black text-white shadow-lg transition-transform hover:scale-105 flex items-center gap-3 tracking-wider
                        ${Xt?"bg-yellow-500 hover:bg-yellow-400":"bg-brand-600 hover:bg-brand-500"}
                    `,children:Xt?T.jsxs(T.Fragment,{children:[T.jsx(sb,{size:24,fill:"currentColor"})," PAUSE STREAM"]}):T.jsxs(T.Fragment,{children:[T.jsx(mh,{size:24,fill:"currentColor"})," START PLAYBACK"]})}),T.jsx("button",{onClick:()=>br(!$i),className:`p-3 rounded-full hover:bg-white/10 transition-all ${$i?"bg-white/10 text-white":"text-gray-400"}`,title:"Motion & Physics",children:T.jsx(lm,{size:20})}),T.jsx("button",{onClick:()=>Ki(!0),className:"p-3 text-gray-400 hover:text-white hover:bg-white/5 rounded-full",title:"Zen Mode",children:T.jsx(Xx,{size:20})})]}),T.jsxs("div",{className:"flex items-center gap-3 w-full xl:w-auto justify-center bg-black/40 p-2 rounded-xl border border-white/10",children:[T.jsxs("button",{onClick:ma,disabled:Ji.active,className:`
                        px-6 py-2.5 rounded-lg font-black flex items-center gap-2 text-xs transition-all shadow-lg hover:scale-105 border border-brand-500/20
                        ${Ji.active?"bg-gray-800 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-brand-600 to-purple-600 text-white hover:brightness-110"}
                    `,children:[Ji.active?T.jsx(Hd,{size:16,className:"animate-spin"}):T.jsx(nb,{size:16}),"DOWNLOAD VIDEO"]}),T.jsxs("div",{className:"relative",children:[T.jsxs("button",{onClick:()=>fs(!fn),className:`px-3 py-2.5 rounded-lg hover:bg-white/10 text-gray-400 transition-colors flex items-center gap-2 text-xs font-bold border border-transparent hover:border-white/10 ${fn?"bg-white/10 text-white":""}`,children:[T.jsx(mI,{size:14})," OPTIONS"]}),fn&&T.jsxs("div",{className:"absolute top-full right-0 mt-3 w-72 bg-black/95 backdrop-blur-xl border border-white/20 rounded-xl p-5 shadow-2xl z-50 animate-fade-in",children:[T.jsxs("div",{className:"flex justify-between items-center mb-4 border-b border-white/10 pb-2",children:[T.jsxs("h4",{className:"text-white text-xs font-bold flex items-center gap-2",children:[T.jsx(kx,{size:14})," FORMAT SETTINGS"]}),T.jsx("button",{onClick:()=>fs(!1),children:T.jsx(so,{size:14,className:"text-gray-400 hover:text-white"})})]}),T.jsxs("div",{className:"space-y-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"text-[10px] text-gray-400 font-bold block mb-1.5 uppercase",children:"Output Duration"}),T.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.keys(Td).map(ue=>{const Se=Td[ue];return T.jsxs("button",{onClick:()=>Ao(ue),className:`py-2 text-[10px] font-bold rounded-lg border transition-all flex flex-col items-center gap-0.5 ${ji===ue?"bg-brand-500/20 border-brand-500 text-white":"border-white/10 text-gray-400 hover:bg-white/5"}`,children:[T.jsx("span",{children:Se.label}),T.jsxs("span",{className:`text-[8px] ${ji===ue?"text-brand-300":"text-gray-600"}`,children:[Se.credits,"cr"]})]},ue)})})]}),!((ms=n.user)!=null&&ms.isSubscriber)&&T.jsx("div",{className:"p-3 rounded-lg border border-yellow-500/30 bg-yellow-900/10",children:T.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[T.jsxs("div",{children:[T.jsx("span",{className:"text-[10px] text-yellow-400 font-bold uppercase",children:"Remove Watermark"}),T.jsx("p",{className:"text-[8px] text-gray-500 mt-0.5",children:"2x credit cost"})]}),T.jsxs("div",{className:"relative",children:[T.jsx("input",{type:"checkbox",checked:Ut,onChange:ue=>Qn(ue.target.checked),className:"sr-only"}),T.jsx("div",{className:`w-10 h-5 rounded-full transition-colors ${Ut?"bg-yellow-500":"bg-gray-600"}`,children:T.jsx("div",{className:`absolute top-0.5 left-0.5 w-4 h-4 bg-white rounded-full transition-transform ${Ut?"translate-x-5":""}`})})]})]})}),T.jsxs("div",{className:"p-2 rounded-lg bg-brand-500/10 border border-brand-500/30 flex justify-between items-center",children:[T.jsx("span",{className:"text-[10px] text-brand-300 font-bold",children:"TOTAL COST"}),T.jsx("span",{className:"text-sm text-white font-black",children:(()=>{var Ne;const ue=Td[ji].credits,Se=!((Ne=n.user)!=null&&Ne.isSubscriber)&&Ut?2:1;return`${ue*Se} credits`})()})]}),T.jsxs("div",{children:[T.jsx("label",{className:"text-[10px] text-gray-400 font-bold block mb-1.5 uppercase",children:"Resolution"}),T.jsx("div",{className:"grid grid-cols-2 gap-2",children:["720p","1080p","4k","portrait"].map(ue=>T.jsx("button",{onClick:()=>fa(ue),className:`py-1.5 text-[10px] font-bold rounded border transition-all uppercase ${ps===ue?"bg-brand-500/20 border-brand-500 text-white":"border-white/10 text-gray-500 hover:text-gray-300"}`,children:ue},ue))})]}),T.jsxs("div",{children:[T.jsx("label",{className:"text-[10px] text-gray-400 font-bold block mb-1.5 uppercase",children:"Frame Rate"}),T.jsx("div",{className:"flex bg-white/5 rounded-lg p-1",children:[24,30,60].map(ue=>T.jsxs("button",{onClick:()=>Pl(ue),className:`flex-1 py-1 text-[10px] font-bold rounded ${Xn===ue?"bg-brand-600 text-white shadow-md":"text-gray-400 hover:text-white"}`,children:[ue," FPS"]},ue))})]}),T.jsxs("div",{children:[T.jsxs("div",{className:"flex justify-between mb-1",children:[T.jsx("label",{className:"text-[10px] text-gray-400 font-bold uppercase",children:"Quality (Bitrate)"}),T.jsxs("span",{className:"text-[10px] text-brand-300 font-mono",children:[(Hs/1e6).toFixed(1)," Mbps"]})]}),T.jsx("input",{type:"range",min:"1000000",max:"20000000",step:"1000000",value:Hs,onChange:ue=>hi(Number(ue.target.value)),className:"w-full h-1.5 bg-white/10 rounded-full appearance-none cursor-pointer accent-brand-500"})]})]})]})]}),T.jsxs("button",{onClick:Gs,className:"px-4 py-2.5 rounded-lg bg-white/5 hover:bg-white/10 text-gray-300 hover:text-brand-300 transition-all border border-white/10 hover:border-brand-500/30 flex items-center gap-2 text-xs font-bold",title:`Save standalone widget (${Is.WIDGET_PURCHASE} credits${(Ar=n.user)!=null&&Ar.isSubscriber?", no watermark":", watermarked"})`,children:[T.jsx(sI,{size:16})," SAVE WIDGET (",Is.WIDGET_PURCHASE,"cr)"]})]})]}),T.jsxs("div",{className:"flex-1 relative overflow-hidden flex items-center justify-center bg-black",children:[T.jsx("canvas",{ref:f,className:"absolute inset-0 w-full h-full object-cover z-0"}),T.jsx("div",{className:"relative z-10 w-full max-w-2xl aspect-[9/16] pointer-events-none flex items-center justify-center",children:T.jsx("canvas",{ref:p,className:"w-full h-full"})}),Rt&&T.jsx("button",{onClick:()=>Ki(!1),className:"absolute top-4 right-4 z-50 p-3 bg-black/50 backdrop-blur-md rounded-full text-white hover:bg-white/20 transition-all border border-white/10",children:T.jsx(tI,{size:24})}),!Rt&&$i&&T.jsxs("div",{className:"absolute top-20 right-4 z-40 w-72 bg-black/90 backdrop-blur-xl border border-white/20 rounded-2xl p-5 shadow-2xl animate-slide-in-right",children:[T.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-white/10 pb-4",children:[T.jsxs("h4",{className:"text-white font-bold flex items-center gap-2",children:[T.jsx(lm,{size:18})," PHYSICS & LOGIC"]}),T.jsx("button",{onClick:()=>br(!1),children:T.jsx(so,{size:18,className:"text-gray-400 hover:text-white"})})]}),T.jsxs("div",{className:"space-y-6",children:[T.jsxs("div",{children:[T.jsx("label",{className:"text-xs text-gray-400 font-bold mb-2 block",children:"MOTION SMOOTHNESS"}),T.jsx("input",{type:"range",min:"0",max:"200",value:pa,onChange:ue=>wr(Number(ue.target.value)),className:"w-full h-1.5 bg-white/20 rounded-lg appearance-none cursor-pointer accent-brand-500"})]}),T.jsxs("div",{className:"p-3 bg-white/5 rounded-xl",children:[T.jsxs("label",{className:"text-xs text-gray-400 font-bold mb-2 flex justify-between",children:[T.jsx("span",{children:"STUTTER RHYTHM"}),T.jsxs("span",{className:"text-red-400 font-mono",children:[fi,"%"]})]}),T.jsx("input",{type:"range",min:"0",max:"100",value:fi,onChange:ue=>xi(Number(ue.target.value)),className:"w-full h-1.5 bg-white/20 rounded-lg appearance-none cursor-pointer accent-red-500 mb-3"}),T.jsx("label",{className:"text-xs text-gray-400 font-bold mb-2 block",children:"STYLE"}),T.jsx("div",{className:"grid grid-cols-2 gap-2",children:["auto","shiver","jump","smash"].map(ue=>T.jsx("button",{onClick:()=>Yt(ue),className:`text-[10px] font-bold py-1 rounded border ${Tn===ue?"bg-red-500/20 border-red-500 text-white":"border-white/10 text-gray-500"}`,children:ue.toUpperCase()},ue))})]}),n.superMode&&T.jsxs("div",{className:"p-3 bg-brand-500/10 border border-brand-500/30 rounded-lg",children:[T.jsxs("h5",{className:"text-brand-300 font-bold text-xs flex items-center gap-2 mb-1",children:[T.jsx(fl,{size:10})," SUPER MODE ACTIVE"]}),T.jsx("p",{className:"text-[10px] text-gray-400",children:"Lip Sync & Triplets enabled."})]}),T.jsx("div",{className:"pt-4 border-t border-white/10",children:T.jsxs("button",{onClick:o,className:"w-full py-3 bg-white/5 hover:bg-white/10 rounded-xl text-xs font-bold text-white flex items-center justify-center gap-2 border border-white/10",children:[T.jsx(na,{size:14})," SAVE PROJECT FILE"]})})]})]}),!Rt&&T.jsx("div",{className:"absolute bottom-4 left-4 z-30 pointer-events-none opacity-50 hover:opacity-100 transition-opacity",children:T.jsxs("div",{className:"bg-black/60 backdrop-blur-md p-3 rounded-xl border border-white/10 text-xs font-mono space-y-1",children:[T.jsxs("div",{className:"flex items-center gap-2 text-brand-300 font-bold",children:[T.jsx(ZS,{size:12})," ",P.activePoseName]}),T.jsx("div",{className:"text-gray-400",children:P.intention}),T.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[T.jsxs("span",{className:"text-gray-600",children:["BAR ",x.current%4+1]}),T.jsx("div",{className:"w-10 h-1 bg-gray-700 rounded-full overflow-hidden",children:T.jsx("div",{className:"h-full bg-brand-500 transition-all duration-100",style:{width:`${P.confidence}%`}})})]}),(()=>{var Se;const ue=cr.getSessionInfo();return ue?T.jsxs("div",{className:"text-xs text-purple-400 border-t border-white/10 pt-2 mt-2",children:[T.jsxs("div",{children:[" ",ue.pattern||"Legacy"]}),T.jsxs("div",{children:[" ",(Se=ue.detected_bpm)==null?void 0:Se.toFixed(0),"BPM ",ue.energy_trend]})]}):null})()]})}),!n.user&&!Rt&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"absolute inset-0 z-20 pointer-events-none overflow-hidden",children:T.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:T.jsx("div",{className:"transform -rotate-45 whitespace-nowrap",children:T.jsx("div",{className:"flex items-center gap-8 opacity-20",children:[...Array(5)].map((ue,Se)=>T.jsx("span",{className:"text-white text-4xl font-black tracking-widest",children:"jusDNCE"},Se))})})})}),T.jsx("div",{className:"absolute bottom-4 right-4 z-30 pointer-events-auto",children:T.jsxs("div",{className:"bg-gradient-to-r from-brand-600/90 to-purple-600/90 backdrop-blur-xl p-4 rounded-2xl border border-white/20 shadow-2xl max-w-xs animate-slide-in-right",children:[T.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[T.jsx("div",{className:"bg-white/20 p-2 rounded-lg",children:T.jsx(Fv,{size:18,className:"text-white"})}),T.jsxs("div",{children:[T.jsx("h4",{className:"text-white font-bold text-sm",children:"Love your dance?"}),T.jsx("p",{className:"text-white/70 text-xs",children:"Sign up FREE to remove watermark & download!"})]})]}),T.jsxs("div",{className:"flex gap-2",children:[T.jsxs("button",{onClick:()=>{const ue="Check out my AI dance animation made with jusDNCE!",Se="https://jusdnce-ai.web.app";navigator.share?navigator.share({title:"My jusDNCE Creation",text:ue,url:Se}):(navigator.clipboard.writeText(`${ue} ${Se}`),alert("Link copied to clipboard!"))},className:"flex-1 px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2",children:[T.jsx(Fv,{size:14})," SHARE"]}),T.jsxs("button",{onClick:d,className:"flex-1 px-4 py-2 bg-white text-brand-700 hover:bg-brand-50 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-2",children:[T.jsx(am,{size:14})," SIGN UP"]})]})]})})]})]}),Ji.active&&T.jsxs("div",{className:"absolute bottom-6 right-6 z-50 bg-gray-900/95 backdrop-blur-xl border border-brand-500/30 p-5 rounded-2xl shadow-2xl flex items-center gap-5 animate-slide-in-right max-w-sm",children:[T.jsxs("div",{className:"relative",children:[T.jsx("div",{className:"absolute inset-0 bg-brand-500/20 rounded-full animate-ping"}),T.jsx(Hd,{size:32,className:"text-brand-400 animate-spin relative z-10"})]}),T.jsxs("div",{className:"flex-1 min-w-[200px]",children:[T.jsxs("h4",{className:"text-white font-bold text-sm mb-1 flex justify-between",children:[T.jsx("span",{children:"RENDERING VIDEO"}),T.jsxs("span",{className:"text-brand-300",children:[Ji.progress,"%"]})]}),T.jsx("div",{className:"w-full h-2 bg-gray-800 rounded-full overflow-hidden",children:T.jsx("div",{className:"h-full bg-brand-500 transition-all duration-300",style:{width:`${Ji.progress}%`}})}),T.jsx("p",{className:"text-[10px] text-gray-500 mt-2 font-mono",children:Ji.status})]}),T.jsx("button",{onClick:()=>{var ue;(ue=wt.current)==null||ue.abort(),hs({active:!1,progress:0,status:"Cancelled"})},className:"p-2 hover:bg-white/10 rounded-full text-gray-400 hover:text-white transition-colors",children:T.jsx(so,{size:18})})]})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let jI,XI;function QI(){return{geminiUrl:jI,vertexUrl:XI}}function WI(n,e,t,i){var o,a;if(!(n!=null&&n.baseUrl)){const u=QI();return e?(o=u.vertexUrl)!==null&&o!==void 0?o:t:(a=u.geminiUrl)!==null&&a!==void 0?a:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Tr{}function pe(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,o)=>{if(Object.prototype.hasOwnProperty.call(e,o)){const a=e[o];return a!=null?String(a):""}else throw new Error(`Key '${o}' not found in valueMap.`)})}function m(n,e,t){for(let a=0;a<e.length-1;a++){const u=e[a];if(u.endsWith("[]")){const d=u.slice(0,-2);if(!(d in n))if(Array.isArray(t))n[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${u}`);if(Array.isArray(n[d])){const f=n[d];if(Array.isArray(t))for(let p=0;p<f.length;p++){const _=f[p];m(_,e.slice(a+1),t[p])}else for(const p of f)m(p,e.slice(a+1),t)}return}else if(u.endsWith("[0]")){const d=u.slice(0,-3);d in n||(n[d]=[{}]);const f=n[d];m(f[0],e.slice(a+1),t);return}(!n[u]||typeof n[u]!="object")&&(n[u]={}),n=n[u]}const i=e[e.length-1],o=n[i];if(o!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===o)return;if(typeof o=="object"&&typeof t=="object"&&o!==null&&t!==null)Object.assign(o,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function h(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const o=e[i];if(o.endsWith("[]")){const a=o.slice(0,-2);if(a in n){const u=n[a];return Array.isArray(u)?u.map(d=>h(d,e.slice(i+1),t)):t}else return t}else n=n[o]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function ZI(n,e){for(const[t,i]of Object.entries(e)){const o=t.split("."),a=i.split("."),u=new Set;let d=-1;for(let f=0;f<o.length;f++)if(o[f]==="*"){d=f;break}if(d!==-1&&a.length>d)for(let f=d;f<a.length;f++){const p=a[f];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&u.add(p)}cm(n,o,a,0,u)}}function cm(n,e,t,i,o){if(i>=e.length||typeof n!="object"||n===null)return;const a=e[i];if(a.endsWith("[]")){const u=a.slice(0,-2),d=n;if(u in d&&Array.isArray(d[u]))for(const f of d[u])cm(f,e,t,i+1,o)}else if(a==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const u=n,d=Object.keys(u).filter(p=>!p.startsWith("_")&&!o.has(p)),f={};for(const p of d)f[p]=u[p];for(const[p,_]of Object.entries(f)){const E=[];for(const S of t.slice(i))S==="*"?E.push(p):E.push(S);m(u,E,_)}for(const p of d)delete u[p]}}else{const u=n;a in u&&cm(u[a],e,t,i+1,o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tg(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eR(n){const e={},t=h(n,["operationName"]);t!=null&&m(e,["operationName"],t);const i=h(n,["resourceName"]);return i!=null&&m(e,["_url","resourceName"],i),e}function tR(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const o=h(n,["done"]);o!=null&&m(e,["done"],o);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const u=h(n,["response","generateVideoResponse"]);return u!=null&&m(e,["response"],iR(u)),e}function nR(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const o=h(n,["done"]);o!=null&&m(e,["done"],o);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const u=h(n,["response"]);return u!=null&&m(e,["response"],sR(u)),e}function iR(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>rR(u))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&m(e,["raiMediaFilteredReasons"],o),e}function sR(n){const e={},t=h(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>oR(u))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&m(e,["raiMediaFilteredReasons"],o),e}function rR(n){const e={},t=h(n,["video"]);return t!=null&&m(e,["video"],hR(t)),e}function oR(n){const e={},t=h(n,["_self"]);return t!=null&&m(e,["video"],fR(t)),e}function aR(n){const e={},t=h(n,["operationName"]);return t!=null&&m(e,["_url","operationName"],t),e}function lR(n){const e={},t=h(n,["operationName"]);return t!=null&&m(e,["_url","operationName"],t),e}function uR(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const o=h(n,["done"]);o!=null&&m(e,["done"],o);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const u=h(n,["response"]);return u!=null&&m(e,["response"],cR(u)),e}function cR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["parent"]);i!=null&&m(e,["parent"],i);const o=h(n,["documentName"]);return o!=null&&m(e,["documentName"],o),e}function lb(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const o=h(n,["done"]);o!=null&&m(e,["done"],o);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const u=h(n,["response"]);return u!=null&&m(e,["response"],dR(u)),e}function dR(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["parent"]);i!=null&&m(e,["parent"],i);const o=h(n,["documentName"]);return o!=null&&m(e,["documentName"],o),e}function hR(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["uri"],t);const i=h(n,["encodedVideo"]);i!=null&&m(e,["videoBytes"],tg(i));const o=h(n,["encoding"]);return o!=null&&m(e,["mimeType"],o),e}function fR(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&m(e,["videoBytes"],tg(i));const o=h(n,["mimeType"]);return o!=null&&m(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Jv;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Jv||(Jv={}));var jv;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(jv||(jv={}));var Xv;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(Xv||(Xv={}));var zn;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(zn||(zn={}));var Qv;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Qv||(Qv={}));var Wv;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Wv||(Wv={}));var Zv;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Zv||(Zv={}));var eE;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(eE||(eE={}));var tE;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(tE||(tE={}));var nE;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(nE||(nE={}));var iE;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(iE||(iE={}));var sE;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(sE||(sE={}));var rE;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(rE||(rE={}));var oE;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(oE||(oE={}));var aE;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(aE||(aE={}));var lE;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(lE||(lE={}));var uE;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(uE||(uE={}));var cE;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(cE||(cE={}));var dE;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(dE||(dE={}));var Gd;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Gd||(Gd={}));var hE;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(hE||(hE={}));var fE;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(fE||(fE={}));var pE;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(pE||(pE={}));var dm;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(dm||(dm={}));var mE;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(mE||(mE={}));var gE;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(gE||(gE={}));var yE;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(yE||(yE={}));var _E;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(_E||(_E={}));var vE;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(vE||(vE={}));var EE;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(EE||(EE={}));var TE;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(TE||(TE={}));var SE;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(SE||(SE={}));var bE;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(bE||(bE={}));var wE;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(wE||(wE={}));var AE;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(AE||(AE={}));var CE;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(CE||(CE={}));var xE;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(xE||(xE={}));var IE;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(IE||(IE={}));var RE;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(RE||(RE={}));var NE;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(NE||(NE={}));var ME;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(ME||(ME={}));var PE;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(PE||(PE={}));var DE;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(DE||(DE={}));var kE;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(kE||(kE={}));var UE;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(UE||(UE={}));var LE;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(LE||(LE={}));var VE;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(VE||(VE={}));var OE;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(OE||(OE={}));var zE;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(zE||(zE={}));var FE;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(FE||(FE={}));var BE;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(BE||(BE={}));var qE;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(qE||(qE={}));var HE;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(HE||(HE={}));var GE;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(GE||(GE={}));var sl;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(sl||(sl={}));class hm{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class bu{get text(){var e,t,i,o,a,u,d,f;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",_=!1;const E=[];for(const S of(f=(d=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[C,k]of Object.entries(S))C!=="text"&&C!=="thought"&&C!=="thoughtSignature"&&(k!==null||k!==void 0)&&E.push(C);if(typeof S.text=="string"){if(typeof S.thought=="boolean"&&S.thought)continue;_=!0,p+=S.text}}return E.length>0&&console.warn(`there are non-text parts ${E} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),_?p:void 0}get data(){var e,t,i,o,a,u,d,f;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const _=[];for(const E of(f=(d=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[S,C]of Object.entries(E))S!=="inlineData"&&(C!==null||C!==void 0)&&_.push(S);E.inlineData&&typeof E.inlineData.data=="string"&&(p+=atob(E.inlineData.data))}return _.length>0&&console.warn(`there are non-data parts ${_} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,o,a,u,d,f;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(f=(d=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(_=>_.functionCall).map(_=>_.functionCall).filter(_=>_!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,t,i,o,a,u,d,f,p;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const _=(f=(d=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(E=>E.executableCode).map(E=>E.executableCode).filter(E=>E!==void 0);if((_==null?void 0:_.length)!==0)return(p=_==null?void 0:_[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,o,a,u,d,f,p;if(((o=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||o===void 0?void 0:o.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const _=(f=(d=(u=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(E=>E.codeExecutionResult).map(E=>E.codeExecutionResult).filter(E=>E!==void 0);if((_==null?void 0:_.length)!==0)return(p=_==null?void 0:_[0])===null||p===void 0?void 0:p.output}}class YE{}class $E{}class pR{}class mR{}class gR{}class yR{}class KE{}class JE{}class jE{}class _R{}class Yd{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Yd;let o;const a=e;return t?o=nR(a):o=tR(a),Object.assign(i,o),i}}class XE{}class QE{}class WE{}class vR{}class ER{}class TR{}class ng{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new ng,a=uR(e);return Object.assign(i,a),i}}class SR{}class bR{}class wR{}class ZE{}class AR{get text(){var e,t,i;let o="",a=!1;const u=[];for(const d of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[f,p]of Object.entries(d))f!=="text"&&f!=="thought"&&p!==null&&u.push(f);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;a=!0,o+=d.text}}return u.length>0&&console.warn(`there are non-text parts ${u} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?o:void 0}get data(){var e,t,i;let o="";const a=[];for(const u of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[d,f]of Object.entries(u))d!=="inlineData"&&f!==null&&a.push(d);u.inlineData&&typeof u.inlineData.data=="string"&&(o+=atob(u.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),o.length>0?btoa(o):void 0}}class CR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class ig{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new ig,a=lb(e);return Object.assign(i,a),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ut(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function ub(n,e){const t=ut(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function cb(n){return Array.isArray(n)?n.map(e=>$d(e)):[$d(n)]}function $d(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function db(n){const e=$d(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function hb(n){const e=$d(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function eT(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function fb(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>eT(e)):[eT(n)]}function fm(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function tT(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function nT(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function qn(n){if(n==null)throw new Error("ContentUnion is required");return fm(n)?n:{role:"user",parts:fb(n)}}function sg(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=qn(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=qn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>qn(t)):[qn(e)]}function Hi(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(tT(n)||nT(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[qn(n)]}const e=[],t=[],i=fm(n[0]);for(const o of n){const a=fm(o);if(a!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(o);else{if(tT(o)||nT(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(o)}}return i||e.push({role:"user",parts:fb(t)}),e}function xR(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(zn).includes(t[0].toUpperCase())?t[0].toUpperCase():zn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(zn).includes(i.toUpperCase())?i.toUpperCase():zn.TYPE_UNSPECIFIED})}}function rl(n){const e={},t=["items"],i=["anyOf"],o=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&xR(n.type,e);for(const[u,d]of Object.entries(n))if(d!=null)if(u=="type"){if(d==="null")throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(zn).includes(d.toUpperCase())?d.toUpperCase():zn.TYPE_UNSPECIFIED}else if(t.includes(u))e[u]=rl(d);else if(i.includes(u)){const f=[];for(const p of d){if(p.type=="null"){e.nullable=!0;continue}f.push(rl(p))}e[u]=f}else if(o.includes(u)){const f={};for(const[p,_]of Object.entries(d))f[p]=rl(_);e[u]=f}else{if(u==="additionalProperties")continue;e[u]=d}return e}function rg(n){return rl(n)}function og(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function ag(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function bl(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=rl(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=rl(e.response));return n}function wl(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function IR(n,e,t,i=1){const o=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:o?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:o?`${t}/${e}`:e}function Sr(n,e){if(typeof e!="string")throw new Error("name must be a string");return IR(n,e,"cachedContents")}function pb(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function _o(n){return tg(n)}function RR(n){return n!=null&&typeof n=="object"&&"name"in n}function NR(n){return n!=null&&typeof n=="object"&&"video"in n}function MR(n){return n!=null&&typeof n=="object"&&"uri"in n}function mb(n){var e;let t;if(RR(n)&&(t=n.name),!(MR(n)&&(t=n.uri,t===void 0))&&!(NR(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const o=t.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${t}`);t=o[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function gb(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function yb(n){for(const e of["models","tunedModels","publisherModels"])if(PR(n,e))return n[e];return[]}function PR(n,e){return n!==null&&typeof n=="object"&&e in n}function DR(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function kR(n,e={}){const t=[],i=new Set;for(const o of n){const a=o.name;if(i.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);i.add(a);const u=DR(o,e);u.functionDeclarations&&t.push(...u.functionDeclarations)}return{functionDeclarations:t}}function _b(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,o=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(o>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||o!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function UR(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function vb(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const o=t.inlinedResponses;if(!Array.isArray(o)||o.length===0)return n;let a=!1;for(const u of o){if(typeof u!="object"||u===null)continue;const f=u.response;if(typeof f!="object"||f===null)continue;if(f.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Al(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function Eb(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LR(n){const e={},t=h(n,["responsesFile"]);t!=null&&m(e,["fileName"],t);const i=h(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>g2(u))),m(e,["inlinedResponses"],a)}const o=h(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>u)),m(e,["inlinedEmbedContentResponses"],a)}return e}function VR(n){const e={},t=h(n,["predictionsFormat"]);t!=null&&m(e,["format"],t);const i=h(n,["gcsDestination","outputUriPrefix"]);i!=null&&m(e,["gcsUri"],i);const o=h(n,["bigqueryDestination","outputUri"]);return o!=null&&m(e,["bigqueryUri"],o),e}function OR(n){const e={},t=h(n,["format"]);t!=null&&m(e,["predictionsFormat"],t);const i=h(n,["gcsUri"]);i!=null&&m(e,["gcsDestination","outputUriPrefix"],i);const o=h(n,["bigqueryUri"]);if(o!=null&&m(e,["bigqueryDestination","outputUri"],o),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(h(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Rd(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata","displayName"]);i!=null&&m(e,["displayName"],i);const o=h(n,["metadata","state"]);o!=null&&m(e,["state"],Eb(o));const a=h(n,["metadata","createTime"]);a!=null&&m(e,["createTime"],a);const u=h(n,["metadata","endTime"]);u!=null&&m(e,["endTime"],u);const d=h(n,["metadata","updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(n,["metadata","model"]);f!=null&&m(e,["model"],f);const p=h(n,["metadata","output"]);return p!=null&&m(e,["dest"],LR(vb(p))),e}function pm(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["displayName"]);i!=null&&m(e,["displayName"],i);const o=h(n,["state"]);o!=null&&m(e,["state"],Eb(o));const a=h(n,["error"]);a!=null&&m(e,["error"],a);const u=h(n,["createTime"]);u!=null&&m(e,["createTime"],u);const d=h(n,["startTime"]);d!=null&&m(e,["startTime"],d);const f=h(n,["endTime"]);f!=null&&m(e,["endTime"],f);const p=h(n,["updateTime"]);p!=null&&m(e,["updateTime"],p);const _=h(n,["model"]);_!=null&&m(e,["model"],_);const E=h(n,["inputConfig"]);E!=null&&m(e,["src"],zR(E));const S=h(n,["outputConfig"]);S!=null&&m(e,["dest"],VR(vb(S)));const C=h(n,["completionStats"]);return C!=null&&m(e,["completionStats"],C),e}function zR(n){const e={},t=h(n,["instancesFormat"]);t!=null&&m(e,["format"],t);const i=h(n,["gcsSource","uris"]);i!=null&&m(e,["gcsUri"],i);const o=h(n,["bigquerySource","inputUri"]);return o!=null&&m(e,["bigqueryUri"],o),e}function FR(n,e){const t={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=h(e,["fileName"]);i!=null&&m(t,["fileName"],i);const o=h(e,["inlinedRequests"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>m2(n,u))),m(t,["requests","requests"],a)}return t}function BR(n){const e={},t=h(n,["format"]);t!=null&&m(e,["instancesFormat"],t);const i=h(n,["gcsUri"]);i!=null&&m(e,["gcsSource","uris"],i);const o=h(n,["bigqueryUri"]);if(o!=null&&m(e,["bigquerySource","inputUri"],o),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function qR(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function HR(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Al(n,i)),t}function GR(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Al(n,i)),t}function YR(n){const e={},t=h(n,["content"]);t!=null&&m(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&m(e,["citationMetadata"],$R(i));const o=h(n,["tokenCount"]);o!=null&&m(e,["tokenCount"],o);const a=h(n,["finishReason"]);a!=null&&m(e,["finishReason"],a);const u=h(n,["avgLogprobs"]);u!=null&&m(e,["avgLogprobs"],u);const d=h(n,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(n,["index"]);f!=null&&m(e,["index"],f);const p=h(n,["logprobsResult"]);p!=null&&m(e,["logprobsResult"],p);const _=h(n,["safetyRatings"]);if(_!=null){let S=_;Array.isArray(S)&&(S=S.map(C=>C)),m(e,["safetyRatings"],S)}const E=h(n,["urlContextMetadata"]);return E!=null&&m(e,["urlContextMetadata"],E),e}function $R(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),m(e,["citations"],i)}return e}function Tb(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(a=>b2(a))),m(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function KR(n,e){const t={},i=h(n,["displayName"]);if(e!==void 0&&i!=null&&m(e,["batch","displayName"],i),h(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function JR(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const o=h(n,["dest"]);return e!==void 0&&o!=null&&m(e,["outputConfig"],OR(UR(o))),t}function iT(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["src"]);o!=null&&m(t,["batch","inputConfig"],FR(n,_b(n,o)));const a=h(e,["config"]);return a!=null&&KR(a,t),t}function jR(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["model"],ut(n,i));const o=h(e,["src"]);o!=null&&m(t,["inputConfig"],BR(_b(n,o)));const a=h(e,["config"]);return a!=null&&JR(a,t),t}function XR(n,e){const t={},i=h(n,["displayName"]);return e!==void 0&&i!=null&&m(e,["batch","displayName"],i),t}function QR(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["src"]);o!=null&&m(t,["batch","inputConfig"],s2(n,o));const a=h(e,["config"]);return a!=null&&XR(a,t),t}function WR(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Al(n,i)),t}function ZR(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Al(n,i)),t}function e2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const o=h(n,["done"]);o!=null&&m(e,["done"],o);const a=h(n,["error"]);return a!=null&&m(e,["error"],a),e}function t2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const o=h(n,["done"]);o!=null&&m(e,["done"],o);const a=h(n,["error"]);return a!=null&&m(e,["error"],a),e}function n2(n,e){const t={},i=h(e,["contents"]);if(i!=null){let a=sg(n,i);Array.isArray(a)&&(a=a.map(u=>u)),m(t,["requests[]","request","content"],a)}const o=h(e,["config"]);return o!=null&&(m(t,["_self"],i2(o,t)),ZI(t,{"requests[].*":"requests[].request.*"})),t}function i2(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&m(e,["requests[]","taskType"],i);const o=h(n,["title"]);e!==void 0&&o!=null&&m(e,["requests[]","title"],o);const a=h(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&m(e,["requests[]","outputDimensionality"],a),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function s2(n,e){const t={},i=h(e,["fileName"]);i!=null&&m(t,["file_name"],i);const o=h(e,["inlinedRequests"]);return o!=null&&m(t,["requests"],n2(n,o)),t}function r2(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function o2(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const o=h(n,["name"]);if(o!=null&&m(e,["name"],o),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function a2(n){const e={},t=h(n,["mode"]);t!=null&&m(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);if(i!=null&&m(e,["allowedFunctionNames"],i),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function l2(n,e,t){const i={},o=h(e,["systemInstruction"]);t!==void 0&&o!=null&&m(t,["systemInstruction"],Tb(qn(o)));const a=h(e,["temperature"]);a!=null&&m(i,["temperature"],a);const u=h(e,["topP"]);u!=null&&m(i,["topP"],u);const d=h(e,["topK"]);d!=null&&m(i,["topK"],d);const f=h(e,["candidateCount"]);f!=null&&m(i,["candidateCount"],f);const p=h(e,["maxOutputTokens"]);p!=null&&m(i,["maxOutputTokens"],p);const _=h(e,["stopSequences"]);_!=null&&m(i,["stopSequences"],_);const E=h(e,["responseLogprobs"]);E!=null&&m(i,["responseLogprobs"],E);const S=h(e,["logprobs"]);S!=null&&m(i,["logprobs"],S);const C=h(e,["presencePenalty"]);C!=null&&m(i,["presencePenalty"],C);const k=h(e,["frequencyPenalty"]);k!=null&&m(i,["frequencyPenalty"],k);const V=h(e,["seed"]);V!=null&&m(i,["seed"],V);const z=h(e,["responseMimeType"]);z!=null&&m(i,["responseMimeType"],z);const J=h(e,["responseSchema"]);J!=null&&m(i,["responseSchema"],rg(J));const j=h(e,["responseJsonSchema"]);if(j!=null&&m(i,["responseJsonSchema"],j),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const Z=h(e,["safetySettings"]);if(t!==void 0&&Z!=null){let O=Z;Array.isArray(O)&&(O=O.map(D=>w2(D))),m(t,["safetySettings"],O)}const H=h(e,["tools"]);if(t!==void 0&&H!=null){let O=wl(H);Array.isArray(O)&&(O=O.map(D=>C2(bl(D)))),m(t,["tools"],O)}const ae=h(e,["toolConfig"]);if(t!==void 0&&ae!=null&&m(t,["toolConfig"],A2(ae)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const oe=h(e,["cachedContent"]);t!==void 0&&oe!=null&&m(t,["cachedContent"],Sr(n,oe));const x=h(e,["responseModalities"]);x!=null&&m(i,["responseModalities"],x);const M=h(e,["mediaResolution"]);M!=null&&m(i,["mediaResolution"],M);const N=h(e,["speechConfig"]);if(N!=null&&m(i,["speechConfig"],og(N)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=h(e,["thinkingConfig"]);P!=null&&m(i,["thinkingConfig"],P);const U=h(e,["imageConfig"]);return U!=null&&m(i,["imageConfig"],p2(U)),i}function u2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(p=>YR(p))),m(e,["candidates"],f)}const o=h(n,["modelVersion"]);o!=null&&m(e,["modelVersion"],o);const a=h(n,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const u=h(n,["responseId"]);u!=null&&m(e,["responseId"],u);const d=h(n,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function c2(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Al(n,i)),t}function d2(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Al(n,i)),t}function h2(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function f2(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function p2(n){const e={},t=h(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const i=h(n,["imageSize"]);if(i!=null&&m(e,["imageSize"],i),h(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(h(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function m2(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["request","model"],ut(n,i));const o=h(e,["contents"]);if(o!=null){let d=Hi(o);Array.isArray(d)&&(d=d.map(f=>Tb(f))),m(t,["request","contents"],d)}const a=h(e,["metadata"]);a!=null&&m(t,["metadata"],a);const u=h(e,["config"]);return u!=null&&m(t,["request","generationConfig"],l2(n,u,h(t,["request"],{}))),t}function g2(n){const e={},t=h(n,["response"]);t!=null&&m(e,["response"],u2(t));const i=h(n,["error"]);return i!=null&&m(e,["error"],i),e}function y2(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);if(e!==void 0&&o!=null&&m(e,["_query","pageToken"],o),h(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function _2(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);e!==void 0&&o!=null&&m(e,["_query","pageToken"],o);const a=h(n,["filter"]);return e!==void 0&&a!=null&&m(e,["_query","filter"],a),t}function v2(n){const e={},t=h(n,["config"]);return t!=null&&y2(t,e),e}function E2(n){const e={},t=h(n,["config"]);return t!=null&&_2(t,e),e}function T2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const o=h(n,["operations"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>Rd(u))),m(e,["batchJobs"],a)}return e}function S2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const o=h(n,["batchPredictionJobs"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>pm(u))),m(e,["batchJobs"],a)}return e}function b2(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const o=h(n,["executableCode"]);o!=null&&m(e,["executableCode"],o);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],r2(a));const u=h(n,["functionCall"]);u!=null&&m(e,["functionCall"],o2(u));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],qR(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const S=h(n,["videoMetadata"]);return S!=null&&m(e,["videoMetadata"],S),e}function w2(n){const e={},t=h(n,["category"]);if(t!=null&&m(e,["category"],t),h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=h(n,["threshold"]);return i!=null&&m(e,["threshold"],i),e}function A2(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],a2(t));const i=h(n,["retrievalConfig"]);return i!=null&&m(e,["retrievalConfig"],i),e}function C2(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const o=h(n,["computerUse"]);o!=null&&m(e,["computerUse"],o);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const u=h(n,["codeExecution"]);if(u!=null&&m(e,["codeExecution"],u),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],h2(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],f2(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var gr;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(gr||(gr={}));class ca{constructor(e,t,i,o){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,o)}init(e,t,i){var o,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let u={config:{}};!i||Object.keys(i).length===0?u={config:{}}:typeof i=="object"?u=Object.assign({},i):u=i,u.config&&(u.config.pageToken=t.nextPageToken),this.paramsInternal=u,this.pageInternalSize=(a=(o=u.config)===null||o===void 0?void 0:o.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class x2 extends Tr{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)},this.list=async(t={})=>new ca(gr.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=iT(this.apiClient,e),i=t._url,o=pe("{model}:batchGenerateContent",i),d=t.batch.inputConfig.requests,f=d.requests,p=[];for(const _ of f){const E=Object.assign({},_);if(E.systemInstruction){const S=E.systemInstruction;delete E.systemInstruction;const C=E.request;C.systemInstruction=S,E.request=C}p.push(E)}return d.requests=p,delete t.config,delete t._url,delete t._query,{path:o,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},o=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${o}`),i.dest===void 0){const a=this.getGcsUri(e),u=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?i.dest=`${a.slice(0,-6)}/dest`:i.dest=`${a}_dest_${o}`;else if(u)i.dest=`${u}_dest_${o}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=jR(this.apiClient,e);return d=pe("batchPredictionJobs",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),u.then(_=>pm(_))}else{const p=iT(this.apiClient,e);return d=pe("{model}:batchGenerateContent",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),u.then(_=>Rd(_))}}async createEmbeddingsInternal(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=QR(this.apiClient,e);return a=pe("{model}:asyncBatchEmbedContent",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>Rd(f))}}async get(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=d2(this.apiClient,e);return d=pe("batchPredictionJobs/{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),u.then(_=>pm(_))}else{const p=c2(this.apiClient,e);return d=pe("batches/{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),u.then(_=>Rd(_))}}async cancel(e){var t,i,o,a;let u="",d={};if(this.apiClient.isVertexAI()){const f=GR(this.apiClient,e);u=pe("batchPredictionJobs/{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const f=HR(this.apiClient,e);u=pe("batches/{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=E2(e);return d=pe("batchPredictionJobs",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=S2(_),S=new ZE;return Object.assign(S,E),S})}else{const p=v2(e);return d=pe("batches",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=T2(_),S=new ZE;return Object.assign(S,E),S})}}async delete(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=ZR(this.apiClient,e);return d=pe("batchPredictionJobs/{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>t2(_))}else{const p=WR(this.apiClient,e);return d=pe("batches/{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>e2(_))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function I2(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function sT(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(a=>Q2(a))),m(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function R2(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const o=h(n,["expireTime"]);e!==void 0&&o!=null&&m(e,["expireTime"],o);const a=h(n,["displayName"]);e!==void 0&&a!=null&&m(e,["displayName"],a);const u=h(n,["contents"]);if(e!==void 0&&u!=null){let _=Hi(u);Array.isArray(_)&&(_=_.map(E=>sT(E))),m(e,["contents"],_)}const d=h(n,["systemInstruction"]);e!==void 0&&d!=null&&m(e,["systemInstruction"],sT(qn(d)));const f=h(n,["tools"]);if(e!==void 0&&f!=null){let _=f;Array.isArray(_)&&(_=_.map(E=>Z2(E))),m(e,["tools"],_)}const p=h(n,["toolConfig"]);if(e!==void 0&&p!=null&&m(e,["toolConfig"],W2(p)),h(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function N2(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const o=h(n,["expireTime"]);e!==void 0&&o!=null&&m(e,["expireTime"],o);const a=h(n,["displayName"]);e!==void 0&&a!=null&&m(e,["displayName"],a);const u=h(n,["contents"]);if(e!==void 0&&u!=null){let E=Hi(u);Array.isArray(E)&&(E=E.map(S=>S)),m(e,["contents"],E)}const d=h(n,["systemInstruction"]);e!==void 0&&d!=null&&m(e,["systemInstruction"],qn(d));const f=h(n,["tools"]);if(e!==void 0&&f!=null){let E=f;Array.isArray(E)&&(E=E.map(S=>eN(S))),m(e,["tools"],E)}const p=h(n,["toolConfig"]);e!==void 0&&p!=null&&m(e,["toolConfig"],p);const _=h(n,["kmsKeyName"]);return e!==void 0&&_!=null&&m(e,["encryption_spec","kmsKeyName"],_),t}function M2(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["model"],ub(n,i));const o=h(e,["config"]);return o!=null&&R2(o,t),t}function P2(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["model"],ub(n,i));const o=h(e,["config"]);return o!=null&&N2(o,t),t}function D2(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Sr(n,i)),t}function k2(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Sr(n,i)),t}function U2(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function L2(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function V2(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function O2(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const o=h(n,["name"]);if(o!=null&&m(e,["name"],o),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function z2(n){const e={},t=h(n,["mode"]);t!=null&&m(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);if(i!=null&&m(e,["allowedFunctionNames"],i),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function F2(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&m(e,["description"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const o=h(n,["parameters"]);o!=null&&m(e,["parameters"],o);const a=h(n,["parametersJsonSchema"]);a!=null&&m(e,["parametersJsonSchema"],a);const u=h(n,["response"]);u!=null&&m(e,["response"],u);const d=h(n,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function B2(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Sr(n,i)),t}function q2(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Sr(n,i)),t}function H2(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function G2(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function Y2(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&m(e,["_query","pageToken"],o),t}function $2(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&m(e,["_query","pageToken"],o),t}function K2(n){const e={},t=h(n,["config"]);return t!=null&&Y2(t,e),e}function J2(n){const e={},t=h(n,["config"]);return t!=null&&$2(t,e),e}function j2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const o=h(n,["cachedContents"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>u)),m(e,["cachedContents"],a)}return e}function X2(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const o=h(n,["cachedContents"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>u)),m(e,["cachedContents"],a)}return e}function Q2(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const o=h(n,["executableCode"]);o!=null&&m(e,["executableCode"],o);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],V2(a));const u=h(n,["functionCall"]);u!=null&&m(e,["functionCall"],O2(u));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],I2(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const S=h(n,["videoMetadata"]);return S!=null&&m(e,["videoMetadata"],S),e}function W2(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],z2(t));const i=h(n,["retrievalConfig"]);return i!=null&&m(e,["retrievalConfig"],i),e}function Z2(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const o=h(n,["computerUse"]);o!=null&&m(e,["computerUse"],o);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const u=h(n,["codeExecution"]);if(u!=null&&m(e,["codeExecution"],u),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],H2(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],G2(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function eN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>F2(S))),m(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&m(e,["retrieval"],i);const o=h(n,["googleSearchRetrieval"]);o!=null&&m(e,["googleSearchRetrieval"],o);const a=h(n,["computerUse"]);if(a!=null&&m(e,["computerUse"],a),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const u=h(n,["codeExecution"]);u!=null&&m(e,["codeExecution"],u);const d=h(n,["enterpriseWebSearch"]);d!=null&&m(e,["enterpriseWebSearch"],d);const f=h(n,["googleMaps"]);f!=null&&m(e,["googleMaps"],f);const p=h(n,["googleSearch"]);p!=null&&m(e,["googleSearch"],p);const _=h(n,["urlContext"]);return _!=null&&m(e,["urlContext"],_),e}function tN(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const o=h(n,["expireTime"]);return e!==void 0&&o!=null&&m(e,["expireTime"],o),t}function nN(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const o=h(n,["expireTime"]);return e!==void 0&&o!=null&&m(e,["expireTime"],o),t}function iN(n,e){const t={},i=h(e,["name"]);i!=null&&m(t,["_url","name"],Sr(n,i));const o=h(e,["config"]);return o!=null&&tN(o,t),t}function sN(n,e){const t={},i=h(e,["name"]);i!=null&&m(t,["_url","name"],Sr(n,i));const o=h(e,["config"]);return o!=null&&nN(o,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rN extends Tr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ca(gr.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=P2(this.apiClient,e);return d=pe("cachedContents",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),u.then(_=>_)}else{const p=M2(this.apiClient,e);return d=pe("cachedContents",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),u.then(_=>_)}}async get(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=q2(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),u.then(_=>_)}else{const p=B2(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),u.then(_=>_)}}async delete(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=k2(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=L2(_),S=new QE;return Object.assign(S,E),S})}else{const p=D2(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=U2(_),S=new QE;return Object.assign(S,E),S})}}async update(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=sN(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),u.then(_=>_)}else{const p=iN(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),u.then(_=>_)}}async listInternal(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=J2(e);return d=pe("cachedContents",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=X2(_),S=new WE;return Object.assign(S,E),S})}else{const p=K2(e);return d=pe("cachedContents",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=j2(_),S=new WE;return Object.assign(S,E),S})}}}function rT(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Dt(n){return this instanceof Dt?(this.v=n,this):new Dt(n)}function ol(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),o,a=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",u),o[Symbol.asyncIterator]=function(){return this},o;function u(C){return function(k){return Promise.resolve(k).then(C,E)}}function d(C,k){i[C]&&(o[C]=function(V){return new Promise(function(z,J){a.push([C,V,z,J])>1||f(C,V)})},k&&(o[C]=k(o[C])))}function f(C,k){try{p(i[C](k))}catch(V){S(a[0][3],V)}}function p(C){C.value instanceof Dt?Promise.resolve(C.value.v).then(_,E):S(a[0][2],C)}function _(C){f("next",C)}function E(C){f("throw",C)}function S(C,k){C(k),a.shift(),a.length&&f(a[0][0],a[0][1])}}function Nu(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof rT=="function"?rT(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=n[a]&&function(u){return new Promise(function(d,f){u=n[a](u),o(d,f,u.done,u.value)})}}function o(a,u,d,f){Promise.resolve(f).then(function(p){a({value:p,done:d})},u)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function oN(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:Sb(t)}function Sb(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function aN(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function oT(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const o=[];let a=!0;for(;i<t&&n[i].role==="model";)o.push(n[i]),a&&!Sb(n[i])&&(a=!1),i++;a?e.push(...o):e.pop()}return e}class lN{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new uN(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class uN{constructor(e,t,i,o={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=o,this.history=a,this.sendPromise=Promise.resolve(),aN(a)}async sendMessage(e){var t;await this.sendPromise;const i=qn(e.message),o=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,u,d;const f=await o,p=(u=(a=f.candidates)===null||a===void 0?void 0:a[0])===null||u===void 0?void 0:u.content,_=f.automaticFunctionCallingHistory,E=this.getHistory(!0).length;let S=[];_!=null&&(S=(d=_.slice(E))!==null&&d!==void 0?d:[]);const C=p?[p]:[];this.recordHistory(i,C,S)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),o}async sendMessageStream(e){var t;await this.sendPromise;const i=qn(e.message),o=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=o.then(()=>{}).catch(()=>{});const a=await o;return this.processStreamResponse(a,i)}getHistory(e=!1){const t=e?oT(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,o;return ol(this,arguments,function*(){var u,d,f,p;const _=[];try{for(var E=!0,S=Nu(e),C;C=yield Dt(S.next()),u=C.done,!u;E=!0){p=C.value,E=!1;const k=p;if(oN(k)){const V=(o=(i=k.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content;V!==void 0&&_.push(V)}yield yield Dt(k)}}catch(k){d={error:k}}finally{try{!E&&!u&&(f=S.return)&&(yield Dt(f.call(S)))}finally{if(d)throw d.error}}this.recordHistory(t,_)})}recordHistory(e,t,i){let o=[];t.length>0&&t.every(a=>a.role!==void 0)?o=t:o.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...oT(i)):this.history.push(e),this.history.push(...o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gh extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,gh.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cN(n){const e={},t=h(n,["file"]);return t!=null&&m(e,["file"],t),e}function dN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function hN(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","file"],mb(t)),e}function fN(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function pN(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","file"],mb(t)),e}function mN(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&m(e,["_query","pageToken"],o),t}function gN(n){const e={},t=h(n,["config"]);return t!=null&&mN(t,e),e}function yN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const o=h(n,["files"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>u)),m(e,["files"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _N extends Tr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ca(gr.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=gN(e);return a=pe("files",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const p=yN(f),_=new SR;return Object.assign(_,p),_})}}async createInternal(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=cN(e);return a=pe("upload/v1beta/files",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>{const p=dN(f),_=new bR;return Object.assign(_,p),_})}}async get(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=pN(e);return a=pe("files/{file}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async delete(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=hN(e);return a=pe("files/{file}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const p=fN(f),_=new wR;return Object.assign(_,p),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Nd(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function vN(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(a=>UN(a))),m(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function EN(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function TN(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const o=h(n,["name"]);if(o!=null&&m(e,["name"],o),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function SN(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&m(e,["description"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const o=h(n,["parameters"]);o!=null&&m(e,["parameters"],o);const a=h(n,["parametersJsonSchema"]);a!=null&&m(e,["parametersJsonSchema"],a);const u=h(n,["response"]);u!=null&&m(e,["response"],u);const d=h(n,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function bN(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&m(e,["modelConfig"],t);const i=h(n,["responseJsonSchema"]);i!=null&&m(e,["responseJsonSchema"],i);const o=h(n,["audioTimestamp"]);o!=null&&m(e,["audioTimestamp"],o);const a=h(n,["candidateCount"]);a!=null&&m(e,["candidateCount"],a);const u=h(n,["enableAffectiveDialog"]);u!=null&&m(e,["enableAffectiveDialog"],u);const d=h(n,["frequencyPenalty"]);d!=null&&m(e,["frequencyPenalty"],d);const f=h(n,["logprobs"]);f!=null&&m(e,["logprobs"],f);const p=h(n,["maxOutputTokens"]);p!=null&&m(e,["maxOutputTokens"],p);const _=h(n,["mediaResolution"]);_!=null&&m(e,["mediaResolution"],_);const E=h(n,["presencePenalty"]);E!=null&&m(e,["presencePenalty"],E);const S=h(n,["responseLogprobs"]);S!=null&&m(e,["responseLogprobs"],S);const C=h(n,["responseMimeType"]);C!=null&&m(e,["responseMimeType"],C);const k=h(n,["responseModalities"]);k!=null&&m(e,["responseModalities"],k);const V=h(n,["responseSchema"]);V!=null&&m(e,["responseSchema"],V);const z=h(n,["routingConfig"]);z!=null&&m(e,["routingConfig"],z);const J=h(n,["seed"]);J!=null&&m(e,["seed"],J);const j=h(n,["speechConfig"]);j!=null&&m(e,["speechConfig"],bb(j));const Z=h(n,["stopSequences"]);Z!=null&&m(e,["stopSequences"],Z);const H=h(n,["temperature"]);H!=null&&m(e,["temperature"],H);const ae=h(n,["thinkingConfig"]);ae!=null&&m(e,["thinkingConfig"],ae);const oe=h(n,["topK"]);oe!=null&&m(e,["topK"],oe);const x=h(n,["topP"]);if(x!=null&&m(e,["topP"],x),h(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function wN(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function AN(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function CN(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig"],i);const o=h(n,["responseModalities"]);e!==void 0&&o!=null&&m(e,["setup","generationConfig","responseModalities"],o);const a=h(n,["temperature"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","temperature"],a);const u=h(n,["topP"]);e!==void 0&&u!=null&&m(e,["setup","generationConfig","topP"],u);const d=h(n,["topK"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","topK"],d);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const p=h(n,["mediaResolution"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","mediaResolution"],p);const _=h(n,["seed"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","seed"],_);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&m(e,["setup","generationConfig","speechConfig"],ag(E));const S=h(n,["thinkingConfig"]);e!==void 0&&S!=null&&m(e,["setup","generationConfig","thinkingConfig"],S);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],C);const k=h(n,["systemInstruction"]);e!==void 0&&k!=null&&m(e,["setup","systemInstruction"],vN(qn(k)));const V=h(n,["tools"]);if(e!==void 0&&V!=null){let oe=wl(V);Array.isArray(oe)&&(oe=oe.map(x=>VN(bl(x)))),m(e,["setup","tools"],oe)}const z=h(n,["sessionResumption"]);e!==void 0&&z!=null&&m(e,["setup","sessionResumption"],LN(z));const J=h(n,["inputAudioTranscription"]);e!==void 0&&J!=null&&m(e,["setup","inputAudioTranscription"],J);const j=h(n,["outputAudioTranscription"]);e!==void 0&&j!=null&&m(e,["setup","outputAudioTranscription"],j);const Z=h(n,["realtimeInputConfig"]);e!==void 0&&Z!=null&&m(e,["setup","realtimeInputConfig"],Z);const H=h(n,["contextWindowCompression"]);e!==void 0&&H!=null&&m(e,["setup","contextWindowCompression"],H);const ae=h(n,["proactivity"]);return e!==void 0&&ae!=null&&m(e,["setup","proactivity"],ae),t}function xN(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig"],bN(i));const o=h(n,["responseModalities"]);e!==void 0&&o!=null&&m(e,["setup","generationConfig","responseModalities"],o);const a=h(n,["temperature"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","temperature"],a);const u=h(n,["topP"]);e!==void 0&&u!=null&&m(e,["setup","generationConfig","topP"],u);const d=h(n,["topK"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","topK"],d);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const p=h(n,["mediaResolution"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","mediaResolution"],p);const _=h(n,["seed"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","seed"],_);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&m(e,["setup","generationConfig","speechConfig"],bb(ag(E)));const S=h(n,["thinkingConfig"]);e!==void 0&&S!=null&&m(e,["setup","generationConfig","thinkingConfig"],S);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],C);const k=h(n,["systemInstruction"]);e!==void 0&&k!=null&&m(e,["setup","systemInstruction"],qn(k));const V=h(n,["tools"]);if(e!==void 0&&V!=null){let oe=wl(V);Array.isArray(oe)&&(oe=oe.map(x=>ON(bl(x)))),m(e,["setup","tools"],oe)}const z=h(n,["sessionResumption"]);e!==void 0&&z!=null&&m(e,["setup","sessionResumption"],z);const J=h(n,["inputAudioTranscription"]);e!==void 0&&J!=null&&m(e,["setup","inputAudioTranscription"],J);const j=h(n,["outputAudioTranscription"]);e!==void 0&&j!=null&&m(e,["setup","outputAudioTranscription"],j);const Z=h(n,["realtimeInputConfig"]);e!==void 0&&Z!=null&&m(e,["setup","realtimeInputConfig"],Z);const H=h(n,["contextWindowCompression"]);e!==void 0&&H!=null&&m(e,["setup","contextWindowCompression"],H);const ae=h(n,["proactivity"]);return e!==void 0&&ae!=null&&m(e,["setup","proactivity"],ae),t}function IN(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["setup","model"],ut(n,i));const o=h(e,["config"]);return o!=null&&m(t,["config"],CN(o,t)),t}function RN(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["setup","model"],ut(n,i));const o=h(e,["config"]);return o!=null&&m(t,["config"],xN(o,t)),t}function NN(n){const e={},t=h(n,["musicGenerationConfig"]);return t!=null&&m(e,["musicGenerationConfig"],t),e}function MN(n){const e={},t=h(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),m(e,["weightedPrompts"],i)}return e}function PN(n){const e={},t=h(n,["media"]);if(t!=null){let p=cb(t);Array.isArray(p)&&(p=p.map(_=>Nd(_))),m(e,["mediaChunks"],p)}const i=h(n,["audio"]);i!=null&&m(e,["audio"],Nd(hb(i)));const o=h(n,["audioStreamEnd"]);o!=null&&m(e,["audioStreamEnd"],o);const a=h(n,["video"]);a!=null&&m(e,["video"],Nd(db(a)));const u=h(n,["text"]);u!=null&&m(e,["text"],u);const d=h(n,["activityStart"]);d!=null&&m(e,["activityStart"],d);const f=h(n,["activityEnd"]);return f!=null&&m(e,["activityEnd"],f),e}function DN(n){const e={},t=h(n,["media"]);if(t!=null){let p=cb(t);Array.isArray(p)&&(p=p.map(_=>_)),m(e,["mediaChunks"],p)}const i=h(n,["audio"]);i!=null&&m(e,["audio"],hb(i));const o=h(n,["audioStreamEnd"]);o!=null&&m(e,["audioStreamEnd"],o);const a=h(n,["video"]);a!=null&&m(e,["video"],db(a));const u=h(n,["text"]);u!=null&&m(e,["text"],u);const d=h(n,["activityStart"]);d!=null&&m(e,["activityStart"],d);const f=h(n,["activityEnd"]);return f!=null&&m(e,["activityEnd"],f),e}function kN(n){const e={},t=h(n,["setupComplete"]);t!=null&&m(e,["setupComplete"],t);const i=h(n,["serverContent"]);i!=null&&m(e,["serverContent"],i);const o=h(n,["toolCall"]);o!=null&&m(e,["toolCall"],o);const a=h(n,["toolCallCancellation"]);a!=null&&m(e,["toolCallCancellation"],a);const u=h(n,["usageMetadata"]);u!=null&&m(e,["usageMetadata"],zN(u));const d=h(n,["goAway"]);d!=null&&m(e,["goAway"],d);const f=h(n,["sessionResumptionUpdate"]);return f!=null&&m(e,["sessionResumptionUpdate"],f),e}function UN(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const o=h(n,["executableCode"]);o!=null&&m(e,["executableCode"],o);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],EN(a));const u=h(n,["functionCall"]);u!=null&&m(e,["functionCall"],TN(u));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],Nd(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const S=h(n,["videoMetadata"]);return S!=null&&m(e,["videoMetadata"],S),e}function LN(n){const e={},t=h(n,["handle"]);if(t!=null&&m(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function bb(n){const e={},t=h(n,["languageCode"]);t!=null&&m(e,["languageCode"],t);const i=h(n,["voiceConfig"]);if(i!=null&&m(e,["voiceConfig"],i),h(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function VN(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const o=h(n,["computerUse"]);o!=null&&m(e,["computerUse"],o);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const u=h(n,["codeExecution"]);if(u!=null&&m(e,["codeExecution"],u),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],wN(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],AN(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function ON(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>SN(S))),m(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&m(e,["retrieval"],i);const o=h(n,["googleSearchRetrieval"]);o!=null&&m(e,["googleSearchRetrieval"],o);const a=h(n,["computerUse"]);if(a!=null&&m(e,["computerUse"],a),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const u=h(n,["codeExecution"]);u!=null&&m(e,["codeExecution"],u);const d=h(n,["enterpriseWebSearch"]);d!=null&&m(e,["enterpriseWebSearch"],d);const f=h(n,["googleMaps"]);f!=null&&m(e,["googleMaps"],f);const p=h(n,["googleSearch"]);p!=null&&m(e,["googleSearch"],p);const _=h(n,["urlContext"]);return _!=null&&m(e,["urlContext"],_),e}function zN(n){const e={},t=h(n,["promptTokenCount"]);t!=null&&m(e,["promptTokenCount"],t);const i=h(n,["cachedContentTokenCount"]);i!=null&&m(e,["cachedContentTokenCount"],i);const o=h(n,["candidatesTokenCount"]);o!=null&&m(e,["responseTokenCount"],o);const a=h(n,["toolUsePromptTokenCount"]);a!=null&&m(e,["toolUsePromptTokenCount"],a);const u=h(n,["thoughtsTokenCount"]);u!=null&&m(e,["thoughtsTokenCount"],u);const d=h(n,["totalTokenCount"]);d!=null&&m(e,["totalTokenCount"],d);const f=h(n,["promptTokensDetails"]);if(f!=null){let C=f;Array.isArray(C)&&(C=C.map(k=>k)),m(e,["promptTokensDetails"],C)}const p=h(n,["cacheTokensDetails"]);if(p!=null){let C=p;Array.isArray(C)&&(C=C.map(k=>k)),m(e,["cacheTokensDetails"],C)}const _=h(n,["candidatesTokensDetails"]);if(_!=null){let C=_;Array.isArray(C)&&(C=C.map(k=>k)),m(e,["responseTokensDetails"],C)}const E=h(n,["toolUsePromptTokensDetails"]);if(E!=null){let C=E;Array.isArray(C)&&(C=C.map(k=>k)),m(e,["toolUsePromptTokensDetails"],C)}const S=h(n,["trafficType"]);return S!=null&&m(e,["trafficType"],S),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FN(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function BN(n){const e={},t=h(n,["content"]);t!=null&&m(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&m(e,["citationMetadata"],qN(i));const o=h(n,["tokenCount"]);o!=null&&m(e,["tokenCount"],o);const a=h(n,["finishReason"]);a!=null&&m(e,["finishReason"],a);const u=h(n,["avgLogprobs"]);u!=null&&m(e,["avgLogprobs"],u);const d=h(n,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(n,["index"]);f!=null&&m(e,["index"],f);const p=h(n,["logprobsResult"]);p!=null&&m(e,["logprobsResult"],p);const _=h(n,["safetyRatings"]);if(_!=null){let S=_;Array.isArray(S)&&(S=S.map(C=>C)),m(e,["safetyRatings"],S)}const E=h(n,["urlContextMetadata"]);return E!=null&&m(e,["urlContextMetadata"],E),e}function qN(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>o)),m(e,["citations"],i)}return e}function HN(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["contents"]);if(o!=null){let a=Hi(o);Array.isArray(a)&&(a=a.map(u=>u)),m(t,["contents"],a)}return t}function GN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["tokensInfo"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>a)),m(e,["tokensInfo"],o)}return e}function YN(n){const e={},t=h(n,["values"]);t!=null&&m(e,["values"],t);const i=h(n,["statistics"]);return i!=null&&m(e,["statistics"],$N(i)),e}function $N(n){const e={},t=h(n,["truncated"]);t!=null&&m(e,["truncated"],t);const i=h(n,["token_count"]);return i!=null&&m(e,["tokenCount"],i),e}function yh(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(a=>tP(a))),m(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function KN(n){const e={},t=h(n,["controlType"]);t!=null&&m(e,["controlType"],t);const i=h(n,["enableControlImageComputation"]);return i!=null&&m(e,["computeControl"],i),e}function JN(n){const e={};if(h(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function jN(n,e){const t={},i=h(n,["systemInstruction"]);e!==void 0&&i!=null&&m(e,["systemInstruction"],qn(i));const o=h(n,["tools"]);if(e!==void 0&&o!=null){let u=o;Array.isArray(u)&&(u=u.map(d=>Ib(d))),m(e,["tools"],u)}const a=h(n,["generationConfig"]);return e!==void 0&&a!=null&&m(e,["generationConfig"],FM(a)),t}function XN(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["contents"]);if(o!=null){let u=Hi(o);Array.isArray(u)&&(u=u.map(d=>yh(d))),m(t,["contents"],u)}const a=h(e,["config"]);return a!=null&&JN(a),t}function QN(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["contents"]);if(o!=null){let u=Hi(o);Array.isArray(u)&&(u=u.map(d=>d)),m(t,["contents"],u)}const a=h(e,["config"]);return a!=null&&jN(a,t),t}function WN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);i!=null&&m(e,["totalTokens"],i);const o=h(n,["cachedContentTokenCount"]);return o!=null&&m(e,["cachedContentTokenCount"],o),e}function ZN(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);return i!=null&&m(e,["totalTokens"],i),e}function eM(n,e){const t={},i=h(e,["model"]);return i!=null&&m(t,["_url","name"],ut(n,i)),t}function tM(n,e){const t={},i=h(e,["model"]);return i!=null&&m(t,["_url","name"],ut(n,i)),t}function nM(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function iM(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function sM(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&m(e,["parameters","storageUri"],i);const o=h(n,["negativePrompt"]);e!==void 0&&o!=null&&m(e,["parameters","negativePrompt"],o);const a=h(n,["numberOfImages"]);e!==void 0&&a!=null&&m(e,["parameters","sampleCount"],a);const u=h(n,["aspectRatio"]);e!==void 0&&u!=null&&m(e,["parameters","aspectRatio"],u);const d=h(n,["guidanceScale"]);e!==void 0&&d!=null&&m(e,["parameters","guidanceScale"],d);const f=h(n,["seed"]);e!==void 0&&f!=null&&m(e,["parameters","seed"],f);const p=h(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&m(e,["parameters","safetySetting"],p);const _=h(n,["personGeneration"]);e!==void 0&&_!=null&&m(e,["parameters","personGeneration"],_);const E=h(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&m(e,["parameters","includeSafetyAttributes"],E);const S=h(n,["includeRaiReason"]);e!==void 0&&S!=null&&m(e,["parameters","includeRaiReason"],S);const C=h(n,["language"]);e!==void 0&&C!=null&&m(e,["parameters","language"],C);const k=h(n,["outputMimeType"]);e!==void 0&&k!=null&&m(e,["parameters","outputOptions","mimeType"],k);const V=h(n,["outputCompressionQuality"]);e!==void 0&&V!=null&&m(e,["parameters","outputOptions","compressionQuality"],V);const z=h(n,["addWatermark"]);e!==void 0&&z!=null&&m(e,["parameters","addWatermark"],z);const J=h(n,["labels"]);e!==void 0&&J!=null&&m(e,["labels"],J);const j=h(n,["editMode"]);e!==void 0&&j!=null&&m(e,["parameters","editMode"],j);const Z=h(n,["baseSteps"]);return e!==void 0&&Z!=null&&m(e,["parameters","editConfig","baseSteps"],Z),t}function rM(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["prompt"]);o!=null&&m(t,["instances[0]","prompt"],o);const a=h(e,["referenceImages"]);if(a!=null){let d=a;Array.isArray(d)&&(d=d.map(f=>aP(f))),m(t,["instances[0]","referenceImages"],d)}const u=h(e,["config"]);return u!=null&&sM(u,t),t}function oM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>_h(a))),m(e,["generatedImages"],o)}return e}function aM(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&m(e,["requests[]","taskType"],i);const o=h(n,["title"]);e!==void 0&&o!=null&&m(e,["requests[]","title"],o);const a=h(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&m(e,["requests[]","outputDimensionality"],a),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function lM(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&m(e,["instances[]","task_type"],i);const o=h(n,["title"]);e!==void 0&&o!=null&&m(e,["instances[]","title"],o);const a=h(n,["outputDimensionality"]);e!==void 0&&a!=null&&m(e,["parameters","outputDimensionality"],a);const u=h(n,["mimeType"]);e!==void 0&&u!=null&&m(e,["instances[]","mimeType"],u);const d=h(n,["autoTruncate"]);return e!==void 0&&d!=null&&m(e,["parameters","autoTruncate"],d),t}function uM(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["contents"]);if(o!=null){let d=sg(n,o);Array.isArray(d)&&(d=d.map(f=>f)),m(t,["requests[]","content"],d)}const a=h(e,["config"]);a!=null&&aM(a,t);const u=h(e,["model"]);return u!==void 0&&m(t,["requests[]","model"],ut(n,u)),t}function cM(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["contents"]);if(o!=null){let u=sg(n,o);Array.isArray(u)&&(u=u.map(d=>d)),m(t,["instances[]","content"],u)}const a=h(e,["config"]);return a!=null&&lM(a,t),t}function dM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>u)),m(e,["embeddings"],a)}const o=h(n,["metadata"]);return o!=null&&m(e,["metadata"],o),e}function hM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions[]","embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>YN(u))),m(e,["embeddings"],a)}const o=h(n,["metadata"]);return o!=null&&m(e,["metadata"],o),e}function fM(n){const e={},t=h(n,["endpoint"]);t!=null&&m(e,["name"],t);const i=h(n,["deployedModelId"]);return i!=null&&m(e,["deployedModelId"],i),e}function pM(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function mM(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const o=h(n,["name"]);if(o!=null&&m(e,["name"],o),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function gM(n){const e={},t=h(n,["mode"]);t!=null&&m(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);if(i!=null&&m(e,["allowedFunctionNames"],i),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function yM(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&m(e,["description"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const o=h(n,["parameters"]);o!=null&&m(e,["parameters"],o);const a=h(n,["parametersJsonSchema"]);a!=null&&m(e,["parametersJsonSchema"],a);const u=h(n,["response"]);u!=null&&m(e,["response"],u);const d=h(n,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function _M(n,e,t){const i={},o=h(e,["systemInstruction"]);t!==void 0&&o!=null&&m(t,["systemInstruction"],yh(qn(o)));const a=h(e,["temperature"]);a!=null&&m(i,["temperature"],a);const u=h(e,["topP"]);u!=null&&m(i,["topP"],u);const d=h(e,["topK"]);d!=null&&m(i,["topK"],d);const f=h(e,["candidateCount"]);f!=null&&m(i,["candidateCount"],f);const p=h(e,["maxOutputTokens"]);p!=null&&m(i,["maxOutputTokens"],p);const _=h(e,["stopSequences"]);_!=null&&m(i,["stopSequences"],_);const E=h(e,["responseLogprobs"]);E!=null&&m(i,["responseLogprobs"],E);const S=h(e,["logprobs"]);S!=null&&m(i,["logprobs"],S);const C=h(e,["presencePenalty"]);C!=null&&m(i,["presencePenalty"],C);const k=h(e,["frequencyPenalty"]);k!=null&&m(i,["frequencyPenalty"],k);const V=h(e,["seed"]);V!=null&&m(i,["seed"],V);const z=h(e,["responseMimeType"]);z!=null&&m(i,["responseMimeType"],z);const J=h(e,["responseSchema"]);J!=null&&m(i,["responseSchema"],rg(J));const j=h(e,["responseJsonSchema"]);if(j!=null&&m(i,["responseJsonSchema"],j),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const Z=h(e,["safetySettings"]);if(t!==void 0&&Z!=null){let O=Z;Array.isArray(O)&&(O=O.map(D=>lP(D))),m(t,["safetySettings"],O)}const H=h(e,["tools"]);if(t!==void 0&&H!=null){let O=wl(H);Array.isArray(O)&&(O=O.map(D=>mP(bl(D)))),m(t,["tools"],O)}const ae=h(e,["toolConfig"]);if(t!==void 0&&ae!=null&&m(t,["toolConfig"],pP(ae)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const oe=h(e,["cachedContent"]);t!==void 0&&oe!=null&&m(t,["cachedContent"],Sr(n,oe));const x=h(e,["responseModalities"]);x!=null&&m(i,["responseModalities"],x);const M=h(e,["mediaResolution"]);M!=null&&m(i,["mediaResolution"],M);const N=h(e,["speechConfig"]);if(N!=null&&m(i,["speechConfig"],og(N)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=h(e,["thinkingConfig"]);P!=null&&m(i,["thinkingConfig"],P);const U=h(e,["imageConfig"]);return U!=null&&m(i,["imageConfig"],YM(U)),i}function vM(n,e,t){const i={},o=h(e,["systemInstruction"]);t!==void 0&&o!=null&&m(t,["systemInstruction"],qn(o));const a=h(e,["temperature"]);a!=null&&m(i,["temperature"],a);const u=h(e,["topP"]);u!=null&&m(i,["topP"],u);const d=h(e,["topK"]);d!=null&&m(i,["topK"],d);const f=h(e,["candidateCount"]);f!=null&&m(i,["candidateCount"],f);const p=h(e,["maxOutputTokens"]);p!=null&&m(i,["maxOutputTokens"],p);const _=h(e,["stopSequences"]);_!=null&&m(i,["stopSequences"],_);const E=h(e,["responseLogprobs"]);E!=null&&m(i,["responseLogprobs"],E);const S=h(e,["logprobs"]);S!=null&&m(i,["logprobs"],S);const C=h(e,["presencePenalty"]);C!=null&&m(i,["presencePenalty"],C);const k=h(e,["frequencyPenalty"]);k!=null&&m(i,["frequencyPenalty"],k);const V=h(e,["seed"]);V!=null&&m(i,["seed"],V);const z=h(e,["responseMimeType"]);z!=null&&m(i,["responseMimeType"],z);const J=h(e,["responseSchema"]);J!=null&&m(i,["responseSchema"],rg(J));const j=h(e,["responseJsonSchema"]);j!=null&&m(i,["responseJsonSchema"],j);const Z=h(e,["routingConfig"]);Z!=null&&m(i,["routingConfig"],Z);const H=h(e,["modelSelectionConfig"]);H!=null&&m(i,["modelConfig"],H);const ae=h(e,["safetySettings"]);if(t!==void 0&&ae!=null){let W=ae;Array.isArray(W)&&(W=W.map(ce=>ce)),m(t,["safetySettings"],W)}const oe=h(e,["tools"]);if(t!==void 0&&oe!=null){let W=wl(oe);Array.isArray(W)&&(W=W.map(ce=>Ib(bl(ce)))),m(t,["tools"],W)}const x=h(e,["toolConfig"]);t!==void 0&&x!=null&&m(t,["toolConfig"],x);const M=h(e,["labels"]);t!==void 0&&M!=null&&m(t,["labels"],M);const N=h(e,["cachedContent"]);t!==void 0&&N!=null&&m(t,["cachedContent"],Sr(n,N));const P=h(e,["responseModalities"]);P!=null&&m(i,["responseModalities"],P);const U=h(e,["mediaResolution"]);U!=null&&m(i,["mediaResolution"],U);const O=h(e,["speechConfig"]);O!=null&&m(i,["speechConfig"],xb(og(O)));const D=h(e,["audioTimestamp"]);D!=null&&m(i,["audioTimestamp"],D);const ct=h(e,["thinkingConfig"]);ct!=null&&m(i,["thinkingConfig"],ct);const rt=h(e,["imageConfig"]);return rt!=null&&m(i,["imageConfig"],$M(rt)),i}function aT(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["contents"]);if(o!=null){let u=Hi(o);Array.isArray(u)&&(u=u.map(d=>yh(d))),m(t,["contents"],u)}const a=h(e,["config"]);return a!=null&&m(t,["generationConfig"],_M(n,a,t)),t}function lT(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["contents"]);if(o!=null){let u=Hi(o);Array.isArray(u)&&(u=u.map(d=>d)),m(t,["contents"],u)}const a=h(e,["config"]);return a!=null&&m(t,["generationConfig"],vM(n,a,t)),t}function uT(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(p=>BN(p))),m(e,["candidates"],f)}const o=h(n,["modelVersion"]);o!=null&&m(e,["modelVersion"],o);const a=h(n,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const u=h(n,["responseId"]);u!=null&&m(e,["responseId"],u);const d=h(n,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function cT(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(_=>_)),m(e,["candidates"],p)}const o=h(n,["createTime"]);o!=null&&m(e,["createTime"],o);const a=h(n,["modelVersion"]);a!=null&&m(e,["modelVersion"],a);const u=h(n,["promptFeedback"]);u!=null&&m(e,["promptFeedback"],u);const d=h(n,["responseId"]);d!=null&&m(e,["responseId"],d);const f=h(n,["usageMetadata"]);return f!=null&&m(e,["usageMetadata"],f),e}function EM(n,e){const t={};if(h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const o=h(n,["aspectRatio"]);e!==void 0&&o!=null&&m(e,["parameters","aspectRatio"],o);const a=h(n,["guidanceScale"]);if(e!==void 0&&a!=null&&m(e,["parameters","guidanceScale"],a),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=h(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&m(e,["parameters","safetySetting"],u);const d=h(n,["personGeneration"]);e!==void 0&&d!=null&&m(e,["parameters","personGeneration"],d);const f=h(n,["includeSafetyAttributes"]);e!==void 0&&f!=null&&m(e,["parameters","includeSafetyAttributes"],f);const p=h(n,["includeRaiReason"]);e!==void 0&&p!=null&&m(e,["parameters","includeRaiReason"],p);const _=h(n,["language"]);e!==void 0&&_!=null&&m(e,["parameters","language"],_);const E=h(n,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const S=h(n,["outputCompressionQuality"]);if(e!==void 0&&S!=null&&m(e,["parameters","outputOptions","compressionQuality"],S),h(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const C=h(n,["imageSize"]);if(e!==void 0&&C!=null&&m(e,["parameters","sampleImageSize"],C),h(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function TM(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&m(e,["parameters","storageUri"],i);const o=h(n,["negativePrompt"]);e!==void 0&&o!=null&&m(e,["parameters","negativePrompt"],o);const a=h(n,["numberOfImages"]);e!==void 0&&a!=null&&m(e,["parameters","sampleCount"],a);const u=h(n,["aspectRatio"]);e!==void 0&&u!=null&&m(e,["parameters","aspectRatio"],u);const d=h(n,["guidanceScale"]);e!==void 0&&d!=null&&m(e,["parameters","guidanceScale"],d);const f=h(n,["seed"]);e!==void 0&&f!=null&&m(e,["parameters","seed"],f);const p=h(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&m(e,["parameters","safetySetting"],p);const _=h(n,["personGeneration"]);e!==void 0&&_!=null&&m(e,["parameters","personGeneration"],_);const E=h(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&m(e,["parameters","includeSafetyAttributes"],E);const S=h(n,["includeRaiReason"]);e!==void 0&&S!=null&&m(e,["parameters","includeRaiReason"],S);const C=h(n,["language"]);e!==void 0&&C!=null&&m(e,["parameters","language"],C);const k=h(n,["outputMimeType"]);e!==void 0&&k!=null&&m(e,["parameters","outputOptions","mimeType"],k);const V=h(n,["outputCompressionQuality"]);e!==void 0&&V!=null&&m(e,["parameters","outputOptions","compressionQuality"],V);const z=h(n,["addWatermark"]);e!==void 0&&z!=null&&m(e,["parameters","addWatermark"],z);const J=h(n,["labels"]);e!==void 0&&J!=null&&m(e,["labels"],J);const j=h(n,["imageSize"]);e!==void 0&&j!=null&&m(e,["parameters","sampleImageSize"],j);const Z=h(n,["enhancePrompt"]);return e!==void 0&&Z!=null&&m(e,["parameters","enhancePrompt"],Z),t}function SM(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["prompt"]);o!=null&&m(t,["instances[0]","prompt"],o);const a=h(e,["config"]);return a!=null&&EM(a,t),t}function bM(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["prompt"]);o!=null&&m(t,["instances[0]","prompt"],o);const a=h(e,["config"]);return a!=null&&TM(a,t),t}function wM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>LM(u))),m(e,["generatedImages"],a)}const o=h(n,["positivePromptSafetyAttributes"]);return o!=null&&m(e,["positivePromptSafetyAttributes"],Ab(o)),e}function AM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>_h(u))),m(e,["generatedImages"],a)}const o=h(n,["positivePromptSafetyAttributes"]);return o!=null&&m(e,["positivePromptSafetyAttributes"],Cb(o)),e}function CM(n,e){const t={},i=h(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i),h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=h(n,["durationSeconds"]);if(e!==void 0&&o!=null&&m(e,["parameters","durationSeconds"],o),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=h(n,["aspectRatio"]);e!==void 0&&a!=null&&m(e,["parameters","aspectRatio"],a);const u=h(n,["resolution"]);e!==void 0&&u!=null&&m(e,["parameters","resolution"],u);const d=h(n,["personGeneration"]);if(e!==void 0&&d!=null&&m(e,["parameters","personGeneration"],d),h(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=h(n,["negativePrompt"]);e!==void 0&&f!=null&&m(e,["parameters","negativePrompt"],f);const p=h(n,["enhancePrompt"]);if(e!==void 0&&p!=null&&m(e,["parameters","enhancePrompt"],p),h(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const _=h(n,["lastFrame"]);e!==void 0&&_!=null&&m(e,["instances[0]","lastFrame"],vh(_));const E=h(n,["referenceImages"]);if(e!==void 0&&E!=null){let S=E;Array.isArray(S)&&(S=S.map(C=>IP(C))),m(e,["instances[0]","referenceImages"],S)}if(h(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(h(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function xM(n,e){const t={},i=h(n,["numberOfVideos"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const o=h(n,["outputGcsUri"]);e!==void 0&&o!=null&&m(e,["parameters","storageUri"],o);const a=h(n,["fps"]);e!==void 0&&a!=null&&m(e,["parameters","fps"],a);const u=h(n,["durationSeconds"]);e!==void 0&&u!=null&&m(e,["parameters","durationSeconds"],u);const d=h(n,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(n,["aspectRatio"]);e!==void 0&&f!=null&&m(e,["parameters","aspectRatio"],f);const p=h(n,["resolution"]);e!==void 0&&p!=null&&m(e,["parameters","resolution"],p);const _=h(n,["personGeneration"]);e!==void 0&&_!=null&&m(e,["parameters","personGeneration"],_);const E=h(n,["pubsubTopic"]);e!==void 0&&E!=null&&m(e,["parameters","pubsubTopic"],E);const S=h(n,["negativePrompt"]);e!==void 0&&S!=null&&m(e,["parameters","negativePrompt"],S);const C=h(n,["enhancePrompt"]);e!==void 0&&C!=null&&m(e,["parameters","enhancePrompt"],C);const k=h(n,["generateAudio"]);e!==void 0&&k!=null&&m(e,["parameters","generateAudio"],k);const V=h(n,["lastFrame"]);e!==void 0&&V!=null&&m(e,["instances[0]","lastFrame"],cs(V));const z=h(n,["referenceImages"]);if(e!==void 0&&z!=null){let Z=z;Array.isArray(Z)&&(Z=Z.map(H=>RP(H))),m(e,["instances[0]","referenceImages"],Z)}const J=h(n,["mask"]);e!==void 0&&J!=null&&m(e,["instances[0]","mask"],xP(J));const j=h(n,["compressionQuality"]);return e!==void 0&&j!=null&&m(e,["parameters","compressionQuality"],j),t}function IM(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const o=h(n,["done"]);o!=null&&m(e,["done"],o);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const u=h(n,["response","generateVideoResponse"]);return u!=null&&m(e,["response"],PM(u)),e}function RM(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const o=h(n,["done"]);o!=null&&m(e,["done"],o);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const u=h(n,["response"]);return u!=null&&m(e,["response"],DM(u)),e}function NM(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["prompt"]);o!=null&&m(t,["instances[0]","prompt"],o);const a=h(e,["image"]);a!=null&&m(t,["instances[0]","image"],vh(a));const u=h(e,["video"]);u!=null&&m(t,["instances[0]","video"],Rb(u));const d=h(e,["source"]);d!=null&&kM(d,t);const f=h(e,["config"]);return f!=null&&CM(f,t),t}function MM(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["prompt"]);o!=null&&m(t,["instances[0]","prompt"],o);const a=h(e,["image"]);a!=null&&m(t,["instances[0]","image"],cs(a));const u=h(e,["video"]);u!=null&&m(t,["instances[0]","video"],Nb(u));const d=h(e,["source"]);d!=null&&UM(d,t);const f=h(e,["config"]);return f!=null&&xM(f,t),t}function PM(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>OM(u))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&m(e,["raiMediaFilteredReasons"],o),e}function DM(n){const e={},t=h(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(u=>zM(u))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const o=h(n,["raiMediaFilteredReasons"]);return o!=null&&m(e,["raiMediaFilteredReasons"],o),e}function kM(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&m(e,["instances[0]","prompt"],i);const o=h(n,["image"]);e!==void 0&&o!=null&&m(e,["instances[0]","image"],vh(o));const a=h(n,["video"]);return e!==void 0&&a!=null&&m(e,["instances[0]","video"],Rb(a)),t}function UM(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&m(e,["instances[0]","prompt"],i);const o=h(n,["image"]);e!==void 0&&o!=null&&m(e,["instances[0]","image"],cs(o));const a=h(n,["video"]);return e!==void 0&&a!=null&&m(e,["instances[0]","video"],Nb(a)),t}function LM(n){const e={},t=h(n,["_self"]);t!=null&&m(e,["image"],KM(t));const i=h(n,["raiFilteredReason"]);i!=null&&m(e,["raiFilteredReason"],i);const o=h(n,["_self"]);return o!=null&&m(e,["safetyAttributes"],Ab(o)),e}function _h(n){const e={},t=h(n,["_self"]);t!=null&&m(e,["image"],wb(t));const i=h(n,["raiFilteredReason"]);i!=null&&m(e,["raiFilteredReason"],i);const o=h(n,["_self"]);o!=null&&m(e,["safetyAttributes"],Cb(o));const a=h(n,["prompt"]);return a!=null&&m(e,["enhancedPrompt"],a),e}function VM(n){const e={},t=h(n,["_self"]);t!=null&&m(e,["mask"],wb(t));const i=h(n,["labels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>a)),m(e,["labels"],o)}return e}function OM(n){const e={},t=h(n,["video"]);return t!=null&&m(e,["video"],AP(t)),e}function zM(n){const e={},t=h(n,["_self"]);return t!=null&&m(e,["video"],CP(t)),e}function FM(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&m(e,["modelConfig"],t);const i=h(n,["responseJsonSchema"]);i!=null&&m(e,["responseJsonSchema"],i);const o=h(n,["audioTimestamp"]);o!=null&&m(e,["audioTimestamp"],o);const a=h(n,["candidateCount"]);a!=null&&m(e,["candidateCount"],a);const u=h(n,["enableAffectiveDialog"]);u!=null&&m(e,["enableAffectiveDialog"],u);const d=h(n,["frequencyPenalty"]);d!=null&&m(e,["frequencyPenalty"],d);const f=h(n,["logprobs"]);f!=null&&m(e,["logprobs"],f);const p=h(n,["maxOutputTokens"]);p!=null&&m(e,["maxOutputTokens"],p);const _=h(n,["mediaResolution"]);_!=null&&m(e,["mediaResolution"],_);const E=h(n,["presencePenalty"]);E!=null&&m(e,["presencePenalty"],E);const S=h(n,["responseLogprobs"]);S!=null&&m(e,["responseLogprobs"],S);const C=h(n,["responseMimeType"]);C!=null&&m(e,["responseMimeType"],C);const k=h(n,["responseModalities"]);k!=null&&m(e,["responseModalities"],k);const V=h(n,["responseSchema"]);V!=null&&m(e,["responseSchema"],V);const z=h(n,["routingConfig"]);z!=null&&m(e,["routingConfig"],z);const J=h(n,["seed"]);J!=null&&m(e,["seed"],J);const j=h(n,["speechConfig"]);j!=null&&m(e,["speechConfig"],xb(j));const Z=h(n,["stopSequences"]);Z!=null&&m(e,["stopSequences"],Z);const H=h(n,["temperature"]);H!=null&&m(e,["temperature"],H);const ae=h(n,["thinkingConfig"]);ae!=null&&m(e,["thinkingConfig"],ae);const oe=h(n,["topK"]);oe!=null&&m(e,["topK"],oe);const x=h(n,["topP"]);if(x!=null&&m(e,["topP"],x),h(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function BM(n,e){const t={},i=h(e,["model"]);return i!=null&&m(t,["_url","name"],ut(n,i)),t}function qM(n,e){const t={},i=h(e,["model"]);return i!=null&&m(t,["_url","name"],ut(n,i)),t}function HM(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function GM(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function YM(n){const e={},t=h(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const i=h(n,["imageSize"]);if(i!=null&&m(e,["imageSize"],i),h(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(h(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function $M(n){const e={},t=h(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const i=h(n,["imageSize"]);i!=null&&m(e,["imageSize"],i);const o=h(n,["outputMimeType"]);o!=null&&m(e,["imageOutputOptions","mimeType"],o);const a=h(n,["outputCompressionQuality"]);return a!=null&&m(e,["imageOutputOptions","compressionQuality"],a),e}function KM(n){const e={},t=h(n,["bytesBase64Encoded"]);t!=null&&m(e,["imageBytes"],_o(t));const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function wb(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["gcsUri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&m(e,["imageBytes"],_o(i));const o=h(n,["mimeType"]);return o!=null&&m(e,["mimeType"],o),e}function vh(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=h(n,["imageBytes"]);t!=null&&m(e,["bytesBase64Encoded"],_o(t));const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function cs(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["gcsUri"],t);const i=h(n,["imageBytes"]);i!=null&&m(e,["bytesBase64Encoded"],_o(i));const o=h(n,["mimeType"]);return o!=null&&m(e,["mimeType"],o),e}function JM(n,e,t){const i={},o=h(e,["pageSize"]);t!==void 0&&o!=null&&m(t,["_query","pageSize"],o);const a=h(e,["pageToken"]);t!==void 0&&a!=null&&m(t,["_query","pageToken"],a);const u=h(e,["filter"]);t!==void 0&&u!=null&&m(t,["_query","filter"],u);const d=h(e,["queryBase"]);return t!==void 0&&d!=null&&m(t,["_url","models_url"],gb(n,d)),i}function jM(n,e,t){const i={},o=h(e,["pageSize"]);t!==void 0&&o!=null&&m(t,["_query","pageSize"],o);const a=h(e,["pageToken"]);t!==void 0&&a!=null&&m(t,["_query","pageToken"],a);const u=h(e,["filter"]);t!==void 0&&u!=null&&m(t,["_query","filter"],u);const d=h(e,["queryBase"]);return t!==void 0&&d!=null&&m(t,["_url","models_url"],gb(n,d)),i}function XM(n,e){const t={},i=h(e,["config"]);return i!=null&&JM(n,i,t),t}function QM(n,e){const t={},i=h(e,["config"]);return i!=null&&jM(n,i,t),t}function WM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const o=h(n,["_self"]);if(o!=null){let a=yb(o);Array.isArray(a)&&(a=a.map(u=>mm(u))),m(e,["models"],a)}return e}function ZM(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const o=h(n,["_self"]);if(o!=null){let a=yb(o);Array.isArray(a)&&(a=a.map(u=>gm(u))),m(e,["models"],a)}return e}function eP(n){const e={},t=h(n,["maskMode"]);t!=null&&m(e,["maskMode"],t);const i=h(n,["segmentationClasses"]);i!=null&&m(e,["maskClasses"],i);const o=h(n,["maskDilation"]);return o!=null&&m(e,["dilation"],o),e}function mm(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["displayName"]);i!=null&&m(e,["displayName"],i);const o=h(n,["description"]);o!=null&&m(e,["description"],o);const a=h(n,["version"]);a!=null&&m(e,["version"],a);const u=h(n,["_self"]);u!=null&&m(e,["tunedModelInfo"],gP(u));const d=h(n,["inputTokenLimit"]);d!=null&&m(e,["inputTokenLimit"],d);const f=h(n,["outputTokenLimit"]);f!=null&&m(e,["outputTokenLimit"],f);const p=h(n,["supportedGenerationMethods"]);p!=null&&m(e,["supportedActions"],p);const _=h(n,["temperature"]);_!=null&&m(e,["temperature"],_);const E=h(n,["maxTemperature"]);E!=null&&m(e,["maxTemperature"],E);const S=h(n,["topP"]);S!=null&&m(e,["topP"],S);const C=h(n,["topK"]);C!=null&&m(e,["topK"],C);const k=h(n,["thinking"]);return k!=null&&m(e,["thinking"],k),e}function gm(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["displayName"]);i!=null&&m(e,["displayName"],i);const o=h(n,["description"]);o!=null&&m(e,["description"],o);const a=h(n,["versionId"]);a!=null&&m(e,["version"],a);const u=h(n,["deployedModels"]);if(u!=null){let E=u;Array.isArray(E)&&(E=E.map(S=>fM(S))),m(e,["endpoints"],E)}const d=h(n,["labels"]);d!=null&&m(e,["labels"],d);const f=h(n,["_self"]);f!=null&&m(e,["tunedModelInfo"],yP(f));const p=h(n,["defaultCheckpointId"]);p!=null&&m(e,["defaultCheckpointId"],p);const _=h(n,["checkpoints"]);if(_!=null){let E=_;Array.isArray(E)&&(E=E.map(S=>S)),m(e,["checkpoints"],E)}return e}function tP(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const o=h(n,["executableCode"]);o!=null&&m(e,["executableCode"],o);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],pM(a));const u=h(n,["functionCall"]);u!=null&&m(e,["functionCall"],mM(u));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],FN(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const S=h(n,["videoMetadata"]);return S!=null&&m(e,["videoMetadata"],S),e}function nP(n){const e={},t=h(n,["productImage"]);return t!=null&&m(e,["image"],cs(t)),e}function iP(n,e){const t={},i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const o=h(n,["baseSteps"]);e!==void 0&&o!=null&&m(e,["parameters","baseSteps"],o);const a=h(n,["outputGcsUri"]);e!==void 0&&a!=null&&m(e,["parameters","storageUri"],a);const u=h(n,["seed"]);e!==void 0&&u!=null&&m(e,["parameters","seed"],u);const d=h(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&m(e,["parameters","safetySetting"],d);const f=h(n,["personGeneration"]);e!==void 0&&f!=null&&m(e,["parameters","personGeneration"],f);const p=h(n,["addWatermark"]);e!==void 0&&p!=null&&m(e,["parameters","addWatermark"],p);const _=h(n,["outputMimeType"]);e!==void 0&&_!=null&&m(e,["parameters","outputOptions","mimeType"],_);const E=h(n,["outputCompressionQuality"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","compressionQuality"],E);const S=h(n,["enhancePrompt"]);e!==void 0&&S!=null&&m(e,["parameters","enhancePrompt"],S);const C=h(n,["labels"]);return e!==void 0&&C!=null&&m(e,["labels"],C),t}function sP(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["source"]);o!=null&&oP(o,t);const a=h(e,["config"]);return a!=null&&iP(a,t),t}function rP(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>_h(o))),m(e,["generatedImages"],i)}return e}function oP(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&m(e,["instances[0]","prompt"],i);const o=h(n,["personImage"]);e!==void 0&&o!=null&&m(e,["instances[0]","personImage","image"],cs(o));const a=h(n,["productImages"]);if(e!==void 0&&a!=null){let u=a;Array.isArray(u)&&(u=u.map(d=>nP(d))),m(e,["instances[0]","productImages"],u)}return t}function aP(n){const e={},t=h(n,["referenceImage"]);t!=null&&m(e,["referenceImage"],cs(t));const i=h(n,["referenceId"]);i!=null&&m(e,["referenceId"],i);const o=h(n,["referenceType"]);o!=null&&m(e,["referenceType"],o);const a=h(n,["maskImageConfig"]);a!=null&&m(e,["maskImageConfig"],eP(a));const u=h(n,["controlImageConfig"]);u!=null&&m(e,["controlImageConfig"],KN(u));const d=h(n,["styleImageConfig"]);d!=null&&m(e,["styleImageConfig"],d);const f=h(n,["subjectImageConfig"]);return f!=null&&m(e,["subjectImageConfig"],f),e}function Ab(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&m(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&m(e,["scores"],i);const o=h(n,["contentType"]);return o!=null&&m(e,["contentType"],o),e}function Cb(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&m(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&m(e,["scores"],i);const o=h(n,["contentType"]);return o!=null&&m(e,["contentType"],o),e}function lP(n){const e={},t=h(n,["category"]);if(t!=null&&m(e,["category"],t),h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=h(n,["threshold"]);return i!=null&&m(e,["threshold"],i),e}function uP(n){const e={},t=h(n,["image"]);return t!=null&&m(e,["image"],cs(t)),e}function cP(n,e){const t={},i=h(n,["mode"]);e!==void 0&&i!=null&&m(e,["parameters","mode"],i);const o=h(n,["maxPredictions"]);e!==void 0&&o!=null&&m(e,["parameters","maxPredictions"],o);const a=h(n,["confidenceThreshold"]);e!==void 0&&a!=null&&m(e,["parameters","confidenceThreshold"],a);const u=h(n,["maskDilation"]);e!==void 0&&u!=null&&m(e,["parameters","maskDilation"],u);const d=h(n,["binaryColorThreshold"]);e!==void 0&&d!=null&&m(e,["parameters","binaryColorThreshold"],d);const f=h(n,["labels"]);return e!==void 0&&f!=null&&m(e,["labels"],f),t}function dP(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["source"]);o!=null&&fP(o,t);const a=h(e,["config"]);return a!=null&&cP(a,t),t}function hP(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(o=>VM(o))),m(e,["generatedMasks"],i)}return e}function fP(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&m(e,["instances[0]","prompt"],i);const o=h(n,["image"]);e!==void 0&&o!=null&&m(e,["instances[0]","image"],cs(o));const a=h(n,["scribbleImage"]);return e!==void 0&&a!=null&&m(e,["instances[0]","scribble"],uP(a)),t}function xb(n){const e={},t=h(n,["languageCode"]);t!=null&&m(e,["languageCode"],t);const i=h(n,["voiceConfig"]);if(i!=null&&m(e,["voiceConfig"],i),h(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function pP(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],gM(t));const i=h(n,["retrievalConfig"]);return i!=null&&m(e,["retrievalConfig"],i),e}function mP(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const o=h(n,["computerUse"]);o!=null&&m(e,["computerUse"],o);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const u=h(n,["codeExecution"]);if(u!=null&&m(e,["codeExecution"],u),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],HM(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],GM(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function Ib(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(S=>yM(S))),m(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&m(e,["retrieval"],i);const o=h(n,["googleSearchRetrieval"]);o!=null&&m(e,["googleSearchRetrieval"],o);const a=h(n,["computerUse"]);if(a!=null&&m(e,["computerUse"],a),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const u=h(n,["codeExecution"]);u!=null&&m(e,["codeExecution"],u);const d=h(n,["enterpriseWebSearch"]);d!=null&&m(e,["enterpriseWebSearch"],d);const f=h(n,["googleMaps"]);f!=null&&m(e,["googleMaps"],f);const p=h(n,["googleSearch"]);p!=null&&m(e,["googleSearch"],p);const _=h(n,["urlContext"]);return _!=null&&m(e,["urlContext"],_),e}function gP(n){const e={},t=h(n,["baseModel"]);t!=null&&m(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&m(e,["createTime"],i);const o=h(n,["updateTime"]);return o!=null&&m(e,["updateTime"],o),e}function yP(n){const e={},t=h(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&m(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&m(e,["createTime"],i);const o=h(n,["updateTime"]);return o!=null&&m(e,["updateTime"],o),e}function _P(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const o=h(n,["description"]);e!==void 0&&o!=null&&m(e,["description"],o);const a=h(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&m(e,["defaultCheckpointId"],a),t}function vP(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const o=h(n,["description"]);e!==void 0&&o!=null&&m(e,["description"],o);const a=h(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&m(e,["defaultCheckpointId"],a),t}function EP(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","name"],ut(n,i));const o=h(e,["config"]);return o!=null&&_P(o,t),t}function TP(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["config"]);return o!=null&&vP(o,t),t}function SP(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&m(e,["parameters","storageUri"],i);const o=h(n,["safetyFilterLevel"]);e!==void 0&&o!=null&&m(e,["parameters","safetySetting"],o);const a=h(n,["personGeneration"]);e!==void 0&&a!=null&&m(e,["parameters","personGeneration"],a);const u=h(n,["includeRaiReason"]);e!==void 0&&u!=null&&m(e,["parameters","includeRaiReason"],u);const d=h(n,["outputMimeType"]);e!==void 0&&d!=null&&m(e,["parameters","outputOptions","mimeType"],d);const f=h(n,["outputCompressionQuality"]);e!==void 0&&f!=null&&m(e,["parameters","outputOptions","compressionQuality"],f);const p=h(n,["enhanceInputImage"]);e!==void 0&&p!=null&&m(e,["parameters","upscaleConfig","enhanceInputImage"],p);const _=h(n,["imagePreservationFactor"]);e!==void 0&&_!=null&&m(e,["parameters","upscaleConfig","imagePreservationFactor"],_);const E=h(n,["labels"]);e!==void 0&&E!=null&&m(e,["labels"],E);const S=h(n,["numberOfImages"]);e!==void 0&&S!=null&&m(e,["parameters","sampleCount"],S);const C=h(n,["mode"]);return e!==void 0&&C!=null&&m(e,["parameters","mode"],C),t}function bP(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],ut(n,i));const o=h(e,["image"]);o!=null&&m(t,["instances[0]","image"],cs(o));const a=h(e,["upscaleFactor"]);a!=null&&m(t,["parameters","upscaleConfig","upscaleFactor"],a);const u=h(e,["config"]);return u!=null&&SP(u,t),t}function wP(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>_h(a))),m(e,["generatedImages"],o)}return e}function AP(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["uri"],t);const i=h(n,["encodedVideo"]);i!=null&&m(e,["videoBytes"],_o(i));const o=h(n,["encoding"]);return o!=null&&m(e,["mimeType"],o),e}function CP(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&m(e,["videoBytes"],_o(i));const o=h(n,["mimeType"]);return o!=null&&m(e,["mimeType"],o),e}function xP(n){const e={},t=h(n,["image"]);t!=null&&m(e,["_self"],cs(t));const i=h(n,["maskMode"]);return i!=null&&m(e,["maskMode"],i),e}function IP(n){const e={},t=h(n,["image"]);t!=null&&m(e,["image"],vh(t));const i=h(n,["referenceType"]);return i!=null&&m(e,["referenceType"],i),e}function RP(n){const e={},t=h(n,["image"]);t!=null&&m(e,["image"],cs(t));const i=h(n,["referenceType"]);return i!=null&&m(e,["referenceType"],i),e}function Rb(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["uri"],t);const i=h(n,["videoBytes"]);i!=null&&m(e,["encodedVideo"],_o(i));const o=h(n,["mimeType"]);return o!=null&&m(e,["encoding"],o),e}function Nb(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["gcsUri"],t);const i=h(n,["videoBytes"]);i!=null&&m(e,["bytesBase64Encoded"],_o(i));const o=h(n,["mimeType"]);return o!=null&&m(e,["mimeType"],o),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const NP="Content-Type",MP="X-Server-Timeout",PP="User-Agent",ym="x-goog-api-client",DP="1.30.0",kP=`google-genai-sdk/${DP}`,UP="v1beta1",LP="v1beta",dT=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class VP{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const o={};this.clientOptions.vertexai?(o.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:UP,o.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(o.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:LP,o.baseUrl="https://generativelanguage.googleapis.com/"),o.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=o,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(o,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const o=[this.getRequestUrlInternal(t)];return i&&o.push(this.getBaseResourcePath()),e!==""&&o.push(e),new URL(`${o.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[u,d]of Object.entries(e.queryParams))o.searchParams.append(u,String(d));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,o.toString(),e.abortSignal),this.unaryApiCall(o,a,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[o,a]of Object.entries(t))typeof a=="object"?i[o]=Object.assign(Object.assign({},i[o]),a):a!==void 0&&(i[o]=a);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),o=this.constructUrl(e.path,t,i);(!o.searchParams.has("alt")||o.searchParams.get("alt")!=="sse")&&o.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,o.toString(),e.abortSignal),this.streamApiCall(o,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,o){if(t&&t.timeout||o){const a=new AbortController,u=a.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const d=setTimeout(()=>a.abort(),t.timeout);d&&typeof d.unref=="function"&&d.unref()}o&&o.addEventListener("abort",()=>{a.abort()}),e.signal=u}return t&&t.extraBody!==null&&OP(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async o=>(await hT(o),new hm(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async o=>(await hT(o),this.processStreamResponse(o))).catch(o=>{throw o instanceof Error?o:new Error(JSON.stringify(o))})}processStreamResponse(e){var t;return ol(this,arguments,function*(){const o=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),a=new TextDecoder("utf-8");if(!o)throw new Error("Response body is empty");try{let u="";for(;;){const{done:d,value:f}=yield Dt(o.read());if(d){if(u.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const p=a.decode(f,{stream:!0});try{const E=JSON.parse(p);if("error"in E){const S=JSON.parse(JSON.stringify(E.error)),C=S.status,k=S.code,V=`got status: ${C}. ${JSON.stringify(E)}`;if(k>=400&&k<600)throw new gh({message:V,status:k})}}catch(E){if(E.name==="ApiError")throw E}u+=p;let _=u.match(dT);for(;_;){const E=_[1];try{const S=new Response(E,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Dt(new hm(S)),u=u.slice(_[0].length),_=u.match(dT)}catch(S){throw new Error(`exception parsing stream chunk ${E}. ${S}`)}}}}finally{o.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=kP+" "+this.clientOptions.userAgentExtra;return e[PP]=t,e[ym]=t,e[NP]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[o,a]of Object.entries(e.headers))i.append(o,a);e.timeout&&e.timeout>0&&i.append(MP,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const o={};t!=null&&(o.mimeType=t.mimeType,o.name=t.name,o.displayName=t.displayName),o.name&&!o.name.startsWith("files/")&&(o.name=`files/${o.name}`);const a=this.clientOptions.uploader,u=await a.stat(e);o.sizeBytes=String(u.size);const d=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:u.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");o.mimeType=d;const f={file:o},p=this.getFileName(e),_=pe("upload/v1beta/files",f._url),E=await this.fetchUploadUrl(_,o.sizeBytes,o.mimeType,p,f,t==null?void 0:t.httpOptions);return a.upload(e,E,this)}async uploadFileToFileSearchStore(e,t,i){var o;const a=this.clientOptions.uploader,u=await a.stat(t),d=String(u.size),f=(o=i==null?void 0:i.mimeType)!==null&&o!==void 0?o:u.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,_=this.getFileName(t),E={};i!=null&&i.customMetadata&&(E.customMetadata=i.customMetadata),i!=null&&i.chunkingConfig&&(E.chunkingConfig=i.chunkingConfig);const S=await this.fetchUploadUrl(p,d,f,_,E,i==null?void 0:i.httpOptions);return a.uploadToFileSearchStore(t,S,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,o,a,u){var d;let f={};u?f=u:f={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},o?{"X-Goog-Upload-File-Name":o}:{})};const p=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:f});if(!p||!(p!=null&&p.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const _=(d=p==null?void 0:p.headers)===null||d===void 0?void 0:d["x-goog-upload-url"];if(_===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return _}}async function hT(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const o=JSON.stringify(i);throw t>=400&&t<600?new gh({message:o,status:t}):new Error(o)}}function OP(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const a=JSON.parse(n.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(a,u){const d=Object.assign({},a);for(const f in u)if(Object.prototype.hasOwnProperty.call(u,f)){const p=u[f],_=d[f];p&&typeof p=="object"&&!Array.isArray(p)&&_&&typeof _=="object"&&!Array.isArray(_)?d[f]=i(_,p):(_&&p&&typeof _!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof _}, New type: ${typeof p}. Overwriting.`),d[f]=p)}return d}const o=i(t,e);n.body=JSON.stringify(o)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zP="mcp_used/unknown";let FP=!1;function Mb(n){for(const e of n)if(BP(e)||typeof e=="object"&&"inputSchema"in e)return!0;return FP}function Pb(n){var e;const t=(e=n[ym])!==null&&e!==void 0?e:"";n[ym]=(t+` ${zP}`).trimStart()}function BP(n){return n!==null&&typeof n=="object"&&n instanceof lg}function qP(n,e=100){return ol(this,arguments,function*(){let i,o=0;for(;o<e;){const a=yield Dt(n.listTools({cursor:i}));for(const u of a.tools)yield yield Dt(u),o++;if(!a.nextCursor)break;i=a.nextCursor}})}class lg{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new lg(e,t)}async initialize(){var e,t,i,o;if(this.mcpTools.length>0)return;const a={},u=[];for(const _ of this.mcpClients)try{for(var d=!0,f=(t=void 0,Nu(qP(_))),p;p=await f.next(),e=p.done,!e;d=!0){o=p.value,d=!1;const E=o;u.push(E);const S=E.name;if(a[S])throw new Error(`Duplicate function name ${S} found in MCP tools. Please ensure function names are unique.`);a[S]=_}}catch(E){t={error:E}}finally{try{!d&&!e&&(i=f.return)&&await i.call(f)}finally{if(t)throw t.error}}this.mcpTools=u,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),kR(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const o=this.functionNameToMcpClient[i.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const u=await o.callTool({name:i.name,arguments:i.args},void 0,a);t.push({functionResponse:{name:i.name,response:u.isError?{error:u}:u}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function HP(n,e,t){const i=new CR;let o;t.data instanceof Blob?o=JSON.parse(await t.data.text()):o=JSON.parse(t.data),Object.assign(i,o),e(i)}class GP{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const o=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),u=KP(this.apiClient.getDefaultHeaders()),d=this.apiClient.getApiKey(),f=`${o}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${d}`;let p=()=>{};const _=new Promise(Z=>{p=Z}),E=e.callbacks,S=function(){p({})},C=this.apiClient,k={onopen:S,onmessage:Z=>{HP(C,E.onmessage,Z)},onerror:(t=E==null?void 0:E.onerror)!==null&&t!==void 0?t:function(Z){},onclose:(i=E==null?void 0:E.onclose)!==null&&i!==void 0?i:function(Z){}},V=this.webSocketFactory.create(f,$P(u),k);V.connect(),await _;const j={setup:{model:ut(this.apiClient,e.model)}};return V.send(JSON.stringify(j)),new YP(V,this.apiClient)}}class YP{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=MN(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=NN(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(sl.PLAY)}pause(){this.sendPlaybackControl(sl.PAUSE)}stop(){this.sendPlaybackControl(sl.STOP)}resetContext(){this.sendPlaybackControl(sl.RESET_CONTEXT)}close(){this.conn.close()}}function $P(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function KP(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const JP="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function jP(n,e,t){const i=new AR;let o;t.data instanceof Blob?o=await t.data.text():t.data instanceof ArrayBuffer?o=new TextDecoder().decode(t.data):o=t.data;const a=JSON.parse(o);if(n.isVertexAI()){const u=kN(a);Object.assign(i,u)}else Object.assign(i,a);e(i)}class XP{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new GP(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,o,a,u,d;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const f=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let _;const E=this.apiClient.getHeaders();e.config&&e.config.tools&&Mb(e.config.tools)&&Pb(E);const S=eD(E);if(this.apiClient.isVertexAI())_=`${f}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(S,_);else{const N=this.apiClient.getApiKey();let P="BidiGenerateContent",U="key";N!=null&&N.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),P="BidiGenerateContentConstrained",U="access_token"),_=`${f}/ws/google.ai.generativelanguage.${p}.GenerativeService.${P}?${U}=${N}`}let C=()=>{};const k=new Promise(N=>{C=N}),V=e.callbacks,z=function(){var N;(N=V==null?void 0:V.onopen)===null||N===void 0||N.call(V),C({})},J=this.apiClient,j={onopen:z,onmessage:N=>{jP(J,V.onmessage,N)},onerror:(t=V==null?void 0:V.onerror)!==null&&t!==void 0?t:function(N){},onclose:(i=V==null?void 0:V.onclose)!==null&&i!==void 0?i:function(N){}},Z=this.webSocketFactory.create(_,ZP(S),j);Z.connect(),await k;let H=ut(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&H.startsWith("publishers/")){const N=this.apiClient.getProject(),P=this.apiClient.getLocation();H=`projects/${N}/locations/${P}/`+H}let ae={};this.apiClient.isVertexAI()&&((o=e.config)===null||o===void 0?void 0:o.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Gd.AUDIO]}:e.config.responseModalities=[Gd.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const oe=(d=(u=e.config)===null||u===void 0?void 0:u.tools)!==null&&d!==void 0?d:[],x=[];for(const N of oe)if(this.isCallableTool(N)){const P=N;x.push(await P.tool())}else x.push(N);x.length>0&&(e.config.tools=x);const M={model:H,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?ae=RN(this.apiClient,M):ae=IN(this.apiClient,M),delete ae.config,Z.send(JSON.stringify(ae)),new WP(Z,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const QP={turnComplete:!0};class WP{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Hi(t.turns),e.isVertexAI()||(i=i.map(o=>yh(o)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const a of i){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(JP)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},QP),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:DN(e)}:t={realtimeInput:PN(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function ZP(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function eD(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fT=10;function pT(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let o=!1;for(const u of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(al(u)){o=!0;break}if(!o)return!0;const a=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function al(n){return"callTool"in n&&typeof n.callTool=="function"}function tD(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(o=>al(o)))!==null&&i!==void 0?i:!1}function mT(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,o)=>{if(al(i))return;const a=i;a.functionDeclarations&&a.functionDeclarations.length>0&&t.push(o)}),t}function gT(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nD extends Tr{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,o,a,u,d;const f=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!tD(t)||pT(t.config))return await this.generateContentInternal(f);const p=mT(t);if(p.length>0){const V=p.map(z=>`tools[${z}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${V}.`)}let _,E;const S=Hi(f.contents),C=(a=(o=(i=f.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&a!==void 0?a:fT;let k=0;for(;k<C&&(_=await this.generateContentInternal(f),!(!_.functionCalls||_.functionCalls.length===0));){const V=_.candidates[0].content,z=[];for(const J of(d=(u=t.config)===null||u===void 0?void 0:u.tools)!==null&&d!==void 0?d:[])if(al(J)){const Z=await J.callTool(_.functionCalls);z.push(...Z)}k++,E={role:"user",parts:z},f.contents=Hi(f.contents),f.contents.push(V),f.contents.push(E),gT(f.config)&&(S.push(V),S.push(E))}return gT(f.config)&&(_.automaticFunctionCallingHistory=S),_},this.generateContentStream=async t=>{var i,o,a,u,d;if(this.maybeMoveToResponseJsonSchem(t),pT(t.config)){const E=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(E)}const f=mT(t);if(f.length>0){const E=f.map(S=>`tools[${S}]`).join(", ");throw new Error(`Incompatible tools found at ${E}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(a=(o=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||o===void 0?void 0:o.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,_=(d=(u=t==null?void 0:t.config)===null||u===void 0?void 0:u.automaticFunctionCalling)===null||d===void 0?void 0:d.disable;if(p&&!_)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var o;let a;const u=[];if(i!=null&&i.generatedImages)for(const f of i.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((o=f==null?void 0:f.safetyAttributes)===null||o===void 0?void 0:o.contentType)==="Positive Prompt"?a=f==null?void 0:f.safetyAttributes:u.push(f);let d;return a?d={generatedImages:u,positivePromptSafetyAttributes:a,sdkHttpResponse:i.sdkHttpResponse}:d={generatedImages:u,sdkHttpResponse:i.sdkHttpResponse},d}),this.list=async t=>{var i;const u={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!u.config.queryBase){if(!((i=u.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");u.config.filter="labels.tune-type:*"}return new ca(gr.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(u),u)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(o=>o.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const o={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(o)},this.generateVideos=async t=>{var i,o,a,u,d,f;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((o=t.video)===null||o===void 0)&&o.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((u=(a=t.source)===null||a===void 0?void 0:a.video)===null||u===void 0)&&u.uri&&(!((f=(d=t.source)===null||d===void 0?void 0:d.video)===null||f===void 0)&&f.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,o;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const u=await Promise.all(a.map(async f=>al(f)?await f.tool():f)),d={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:u})};if(d.config.tools=u,e.config&&e.config.tools&&Mb(e.config.tools)){const f=(o=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&o!==void 0?o:{};let p=Object.assign({},f);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),Pb(p),d.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return d}async initAfcToolsMap(e){var t,i,o;const a=new Map;for(const u of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(al(u)){const d=u,f=await d.tool();for(const p of(o=f.functionDeclarations)!==null&&o!==void 0?o:[]){if(!p.name)throw new Error("Function declaration name is required.");if(a.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);a.set(p.name,d)}}return a}async processAfcStream(e){var t,i,o;const a=(o=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:fT;let u=!1,d=0;const f=await this.initAfcToolsMap(e);return(function(p,_,E){var S,C;return ol(this,arguments,function*(){for(var k,V,z,J;d<a;){u&&(d++,u=!1);const ae=yield Dt(p.processParamsMaybeAddMcpUsage(E)),oe=yield Dt(p.generateContentStreamInternal(ae)),x=[],M=[];try{for(var j=!0,Z=(V=void 0,Nu(oe)),H;H=yield Dt(Z.next()),k=H.done,!k;j=!0){J=H.value,j=!1;const N=J;if(yield yield Dt(N),N.candidates&&(!((S=N.candidates[0])===null||S===void 0)&&S.content)){M.push(N.candidates[0].content);for(const P of(C=N.candidates[0].content.parts)!==null&&C!==void 0?C:[])if(d<a&&P.functionCall){if(!P.functionCall.name)throw new Error("Function call name was not returned by the model.");if(_.has(P.functionCall.name)){const U=yield Dt(_.get(P.functionCall.name).callTool([P.functionCall]));x.push(...U)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${_.keys()}, mising tool: ${P.functionCall.name}`)}}}}catch(N){V={error:N}}finally{try{!j&&!k&&(z=Z.return)&&(yield Dt(z.call(Z)))}finally{if(V)throw V.error}}if(x.length>0){u=!0;const N=new bu;N.candidates=[{content:{role:"user",parts:x}}],yield yield Dt(N);const P=[];P.push(...M),P.push({role:"user",parts:x});const U=Hi(E.contents).concat(P);E.contents=U}else break}})})(this,f,e)}async generateContentInternal(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=lT(this.apiClient,e);return d=pe("{model}:generateContent",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=cT(_),S=new bu;return Object.assign(S,E),S})}else{const p=aT(this.apiClient,e);return d=pe("{model}:generateContent",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=uT(_),S=new bu;return Object.assign(S,E),S})}}async generateContentStreamInternal(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=lT(this.apiClient,e);return d=pe("{model}:streamGenerateContent?alt=sse",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.requestStream({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),u.then(function(E){return ol(this,arguments,function*(){var S,C,k,V;try{for(var z=!0,J=Nu(E),j;j=yield Dt(J.next()),S=j.done,!S;z=!0){V=j.value,z=!1;const Z=V,H=cT(yield Dt(Z.json()));H.sdkHttpResponse={headers:Z.headers};const ae=new bu;Object.assign(ae,H),yield yield Dt(ae)}}catch(Z){C={error:Z}}finally{try{!z&&!S&&(k=J.return)&&(yield Dt(k.call(J)))}finally{if(C)throw C.error}}})})}else{const p=aT(this.apiClient,e);return d=pe("{model}:streamGenerateContent?alt=sse",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.requestStream({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),u.then(function(E){return ol(this,arguments,function*(){var S,C,k,V;try{for(var z=!0,J=Nu(E),j;j=yield Dt(J.next()),S=j.done,!S;z=!0){V=j.value,z=!1;const Z=V,H=uT(yield Dt(Z.json()));H.sdkHttpResponse={headers:Z.headers};const ae=new bu;Object.assign(ae,H),yield yield Dt(ae)}}catch(Z){C={error:Z}}finally{try{!z&&!S&&(k=J.return)&&(yield Dt(k.call(J)))}finally{if(C)throw C.error}}})})}}async embedContent(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=cM(this.apiClient,e);return d=pe("{model}:predict",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=hM(_),S=new YE;return Object.assign(S,E),S})}else{const p=uM(this.apiClient,e);return d=pe("{model}:batchEmbedContents",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=dM(_),S=new YE;return Object.assign(S,E),S})}}async generateImagesInternal(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=bM(this.apiClient,e);return d=pe("{model}:predict",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=AM(_),S=new $E;return Object.assign(S,E),S})}else{const p=SM(this.apiClient,e);return d=pe("{model}:predict",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=wM(_),S=new $E;return Object.assign(S,E),S})}}async editImageInternal(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI()){const d=rM(this.apiClient,e);return a=pe("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const p=oM(f),_=new pR;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI()){const d=bP(this.apiClient,e);return a=pe("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const p=wP(f),_=new mR;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI()){const d=sP(this.apiClient,e);return a=pe("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>{const p=rP(f),_=new gR;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI()){const d=dP(this.apiClient,e);return a=pe("{model}:predict",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>{const p=hP(f),_=new yR;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=qM(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),u.then(_=>gm(_))}else{const p=BM(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),u.then(_=>mm(_))}}async listInternal(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=QM(this.apiClient,e);return d=pe("{models_url}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=ZM(_),S=new KE;return Object.assign(S,E),S})}else{const p=XM(this.apiClient,e);return d=pe("{models_url}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=WM(_),S=new KE;return Object.assign(S,E),S})}}async update(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=TP(this.apiClient,e);return d=pe("{model}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),u.then(_=>gm(_))}else{const p=EP(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),u.then(_=>mm(_))}}async delete(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=tM(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=iM(_),S=new JE;return Object.assign(S,E),S})}else{const p=eM(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=nM(_),S=new JE;return Object.assign(S,E),S})}}async countTokens(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=QN(this.apiClient,e);return d=pe("{model}:countTokens",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=ZN(_),S=new jE;return Object.assign(S,E),S})}else{const p=XN(this.apiClient,e);return d=pe("{model}:countTokens",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=WN(_),S=new jE;return Object.assign(S,E),S})}}async computeTokens(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI()){const d=HN(this.apiClient,e);return a=pe("{model}:computeTokens",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>{const p=GN(f),_=new _R;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=MM(this.apiClient,e);return d=pe("{model}:predictLongRunning",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),u.then(_=>{const E=RM(_),S=new Yd;return Object.assign(S,E),S})}else{const p=NM(this.apiClient,e);return d=pe("{model}:predictLongRunning",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),u.then(_=>{const E=IM(_),S=new Yd;return Object.assign(S,E),S})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class iD extends Tr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:u,_isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const o=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const u=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:o,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:u,_isVertexAI:!0})}else{const o=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=lR(e);return d=pe("{operationName}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),u}else{const p=aR(e);return d=pe("{operationName}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),u}}async fetchPredictVideosOperationInternal(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI()){const d=eR(e);return a=pe("{resourceName}:fetchPredictOperation",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sD(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function rD(n){const e={},t=h(n,["parts"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(a=>pD(a))),m(e,["parts"],o)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function oD(n,e,t){const i={},o=h(e,["expireTime"]);t!==void 0&&o!=null&&m(t,["expireTime"],o);const a=h(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&m(t,["newSessionExpireTime"],a);const u=h(e,["uses"]);t!==void 0&&u!=null&&m(t,["uses"],u);const d=h(e,["liveConnectConstraints"]);t!==void 0&&d!=null&&m(t,["bidiGenerateContentSetup"],fD(n,d));const f=h(e,["lockAdditionalFields"]);return t!==void 0&&f!=null&&m(t,["fieldMask"],f),i}function aD(n,e){const t={},i=h(e,["config"]);return i!=null&&m(t,["config"],oD(n,i,t)),t}function lD(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function uD(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const o=h(n,["name"]);if(o!=null&&m(e,["name"],o),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function cD(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function dD(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function hD(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig"],i);const o=h(n,["responseModalities"]);e!==void 0&&o!=null&&m(e,["setup","generationConfig","responseModalities"],o);const a=h(n,["temperature"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","temperature"],a);const u=h(n,["topP"]);e!==void 0&&u!=null&&m(e,["setup","generationConfig","topP"],u);const d=h(n,["topK"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","topK"],d);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const p=h(n,["mediaResolution"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","mediaResolution"],p);const _=h(n,["seed"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","seed"],_);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&m(e,["setup","generationConfig","speechConfig"],ag(E));const S=h(n,["thinkingConfig"]);e!==void 0&&S!=null&&m(e,["setup","generationConfig","thinkingConfig"],S);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],C);const k=h(n,["systemInstruction"]);e!==void 0&&k!=null&&m(e,["setup","systemInstruction"],rD(qn(k)));const V=h(n,["tools"]);if(e!==void 0&&V!=null){let oe=wl(V);Array.isArray(oe)&&(oe=oe.map(x=>gD(bl(x)))),m(e,["setup","tools"],oe)}const z=h(n,["sessionResumption"]);e!==void 0&&z!=null&&m(e,["setup","sessionResumption"],mD(z));const J=h(n,["inputAudioTranscription"]);e!==void 0&&J!=null&&m(e,["setup","inputAudioTranscription"],J);const j=h(n,["outputAudioTranscription"]);e!==void 0&&j!=null&&m(e,["setup","outputAudioTranscription"],j);const Z=h(n,["realtimeInputConfig"]);e!==void 0&&Z!=null&&m(e,["setup","realtimeInputConfig"],Z);const H=h(n,["contextWindowCompression"]);e!==void 0&&H!=null&&m(e,["setup","contextWindowCompression"],H);const ae=h(n,["proactivity"]);return e!==void 0&&ae!=null&&m(e,["setup","proactivity"],ae),t}function fD(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["setup","model"],ut(n,i));const o=h(e,["config"]);return o!=null&&m(t,["config"],hD(o,t)),t}function pD(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const o=h(n,["executableCode"]);o!=null&&m(e,["executableCode"],o);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],lD(a));const u=h(n,["functionCall"]);u!=null&&m(e,["functionCall"],uD(u));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],sD(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const S=h(n,["videoMetadata"]);return S!=null&&m(e,["videoMetadata"],S),e}function mD(n){const e={},t=h(n,["handle"]);if(t!=null&&m(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function gD(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const o=h(n,["computerUse"]);o!=null&&m(e,["computerUse"],o);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const u=h(n,["codeExecution"]);if(u!=null&&m(e,["codeExecution"],u),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],cD(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],dD(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yD(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const o=Object.keys(i).map(a=>`${t}.${a}`);e.push(...o)}else e.push(t)}return e.join(",")}function _D(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const a=i.setup;typeof a=="object"&&a!==null?(n.bidiGenerateContentSetup=a,t=a):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const o=n.fieldMask;if(t){const a=yD(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?n.fieldMask=a:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&o!==null&&Array.isArray(o)&&o.length>0){const u=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];o.length>0&&(d=o.map(p=>u.includes(p)?`generationConfig.${p}`:p));const f=[];a&&f.push(a),d.length>0&&f.push(...d),f.length>0?n.fieldMask=f.join(","):delete n.fieldMask}else delete n.fieldMask}else o!==null&&Array.isArray(o)&&o.length>0?n.fieldMask=o.join(","):delete n.fieldMask;return n}class vD extends Tr{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const d=aD(this.apiClient,e);a=pe("auth_tokens",d._url),u=d._query,delete d.config,delete d._url,delete d._query;const f=_D(d,e.config);return o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),o.then(p=>p)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ED(n,e){const t={},i=h(n,["displayName"]);return e!==void 0&&i!=null&&m(e,["displayName"],i),t}function TD(n){const e={},t=h(n,["config"]);return t!=null&&ED(t,e),e}function SD(n,e){const t={},i=h(n,["force"]);return e!==void 0&&i!=null&&m(e,["_query","force"],i),t}function bD(n){const e={},t=h(n,["name"]);t!=null&&m(e,["_url","name"],t);const i=h(n,["config"]);return i!=null&&SD(i,e),e}function wD(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","name"],t),e}function AD(n,e){const t={},i=h(n,["customMetadata"]);if(e!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(u=>u)),m(e,["customMetadata"],a)}const o=h(n,["chunkingConfig"]);return e!==void 0&&o!=null&&m(e,["chunkingConfig"],o),t}function CD(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const o=h(n,["done"]);o!=null&&m(e,["done"],o);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const u=h(n,["response"]);return u!=null&&m(e,["response"],ID(u)),e}function xD(n){const e={},t=h(n,["fileSearchStoreName"]);t!=null&&m(e,["_url","file_search_store_name"],t);const i=h(n,["fileName"]);i!=null&&m(e,["fileName"],i);const o=h(n,["config"]);return o!=null&&AD(o,e),e}function ID(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["parent"]);i!=null&&m(e,["parent"],i);const o=h(n,["documentName"]);return o!=null&&m(e,["documentName"],o),e}function RD(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&m(e,["_query","pageToken"],o),t}function ND(n){const e={},t=h(n,["config"]);return t!=null&&RD(t,e),e}function MD(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const o=h(n,["fileSearchStores"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>u)),m(e,["fileSearchStores"],a)}return e}function PD(n,e){const t={},i=h(n,["mimeType"]);e!==void 0&&i!=null&&m(e,["mimeType"],i);const o=h(n,["displayName"]);e!==void 0&&o!=null&&m(e,["displayName"],o);const a=h(n,["customMetadata"]);if(e!==void 0&&a!=null){let d=a;Array.isArray(d)&&(d=d.map(f=>f)),m(e,["customMetadata"],d)}const u=h(n,["chunkingConfig"]);return e!==void 0&&u!=null&&m(e,["chunkingConfig"],u),t}function DD(n){const e={},t=h(n,["fileSearchStoreName"]);t!=null&&m(e,["_url","file_search_store_name"],t);const i=h(n,["config"]);return i!=null&&PD(i,e),e}function kD(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function UD(n,e){const t={},i=h(n,["force"]);return e!==void 0&&i!=null&&m(e,["_query","force"],i),t}function LD(n){const e={},t=h(n,["name"]);t!=null&&m(e,["_url","name"],t);const i=h(n,["config"]);return i!=null&&UD(i,e),e}function VD(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","name"],t),e}function OD(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const o=h(n,["pageToken"]);return e!==void 0&&o!=null&&m(e,["_query","pageToken"],o),t}function zD(n){const e={},t=h(n,["parent"]);t!=null&&m(e,["_url","parent"],t);const i=h(n,["config"]);return i!=null&&OD(i,e),e}function FD(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const o=h(n,["documents"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(u=>u)),m(e,["documents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class BD extends Tr{constructor(e){super(),this.apiClient=e,this.list=async t=>new ca(gr.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=VD(e);return a=pe("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async delete(e){var t,i;let o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=LD(e);o=pe("{name}",u._url),a=u._query,delete u._url,delete u._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=zD(e);return a=pe("{parent}/documents",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>{const p=FD(f),_=new vR;return Object.assign(_,p),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qD extends Tr{constructor(e,t=new BD(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new ca(gr.PAGED_ITEM_FILE_SEARCH_STORES,o=>this.listInternal(o),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=TD(e);return a=pe("fileSearchStores",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async get(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=wD(e);return a=pe("{name}",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>f)}}async delete(e){var t,i;let o="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=bD(e);o=pe("{name}",u._url),a=u._query,delete u._url,delete u._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=ND(e);return a=pe("fileSearchStores",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>{const p=MD(f),_=new ER;return Object.assign(_,p),_})}}async uploadToFileSearchStoreInternal(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=DD(e);return a=pe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>{const p=kD(f),_=new TR;return Object.assign(_,p),_})}}async importFile(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=xD(e);return a=pe("{file_search_store_name}:importFile",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),o.then(f=>{const p=CD(f),_=new ng;return Object.assign(_,p),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HD(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function GD(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function YD(n,e,t){const i={};if(h(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const o=h(n,["tunedModelDisplayName"]);if(e!==void 0&&o!=null&&m(e,["displayName"],o),h(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=h(n,["epochCount"]);e!==void 0&&a!=null&&m(e,["tuningTask","hyperparameters","epochCount"],a);const u=h(n,["learningRateMultiplier"]);if(u!=null&&m(i,["tuningTask","hyperparameters","learningRateMultiplier"],u),h(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(h(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const d=h(n,["batchSize"]);e!==void 0&&d!=null&&m(e,["tuningTask","hyperparameters","batchSize"],d);const f=h(n,["learningRate"]);if(e!==void 0&&f!=null&&m(e,["tuningTask","hyperparameters","learningRate"],f),h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(h(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function $D(n,e,t){const i={};let o=h(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const C=h(n,["validationDataset"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec"],yT(C))}else if(o==="PREFERENCE_TUNING"){const C=h(n,["validationDataset"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec"],yT(C))}const a=h(n,["tunedModelDisplayName"]);e!==void 0&&a!=null&&m(e,["tunedModelDisplayName"],a);const u=h(n,["description"]);e!==void 0&&u!=null&&m(e,["description"],u);let d=h(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const C=h(n,["epochCount"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec","hyperParameters","epochCount"],C)}else if(d==="PREFERENCE_TUNING"){const C=h(n,["epochCount"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],C)}let f=h(t,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const C=h(n,["learningRateMultiplier"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],C)}else if(f==="PREFERENCE_TUNING"){const C=h(n,["learningRateMultiplier"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],C)}let p=h(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const C=h(n,["exportLastCheckpointOnly"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec","exportLastCheckpointOnly"],C)}else if(p==="PREFERENCE_TUNING"){const C=h(n,["exportLastCheckpointOnly"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],C)}let _=h(t,["config","method"]);if(_===void 0&&(_="SUPERVISED_FINE_TUNING"),_==="SUPERVISED_FINE_TUNING"){const C=h(n,["adapterSize"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec","hyperParameters","adapterSize"],C)}else if(_==="PREFERENCE_TUNING"){const C=h(n,["adapterSize"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],C)}if(h(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const E=h(n,["labels"]);e!==void 0&&E!=null&&m(e,["labels"],E);const S=h(n,["beta"]);return e!==void 0&&S!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","beta"],S),i}function KD(n,e){const t={},i=h(n,["baseModel"]);i!=null&&m(t,["baseModel"],i);const o=h(n,["preTunedModel"]);o!=null&&m(t,["preTunedModel"],o);const a=h(n,["trainingDataset"]);a!=null&&sk(a);const u=h(n,["config"]);return u!=null&&YD(u,t),t}function JD(n,e){const t={},i=h(n,["baseModel"]);i!=null&&m(t,["baseModel"],i);const o=h(n,["preTunedModel"]);o!=null&&m(t,["preTunedModel"],o);const a=h(n,["trainingDataset"]);a!=null&&rk(a,t,e);const u=h(n,["config"]);return u!=null&&$D(u,t,e),t}function jD(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function XD(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function QD(n,e,t){const i={},o=h(n,["pageSize"]);e!==void 0&&o!=null&&m(e,["_query","pageSize"],o);const a=h(n,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const u=h(n,["filter"]);return e!==void 0&&u!=null&&m(e,["_query","filter"],u),i}function WD(n,e,t){const i={},o=h(n,["pageSize"]);e!==void 0&&o!=null&&m(e,["_query","pageSize"],o);const a=h(n,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const u=h(n,["filter"]);return e!==void 0&&u!=null&&m(e,["_query","filter"],u),i}function ZD(n,e){const t={},i=h(n,["config"]);return i!=null&&QD(i,t),t}function ek(n,e){const t={},i=h(n,["config"]);return i!=null&&WD(i,t),t}function tk(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const o=h(n,["nextPageToken"]);o!=null&&m(t,["nextPageToken"],o);const a=h(n,["tunedModels"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(d=>Db(d))),m(t,["tuningJobs"],u)}return t}function nk(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const o=h(n,["nextPageToken"]);o!=null&&m(t,["nextPageToken"],o);const a=h(n,["tuningJobs"]);if(a!=null){let u=a;Array.isArray(u)&&(u=u.map(d=>_m(d))),m(t,["tuningJobs"],u)}return t}function ik(n,e){const t={},i=h(n,["name"]);i!=null&&m(t,["model"],i);const o=h(n,["name"]);return o!=null&&m(t,["endpoint"],o),t}function sk(n,e){const t={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=h(n,["examples"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(a=>a)),m(t,["examples","examples"],o)}return t}function rk(n,e,t){const i={};let o=h(t,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const u=h(n,["gcsUri"]);e!==void 0&&u!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],u)}else if(o==="PREFERENCE_TUNING"){const u=h(n,["gcsUri"]);e!==void 0&&u!=null&&m(e,["preferenceOptimizationSpec","trainingDatasetUri"],u)}let a=h(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const u=h(n,["vertexDatasetResource"]);e!==void 0&&u!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],u)}else if(a==="PREFERENCE_TUNING"){const u=h(n,["vertexDatasetResource"]);e!==void 0&&u!=null&&m(e,["preferenceOptimizationSpec","trainingDatasetUri"],u)}if(h(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function Db(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const o=h(n,["name"]);o!=null&&m(t,["name"],o);const a=h(n,["state"]);a!=null&&m(t,["state"],pb(a));const u=h(n,["createTime"]);u!=null&&m(t,["createTime"],u);const d=h(n,["tuningTask","startTime"]);d!=null&&m(t,["startTime"],d);const f=h(n,["tuningTask","completeTime"]);f!=null&&m(t,["endTime"],f);const p=h(n,["updateTime"]);p!=null&&m(t,["updateTime"],p);const _=h(n,["description"]);_!=null&&m(t,["description"],_);const E=h(n,["baseModel"]);E!=null&&m(t,["baseModel"],E);const S=h(n,["_self"]);return S!=null&&m(t,["tunedModel"],ik(S)),t}function _m(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const o=h(n,["name"]);o!=null&&m(t,["name"],o);const a=h(n,["state"]);a!=null&&m(t,["state"],pb(a));const u=h(n,["createTime"]);u!=null&&m(t,["createTime"],u);const d=h(n,["startTime"]);d!=null&&m(t,["startTime"],d);const f=h(n,["endTime"]);f!=null&&m(t,["endTime"],f);const p=h(n,["updateTime"]);p!=null&&m(t,["updateTime"],p);const _=h(n,["error"]);_!=null&&m(t,["error"],_);const E=h(n,["description"]);E!=null&&m(t,["description"],E);const S=h(n,["baseModel"]);S!=null&&m(t,["baseModel"],S);const C=h(n,["tunedModel"]);C!=null&&m(t,["tunedModel"],C);const k=h(n,["preTunedModel"]);k!=null&&m(t,["preTunedModel"],k);const V=h(n,["supervisedTuningSpec"]);V!=null&&m(t,["supervisedTuningSpec"],V);const z=h(n,["preferenceOptimizationSpec"]);z!=null&&m(t,["preferenceOptimizationSpec"],z);const J=h(n,["tuningDataStats"]);J!=null&&m(t,["tuningDataStats"],J);const j=h(n,["encryptionSpec"]);j!=null&&m(t,["encryptionSpec"],j);const Z=h(n,["partnerModelTuningSpec"]);Z!=null&&m(t,["partnerModelTuningSpec"],Z);const H=h(n,["customBaseModel"]);H!=null&&m(t,["customBaseModel"],H);const ae=h(n,["experiment"]);ae!=null&&m(t,["experiment"],ae);const oe=h(n,["labels"]);oe!=null&&m(t,["labels"],oe);const x=h(n,["outputUri"]);x!=null&&m(t,["outputUri"],x);const M=h(n,["pipelineJob"]);M!=null&&m(t,["pipelineJob"],M);const N=h(n,["serviceAccount"]);N!=null&&m(t,["serviceAccount"],N);const P=h(n,["tunedModelDisplayName"]);P!=null&&m(t,["tunedModelDisplayName"],P);const U=h(n,["veoTuningSpec"]);return U!=null&&m(t,["veoTuningSpec"],U),t}function ok(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const o=h(n,["name"]);o!=null&&m(t,["name"],o);const a=h(n,["metadata"]);a!=null&&m(t,["metadata"],a);const u=h(n,["done"]);u!=null&&m(t,["done"],u);const d=h(n,["error"]);return d!=null&&m(t,["error"],d),t}function yT(n,e){const t={},i=h(n,["gcsUri"]);i!=null&&m(t,["validationDatasetUri"],i);const o=h(n,["vertexDatasetResource"]);return o!=null&&m(t,["validationDatasetUri"],o),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ak extends Tr{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new ca(gr.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const o={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(o.checkpointId=t.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},t),{preTunedModel:o});return a.baseModel=void 0,await this.tuneInternal(a)}else{const o=Object.assign({},t);return await this.tuneInternal(o)}else{const o=Object.assign({},t),a=await this.tuneMldevInternal(o);let u="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?u=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(u=a.name.split("/operations/")[0]),{name:u,state:dm.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=XD(e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>_m(_))}else{const p=jD(e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>Db(_))}}async listInternal(e){var t,i,o,a;let u,d="",f={};if(this.apiClient.isVertexAI()){const p=ek(e);return d=pe("tuningJobs",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=nk(_),S=new XE;return Object.assign(S,E),S})}else{const p=ZD(e);return d=pe("tunedModels",p._url),f=p._query,delete p._url,delete p._query,u=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const S=E;return S.sdkHttpResponse={headers:_.headers},S})),u.then(_=>{const E=tk(_),S=new XE;return Object.assign(S,E),S})}}async cancel(e){var t,i,o,a;let u="",d={};if(this.apiClient.isVertexAI()){const f=GD(e);u=pe("{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const f=HD(e);u=pe("{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(o=e.config)===null||o===void 0?void 0:o.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async tuneInternal(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI()){const d=JD(e,e);return a=pe("tuningJobs",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>_m(f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let o,a="",u={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=KD(e);return a=pe("tunedModels",d._url),u=d._query,delete d._url,delete d._query,o=this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),o.then(f=>ok(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lk{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const uk=1024*1024*8,ck=3,dk=1e3,hk=2,Kd="x-goog-upload-status";async function fk(n,e,t){var i;const o=await kb(n,e,t),a=await(o==null?void 0:o.json());if(((i=o==null?void 0:o.headers)===null||i===void 0?void 0:i[Kd])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function pk(n,e,t){var i;const o=await kb(n,e,t),a=await(o==null?void 0:o.json());if(((i=o==null?void 0:o.headers)===null||i===void 0?void 0:i[Kd])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const u=lb(a),d=new ig;return Object.assign(d,u),d}async function kb(n,e,t){var i,o;let a=0,u=0,d=new hm(new Response),f="upload";for(a=n.size;u<a;){const p=Math.min(uk,a-u),_=n.slice(u,u+p);u+p>=a&&(f+=", finalize");let E=0,S=dk;for(;E<ck&&(d=await t.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(u),"Content-Length":String(p)}}}),!(!((i=d==null?void 0:d.headers)===null||i===void 0)&&i[Kd]));)E++,await gk(S),S=S*hk;if(u+=p,((o=d==null?void 0:d.headers)===null||o===void 0?void 0:o[Kd])!=="active")break;if(a<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return d}async function mk(n){return{size:n.size,type:n.type}}function gk(n){return new Promise(e=>setTimeout(e,n))}class yk{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await fk(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await pk(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await mk(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _k{create(e,t,i){return new vk(e,t,i)}}class vk{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _T="x-goog-api-key";class Ek{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(_T)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(_T,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Tk="gl-node/";class Sk{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=WI(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const o=new Ek(this.apiKey);this.apiClient=new VP({auth:o,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:Tk+"web",uploader:new yk,downloader:new lk}),this.models=new nD(this.apiClient),this.live=new XP(this.apiClient,o,new _k),this.batches=new x2(this.apiClient),this.chats=new lN(this.models,this.apiClient),this.caches=new rN(this.apiClient),this.files=new _N(this.apiClient),this.operations=new iD(this.apiClient),this.authTokens=new vD(this.apiClient),this.tunings=new ak(this.apiClient),this.fileSearchStores=new qD(this.apiClient)}}const bk="AIzaSyD_SjDb6huAMMCPdSfxUDlvEM9qwnYEYXQ",vm=n=>new Promise(e=>setTimeout(e,n)),wk=n=>window.btoa(encodeURIComponent(n).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode(parseInt(t,16)))),Ub=n=>new Promise((e,t)=>{const i=new FileReader;i.readAsDataURL(n),i.onload=()=>{typeof i.result=="string"?e(i.result):t(new Error("FileReader result was not a string"))},i.onerror=o=>{var a,u;return t(new Error("File reading failed: "+(((u=(a=o.target)==null?void 0:a.error)==null?void 0:u.message)||"Unknown error")))}}),ug=312,Eh=(n,e=ug)=>new Promise((t,i)=>{let o="";if(typeof n=="string")o=n;else{if(!n||!(n instanceof File))return i(new Error("Invalid file passed to resizeImage"));try{o=URL.createObjectURL(n)}catch{return Ub(n).then(d=>Eh(d,e)).then(t).catch(i)}}const a=new Image;a.crossOrigin="anonymous",a.onload=()=>{try{const u=document.createElement("canvas");let d=a.width,f=a.height;d>f?d>e&&(f*=e/d,d=e):f>e&&(d*=e/f,f=e),u.width=Math.floor(d),u.height=Math.floor(f);const p=u.getContext("2d");if(!p){o.startsWith("blob:")&&URL.revokeObjectURL(o),t(o);return}p.drawImage(a,0,0,d,f);const _=u.toDataURL("image/jpeg",.6);o.startsWith("blob:")&&URL.revokeObjectURL(o),t(_)}catch(u){o.startsWith("blob:")&&URL.revokeObjectURL(o),console.warn("Canvas resize failed, falling back to original",u),t(o)}},a.onerror=u=>{o.startsWith("blob:")&&URL.revokeObjectURL(o),console.warn("Image load for resize failed, falling back to original"),t(o)},a.src=o}),Ak=n=>new Promise((e,t)=>{const i=new Image;i.onload=()=>{try{const o=document.createElement("canvas");o.width=i.width,o.height=i.height;const a=o.getContext("2d");if(!a)return t(new Error("Canvas context failed"));a.translate(o.width,0),a.scale(-1,1),a.drawImage(i,0,0),e(o.toDataURL("image/jpeg",.6))}catch(o){t(o)}},i.onerror=()=>t(new Error("Mirror failed")),i.src=n}),Ck=async n=>{try{return await Eh(n,ug)}catch{try{return await Ub(n)}catch{throw new Error("Failed to process file")}}},Lb=n=>{if(!n||!n.includes(","))throw new Error("Invalid Data URI");const e=n.split(","),t=e[0].match(/^data:(.+);base64$/);return{mimeType:t?t[1]:"image/jpeg",data:e[1]}},jo=(n,e,t)=>{let i="";n==="step_left"?i=`<line x1="192" y1="200" x2="140" y2="350" stroke="${e}" stroke-width="20" /> <!-- Leg L -->
                 <line x1="192" y1="200" x2="240" y2="350" stroke="${e}" stroke-width="20" /> <!-- Leg R -->
                 <line x1="192" y1="150" x2="100" y2="100" stroke="${e}" stroke-width="20" /> <!-- Arm L -->
                 <line x1="192" y1="150" x2="284" y2="180" stroke="${e}" stroke-width="20" /> <!-- Arm R -->`:n==="step_right"?i=`<line x1="192" y1="200" x2="140" y2="350" stroke="${e}" stroke-width="20" /> <!-- Leg L -->
                 <line x1="192" y1="200" x2="260" y2="320" stroke="${e}" stroke-width="20" /> <!-- Leg R -->
                 <line x1="192" y1="150" x2="100" y2="180" stroke="${e}" stroke-width="20" /> <!-- Arm L -->
                 <line x1="192" y1="150" x2="284" y2="100" stroke="${e}" stroke-width="20" /> <!-- Arm R -->`:n==="impact"?i=`<line x1="192" y1="200" x2="120" y2="380" stroke="${e}" stroke-width="20" /> 
                 <line x1="192" y1="200" x2="264" y2="380" stroke="${e}" stroke-width="20" />
                 <line x1="192" y1="150" x2="80" y2="80" stroke="${e}" stroke-width="20" /> 
                 <line x1="192" y1="150" x2="304" y2="80" stroke="${e}" stroke-width="20" />`:i=`<line x1="192" y1="200" x2="172" y2="380" stroke="${e}" stroke-width="20" /> 
                 <line x1="192" y1="200" x2="212" y2="380" stroke="${e}" stroke-width="20" />
                 <line x1="192" y1="150" x2="142" y2="250" stroke="${e}" stroke-width="20" /> 
                 <line x1="192" y1="150" x2="242" y2="250" stroke="${e}" stroke-width="20" />`;const o=`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="384" height="512">
        <rect width="100%" height="100%" fill="#111" />
        <circle cx="192" cy="256" r="150" fill="none" stroke="${e}" stroke-width="2" opacity="0.2" />
        
        <!-- Body -->
        <line x1="192" y1="100" x2="192" y2="250" stroke="${e}" stroke-width="20" />
        <circle cx="192" cy="80" r="40" fill="${e}" />
        ${i}
        
        <!-- Label -->
        <rect x="0" y="450" width="100%" height="60" fill="black" opacity="0.7" />
        <text x="192" y="490" fill="white" font-family="monospace" font-size="24" text-anchor="middle" font-weight="bold">${t}</text>
    </svg>`;return`data:image/svg+xml;base64,${wk(o)}`},xk=n=>[{url:n,pose:"base",energy:"low",type:"body"},{url:jo("step_left","#00ffff","STEP LEFT"),pose:"step_left",energy:"mid",type:"body"},{url:jo("step_right","#ff00ff","STEP RIGHT"),pose:"step_right",energy:"mid",type:"body"},{url:jo("impact","#ffffff","IMPACT"),pose:"impact",energy:"high",type:"body"},{url:jo("base","#8b5cf6","IDLE 2"),pose:"idle_alt",energy:"low",type:"body"},{url:jo("step_left","#ffff00","LEAN LEFT"),pose:"lean_left",energy:"mid",type:"body"},{url:jo("step_right","#00ff00","LEAN RIGHT"),pose:"lean_right",energy:"mid",type:"body"},{url:jo("impact","#ff0000","SUPER JUMP"),pose:"jump",energy:"high",type:"body"}],Ik=async(n,e,t,i,o,a)=>{const{mimeType:u,data:d}=Lb(e),f=`
    Analyze image. Classify subject: 'CHARACTER', 'TEXT', or 'SYMBOL'.
    Plan keyframes. Use visual effects in prompts (Dolly zoom, RGB Moir, Chromatic aberration).
    `,p=`Plan 4 keyframes. ${f}
    1. LOW: Center Idle (Symmetrical)
    2. MID: Asymmetrical Move (Left)
    3. MID: Asymmetrical Move (Left) - Alt
    4. HIGH: Impact Pose (Left)`,_=`Plan 8 keyframes. ${f}
    Focus on directional asymmetry (LEFT SIDE ONLY). Progressive distortion.`,E=`Plan 15 keyframes. ${f}
    This is a PREMIUM generation.
    1-5: High Energy Dance Moves (Left Side).
    6-10: Smooth Transition/Flourish Moves.
    11-13: EXTREME CLOSE-UP of Face/Center. 11=Mouth Closed, 12=Mouth Open (Singing), 13=Mouth Wide (Shouting).
    14-15: Ultra-wide Impact Poses.
    Mark close-ups with type='closeup', others 'body'.
    `,C=`You are an Animation Director. Output JSON: { category, plans: [{pose, energy, prompt, type}] }. 
    Type must be 'body' or 'closeup'. Energy: 'low'|'mid'|'high'. 
    ${a?E:o?p:_}`,k=`Motion: "${t||"Dance/Pulse"}". Style: "${i}".`;try{console.log(`Planning animation... SuperMode: ${a}`);const V=await n.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{inlineData:{mimeType:u,data:d}},{text:k}]},config:{systemInstruction:C,responseMimeType:"application/json",responseSchema:{type:zn.OBJECT,properties:{category:{type:zn.STRING,enum:["CHARACTER","TEXT","SYMBOL"]},plans:{type:zn.ARRAY,items:{type:zn.OBJECT,properties:{pose:{type:zn.STRING},energy:{type:zn.STRING,enum:["low","mid","high"]},type:{type:zn.STRING,enum:["body","closeup"]},prompt:{type:zn.STRING}},required:["pose","energy","prompt"]}}},required:["category","plans"]}}}),z=JSON.parse(V.text||"{}");return{category:z.category||"CHARACTER",plans:z.plans||[]}}catch(V){return console.warn("Plan failed, fallback.",V),{category:"CHARACTER",plans:[{pose:"mid1",energy:"mid",prompt:"Dance move",type:"body"}]}}},Rk=async(n,e,t,i,o,a)=>{var _,E,S,C,k;let u="";i.type==="closeup"?(u=" Extreme close-up shot. Focus on face/center. Detail facial features or texture details.",i.prompt.includes("Open")?u+=" Mouth open, singing expression.":i.prompt.includes("Wide")?u+=" Mouth wide open, shouting/energetic expression.":u+=" Neutral/Closed mouth."):a==="CHARACTER"?u=" Full body shot. Dynamic depth of field. 'Dolly Zoom' effect.":a==="TEXT"&&(u=" Heavy RGB Moir pattern. Scanline interference.");const f=`Subject: ${a}. Style: ${o}. Action: ${i.prompt}. ${u}  Minimal dark background.`;let p=0;for(;p<3;)try{const z=(C=(S=(E=(_=(await n.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:[{inlineData:{mimeType:e,data:t}},{text:f}]}})).candidates)==null?void 0:_[0])==null?void 0:E.content)==null?void 0:S.parts)==null?void 0:C.find(J=>J.inlineData);if(z!=null&&z.inlineData){const J=`data:image/jpeg;base64,${z.inlineData.data}`;return{url:await Eh(J,512),pose:i.pose,energy:i.energy,type:i.type||"body",promptUsed:i.prompt}}return null}catch(V){if((k=V.message)!=null&&k.includes("429"))await vm(2e3*(p+1)+Math.random()*500),p++;else return null}return null},Nk=async(n,e,t,i,o,a=!1)=>{if(a)return await vm(1e3),{frames:xk(n),category:"CHARACTER"};const u=new Sk({apiKey:bk}),d=await Eh(n,ug),{mimeType:f,data:p}=Lb(d),{plans:_,category:E}=await Ik(u,d,t,e,i,o),C=(await Promise.all(_.map(async(z,J)=>(await vm(J*(o?1e3:800)),Rk(u,f,p,z,e,E))))).filter(z=>z!==null);if(C.length===0)throw new Error("Generation failed.");let k=[];if(E!=="TEXT"){const z=C.filter(j=>(j.energy==="mid"||j.energy==="high")&&j.type!=="closeup");k=(await Promise.all(z.map(async j=>{try{const Z=await Ak(j.url);return{...j,pose:`${j.pose}_mirror`,url:Z,promptUsed:j.promptUsed+" (Mirrored)"}}catch{return null}}))).filter(j=>j!==null)}return{frames:[{url:d,pose:"base",energy:"low",type:"body"},...C,...k],category:E}},Mk=()=>{};var vT={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let o=n.charCodeAt(i);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},Pk=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const o=n[t++];if(o<128)e[i++]=String.fromCharCode(o);else if(o>191&&o<224){const a=n[t++];e[i++]=String.fromCharCode((o&31)<<6|a&63)}else if(o>239&&o<365){const a=n[t++],u=n[t++],d=n[t++],f=((o&7)<<18|(a&63)<<12|(u&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(f>>10)),e[i++]=String.fromCharCode(56320+(f&1023))}else{const a=n[t++],u=n[t++];e[i++]=String.fromCharCode((o&15)<<12|(a&63)<<6|u&63)}}return e.join("")},Ob={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let o=0;o<n.length;o+=3){const a=n[o],u=o+1<n.length,d=u?n[o+1]:0,f=o+2<n.length,p=f?n[o+2]:0,_=a>>2,E=(a&3)<<4|d>>4;let S=(d&15)<<2|p>>6,C=p&63;f||(C=64,u||(S=64)),i.push(t[_],t[E],t[S],t[C])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Vb(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Pk(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let o=0;o<n.length;){const a=t[n.charAt(o++)],d=o<n.length?t[n.charAt(o)]:0;++o;const p=o<n.length?t[n.charAt(o)]:64;++o;const E=o<n.length?t[n.charAt(o)]:64;if(++o,a==null||d==null||p==null||E==null)throw new Dk;const S=a<<2|d>>4;if(i.push(S),p!==64){const C=d<<4&240|p>>2;if(i.push(C),E!==64){const k=p<<6&192|E;i.push(k)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Dk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kk=function(n){const e=Vb(n);return Ob.encodeByteArray(e,!0)},Jd=function(n){return kk(n).replace(/\./g,"")},zb=function(n){try{return Ob.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lk=()=>Uk().__FIREBASE_DEFAULTS__,Vk=()=>{if(typeof process>"u"||typeof vT>"u")return;const n=vT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Ok=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&zb(n[1]);return e&&JSON.parse(e)},Th=()=>{try{return Mk()||Lk()||Vk()||Ok()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Fb=n=>{var e,t;return(t=(e=Th())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},Bb=n=>{const e=Fb(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},qb=()=>{var n;return(n=Th())==null?void 0:n.config},Hb=n=>{var e;return(e=Th())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function cg(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",o=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:o,exp:o+3600,auth_time:o,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}},...n};return[Jd(JSON.stringify(t)),Jd(JSON.stringify(u)),""].join(".")}const Mu={};function Bk(){const n={prod:[],emulator:[]};for(const e of Object.keys(Mu))Mu[e]?n.emulator.push(e):n.prod.push(e);return n}function qk(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let ET=!1;function dg(n,e){if(typeof window>"u"||typeof document>"u"||!vo(window.location.host)||Mu[n]===e||Mu[n]||ET)return;Mu[n]=e;function t(S){return`__firebase__banner__${S}`}const i="__firebase__banner",a=Bk().prod.length>0;function u(){const S=document.getElementById(i);S&&S.remove()}function d(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function f(S,C){S.setAttribute("width","24"),S.setAttribute("id",C),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function p(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{ET=!0,u()},S}function _(S,C){S.setAttribute("id",C),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function E(){const S=qk(i),C=t("text"),k=document.getElementById(C)||document.createElement("span"),V=t("learnmore"),z=document.getElementById(V)||document.createElement("a"),J=t("preprendIcon"),j=document.getElementById(J)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const Z=S.element;d(Z),_(z,V);const H=p();f(j,J),Z.append(j,k,z,H),document.body.appendChild(Z)}a?(k.innerText="Preview backend disconnected.",j.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(j.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Hk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Hn())}function Gk(){var e;const n=(e=Th())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Yk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function $k(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Kk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Jk(){const n=Hn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function jk(){return!Gk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Xk(){try{return typeof indexedDB=="object"}catch{return!1}}function Qk(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(i);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var a;e(((a=o.error)==null?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk="FirebaseError";class Fs extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Wk,Object.setPrototypeOf(this,Fs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ju.prototype.create)}}class Ju{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},o=`${this.service}/${e}`,a=this.errors[e],u=a?Zk(a,i):"Error",d=`${this.serviceName}: ${u} (${o}).`;return new Fs(o,d,i)}}function Zk(n,e){return n.replace(e5,(t,i)=>{const o=e[i];return o!=null?String(o):`<${i}?>`})}const e5=/\{\$([^}]+)}/g;function t5(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function sa(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const o of t){if(!i.includes(o))return!1;const a=n[o],u=e[o];if(TT(a)&&TT(u)){if(!sa(a,u))return!1}else if(a!==u)return!1}for(const o of i)if(!t.includes(o))return!1;return!0}function TT(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function wu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[o,a]=i.split("=");e[decodeURIComponent(o)]=decodeURIComponent(a)}}),e}function Au(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function n5(n,e){const t=new i5(n,e);return t.subscribe.bind(t)}class i5{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let o;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");s5(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:i},o.next===void 0&&(o.next=$p),o.error===void 0&&(o.error=$p),o.complete===void 0&&(o.complete=$p);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function s5(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function $p(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(n){return n&&n._delegate?n._delegate:n}class co{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r5{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new zk;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&i.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(a5(e))try{this.getOrInitializeService({instanceIdentifier:Qo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:o});i.resolve(a)}catch{}}}}clearInstance(e=Qo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Qo){return this.instances.has(e)}getOptions(e=Qo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[a,u]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);i===d&&u.resolve(o)}return o}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(i)??new Set;o.add(e),this.onInitCallbacks.set(i,o);const a=this.instances.get(i);return a&&e(a,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const o of i)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:o5(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Qo){return this.component?this.component.multipleInstances?e:Qo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function o5(n){return n===Qo?void 0:n}function a5(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new r5(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Qe||(Qe={}));const u5={debug:Qe.DEBUG,verbose:Qe.VERBOSE,info:Qe.INFO,warn:Qe.WARN,error:Qe.ERROR,silent:Qe.SILENT},c5=Qe.INFO,d5={[Qe.DEBUG]:"log",[Qe.VERBOSE]:"log",[Qe.INFO]:"info",[Qe.WARN]:"warn",[Qe.ERROR]:"error"},h5=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),o=d5[e];if(o)console[o](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class hg{constructor(e){this.name=e,this._logLevel=c5,this._logHandler=h5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?u5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qe.DEBUG,...e),this._logHandler(this,Qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qe.VERBOSE,...e),this._logHandler(this,Qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qe.INFO,...e),this._logHandler(this,Qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qe.WARN,...e),this._logHandler(this,Qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qe.ERROR,...e),this._logHandler(this,Qe.ERROR,...e)}}const f5=(n,e)=>e.some(t=>n instanceof t);let ST,bT;function p5(){return ST||(ST=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function m5(){return bT||(bT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Gb=new WeakMap,Em=new WeakMap,Yb=new WeakMap,Kp=new WeakMap,fg=new WeakMap;function g5(n){const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("success",a),n.removeEventListener("error",u)},a=()=>{t(ro(n.result)),o()},u=()=>{i(n.error),o()};n.addEventListener("success",a),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&Gb.set(t,n)}).catch(()=>{}),fg.set(e,n),e}function y5(n){if(Em.has(n))return;const e=new Promise((t,i)=>{const o=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",u),n.removeEventListener("abort",u)},a=()=>{t(),o()},u=()=>{i(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",a),n.addEventListener("error",u),n.addEventListener("abort",u)});Em.set(n,e)}let Tm={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Em.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Yb.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ro(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function _5(n){Tm=n(Tm)}function v5(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Jp(this),e,...t);return Yb.set(i,e.sort?e.sort():[e]),ro(i)}:m5().includes(n)?function(...e){return n.apply(Jp(this),e),ro(Gb.get(this))}:function(...e){return ro(n.apply(Jp(this),e))}}function E5(n){return typeof n=="function"?v5(n):(n instanceof IDBTransaction&&y5(n),f5(n,p5())?new Proxy(n,Tm):n)}function ro(n){if(n instanceof IDBRequest)return g5(n);if(Kp.has(n))return Kp.get(n);const e=E5(n);return e!==n&&(Kp.set(n,e),fg.set(e,n)),e}const Jp=n=>fg.get(n);function T5(n,e,{blocked:t,upgrade:i,blocking:o,terminated:a}={}){const u=indexedDB.open(n,e),d=ro(u);return i&&u.addEventListener("upgradeneeded",f=>{i(ro(u.result),f.oldVersion,f.newVersion,ro(u.transaction),f)}),t&&u.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),d.then(f=>{a&&f.addEventListener("close",()=>a()),o&&f.addEventListener("versionchange",p=>o(p.oldVersion,p.newVersion,p))}).catch(()=>{}),d}const S5=["get","getKey","getAll","getAllKeys","count"],b5=["put","add","delete","clear"],jp=new Map;function wT(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(jp.get(e))return jp.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,o=b5.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(o||S5.includes(t)))return;const a=async function(u,...d){const f=this.transaction(u,o?"readwrite":"readonly");let p=f.store;return i&&(p=p.index(d.shift())),(await Promise.all([p[t](...d),o&&f.done]))[0]};return jp.set(e,a),a}_5(n=>({...n,get:(e,t,i)=>wT(e,t)||n.get(e,t,i),has:(e,t)=>!!wT(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(A5(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function A5(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Sm="@firebase/app",AT="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yr=new hg("@firebase/app"),C5="@firebase/app-compat",x5="@firebase/analytics-compat",I5="@firebase/analytics",R5="@firebase/app-check-compat",N5="@firebase/app-check",M5="@firebase/auth",P5="@firebase/auth-compat",D5="@firebase/database",k5="@firebase/data-connect",U5="@firebase/database-compat",L5="@firebase/functions",V5="@firebase/functions-compat",O5="@firebase/installations",z5="@firebase/installations-compat",F5="@firebase/messaging",B5="@firebase/messaging-compat",q5="@firebase/performance",H5="@firebase/performance-compat",G5="@firebase/remote-config",Y5="@firebase/remote-config-compat",$5="@firebase/storage",K5="@firebase/storage-compat",J5="@firebase/firestore",j5="@firebase/ai",X5="@firebase/firestore-compat",Q5="firebase",W5="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bm="[DEFAULT]",Z5={[Sm]:"fire-core",[C5]:"fire-core-compat",[I5]:"fire-analytics",[x5]:"fire-analytics-compat",[N5]:"fire-app-check",[R5]:"fire-app-check-compat",[M5]:"fire-auth",[P5]:"fire-auth-compat",[D5]:"fire-rtdb",[k5]:"fire-data-connect",[U5]:"fire-rtdb-compat",[L5]:"fire-fn",[V5]:"fire-fn-compat",[O5]:"fire-iid",[z5]:"fire-iid-compat",[F5]:"fire-fcm",[B5]:"fire-fcm-compat",[q5]:"fire-perf",[H5]:"fire-perf-compat",[G5]:"fire-rc",[Y5]:"fire-rc-compat",[$5]:"fire-gcs",[K5]:"fire-gcs-compat",[J5]:"fire-fst",[X5]:"fire-fst-compat",[j5]:"fire-vertex","fire-js":"fire-js",[Q5]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd=new Map,e4=new Map,wm=new Map;function CT(n,e){try{n.container.addComponent(e)}catch(t){yr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ra(n){const e=n.name;if(wm.has(e))return yr.debug(`There were multiple attempts to register component ${e}.`),!1;wm.set(e,n);for(const t of jd.values())CT(t,n);for(const t of e4.values())CT(t,n);return!0}function Sh(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function li(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t4={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},oo=new Ju("app","Firebase",t4);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new co("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw oo.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl=W5;function $b(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:bm,automaticDataCollectionEnabled:!0,...e},o=i.name;if(typeof o!="string"||!o)throw oo.create("bad-app-name",{appName:String(o)});if(t||(t=qb()),!t)throw oo.create("no-options");const a=jd.get(o);if(a){if(sa(t,a.options)&&sa(i,a.config))return a;throw oo.create("duplicate-app",{appName:o})}const u=new l5(o);for(const f of wm.values())u.addComponent(f);const d=new n4(t,i,u);return jd.set(o,d),d}function pg(n=bm){const e=jd.get(n);if(!e&&n===bm&&qb())return $b();if(!e)throw oo.create("no-app",{appName:n});return e}function Ns(n,e,t){let i=Z5[n]??n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yr.warn(u.join(" "));return}ra(new co(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4="firebase-heartbeat-database",s4=1,Vu="firebase-heartbeat-store";let Xp=null;function Kb(){return Xp||(Xp=T5(i4,s4,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Vu)}catch(t){console.warn(t)}}}}).catch(n=>{throw oo.create("idb-open",{originalErrorMessage:n.message})})),Xp}async function r4(n){try{const t=(await Kb()).transaction(Vu),i=await t.objectStore(Vu).get(Jb(n));return await t.done,i}catch(e){if(e instanceof Fs)yr.warn(e.message);else{const t=oo.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});yr.warn(t.message)}}}async function xT(n,e){try{const i=(await Kb()).transaction(Vu,"readwrite");await i.objectStore(Vu).put(e,Jb(n)),await i.done}catch(t){if(t instanceof Fs)yr.warn(t.message);else{const i=oo.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});yr.warn(i.message)}}}function Jb(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o4=1024,a4=30;class l4{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new c4(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=IT();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(u=>u.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:o}),this._heartbeatsCache.heartbeats.length>a4){const u=d4(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){yr.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=IT(),{heartbeatsToSend:i,unsentEntries:o}=u4(this._heartbeatsCache.heartbeats),a=Jd(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return yr.warn(t),""}}}function IT(){return new Date().toISOString().substring(0,10)}function u4(n,e=o4){const t=[];let i=n.slice();for(const o of n){const a=t.find(u=>u.agent===o.agent);if(a){if(a.dates.push(o.date),RT(t)>e){a.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),RT(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class c4{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Xk()?Qk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await r4(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return xT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return xT(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function RT(n){return Jd(JSON.stringify({version:2,heartbeats:n})).length}function d4(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h4(n){ra(new co("platform-logger",e=>new w5(e),"PRIVATE")),ra(new co("heartbeat",e=>new l4(e),"PRIVATE")),Ns(Sm,AT,n),Ns(Sm,AT,"esm2020"),Ns("fire-js","")}h4("");var f4="firebase",p4="12.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ns(f4,p4,"app");function jb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const m4=jb,Xb=new Ju("auth","Firebase",jb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd=new hg("@firebase/auth");function g4(n,...e){Xd.logLevel<=Qe.WARN&&Xd.warn(`Auth (${Cl}): ${n}`,...e)}function Md(n,...e){Xd.logLevel<=Qe.ERROR&&Xd.error(`Auth (${Cl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gi(n,...e){throw gg(n,...e)}function us(n,...e){return gg(n,...e)}function mg(n,e,t){const i={...m4(),[e]:t};return new Ju("auth","Firebase",i).create(e,{appName:n.name})}function mr(n){return mg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function y4(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Gi(n,"argument-error"),mg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function gg(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return Xb.create(n,...e)}function Me(n,e,...t){if(!n)throw gg(e,...t)}function fr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Md(e),new Error(e)}function _r(n,e){n||fr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Am(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function _4(){return NT()==="http:"||NT()==="https:"}function NT(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_4()||$k()||"connection"in navigator)?navigator.onLine:!0}function E4(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,t){this.shortDelay=e,this.longDelay=t,_r(t>e,"Short delay should be less than long delay!"),this.isMobile=Hk()||Kk()}get(){return v4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yg(n,e){_r(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;fr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;fr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;fr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],b4=new Xu(3e4,6e4);function Eo(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function To(n,e,t,i,o={}){return Wb(n,o,async()=>{let a={},u={};i&&(e==="GET"?u=i:a={body:JSON.stringify(i)});const d=ju({key:n.config.apiKey,...u}).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:f,...a};return Yk()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&vo(n.emulatorConfig.host)&&(p.credentials="include"),Qb.fetch()(await Zb(n,n.config.apiHost,t,d),p)})}async function Wb(n,e,t){n._canInitEmulator=!1;const i={...T4,...e};try{const o=new A4(n),a=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const u=await a.json();if("needConfirmation"in u)throw Sd(n,"account-exists-with-different-credential",u);if(a.ok&&!("errorMessage"in u))return u;{const d=a.ok?u.errorMessage:u.error.message,[f,p]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Sd(n,"credential-already-in-use",u);if(f==="EMAIL_EXISTS")throw Sd(n,"email-already-in-use",u);if(f==="USER_DISABLED")throw Sd(n,"user-disabled",u);const _=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw mg(n,_,p);Gi(n,_)}}catch(o){if(o instanceof Fs)throw o;Gi(n,"network-request-failed",{message:String(o)})}}async function Qu(n,e,t,i,o={}){const a=await To(n,e,t,i,o);return"mfaPendingCredential"in a&&Gi(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function Zb(n,e,t,i){const o=`${e}${t}?${i}`,a=n,u=a.config.emulator?yg(n.config,o):`${n.config.apiScheme}://${o}`;return S4.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(u).toString():u}function w4(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class A4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(us(this.auth,"network-request-failed")),b4.get())})}}function Sd(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const o=us(n,e,i);return o.customData._tokenResponse=t,o}function MT(n){return n!==void 0&&n.enterprise!==void 0}class C4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return w4(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function x4(n,e){return To(n,"GET","/v2/recaptchaConfig",Eo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I4(n,e){return To(n,"POST","/v1/accounts:delete",e)}async function Qd(n,e){return To(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function R4(n,e=!1){const t=yn(n),i=await t.getIdToken(e),o=_g(i);Me(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const a=typeof o.firebase=="object"?o.firebase:void 0,u=a==null?void 0:a.sign_in_provider;return{claims:o,token:i,authTime:Pu(Qp(o.auth_time)),issuedAtTime:Pu(Qp(o.iat)),expirationTime:Pu(Qp(o.exp)),signInProvider:u||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Qp(n){return Number(n)*1e3}function _g(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Md("JWT malformed, contained fewer than 3 sections"),null;try{const o=zb(t);return o?JSON.parse(o):(Md("Failed to decode base64 JWT payload"),null)}catch(o){return Md("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function PT(n){const e=_g(n);return Me(e,"internal-error"),Me(typeof e.exp<"u","internal-error"),Me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ou(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Fs&&N4(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function N4({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Pu(this.lastLoginAt),this.creationTime=Pu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wd(n){var E;const e=n.auth,t=await n.getIdToken(),i=await Ou(n,Qd(e,{idToken:t}));Me(i==null?void 0:i.users.length,e,"internal-error");const o=i.users[0];n._notifyReloadListener(o);const a=(E=o.providerUserInfo)!=null&&E.length?e1(o.providerUserInfo):[],u=D4(n.providerData,a),d=n.isAnonymous,f=!(n.email&&o.passwordHash)&&!(u!=null&&u.length),p=d?f:!1,_={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new Cm(o.createdAt,o.lastLoginAt),isAnonymous:p};Object.assign(n,_)}async function P4(n){const e=yn(n);await Wd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function D4(n,e){return[...n.filter(i=>!e.some(o=>o.providerId===i.providerId)),...e]}function e1(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k4(n,e){const t=await Wb(n,{},async()=>{const i=ju({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:a}=n.config,u=await Zb(n,o,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:i};return n.emulatorConfig&&vo(n.emulatorConfig.host)&&(f.credentials="include"),Qb.fetch()(u,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function U4(n,e){return To(n,"POST","/v2/accounts:revokeToken",Eo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Me(e.idToken,"internal-error"),Me(typeof e.idToken<"u","internal-error"),Me(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):PT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Me(e.length!==0,"internal-error");const t=PT(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:o,expiresIn:a}=await k4(e,t);this.updateTokensAndExpiration(i,o,Number(a))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:o,expirationTime:a}=t,u=new ll;return i&&(Me(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),o&&(Me(typeof o=="string","internal-error",{appName:e}),u.accessToken=o),a&&(Me(typeof a=="number","internal-error",{appName:e}),u.expirationTime=a),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ll,this.toJSON())}_performRefresh(){return fr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(n,e){Me(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ls{constructor({uid:e,auth:t,stsTokenManager:i,...o}){this.providerId="firebase",this.proactiveRefresh=new M4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Cm(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Ou(this,this.stsTokenManager.getToken(this.auth,e));return Me(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return R4(this,e)}reload(){return P4(this)}_assign(e){this!==e&&(Me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ls({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Wd(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(li(this.auth.app))return Promise.reject(mr(this.auth));const e=await this.getIdToken();return await Ou(this,I4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,o=t.email??void 0,a=t.phoneNumber??void 0,u=t.photoURL??void 0,d=t.tenantId??void 0,f=t._redirectEventId??void 0,p=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:E,emailVerified:S,isAnonymous:C,providerData:k,stsTokenManager:V}=t;Me(E&&V,e,"internal-error");const z=ll.fromJSON(this.name,V);Me(typeof E=="string",e,"internal-error"),Zr(i,e.name),Zr(o,e.name),Me(typeof S=="boolean",e,"internal-error"),Me(typeof C=="boolean",e,"internal-error"),Zr(a,e.name),Zr(u,e.name),Zr(d,e.name),Zr(f,e.name),Zr(p,e.name),Zr(_,e.name);const J=new ls({uid:E,auth:e,email:o,emailVerified:S,displayName:i,isAnonymous:C,photoURL:u,phoneNumber:a,tenantId:d,stsTokenManager:z,createdAt:p,lastLoginAt:_});return k&&Array.isArray(k)&&(J.providerData=k.map(j=>({...j}))),f&&(J._redirectEventId=f),J}static async _fromIdTokenResponse(e,t,i=!1){const o=new ll;o.updateFromServerResponse(t);const a=new ls({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:i});return await Wd(a),a}static async _fromGetAccountInfoResponse(e,t,i){const o=t.users[0];Me(o.localId!==void 0,"internal-error");const a=o.providerUserInfo!==void 0?e1(o.providerUserInfo):[],u=!(o.email&&o.passwordHash)&&!(a!=null&&a.length),d=new ll;d.updateFromIdToken(i);const f=new ls({uid:o.localId,auth:e,stsTokenManager:d,isAnonymous:u}),p={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new Cm(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(a!=null&&a.length)};return Object.assign(f,p),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT=new Map;function pr(n){_r(n instanceof Function,"Expected a class definition");let e=DT.get(n);return e?(_r(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,DT.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}t1.type="NONE";const kT=t1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pd(n,e,t){return`firebase:${n}:${e}:${t}`}class ul{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:o,name:a}=this.auth;this.fullUserKey=Pd(this.userKey,o.apiKey,a),this.fullPersistenceKey=Pd("persistence",o.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Qd(this.auth,{idToken:e}).catch(()=>{});return t?ls._fromGetAccountInfoResponse(this.auth,t,e):null}return ls._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new ul(pr(kT),e,i);const o=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=o[0]||pr(kT);const u=Pd(i,e.config.apiKey,e.name);let d=null;for(const p of t)try{const _=await p._get(u);if(_){let E;if(typeof _=="string"){const S=await Qd(e,{idToken:_}).catch(()=>{});if(!S)break;E=await ls._fromGetAccountInfoResponse(e,S,_)}else E=ls._fromJSON(e,_);p!==a&&(d=E),a=p;break}}catch{}const f=o.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new ul(a,e,i):(a=f[0],d&&await a._set(u,d.toJSON()),await Promise.all(t.map(async p=>{if(p!==a)try{await p._remove(u)}catch{}})),new ul(a,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UT(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(r1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(n1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(a1(e))return"Blackberry";if(l1(e))return"Webos";if(i1(e))return"Safari";if((e.includes("chrome/")||s1(e))&&!e.includes("edge/"))return"Chrome";if(o1(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function n1(n=Hn()){return/firefox\//i.test(n)}function i1(n=Hn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function s1(n=Hn()){return/crios\//i.test(n)}function r1(n=Hn()){return/iemobile/i.test(n)}function o1(n=Hn()){return/android/i.test(n)}function a1(n=Hn()){return/blackberry/i.test(n)}function l1(n=Hn()){return/webos/i.test(n)}function vg(n=Hn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function L4(n=Hn()){var e;return vg(n)&&!!((e=window.navigator)!=null&&e.standalone)}function V4(){return Jk()&&document.documentMode===10}function u1(n=Hn()){return vg(n)||o1(n)||l1(n)||a1(n)||/windows phone/i.test(n)||r1(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c1(n,e=[]){let t;switch(n){case"Browser":t=UT(Hn());break;case"Worker":t=`${UT(Hn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Cl}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=a=>new Promise((u,d)=>{try{const f=e(a);u(f)}catch(f){d(f)}});i.onAbort=t,this.queue.push(i);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z4(n,e={}){return To(n,"GET","/v2/passwordPolicy",Eo(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F4=6;class B4{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??F4,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let o=0;o<e.length;o++)i=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,o,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e,t,i,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new LT(this),this.idTokenSubscription=new LT(this),this.beforeStateQueue=new O4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Xb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=pr(t)),this._initializationPromise=this.queue(async()=>{var i,o,a;if(!this._deleted&&(this.persistenceManager=await ul.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((o=this._popupRedirectResolver)!=null&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Qd(this,{idToken:e}),i=await ls._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(li(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(a=this.redirectUser)==null?void 0:a._redirectEventId,d=i==null?void 0:i._redirectEventId,f=await this.tryRedirectSignIn(e);(!u||u===d)&&(f!=null&&f.user)&&(i=f.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(u){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Wd(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=E4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(li(this.app))return Promise.reject(mr(this));const t=e?yn(e):null;return t&&Me(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return li(this.app)?Promise.reject(mr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return li(this.app)?Promise.reject(mr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(pr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await z4(this),t=new B4(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ju("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await U4(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&pr(e)||this._popupRedirectResolver;Me(t,this,"argument-error"),this.redirectPersistenceManager=await ul.create(this,[pr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,o){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let u=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Me(d,this,"internal-error"),d.then(()=>{u||a(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,i,o);return()=>{u=!0,f()}}else{const f=e.addObserver(t);return()=>{u=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=c1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var o;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((o=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:o.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(li(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&g4(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function So(n){return yn(n)}class LT{constructor(e){this.auth=e,this.observer=null,this.addObserver=n5(t=>this.observer=t)}get next(){return Me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function H4(n){bh=n}function d1(n){return bh.loadJS(n)}function G4(){return bh.recaptchaEnterpriseScript}function Y4(){return bh.gapiScript}function $4(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class K4{constructor(){this.enterprise=new J4}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class J4{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const j4="recaptcha-enterprise",h1="NO_RECAPTCHA";class X4{constructor(e){this.type=j4,this.auth=So(e)}async verify(e="verify",t=!1){async function i(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(u,d)=>{x4(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const p=new C4(f);return a.tenantId==null?a._agentRecaptchaConfig=p:a._tenantRecaptchaConfigs[a.tenantId]=p,u(p.siteKey)}}).catch(f=>{d(f)})})}function o(a,u,d){const f=window.grecaptcha;MT(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(p=>{u(p)}).catch(()=>{u(h1)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new K4().execute("siteKey",{action:"verify"}):new Promise((a,u)=>{i(this.auth).then(d=>{if(!t&&MT(window.grecaptcha))o(d,a,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let f=G4();f.length!==0&&(f+=d),d1(f).then(()=>{o(d,a,u)}).catch(p=>{u(p)})}}).catch(d=>{u(d)})})}}async function VT(n,e,t,i=!1,o=!1){const a=new X4(n);let u;if(o)u=h1;else try{u=await a.verify(t)}catch{u=await a.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const f=d.phoneEnrollmentInfo.phoneNumber,p=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const f=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return i?Object.assign(d,{captchaResp:u}):Object.assign(d,{captchaResponse:u}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function xm(n,e,t,i,o){var a;if((a=n._getRecaptchaConfig())!=null&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await VT(n,e,t,t==="getOobCode");return i(n,u)}else return i(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await VT(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q4(n,e){const t=Sh(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),a=t.getOptions();if(sa(a,e??{}))return o;Gi(o,"already-initialized")}return t.initialize({options:e})}function W4(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(pr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function Z4(n,e,t){const i=So(n);Me(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const o=!1,a=f1(e),{host:u,port:d}=e3(e),f=d===null?"":`:${d}`,p={url:`${a}//${u}${f}/`},_=Object.freeze({host:u,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!i._canInitEmulator){Me(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Me(sa(p,i.config.emulator)&&sa(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,vo(u)?(cg(`${a}//${u}${f}`),dg("Auth",!0)):t3()}function f1(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function e3(n){const e=f1(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(i);if(o){const a=o[1];return{host:a,port:OT(i.substr(a.length+1))}}else{const[a,u]=i.split(":");return{host:a,port:OT(u)}}}function OT(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function t3(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return fr("not implemented")}_getIdTokenResponse(e){return fr("not implemented")}_linkToIdToken(e,t){return fr("not implemented")}_getReauthenticationResolver(e){return fr("not implemented")}}async function n3(n,e){return To(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i3(n,e){return Qu(n,"POST","/v1/accounts:signInWithPassword",Eo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s3(n,e){return Qu(n,"POST","/v1/accounts:signInWithEmailLink",Eo(n,e))}async function r3(n,e){return Qu(n,"POST","/v1/accounts:signInWithEmailLink",Eo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu extends Eg{constructor(e,t,i,o=null){super("password",i),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new zu(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new zu(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return xm(e,t,"signInWithPassword",i3);case"emailLink":return s3(e,{email:this._email,oobCode:this._password});default:Gi(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return xm(e,i,"signUpPassword",n3);case"emailLink":return r3(e,{idToken:t,email:this._email,oobCode:this._password});default:Gi(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cl(n,e){return Qu(n,"POST","/v1/accounts:signInWithIdp",Eo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o3="http://localhost";class oa extends Eg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new oa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Gi("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:o,...a}=t;if(!i||!o)return null;const u=new oa(i,o);return u.idToken=a.idToken||void 0,u.accessToken=a.accessToken||void 0,u.secret=a.secret,u.nonce=a.nonce,u.pendingToken=a.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return cl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,cl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,cl(e,t)}buildRequest(){const e={requestUri:o3,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ju(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a3(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function l3(n){const e=wu(Au(n)).link,t=e?wu(Au(e)).deep_link_id:null,i=wu(Au(n)).deep_link_id;return(i?wu(Au(i)).link:null)||i||t||e||n}class Tg{constructor(e){const t=wu(Au(e)),i=t.apiKey??null,o=t.oobCode??null,a=a3(t.mode??null);Me(i&&o&&a,"argument-error"),this.apiKey=i,this.operation=a,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=l3(e);try{return new Tg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(){this.providerId=xl.PROVIDER_ID}static credential(e,t){return zu._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Tg.parseLink(t);return Me(i,"argument-error"),zu._fromEmailAndCode(e,i.code,i.tenantId)}}xl.PROVIDER_ID="password";xl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";xl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu extends Sg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo extends Wu{constructor(){super("facebook.com")}static credential(e){return oa._fromParams({providerId:eo.PROVIDER_ID,signInMethod:eo.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return eo.credentialFromTaggedObject(e)}static credentialFromError(e){return eo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return eo.credential(e.oauthAccessToken)}catch{return null}}}eo.FACEBOOK_SIGN_IN_METHOD="facebook.com";eo.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr extends Wu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return oa._fromParams({providerId:hr.PROVIDER_ID,signInMethod:hr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return hr.credentialFromTaggedObject(e)}static credentialFromError(e){return hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return hr.credential(t,i)}catch{return null}}}hr.GOOGLE_SIGN_IN_METHOD="google.com";hr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to extends Wu{constructor(){super("github.com")}static credential(e){return oa._fromParams({providerId:to.PROVIDER_ID,signInMethod:to.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return to.credentialFromTaggedObject(e)}static credentialFromError(e){return to.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return to.credential(e.oauthAccessToken)}catch{return null}}}to.GITHUB_SIGN_IN_METHOD="github.com";to.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no extends Wu{constructor(){super("twitter.com")}static credential(e,t){return oa._fromParams({providerId:no.PROVIDER_ID,signInMethod:no.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return no.credentialFromTaggedObject(e)}static credentialFromError(e){return no.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return no.credential(t,i)}catch{return null}}}no.TWITTER_SIGN_IN_METHOD="twitter.com";no.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u3(n,e){return Qu(n,"POST","/v1/accounts:signUp",Eo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,o=!1){const a=await ls._fromIdTokenResponse(e,i,o),u=zT(i);return new aa({user:a,providerId:u,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const o=zT(i);return new aa({user:e,providerId:o,_tokenResponse:i,operationType:t})}}function zT(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd extends Fs{constructor(e,t,i,o){super(t.code,t.message),this.operationType=i,this.user=o,Object.setPrototypeOf(this,Zd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,o){return new Zd(e,t,i,o)}}function p1(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?Zd._fromErrorAndOperation(n,a,e,i):a})}async function c3(n,e,t=!1){const i=await Ou(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return aa._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d3(n,e,t=!1){const{auth:i}=n;if(li(i.app))return Promise.reject(mr(i));const o="reauthenticate";try{const a=await Ou(n,p1(i,o,e,n),t);Me(a.idToken,i,"internal-error");const u=_g(a.idToken);Me(u,i,"internal-error");const{sub:d}=u;return Me(n.uid===d,i,"user-mismatch"),aa._forOperation(n,o,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Gi(i,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m1(n,e,t=!1){if(li(n.app))return Promise.reject(mr(n));const i="signIn",o=await p1(n,i,e),a=await aa._fromIdTokenResponse(n,i,o);return t||await n._updateCurrentUser(a.user),a}async function h3(n,e){return m1(So(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g1(n){const e=So(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function f3(n,e,t){if(li(n.app))return Promise.reject(mr(n));const i=So(n),u=await xm(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",u3).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&g1(n),f}),d=await aa._fromIdTokenResponse(i,"signIn",u);return await i._updateCurrentUser(d.user),d}function p3(n,e,t){return li(n.app)?Promise.reject(mr(n)):h3(yn(n),xl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&g1(n),i})}function m3(n,e,t,i){return yn(n).onIdTokenChanged(e,t,i)}function g3(n,e,t){return yn(n).beforeAuthStateChanged(e,t)}function y3(n,e,t,i){return yn(n).onAuthStateChanged(e,t,i)}const eh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(eh,"1"),this.storage.removeItem(eh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _3=1e3,v3=10;class _1 extends y1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=u1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),o=this.localCache[t];i!==o&&e(t,o,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,d,f)=>{this.notifyListeners(u,f)});return}const i=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const u=this.storage.getItem(i);!t&&this.localCache[i]===u||this.notifyListeners(i,u)},a=this.storage.getItem(i);V4()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,v3):o()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},_3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}_1.type="LOCAL";const E3=_1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1 extends y1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}v1.type="SESSION";const E1=v1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T3(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const i=new wh(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:o,data:a}=t.data,u=this.handlersMap[o];if(!(u!=null&&u.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:o});const d=Array.from(u).map(async p=>p(t.origin,a)),f=await T3(d);t.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}wh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bg(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S3{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let a,u;return new Promise((d,f)=>{const p=bg("",20);o.port1.start();const _=setTimeout(()=>{f(new Error("unsupported_event"))},i);u={messageChannel:o,onMessage(E){const S=E;if(S.data.eventId===p)switch(S.data.status){case"ack":clearTimeout(_),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(S.data.response);break;default:clearTimeout(_),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(u),o.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[o.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(){return window}function b3(n){Ms().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T1(){return typeof Ms().WorkerGlobalScope<"u"&&typeof Ms().importScripts=="function"}async function w3(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function A3(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function C3(){return T1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1="firebaseLocalStorageDb",x3=1,th="firebaseLocalStorage",b1="fbase_key";class Zu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ah(n,e){return n.transaction([th],e?"readwrite":"readonly").objectStore(th)}function I3(){const n=indexedDB.deleteDatabase(S1);return new Zu(n).toPromise()}function Im(){const n=indexedDB.open(S1,x3);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(th,{keyPath:b1})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(th)?e(i):(i.close(),await I3(),e(await Im()))})})}async function FT(n,e,t){const i=Ah(n,!0).put({[b1]:e,value:t});return new Zu(i).toPromise()}async function R3(n,e){const t=Ah(n,!1).get(e),i=await new Zu(t).toPromise();return i===void 0?null:i.value}function BT(n,e){const t=Ah(n,!0).delete(e);return new Zu(t).toPromise()}const N3=800,M3=3;class w1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Im(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>M3)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return T1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wh._getInstance(C3()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await w3(),!this.activeServiceWorker)return;this.sender=new S3(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||A3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Im();return await FT(e,eh,"1"),await BT(e,eh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>FT(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>R3(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>BT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const a=Ah(o,!1).getAll();return new Zu(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:o,value:a}of e)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const o of Array.from(i))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),N3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}w1.type="LOCAL";const P3=w1;new Xu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A1(n,e){return e?pr(e):(Me(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg extends Eg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return cl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return cl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return cl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function D3(n){return m1(n.auth,new wg(n),n.bypassAuthState)}function k3(n){const{auth:e,user:t}=n;return Me(t,e,"internal-error"),d3(t,new wg(n),n.bypassAuthState)}async function U3(n){const{auth:e,user:t}=n;return Me(t,e,"internal-error"),c3(t,new wg(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(e,t,i,o,a=!1){this.auth=e,this.resolver=i,this.user=o,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:o,tenantId:a,error:u,type:d}=e;if(u){this.reject(u);return}const f={auth:this.auth,requestUri:t,sessionId:i,tenantId:a||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return D3;case"linkViaPopup":case"linkViaRedirect":return U3;case"reauthViaPopup":case"reauthViaRedirect":return k3;default:Gi(this.auth,"internal-error")}}resolve(e){_r(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_r(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L3=new Xu(2e3,1e4);async function V3(n,e,t){if(li(n.app))return Promise.reject(us(n,"operation-not-supported-in-this-environment"));const i=So(n);y4(n,e,Sg);const o=A1(i,t);return new ea(i,"signInViaPopup",e,o).executeNotNull()}class ea extends C1{constructor(e,t,i,o,a){super(e,t,o,a),this.provider=i,this.authWindow=null,this.pollId=null,ea.currentPopupAction&&ea.currentPopupAction.cancel(),ea.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Me(e,this.auth,"internal-error"),e}async onExecution(){_r(this.filter.length===1,"Popup operations only handle one event");const e=bg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(us(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(us(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ea.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(us(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,L3.get())};e()}}ea.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3="pendingRedirect",Dd=new Map;class z3 extends C1{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Dd.get(this.auth._key());if(!e){try{const i=await F3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Dd.set(this.auth._key(),e)}return this.bypassAuthState||Dd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function F3(n,e){const t=H3(e),i=q3(n);if(!await i._isAvailable())return!1;const o=await i._get(t)==="true";return await i._remove(t),o}function B3(n,e){Dd.set(n._key(),e)}function q3(n){return pr(n._redirectPersistence)}function H3(n){return Pd(O3,n.config.apiKey,n.name)}async function G3(n,e,t=!1){if(li(n.app))return Promise.reject(mr(n));const i=So(n),o=A1(i,e),u=await new z3(i,o,t).execute();return u&&!t&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y3=600*1e3;class $3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!K3(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!x1(e)){const o=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(us(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Y3&&this.cachedEventUids.clear(),this.cachedEventUids.has(qT(e))}saveEventToCache(e){this.cachedEventUids.add(qT(e)),this.lastProcessedEventTime=Date.now()}}function qT(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function x1({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function K3(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return x1(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J3(n,e={}){return To(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,X3=/^https?/;async function Q3(n){if(n.config.emulator)return;const{authorizedDomains:e}=await J3(n);for(const t of e)try{if(W3(t))return}catch{}Gi(n,"unauthorized-domain")}function W3(n){const e=Am(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===i}if(!X3.test(t))return!1;if(j3.test(n))return i===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z3=new Xu(3e4,6e4);function HT(){const n=Ms().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function eU(n){return new Promise((e,t)=>{var o,a,u;function i(){HT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{HT(),t(us(n,"network-request-failed"))},timeout:Z3.get()})}if((a=(o=Ms().gapi)==null?void 0:o.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((u=Ms().gapi)!=null&&u.load)i();else{const d=$4("iframefcb");return Ms()[d]=()=>{gapi.load?i():t(us(n,"network-request-failed"))},d1(`${Y4()}?onload=${d}`).catch(f=>t(f))}}).catch(e=>{throw kd=null,e})}let kd=null;function tU(n){return kd=kd||eU(n),kd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nU=new Xu(5e3,15e3),iU="__/auth/iframe",sU="emulator/auth/iframe",rU={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oU=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function aU(n){const e=n.config;Me(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?yg(e,sU):`https://${n.config.authDomain}/${iU}`,i={apiKey:e.apiKey,appName:n.name,v:Cl},o=oU.get(n.config.apiHost);o&&(i.eid=o);const a=n._getFrameworks();return a.length&&(i.fw=a.join(",")),`${t}?${ju(i).slice(1)}`}async function lU(n){const e=await tU(n),t=Ms().gapi;return Me(t,n,"internal-error"),e.open({where:document.body,url:aU(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rU,dontclear:!0},i=>new Promise(async(o,a)=>{await i.restyle({setHideOnLeave:!1});const u=us(n,"network-request-failed"),d=Ms().setTimeout(()=>{a(u)},nU.get());function f(){Ms().clearTimeout(d),o(i)}i.ping(f).then(f,()=>{a(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uU={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},cU=500,dU=600,hU="_blank",fU="http://localhost";class GT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function pU(n,e,t,i=cU,o=dU){const a=Math.max((window.screen.availHeight-o)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const f={...uU,width:i.toString(),height:o.toString(),top:a,left:u},p=Hn().toLowerCase();t&&(d=s1(p)?hU:t),n1(p)&&(e=e||fU,f.scrollbars="yes");const _=Object.entries(f).reduce((S,[C,k])=>`${S}${C}=${k},`,"");if(L4(p)&&d!=="_self")return mU(e||"",d),new GT(null);const E=window.open(e||"",d,_);Me(E,n,"popup-blocked");try{E.focus()}catch{}return new GT(E)}function mU(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gU="__/auth/handler",yU="emulator/auth/handler",_U=encodeURIComponent("fac");async function YT(n,e,t,i,o,a){Me(n.config.authDomain,n,"auth-domain-config-required"),Me(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Cl,eventId:o};if(e instanceof Sg){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",t5(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,E]of Object.entries({}))u[_]=E}if(e instanceof Wu){const _=e.getScopes().filter(E=>E!=="");_.length>0&&(u.scopes=_.join(","))}n.tenantId&&(u.tid=n.tenantId);const d=u;for(const _ of Object.keys(d))d[_]===void 0&&delete d[_];const f=await n._getAppCheckToken(),p=f?`#${_U}=${encodeURIComponent(f)}`:"";return`${vU(n)}?${ju(d).slice(1)}${p}`}function vU({config:n}){return n.emulator?yg(n,yU):`https://${n.authDomain}/${gU}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wp="webStorageSupport";class EU{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=E1,this._completeRedirectFn=G3,this._overrideRedirectResult=B3}async _openPopup(e,t,i,o){var u;_r((u=this.eventManagers[e._key()])==null?void 0:u.manager,"_initialize() not called before _openPopup()");const a=await YT(e,t,i,Am(),o);return pU(e,a,bg())}async _openRedirect(e,t,i,o){await this._originValidation(e);const a=await YT(e,t,i,Am(),o);return b3(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:a}=this.eventManagers[t];return o?Promise.resolve(o):(_r(a,"If manager is not set, promise should be"),a)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await lU(e),i=new $3(e);return t.register("authEvent",o=>(Me(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:i.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Wp,{type:Wp},o=>{var u;const a=(u=o==null?void 0:o[0])==null?void 0:u[Wp];a!==void 0&&t(!!a),Gi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Q3(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return u1()||i1()||vg()}}const TU=EU;var $T="@firebase/auth",KT="1.11.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SU{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bU(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function wU(n){ra(new co("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:u,authDomain:d}=i.options;Me(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const f={apiKey:u,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:c1(n)},p=new q4(i,o,a,f);return W4(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),ra(new co("auth-internal",e=>{const t=So(e.getProvider("auth").getImmediate());return(i=>new SU(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ns($T,KT,bU(n)),Ns($T,KT,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AU=300,CU=Hb("authIdTokenMaxAge")||AU;let JT=null;const xU=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>CU)return;const o=t==null?void 0:t.token;JT!==o&&(JT=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function IU(n=pg()){const e=Sh(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Q4(n,{popupRedirectResolver:TU,persistence:[P3,E3,E1]}),i=Hb("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(i,location.origin);if(location.origin===a.origin){const u=xU(a.toString());g3(t,u,()=>u(t.currentUser)),m3(t,d=>u(d))}}const o=Fb("auth");return o&&Z4(t,`http://${o}`),t}function RU(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}H4({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=o=>{const a=us("internal-error");a.customData=o,t(a)},i.type="text/javascript",i.charset="UTF-8",RU().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});wU("Browser");var jT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ao,I1;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,M){function N(){}N.prototype=M.prototype,x.F=M.prototype,x.prototype=new N,x.prototype.constructor=x,x.D=function(P,U,O){for(var D=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)D[ct-2]=arguments[ct];return M.prototype[U].apply(P,D)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(x,M,N){N||(N=0);const P=Array(16);if(typeof M=="string")for(var U=0;U<16;++U)P[U]=M.charCodeAt(N++)|M.charCodeAt(N++)<<8|M.charCodeAt(N++)<<16|M.charCodeAt(N++)<<24;else for(U=0;U<16;++U)P[U]=M[N++]|M[N++]<<8|M[N++]<<16|M[N++]<<24;M=x.g[0],N=x.g[1],U=x.g[2];let O=x.g[3],D;D=M+(O^N&(U^O))+P[0]+3614090360&4294967295,M=N+(D<<7&4294967295|D>>>25),D=O+(U^M&(N^U))+P[1]+3905402710&4294967295,O=M+(D<<12&4294967295|D>>>20),D=U+(N^O&(M^N))+P[2]+606105819&4294967295,U=O+(D<<17&4294967295|D>>>15),D=N+(M^U&(O^M))+P[3]+3250441966&4294967295,N=U+(D<<22&4294967295|D>>>10),D=M+(O^N&(U^O))+P[4]+4118548399&4294967295,M=N+(D<<7&4294967295|D>>>25),D=O+(U^M&(N^U))+P[5]+1200080426&4294967295,O=M+(D<<12&4294967295|D>>>20),D=U+(N^O&(M^N))+P[6]+2821735955&4294967295,U=O+(D<<17&4294967295|D>>>15),D=N+(M^U&(O^M))+P[7]+4249261313&4294967295,N=U+(D<<22&4294967295|D>>>10),D=M+(O^N&(U^O))+P[8]+1770035416&4294967295,M=N+(D<<7&4294967295|D>>>25),D=O+(U^M&(N^U))+P[9]+2336552879&4294967295,O=M+(D<<12&4294967295|D>>>20),D=U+(N^O&(M^N))+P[10]+4294925233&4294967295,U=O+(D<<17&4294967295|D>>>15),D=N+(M^U&(O^M))+P[11]+2304563134&4294967295,N=U+(D<<22&4294967295|D>>>10),D=M+(O^N&(U^O))+P[12]+1804603682&4294967295,M=N+(D<<7&4294967295|D>>>25),D=O+(U^M&(N^U))+P[13]+4254626195&4294967295,O=M+(D<<12&4294967295|D>>>20),D=U+(N^O&(M^N))+P[14]+2792965006&4294967295,U=O+(D<<17&4294967295|D>>>15),D=N+(M^U&(O^M))+P[15]+1236535329&4294967295,N=U+(D<<22&4294967295|D>>>10),D=M+(U^O&(N^U))+P[1]+4129170786&4294967295,M=N+(D<<5&4294967295|D>>>27),D=O+(N^U&(M^N))+P[6]+3225465664&4294967295,O=M+(D<<9&4294967295|D>>>23),D=U+(M^N&(O^M))+P[11]+643717713&4294967295,U=O+(D<<14&4294967295|D>>>18),D=N+(O^M&(U^O))+P[0]+3921069994&4294967295,N=U+(D<<20&4294967295|D>>>12),D=M+(U^O&(N^U))+P[5]+3593408605&4294967295,M=N+(D<<5&4294967295|D>>>27),D=O+(N^U&(M^N))+P[10]+38016083&4294967295,O=M+(D<<9&4294967295|D>>>23),D=U+(M^N&(O^M))+P[15]+3634488961&4294967295,U=O+(D<<14&4294967295|D>>>18),D=N+(O^M&(U^O))+P[4]+3889429448&4294967295,N=U+(D<<20&4294967295|D>>>12),D=M+(U^O&(N^U))+P[9]+568446438&4294967295,M=N+(D<<5&4294967295|D>>>27),D=O+(N^U&(M^N))+P[14]+3275163606&4294967295,O=M+(D<<9&4294967295|D>>>23),D=U+(M^N&(O^M))+P[3]+4107603335&4294967295,U=O+(D<<14&4294967295|D>>>18),D=N+(O^M&(U^O))+P[8]+1163531501&4294967295,N=U+(D<<20&4294967295|D>>>12),D=M+(U^O&(N^U))+P[13]+2850285829&4294967295,M=N+(D<<5&4294967295|D>>>27),D=O+(N^U&(M^N))+P[2]+4243563512&4294967295,O=M+(D<<9&4294967295|D>>>23),D=U+(M^N&(O^M))+P[7]+1735328473&4294967295,U=O+(D<<14&4294967295|D>>>18),D=N+(O^M&(U^O))+P[12]+2368359562&4294967295,N=U+(D<<20&4294967295|D>>>12),D=M+(N^U^O)+P[5]+4294588738&4294967295,M=N+(D<<4&4294967295|D>>>28),D=O+(M^N^U)+P[8]+2272392833&4294967295,O=M+(D<<11&4294967295|D>>>21),D=U+(O^M^N)+P[11]+1839030562&4294967295,U=O+(D<<16&4294967295|D>>>16),D=N+(U^O^M)+P[14]+4259657740&4294967295,N=U+(D<<23&4294967295|D>>>9),D=M+(N^U^O)+P[1]+2763975236&4294967295,M=N+(D<<4&4294967295|D>>>28),D=O+(M^N^U)+P[4]+1272893353&4294967295,O=M+(D<<11&4294967295|D>>>21),D=U+(O^M^N)+P[7]+4139469664&4294967295,U=O+(D<<16&4294967295|D>>>16),D=N+(U^O^M)+P[10]+3200236656&4294967295,N=U+(D<<23&4294967295|D>>>9),D=M+(N^U^O)+P[13]+681279174&4294967295,M=N+(D<<4&4294967295|D>>>28),D=O+(M^N^U)+P[0]+3936430074&4294967295,O=M+(D<<11&4294967295|D>>>21),D=U+(O^M^N)+P[3]+3572445317&4294967295,U=O+(D<<16&4294967295|D>>>16),D=N+(U^O^M)+P[6]+76029189&4294967295,N=U+(D<<23&4294967295|D>>>9),D=M+(N^U^O)+P[9]+3654602809&4294967295,M=N+(D<<4&4294967295|D>>>28),D=O+(M^N^U)+P[12]+3873151461&4294967295,O=M+(D<<11&4294967295|D>>>21),D=U+(O^M^N)+P[15]+530742520&4294967295,U=O+(D<<16&4294967295|D>>>16),D=N+(U^O^M)+P[2]+3299628645&4294967295,N=U+(D<<23&4294967295|D>>>9),D=M+(U^(N|~O))+P[0]+4096336452&4294967295,M=N+(D<<6&4294967295|D>>>26),D=O+(N^(M|~U))+P[7]+1126891415&4294967295,O=M+(D<<10&4294967295|D>>>22),D=U+(M^(O|~N))+P[14]+2878612391&4294967295,U=O+(D<<15&4294967295|D>>>17),D=N+(O^(U|~M))+P[5]+4237533241&4294967295,N=U+(D<<21&4294967295|D>>>11),D=M+(U^(N|~O))+P[12]+1700485571&4294967295,M=N+(D<<6&4294967295|D>>>26),D=O+(N^(M|~U))+P[3]+2399980690&4294967295,O=M+(D<<10&4294967295|D>>>22),D=U+(M^(O|~N))+P[10]+4293915773&4294967295,U=O+(D<<15&4294967295|D>>>17),D=N+(O^(U|~M))+P[1]+2240044497&4294967295,N=U+(D<<21&4294967295|D>>>11),D=M+(U^(N|~O))+P[8]+1873313359&4294967295,M=N+(D<<6&4294967295|D>>>26),D=O+(N^(M|~U))+P[15]+4264355552&4294967295,O=M+(D<<10&4294967295|D>>>22),D=U+(M^(O|~N))+P[6]+2734768916&4294967295,U=O+(D<<15&4294967295|D>>>17),D=N+(O^(U|~M))+P[13]+1309151649&4294967295,N=U+(D<<21&4294967295|D>>>11),D=M+(U^(N|~O))+P[4]+4149444226&4294967295,M=N+(D<<6&4294967295|D>>>26),D=O+(N^(M|~U))+P[11]+3174756917&4294967295,O=M+(D<<10&4294967295|D>>>22),D=U+(M^(O|~N))+P[2]+718787259&4294967295,U=O+(D<<15&4294967295|D>>>17),D=N+(O^(U|~M))+P[9]+3951481745&4294967295,x.g[0]=x.g[0]+M&4294967295,x.g[1]=x.g[1]+(U+(D<<21&4294967295|D>>>11))&4294967295,x.g[2]=x.g[2]+U&4294967295,x.g[3]=x.g[3]+O&4294967295}i.prototype.v=function(x,M){M===void 0&&(M=x.length);const N=M-this.blockSize,P=this.C;let U=this.h,O=0;for(;O<M;){if(U==0)for(;O<=N;)o(this,x,O),O+=this.blockSize;if(typeof x=="string"){for(;O<M;)if(P[U++]=x.charCodeAt(O++),U==this.blockSize){o(this,P),U=0;break}}else for(;O<M;)if(P[U++]=x[O++],U==this.blockSize){o(this,P),U=0;break}}this.h=U,this.o+=M},i.prototype.A=function(){var x=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);x[0]=128;for(var M=1;M<x.length-8;++M)x[M]=0;M=this.o*8;for(var N=x.length-8;N<x.length;++N)x[N]=M&255,M/=256;for(this.v(x),x=Array(16),M=0,N=0;N<4;++N)for(let P=0;P<32;P+=8)x[M++]=this.g[N]>>>P&255;return x};function a(x,M){var N=d;return Object.prototype.hasOwnProperty.call(N,x)?N[x]:N[x]=M(x)}function u(x,M){this.h=M;const N=[];let P=!0;for(let U=x.length-1;U>=0;U--){const O=x[U]|0;P&&O==M||(N[U]=O,P=!1)}this.g=N}var d={};function f(x){return-128<=x&&x<128?a(x,function(M){return new u([M|0],M<0?-1:0)}):new u([x|0],x<0?-1:0)}function p(x){if(isNaN(x)||!isFinite(x))return E;if(x<0)return z(p(-x));const M=[];let N=1;for(let P=0;x>=N;P++)M[P]=x/N|0,N*=4294967296;return new u(M,0)}function _(x,M){if(x.length==0)throw Error("number format error: empty string");if(M=M||10,M<2||36<M)throw Error("radix out of range: "+M);if(x.charAt(0)=="-")return z(_(x.substring(1),M));if(x.indexOf("-")>=0)throw Error('number format error: interior "-" character');const N=p(Math.pow(M,8));let P=E;for(let O=0;O<x.length;O+=8){var U=Math.min(8,x.length-O);const D=parseInt(x.substring(O,O+U),M);U<8?(U=p(Math.pow(M,U)),P=P.j(U).add(p(D))):(P=P.j(N),P=P.add(p(D)))}return P}var E=f(0),S=f(1),C=f(16777216);n=u.prototype,n.m=function(){if(V(this))return-z(this).m();let x=0,M=1;for(let N=0;N<this.g.length;N++){const P=this.i(N);x+=(P>=0?P:4294967296+P)*M,M*=4294967296}return x},n.toString=function(x){if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(k(this))return"0";if(V(this))return"-"+z(this).toString(x);const M=p(Math.pow(x,6));var N=this;let P="";for(;;){const U=H(N,M).g;N=J(N,U.j(M));let O=((N.g.length>0?N.g[0]:N.h)>>>0).toString(x);if(N=U,k(N))return O+P;for(;O.length<6;)O="0"+O;P=O+P}},n.i=function(x){return x<0?0:x<this.g.length?this.g[x]:this.h};function k(x){if(x.h!=0)return!1;for(let M=0;M<x.g.length;M++)if(x.g[M]!=0)return!1;return!0}function V(x){return x.h==-1}n.l=function(x){return x=J(this,x),V(x)?-1:k(x)?0:1};function z(x){const M=x.g.length,N=[];for(let P=0;P<M;P++)N[P]=~x.g[P];return new u(N,~x.h).add(S)}n.abs=function(){return V(this)?z(this):this},n.add=function(x){const M=Math.max(this.g.length,x.g.length),N=[];let P=0;for(let U=0;U<=M;U++){let O=P+(this.i(U)&65535)+(x.i(U)&65535),D=(O>>>16)+(this.i(U)>>>16)+(x.i(U)>>>16);P=D>>>16,O&=65535,D&=65535,N[U]=D<<16|O}return new u(N,N[N.length-1]&-2147483648?-1:0)};function J(x,M){return x.add(z(M))}n.j=function(x){if(k(this)||k(x))return E;if(V(this))return V(x)?z(this).j(z(x)):z(z(this).j(x));if(V(x))return z(this.j(z(x)));if(this.l(C)<0&&x.l(C)<0)return p(this.m()*x.m());const M=this.g.length+x.g.length,N=[];for(var P=0;P<2*M;P++)N[P]=0;for(P=0;P<this.g.length;P++)for(let U=0;U<x.g.length;U++){const O=this.i(P)>>>16,D=this.i(P)&65535,ct=x.i(U)>>>16,rt=x.i(U)&65535;N[2*P+2*U]+=D*rt,j(N,2*P+2*U),N[2*P+2*U+1]+=O*rt,j(N,2*P+2*U+1),N[2*P+2*U+1]+=D*ct,j(N,2*P+2*U+1),N[2*P+2*U+2]+=O*ct,j(N,2*P+2*U+2)}for(x=0;x<M;x++)N[x]=N[2*x+1]<<16|N[2*x];for(x=M;x<2*M;x++)N[x]=0;return new u(N,0)};function j(x,M){for(;(x[M]&65535)!=x[M];)x[M+1]+=x[M]>>>16,x[M]&=65535,M++}function Z(x,M){this.g=x,this.h=M}function H(x,M){if(k(M))throw Error("division by zero");if(k(x))return new Z(E,E);if(V(x))return M=H(z(x),M),new Z(z(M.g),z(M.h));if(V(M))return M=H(x,z(M)),new Z(z(M.g),M.h);if(x.g.length>30){if(V(x)||V(M))throw Error("slowDivide_ only works with positive integers.");for(var N=S,P=M;P.l(x)<=0;)N=ae(N),P=ae(P);var U=oe(N,1),O=oe(P,1);for(P=oe(P,2),N=oe(N,2);!k(P);){var D=O.add(P);D.l(x)<=0&&(U=U.add(N),O=D),P=oe(P,1),N=oe(N,1)}return M=J(x,U.j(M)),new Z(U,M)}for(U=E;x.l(M)>=0;){for(N=Math.max(1,Math.floor(x.m()/M.m())),P=Math.ceil(Math.log(N)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),O=p(N),D=O.j(M);V(D)||D.l(x)>0;)N-=P,O=p(N),D=O.j(M);k(O)&&(O=S),U=U.add(O),x=J(x,D)}return new Z(U,x)}n.B=function(x){return H(this,x).h},n.and=function(x){const M=Math.max(this.g.length,x.g.length),N=[];for(let P=0;P<M;P++)N[P]=this.i(P)&x.i(P);return new u(N,this.h&x.h)},n.or=function(x){const M=Math.max(this.g.length,x.g.length),N=[];for(let P=0;P<M;P++)N[P]=this.i(P)|x.i(P);return new u(N,this.h|x.h)},n.xor=function(x){const M=Math.max(this.g.length,x.g.length),N=[];for(let P=0;P<M;P++)N[P]=this.i(P)^x.i(P);return new u(N,this.h^x.h)};function ae(x){const M=x.g.length+1,N=[];for(let P=0;P<M;P++)N[P]=x.i(P)<<1|x.i(P-1)>>>31;return new u(N,x.h)}function oe(x,M){const N=M>>5;M%=32;const P=x.g.length-N,U=[];for(let O=0;O<P;O++)U[O]=M>0?x.i(O+N)>>>M|x.i(O+N+1)<<32-M:x.i(O+N);return new u(U,x.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,I1=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=p,u.fromString=_,ao=u}).apply(typeof jT<"u"?jT:typeof self<"u"?self:typeof window<"u"?window:{});var bd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var R1,Cu,N1,Ud,Rm,M1,P1,D1;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof bd=="object"&&bd];for(var b=0;b<g.length;++b){var A=g[b];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var i=t(this);function o(g,b){if(b)e:{var A=i;g=g.split(".");for(var R=0;R<g.length-1;R++){var G=g[R];if(!(G in A))break e;A=A[G]}g=g[g.length-1],R=A[g],b=b(R),b!=R&&b!=null&&e(A,g,{configurable:!0,writable:!0,value:b})}}o("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(g){return g||function(b){var A=[],R;for(R in b)Object.prototype.hasOwnProperty.call(b,R)&&A.push([R,b[R]]);return A}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},u=this||self;function d(g){var b=typeof g;return b=="object"&&g!=null||b=="function"}function f(g,b,A){return g.call.apply(g.bind,arguments)}function p(g,b,A){return p=f,p.apply(null,arguments)}function _(g,b){var A=Array.prototype.slice.call(arguments,1);return function(){var R=A.slice();return R.push.apply(R,arguments),g.apply(this,R)}}function E(g,b){function A(){}A.prototype=b.prototype,g.Z=b.prototype,g.prototype=new A,g.prototype.constructor=g,g.Ob=function(R,G,X){for(var de=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)de[Be-2]=arguments[Be];return b.prototype[G].apply(R,de)}}var S=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function C(g){const b=g.length;if(b>0){const A=Array(b);for(let R=0;R<b;R++)A[R]=g[R];return A}return[]}function k(g,b){for(let R=1;R<arguments.length;R++){const G=arguments[R];var A=typeof G;if(A=A!="object"?A:G?Array.isArray(G)?"array":A:"null",A=="array"||A=="object"&&typeof G.length=="number"){A=g.length||0;const X=G.length||0;g.length=A+X;for(let de=0;de<X;de++)g[A+de]=G[de]}else g.push(G)}}class V{constructor(b,A){this.i=b,this.j=A,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function z(g){u.setTimeout(()=>{throw g},0)}function J(){var g=x;let b=null;return g.g&&(b=g.g,g.g=g.g.next,g.g||(g.h=null),b.next=null),b}class j{constructor(){this.h=this.g=null}add(b,A){const R=Z.get();R.set(b,A),this.h?this.h.next=R:this.g=R,this.h=R}}var Z=new V(()=>new H,g=>g.reset());class H{constructor(){this.next=this.g=this.h=null}set(b,A){this.h=b,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let ae,oe=!1,x=new j,M=()=>{const g=Promise.resolve(void 0);ae=()=>{g.then(N)}};function N(){for(var g;g=J();){try{g.h.call(g.g)}catch(A){z(A)}var b=Z;b.j(g),b.h<100&&(b.h++,g.next=b.g,b.g=g)}oe=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function U(g,b){this.type=g,this.g=this.target=b,this.defaultPrevented=!1}U.prototype.h=function(){this.defaultPrevented=!0};var O=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var g=!1,b=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const A=()=>{};u.addEventListener("test",A,b),u.removeEventListener("test",A,b)}catch{}return g})();function D(g){return/^[\s\xa0]*$/.test(g)}function ct(g,b){U.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,b)}E(ct,U),ct.prototype.init=function(g,b){const A=this.type=g.type,R=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=b,b=g.relatedTarget,b||(A=="mouseover"?b=g.fromElement:A=="mouseout"&&(b=g.toElement)),this.relatedTarget=b,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&ct.Z.h.call(this)},ct.prototype.h=function(){ct.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var rt="closure_listenable_"+(Math.random()*1e6|0),W=0;function ce(g,b,A,R,G){this.listener=g,this.proxy=null,this.src=b,this.type=A,this.capture=!!R,this.ha=G,this.key=++W,this.da=this.fa=!1}function Te(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Ge(g,b,A){for(const R in g)b.call(A,g[R],R,g)}function tt(g,b){for(const A in g)b.call(void 0,g[A],A,g)}function F(g){const b={};for(const A in g)b[A]=g[A];return b}const ie="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function he(g,b){let A,R;for(let G=1;G<arguments.length;G++){R=arguments[G];for(A in R)g[A]=R[A];for(let X=0;X<ie.length;X++)A=ie[X],Object.prototype.hasOwnProperty.call(R,A)&&(g[A]=R[A])}}function fe(g){this.src=g,this.g={},this.h=0}fe.prototype.add=function(g,b,A,R,G){const X=g.toString();g=this.g[X],g||(g=this.g[X]=[],this.h++);const de=ke(g,b,R,G);return de>-1?(b=g[de],A||(b.fa=!1)):(b=new ce(b,this.src,X,!!R,G),b.fa=A,g.push(b)),b};function we(g,b){const A=b.type;if(A in g.g){var R=g.g[A],G=Array.prototype.indexOf.call(R,b,void 0),X;(X=G>=0)&&Array.prototype.splice.call(R,G,1),X&&(Te(b),g.g[A].length==0&&(delete g.g[A],g.h--))}}function ke(g,b,A,R){for(let G=0;G<g.length;++G){const X=g[G];if(!X.da&&X.listener==b&&X.capture==!!A&&X.ha==R)return G}return-1}var ye="closure_lm_"+(Math.random()*1e6|0),jt={};function It(g,b,A,R,G){if(Array.isArray(b)){for(let X=0;X<b.length;X++)It(g,b[X],A,R,G);return null}return A=Ci(A),g&&g[rt]?g.J(b,A,d(R)?!!R.capture:!1,G):Bs(g,b,A,!1,R,G)}function Bs(g,b,A,R,G,X){if(!b)throw Error("Invalid event type");const de=d(G)?!!G.capture:!!G;let Be=$i(g);if(Be||(g[ye]=Be=new fe(g)),A=Be.add(b,A,R,de,X),A.proxy)return A;if(R=di(),A.proxy=R,R.src=g,R.listener=A,g.addEventListener)O||(G=de),G===void 0&&(G=!1),g.addEventListener(b.toString(),R,G);else if(g.attachEvent)g.attachEvent(Xt(b.toString()),R);else if(g.addListener&&g.removeListener)g.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return A}function di(){function g(A){return b.call(g.src,g.listener,A)}const b=Yi;return g}function qs(g,b,A,R,G){if(Array.isArray(b))for(var X=0;X<b.length;X++)qs(g,b[X],A,R,G);else R=d(R)?!!R.capture:!!R,A=Ci(A),g&&g[rt]?(g=g.i,X=String(b).toString(),X in g.g&&(b=g.g[X],A=ke(b,A,R,G),A>-1&&(Te(b[A]),Array.prototype.splice.call(b,A,1),b.length==0&&(delete g.g[X],g.h--)))):g&&(g=$i(g))&&(b=g.g[b.toString()],g=-1,b&&(g=ke(b,A,R,G)),(A=g>-1?b[g]:null)&&ds(A))}function ds(g){if(typeof g!="number"&&g&&!g.da){var b=g.src;if(b&&b[rt])we(b.i,g);else{var A=g.type,R=g.proxy;b.removeEventListener?b.removeEventListener(A,R,g.capture):b.detachEvent?b.detachEvent(Xt(A),R):b.addListener&&b.removeListener&&b.removeListener(R),(A=$i(b))?(we(A,g),A.h==0&&(A.src=null,b[ye]=null)):Te(g)}}}function Xt(g){return g in jt?jt[g]:jt[g]="on"+g}function Yi(g,b){if(g.da)g=!0;else{b=new ct(b,this);const A=g.listener,R=g.ha||g.src;g.fa&&ds(g),g=A.call(R,b)}return g}function $i(g){return g=g[ye],g instanceof fe?g:null}var br="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ci(g){return typeof g=="function"?g:(g[br]||(g[br]=function(b){return g.handleEvent(b)}),g[br])}function zt(){P.call(this),this.i=new fe(this),this.M=this,this.G=null}E(zt,P),zt.prototype[rt]=!0,zt.prototype.removeEventListener=function(g,b,A,R){qs(this,g,b,A,R)};function Rt(g,b){var A,R=g.G;if(R)for(A=[];R;R=R.G)A.push(R);if(g=g.M,R=b.type||b,typeof b=="string")b=new U(b,g);else if(b instanceof U)b.target=b.target||g;else{var G=b;b=new U(R,g),he(b,G)}G=!0;let X,de;if(A)for(de=A.length-1;de>=0;de--)X=b.g=A[de],G=Ki(X,R,!0,b)&&G;if(X=b.g=g,G=Ki(X,R,!0,b)&&G,G=Ki(X,R,!1,b)&&G,A)for(de=0;de<A.length;de++)X=b.g=A[de],G=Ki(X,R,!1,b)&&G}zt.prototype.N=function(){if(zt.Z.N.call(this),this.i){var g=this.i;for(const b in g.g){const A=g.g[b];for(let R=0;R<A.length;R++)Te(A[R]);delete g.g[b],g.h--}}this.G=null},zt.prototype.J=function(g,b,A,R){return this.i.add(String(g),b,!1,A,R)},zt.prototype.K=function(g,b,A,R){return this.i.add(String(g),b,!0,A,R)};function Ki(g,b,A,R){if(b=g.i.g[String(b)],!b)return!0;b=b.concat();let G=!0;for(let X=0;X<b.length;++X){const de=b[X];if(de&&!de.da&&de.capture==A){const Be=de.listener,en=de.ha||de.src;de.fa&&we(g.i,de),G=Be.call(en,R)!==!1&&G}}return G&&!R.defaultPrevented}function Ji(g,b){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=p(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:u.setTimeout(g,b||0)}function hs(g){g.g=Ji(()=>{g.g=null,g.i&&(g.i=!1,hs(g))},g.l);const b=g.h;g.h=null,g.m.apply(null,b)}class fn extends P{constructor(b,A){super(),this.m=b,this.l=A,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:hs(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fs(g){P.call(this),this.h=g,this.g={}}E(fs,P);var ji=[];function Ao(g){Ge(g.g,function(b,A){this.g.hasOwnProperty(A)&&ds(b)},g),g.g={}}fs.prototype.N=function(){fs.Z.N.call(this),Ao(this)},fs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xn=u.JSON.stringify,Pl=u.JSON.parse,ps=class{stringify(g){return u.JSON.stringify(g,void 0)}parse(g){return u.JSON.parse(g,void 0)}};function fa(){}function Hs(){}var hi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ut(){U.call(this,"d")}E(Ut,U);function Qn(){U.call(this,"c")}E(Qn,U);var wt={},pa=null;function wr(){return pa=pa||new zt}wt.Ia="serverreachability";function fi(g){U.call(this,wt.Ia,g)}E(fi,U);function xi(g){const b=wr();Rt(b,new fi(b))}wt.STAT_EVENT="statevent";function Tn(g,b){U.call(this,wt.STAT_EVENT,g),this.stat=b}E(Tn,U);function Yt(g){const b=wr();Rt(b,new Tn(b,g))}wt.Ja="timingevent";function pi(g,b){U.call(this,wt.Ja,g),this.size=b}E(pi,U);function Ii(g,b){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){g()},b)}function mi(){this.g=!0}mi.prototype.ua=function(){this.g=!1};function Co(g,b,A,R,G,X){g.info(function(){if(g.g)if(X){var de="",Be=X.split("&");for(let ht=0;ht<Be.length;ht++){var en=Be[ht].split("=");if(en.length>1){const Vt=en[0];en=en[1];const Di=Vt.split("_");de=Di.length>=2&&Di[1]=="type"?de+(Vt+"="+en+"&"):de+(Vt+"=redacted&")}}}else de=null;else de=X;return"XMLHTTP REQ ("+R+") [attempt "+G+"]: "+b+`
`+A+`
`+de})}function ma(g,b,A,R,G,X,de){g.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+G+"]: "+b+`
`+A+`
`+X+" "+de})}function Ri(g,b,A,R){g.info(function(){return"XMLHTTP TEXT ("+b+"): "+ga(g,A)+(R?" "+R:"")})}function Gs(g,b){g.info(function(){return"TIMEOUT: "+b})}mi.prototype.info=function(){};function ga(g,b){if(!g.g)return b;if(!b)return null;try{const X=JSON.parse(b);if(X){for(g=0;g<X.length;g++)if(Array.isArray(X[g])){var A=X[g];if(!(A.length<2)){var R=A[1];if(Array.isArray(R)&&!(R.length<1)){var G=R[0];if(G!="noop"&&G!="stop"&&G!="close")for(let de=1;de<R.length;de++)R[de]=""}}}}return Xn(X)}catch{return b}}var ms={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ar={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ue;function Se(){}E(Se,fa),Se.prototype.g=function(){return new XMLHttpRequest},ue=new Se;function Ne(g){return encodeURIComponent(String(g))}function Je(g){var b=1;g=g.split(":");const A=[];for(;b>0&&g.length;)A.push(g.shift()),b--;return g.length&&A.push(g.join(":")),A}function ot(g,b,A,R){this.j=g,this.i=b,this.l=A,this.S=R||1,this.V=new fs(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new it}function it(){this.i=null,this.g="",this.h=!1}var Ce={},Ye={};function Sn(g,b,A){g.M=1,g.A=Wt(dt(b)),g.u=A,g.R=!0,Ft(g,null)}function Ft(g,b){g.F=Date.now(),_n(g),g.B=dt(g.A);var A=g.B,R=g.S;Array.isArray(R)||(R=[String(R)]),ti(A.i,"t",R),g.C=0,A=g.j.L,g.h=new it,g.g=pc(g.j,A?b:null,!g.u),g.P>0&&(g.O=new fn(p(g.Y,g,g.g),g.P)),b=g.V,A=g.g,R=g.ba;var G="readystatechange";Array.isArray(G)||(G&&(ji[0]=G.toString()),G=ji);for(let X=0;X<G.length;X++){const de=It(A,G[X],R||b.handleEvent,!1,b.h||b);if(!de)break;b.g[de.key]=de}b=g.J?F(g.J):{},g.u?(g.v||(g.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,b)):(g.v="GET",g.g.ea(g.B,g.v,null,b)),xi(),Co(g.i,g.v,g.B,g.l,g.S,g.u)}ot.prototype.ba=function(g){g=g.target;const b=this.O;b&&es(g)==3?b.j():this.Y(g)},ot.prototype.Y=function(g){try{if(g==this.g)e:{const Be=es(this.g),en=this.g.ya(),ht=this.g.ca();if(!(Be<3)&&(Be!=3||this.g&&(this.h.h||this.g.la()||An(this.g)))){this.K||Be!=4||en==7||(en==8||ht<=0?xi(3):xi(2)),rn(this);var b=this.g.ca();this.X=b;var A=Wn(this);if(this.o=b==200,ma(this.i,this.v,this.B,this.l,this.S,Be,b),this.o){if(this.U&&!this.L){t:{if(this.g){var R,G=this.g;if((R=G.g?G.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(R)){var X=R;break t}}X=null}if(g=X)Ri(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Gn(this,g);else{this.o=!1,this.m=3,Yt(12),vt(this),Ue(this);break e}}if(this.R){g=!0;let Vt;for(;!this.K&&this.C<A.length;)if(Vt=gs(this,A),Vt==Ye){Be==4&&(this.m=4,Yt(14),g=!1),Ri(this.i,this.l,null,"[Incomplete Response]");break}else if(Vt==Ce){this.m=4,Yt(15),Ri(this.i,this.l,A,"[Invalid Chunk]"),g=!1;break}else Ri(this.i,this.l,Vt,null),Gn(this,Vt);if(Zn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Be!=4||A.length!=0||this.h.h||(this.m=1,Yt(16),g=!1),this.o=this.o&&g,!g)Ri(this.i,this.l,A,"[Invalid Chunked Response]"),vt(this),Ue(this);else if(A.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+A.length),Ol(de),de.P=!0,Yt(11))}}else Ri(this.i,this.l,A,null),Gn(this,A);Be==4&&vt(this),this.o&&!this.K&&(Be==4?cc(this.j,this):(this.o=!1,_n(this)))}else Ks(this.g),b==400&&A.indexOf("Unknown SID")>0?(this.m=3,Yt(12)):(this.m=0,Yt(13)),vt(this),Ue(this)}}}catch{}finally{}};function Wn(g){if(!Zn(g))return g.g.la();const b=An(g.g);if(b==="")return"";let A="";const R=b.length,G=es(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return vt(g),Ue(g),"";g.h.i=new u.TextDecoder}for(let X=0;X<R;X++)g.h.h=!0,A+=g.h.i.decode(b[X],{stream:!(G&&X==R-1)});return b.length=0,g.h.g+=A,g.C=0,g.h.g}function Zn(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function gs(g,b){var A=g.C,R=b.indexOf(`
`,A);return R==-1?Ye:(A=Number(b.substring(A,R)),isNaN(A)?Ce:(R+=1,R+A>b.length?Ye:(b=b.slice(R,R+A),g.C=R+A,b)))}ot.prototype.cancel=function(){this.K=!0,vt(this)};function _n(g){g.T=Date.now()+g.H,Ni(g,g.H)}function Ni(g,b){if(g.D!=null)throw Error("WatchDog timer not null");g.D=Ii(p(g.aa,g),b)}function rn(g){g.D&&(u.clearTimeout(g.D),g.D=null)}ot.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(Gs(this.i,this.B),this.M!=2&&(xi(),Yt(17)),vt(this),this.m=2,Ue(this)):Ni(this,this.T-g)};function Ue(g){g.j.I==0||g.K||cc(g.j,g)}function vt(g){rn(g);var b=g.O;b&&typeof b.dispose=="function"&&b.dispose(),g.O=null,Ao(g.V),g.g&&(b=g.g,g.g=null,b.abort(),b.dispose())}function Gn(g,b){try{var A=g.j;if(A.I!=0&&(A.g==g||De(A.h,g))){if(!g.L&&De(A.h,g)&&A.I==3){try{var R=A.Ba.g.parse(b)}catch{R=null}if(Array.isArray(R)&&R.length==3){var G=R;if(G[0]==0){e:if(!A.v){if(A.g)if(A.g.F+3e3<g.F)Ta(A),Rr(A);else break e;Po(A),Yt(18)}}else A.xa=G[1],0<A.xa-A.K&&G[2]<37500&&A.F&&A.A==0&&!A.C&&(A.C=Ii(p(A.Va,A),6e3));kn(A.h)<=1&&A.ta&&(A.ta=void 0)}else Ss(A,11)}else if((g.L||A.g==g)&&Ta(A),!D(b))for(G=A.Ba.g.parse(b),b=0;b<G.length;b++){let ht=G[b];const Vt=ht[0];if(!(Vt<=A.K))if(A.K=Vt,ht=ht[1],A.I==2)if(ht[0]=="c"){A.M=ht[1],A.ba=ht[2];const Di=ht[3];Di!=null&&(A.ka=Di,A.j.info("VER="+A.ka));const bs=ht[4];bs!=null&&(A.za=bs,A.j.info("SVER="+A.za));const ts=ht[5];ts!=null&&typeof ts=="number"&&ts>0&&(R=1.5*ts,A.O=R,A.j.info("backChannelRequestTimeoutMs_="+R)),R=A;const ns=g.g;if(ns){const Do=ns.g?ns.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Do){var X=R.h;X.g||Do.indexOf("spdy")==-1&&Do.indexOf("quic")==-1&&Do.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&(Re(X,X.h),X.h=null))}if(R.G){const Sa=ns.g?ns.g.getResponseHeader("X-HTTP-Session-Id"):null;Sa&&(R.wa=Sa,Oe(R.J,R.G,Sa))}}A.I=3,A.l&&A.l.ra(),A.aa&&(A.T=Date.now()-g.F,A.j.info("Handshake RTT: "+A.T+"ms")),R=A;var de=g;if(R.na=fc(R,R.L?R.ba:null,R.W),de.L){Ve(R.h,de);var Be=de,en=R.O;en&&(Be.H=en),Be.D&&(rn(Be),_n(Be)),R.g=de}else lc(R);A.i.length>0&&Ts(A)}else ht[0]!="stop"&&ht[0]!="close"||Ss(A,7);else A.I==3&&(ht[0]=="stop"||ht[0]=="close"?ht[0]=="stop"?Ss(A,7):Ll(A):ht[0]!="noop"&&A.l&&A.l.qa(ht),A.A=0)}}xi(4)}catch{}}var At=class{constructor(g,b){this.g=g,this.map=b}};function Dn(g){this.l=g||10,u.PerformanceNavigationTiming?(g=u.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ve(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function kn(g){return g.h?1:g.g?g.g.size:0}function De(g,b){return g.h?g.h==b:g.g?g.g.has(b):!1}function Re(g,b){g.g?g.g.add(b):g.h=b}function Ve(g,b){g.h&&g.h==b?g.h=null:g.g&&g.g.has(b)&&g.g.delete(b)}Dn.prototype.cancel=function(){if(this.i=st(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function st(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let b=g.i;for(const A of g.g.values())b=b.concat(A.G);return b}return C(g.i)}var Bt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yn(g,b){if(g){g=g.split("&");for(let A=0;A<g.length;A++){const R=g[A].indexOf("=");let G,X=null;R>=0?(G=g[A].substring(0,R),X=g[A].substring(R+1)):G=g[A],b(G,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function Nt(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;g instanceof Nt?(this.l=g.l,Lt(this,g.j),this.o=g.o,this.g=g.g,$n(this,g.u),this.h=g.h,Qt(this,Qi(g.i)),this.m=g.m):g&&(b=String(g).match(Bt))?(this.l=!1,Lt(this,b[1]||"",!0),this.o=bn(b[2]||""),this.g=bn(b[3]||"",!0),$n(this,b[4]),this.h=bn(b[5]||"",!0),Qt(this,b[6]||"",!0),this.m=bn(b[7]||"")):(this.l=!1,this.i=new qt(null,this.l))}Nt.prototype.toString=function(){const g=[];var b=this.j;b&&g.push(Un(b,pt,!0),":");var A=this.g;return(A||b=="file")&&(g.push("//"),(b=this.o)&&g.push(Un(b,pt,!0),"@"),g.push(Ne(A).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.u,A!=null&&g.push(":",String(A))),(A=this.h)&&(this.g&&A.charAt(0)!="/"&&g.push("/"),g.push(Un(A,A.charAt(0)=="/"?ei:wn,!0))),(A=this.i.toString())&&g.push("?",A),(A=this.m)&&g.push("#",Un(A,gi)),g.join("")},Nt.prototype.resolve=function(g){const b=dt(this);let A=!!g.j;A?Lt(b,g.j):A=!!g.o,A?b.o=g.o:A=!!g.g,A?b.g=g.g:A=g.u!=null;var R=g.h;if(A)$n(b,g.u);else if(A=!!g.h){if(R.charAt(0)!="/")if(this.g&&!this.h)R="/"+R;else{var G=b.h.lastIndexOf("/");G!=-1&&(R=b.h.slice(0,G+1)+R)}if(G=R,G==".."||G==".")R="";else if(G.indexOf("./")!=-1||G.indexOf("/.")!=-1){R=G.lastIndexOf("/",0)==0,G=G.split("/");const X=[];for(let de=0;de<G.length;){const Be=G[de++];Be=="."?R&&de==G.length&&X.push(""):Be==".."?((X.length>1||X.length==1&&X[0]!="")&&X.pop(),R&&de==G.length&&X.push("")):(X.push(Be),R=!0)}R=X.join("/")}else R=G}return A?b.h=R:A=g.i.toString()!=="",A?Qt(b,Qi(g.i)):A=!!g.m,A&&(b.m=g.m),b};function dt(g){return new Nt(g)}function Lt(g,b,A){g.j=A?bn(b,!0):b,g.j&&(g.j=g.j.replace(/:$/,""))}function $n(g,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);g.u=b}else g.u=null}function Qt(g,b,A){b instanceof qt?(g.i=b,ya(g.i,g.l)):(A||(b=Un(b,Zt)),g.i=new qt(b,g.l))}function Oe(g,b,A){g.i.set(b,A)}function Wt(g){return Oe(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function bn(g,b){return g?b?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Un(g,b,A){return typeof g=="string"?(g=encodeURI(g).replace(b,$t),A&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function $t(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var pt=/[#\/\?@]/g,wn=/[#\?:]/g,ei=/[#\?]/g,Zt=/[#\?@]/g,gi=/#/g;function qt(g,b){this.h=this.g=null,this.i=g||null,this.j=!!b}function gt(g){g.g||(g.g=new Map,g.h=0,g.i&&Yn(g.i,function(b,A){g.add(decodeURIComponent(b.replace(/\+/g," ")),A)}))}n=qt.prototype,n.add=function(g,b){gt(this),this.i=null,g=ys(this,g);let A=this.g.get(g);return A||this.g.set(g,A=[]),A.push(b),this.h+=1,this};function yi(g,b){gt(g),b=ys(g,b),g.g.has(b)&&(g.i=null,g.h-=g.g.get(b).length,g.g.delete(b))}function Ys(g,b){return gt(g),b=ys(g,b),g.g.has(b)}n.forEach=function(g,b){gt(this),this.g.forEach(function(A,R){A.forEach(function(G){g.call(b,G,R,this)},this)},this)};function Xi(g,b){gt(g);let A=[];if(typeof b=="string")Ys(g,b)&&(A=A.concat(g.g.get(ys(g,b))));else for(g=Array.from(g.g.values()),b=0;b<g.length;b++)A=A.concat(g[b]);return A}n.set=function(g,b){return gt(this),this.i=null,g=ys(this,g),Ys(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[b]),this.h+=1,this},n.get=function(g,b){return g?(g=Xi(this,g),g.length>0?String(g[0]):b):b};function ti(g,b,A){yi(g,b),A.length>0&&(g.i=null,g.g.set(ys(g,b),C(A)),g.h+=A.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],b=Array.from(this.g.keys());for(let R=0;R<b.length;R++){var A=b[R];const G=Ne(A);A=Xi(this,A);for(let X=0;X<A.length;X++){let de=G;A[X]!==""&&(de+="="+Ne(A[X])),g.push(de)}}return this.i=g.join("&")};function Qi(g){const b=new qt;return b.i=g.i,g.g&&(b.g=new Map(g.g),b.h=g.h),b}function ys(g,b){return b=String(b),g.j&&(b=b.toLowerCase()),b}function ya(g,b){b&&!g.j&&(gt(g),g.i=null,g.g.forEach(function(A,R){const G=R.toLowerCase();R!=G&&(yi(this,R),ti(this,G,A))},g)),g.j=b}function Wi(g,b){const A=new mi;if(u.Image){const R=new Image;R.onload=_(Mi,A,"TestLoadImage: loaded",!0,b,R),R.onerror=_(Mi,A,"TestLoadImage: error",!1,b,R),R.onabort=_(Mi,A,"TestLoadImage: abort",!1,b,R),R.ontimeout=_(Mi,A,"TestLoadImage: timeout",!1,b,R),u.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=g}else b(!1)}function Dl(g,b){const A=new mi,R=new AbortController,G=setTimeout(()=>{R.abort(),Mi(A,"TestPingServer: timeout",!1,b)},1e4);fetch(g,{signal:R.signal}).then(X=>{clearTimeout(G),X.ok?Mi(A,"TestPingServer: ok",!0,b):Mi(A,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(G),Mi(A,"TestPingServer: error",!1,b)})}function Mi(g,b,A,R,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),R(A)}catch{}}function Cr(){this.g=new ps}function _s(g){this.i=g.Sb||null,this.h=g.ab||!1}E(_s,fa),_s.prototype.g=function(){return new xo(this.i,this.h)};function xo(g,b){zt.call(this),this.H=g,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(xo,zt),n=xo.prototype,n.open=function(g,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=b,this.readyState=1,Zi(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(b.body=g),(this.H||u).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,xr(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,Zi(this)),this.g&&(this.readyState=3,Zi(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;_a(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function _a(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var b=g.value?g.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!g.done}))&&(this.response=this.responseText+=b)}g.done?xr(this):Zi(this),this.readyState==3&&_a(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,xr(this))},n.Na=function(g){this.g&&(this.response=g,xr(this))},n.ga=function(){this.g&&xr(this)};function xr(g){g.readyState=4,g.l=null,g.j=null,g.B=null,Zi(g)}n.setRequestHeader=function(g,b){this.A.append(g,b)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],b=this.h.entries();for(var A=b.next();!A.done;)A=A.value,g.push(A[0]+": "+A[1]),A=b.next();return g.join(`\r
`)};function Zi(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(xo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Pi(g){let b="";return Ge(g,function(A,R){b+=R,b+=":",b+=A,b+=`\r
`}),b}function Io(g,b,A){e:{for(R in A){var R=!1;break e}R=!0}R||(A=Pi(A),typeof g=="string"?A!=null&&Ne(A):Oe(g,b,A))}function Et(g){zt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(Et,zt);var vs=/^https?$/i,kl=["POST","PUT"];n=Et.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,b,A,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);b=b?b.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ue.g(),this.g.onreadystatechange=S(p(this.Ca,this));try{this.B=!0,this.g.open(b,String(g),!0),this.B=!1}catch(X){Ro(this,X);return}if(g=A||"",A=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var G in R)A.set(G,R[G]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const X of R.keys())A.set(X,R.get(X));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(A.keys()).find(X=>X.toLowerCase()=="content-type"),G=u.FormData&&g instanceof u.FormData,!(Array.prototype.indexOf.call(kl,b,void 0)>=0)||R||G||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,de]of A)this.g.setRequestHeader(X,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(X){Ro(this,X)}};function Ro(g,b){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=b,g.o=5,Ul(g),$s(g)}function Ul(g){g.A||(g.A=!0,Rt(g,"complete"),Rt(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,Rt(this,"complete"),Rt(this,"abort"),$s(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$s(this,!0)),Et.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?No(this):this.Xa())},n.Xa=function(){No(this)};function No(g){if(g.h&&typeof a<"u"){if(g.v&&es(g)==4)setTimeout(g.Ca.bind(g),0);else if(Rt(g,"readystatechange"),es(g)==4){g.h=!1;try{const X=g.ca();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var A;if(!(A=b)){var R;if(R=X===0){let de=String(g.D).match(Bt)[1]||null;!de&&u.self&&u.self.location&&(de=u.self.location.protocol.slice(0,-1)),R=!vs.test(de?de.toLowerCase():"")}A=R}if(A)Rt(g,"complete"),Rt(g,"success");else{g.o=6;try{var G=es(g)>2?g.g.statusText:""}catch{G=""}g.l=G+" ["+g.ca()+"]",Ul(g)}}finally{$s(g)}}}}function $s(g,b){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const A=g.g;g.g=null,b||Rt(g,"ready");try{A.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function es(g){return g.g?g.g.readyState:0}n.ca=function(){try{return es(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var b=this.g.responseText;return g&&b.indexOf(g)==0&&(b=b.substring(g.length)),Pl(b)}};function An(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function Ks(g){const b={};g=(g.g&&es(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<g.length;R++){if(D(g[R]))continue;var A=Je(g[R]);const G=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const X=b[G]||[];b[G]=X,X.push(A)}tt(b,function(R){return R.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Es(g,b,A){return A&&A.internalChannelParams&&A.internalChannelParams[g]||b}function Ir(g){this.za=0,this.i=[],this.j=new mi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Es("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Es("baseRetryDelayMs",5e3,g),this.Za=Es("retryDelaySeedMs",1e4,g),this.Ta=Es("forwardChannelMaxRetries",2,g),this.va=Es("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Dn(g&&g.concurrentRequestLimit),this.Ba=new Cr,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ir.prototype,n.ka=8,n.I=1,n.connect=function(g,b,A,R){Yt(0),this.W=g,this.H=b||{},A&&R!==void 0&&(this.H.OSID=A,this.H.OAID=R),this.F=this.X,this.J=fc(this,null,this.W),Ts(this)};function Ll(g){if(va(g),g.I==3){var b=g.V++,A=dt(g.J);if(Oe(A,"SID",g.M),Oe(A,"RID",b),Oe(A,"TYPE","terminate"),Mo(g,A),b=new ot(g,g.j,b),b.M=2,b.A=Wt(dt(A)),A=!1,u.navigator&&u.navigator.sendBeacon)try{A=u.navigator.sendBeacon(b.A.toString(),"")}catch{}!A&&u.Image&&(new Image().src=b.A,A=!0),A||(b.g=pc(b.j,null),b.g.ea(b.A)),b.F=Date.now(),_n(b)}hc(g)}function Rr(g){g.g&&(Ol(g),g.g.cancel(),g.g=null)}function va(g){Rr(g),g.v&&(u.clearTimeout(g.v),g.v=null),Ta(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&u.clearTimeout(g.m),g.m=null)}function Ts(g){if(!ve(g.h)&&!g.m){g.m=!0;var b=g.Ea;ae||M(),oe||(ae(),oe=!0),x.add(b,g),g.D=0}}function Ea(g,b){return kn(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=b.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=Ii(p(g.Ea,g,b),dc(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const G=new ot(this,this.j,g);let X=this.o;if(this.U&&(X?(X=F(X),he(X,this.U)):X=this.U),this.u!==null||this.R||(G.J=X,X=null),this.S)e:{for(var b=0,A=0;A<this.i.length;A++){t:{var R=this.i[A];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(b+=R,b>4096){b=A;break e}if(b===4096||A===this.i.length-1){b=A+1;break e}}b=1e3}else b=1e3;b=ac(this,G,b),A=dt(this.J),Oe(A,"RID",g),Oe(A,"CVER",22),this.G&&Oe(A,"X-HTTP-Session-Id",this.G),Mo(this,A),X&&(this.R?b="headers="+Ne(Pi(X))+"&"+b:this.u&&Io(A,this.u,X)),Re(this.h,G),this.Ra&&Oe(A,"TYPE","init"),this.S?(Oe(A,"$req",b),Oe(A,"SID","null"),G.U=!0,Sn(G,A,null)):Sn(G,A,b),this.I=2}}else this.I==3&&(g?Vl(this,g):this.i.length==0||ve(this.h)||Vl(this))};function Vl(g,b){var A;b?A=b.l:A=g.V++;const R=dt(g.J);Oe(R,"SID",g.M),Oe(R,"RID",A),Oe(R,"AID",g.K),Mo(g,R),g.u&&g.o&&Io(R,g.u,g.o),A=new ot(g,g.j,A,g.D+1),g.u===null&&(A.J=g.o),b&&(g.i=b.G.concat(g.i)),b=ac(g,A,1e3),A.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Re(g.h,A),Sn(A,R,b)}function Mo(g,b){g.H&&Ge(g.H,function(A,R){Oe(b,R,A)}),g.l&&Ge({},function(A,R){Oe(b,R,A)})}function ac(g,b,A){A=Math.min(g.i.length,A);const R=g.l?p(g.l.Ka,g.l,g):null;e:{var G=g.i;let Be=-1;for(;;){const en=["count="+A];Be==-1?A>0?(Be=G[0].g,en.push("ofs="+Be)):Be=0:en.push("ofs="+Be);let ht=!0;for(let Vt=0;Vt<A;Vt++){var X=G[Vt].g;const Di=G[Vt].map;if(X-=Be,X<0)Be=Math.max(0,G[Vt].g-100),ht=!1;else try{X="req"+X+"_"||"";try{var de=Di instanceof Map?Di:Object.entries(Di);for(const[bs,ts]of de){let ns=ts;d(ts)&&(ns=Xn(ts)),en.push(X+bs+"="+encodeURIComponent(ns))}}catch(bs){throw en.push(X+"type="+encodeURIComponent("_badmap")),bs}}catch{R&&R(Di)}}if(ht){de=en.join("&");break e}}de=void 0}return g=g.i.splice(0,A),b.G=g,de}function lc(g){if(!g.g&&!g.v){g.Y=1;var b=g.Da;ae||M(),oe||(ae(),oe=!0),x.add(b,g),g.A=0}}function Po(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=Ii(p(g.Da,g),dc(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,uc(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=Ii(p(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Yt(10),Rr(this),uc(this))};function Ol(g){g.B!=null&&(u.clearTimeout(g.B),g.B=null)}function uc(g){g.g=new ot(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var b=dt(g.na);Oe(b,"RID","rpc"),Oe(b,"SID",g.M),Oe(b,"AID",g.K),Oe(b,"CI",g.F?"0":"1"),!g.F&&g.ia&&Oe(b,"TO",g.ia),Oe(b,"TYPE","xmlhttp"),Mo(g,b),g.u&&g.o&&Io(b,g.u,g.o),g.O&&(g.g.H=g.O);var A=g.g;g=g.ba,A.M=1,A.A=Wt(dt(b)),A.u=null,A.R=!0,Ft(A,g)}n.Va=function(){this.C!=null&&(this.C=null,Rr(this),Po(this),Yt(19))};function Ta(g){g.C!=null&&(u.clearTimeout(g.C),g.C=null)}function cc(g,b){var A=null;if(g.g==b){Ta(g),Ol(g),g.g=null;var R=2}else if(De(g.h,b))A=b.G,Ve(g.h,b),R=1;else return;if(g.I!=0){if(b.o)if(R==1){A=b.u?b.u.length:0,b=Date.now()-b.F;var G=g.D;R=wr(),Rt(R,new pi(R,A)),Ts(g)}else lc(g);else if(G=b.m,G==3||G==0&&b.X>0||!(R==1&&Ea(g,b)||R==2&&Po(g)))switch(A&&A.length>0&&(b=g.h,b.i=b.i.concat(A)),G){case 1:Ss(g,5);break;case 4:Ss(g,10);break;case 3:Ss(g,6);break;default:Ss(g,2)}}}function dc(g,b){let A=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(A*=2),A*b}function Ss(g,b){if(g.j.info("Error code "+b),b==2){var A=p(g.bb,g),R=g.Ua;const G=!R;R=new Nt(R||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Lt(R,"https"),Wt(R),G?Wi(R.toString(),A):Dl(R.toString(),A)}else Yt(2);g.I=0,g.l&&g.l.pa(b),hc(g),va(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),Yt(2)):(this.j.info("Failed to ping google.com"),Yt(1))};function hc(g){if(g.I=0,g.ja=[],g.l){const b=st(g.h);(b.length!=0||g.i.length!=0)&&(k(g.ja,b),k(g.ja,g.i),g.h.i.length=0,C(g.i),g.i.length=0),g.l.oa()}}function fc(g,b,A){var R=A instanceof Nt?dt(A):new Nt(A);if(R.g!="")b&&(R.g=b+"."+R.g),$n(R,R.u);else{var G=u.location;R=G.protocol,b=b?b+"."+G.hostname:G.hostname,G=+G.port;const X=new Nt(null);R&&Lt(X,R),b&&(X.g=b),G&&$n(X,G),A&&(X.h=A),R=X}return A=g.G,b=g.wa,A&&b&&Oe(R,A,b),Oe(R,"VER",g.ka),Mo(g,R),R}function pc(g,b,A){if(b&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=g.Aa&&!g.ma?new Et(new _s({ab:A})):new Et(g.ma),b.Fa(g.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function mc(){}n=mc.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Nr(){}Nr.prototype.g=function(g,b){return new Kn(g,b)};function Kn(g,b){zt.call(this),this.g=new Ir(b),this.l=g,this.h=b&&b.messageUrlParams||null,g=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(g?g["X-WebChannel-Content-Type"]=b.messageContentType:g={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(g?g["X-WebChannel-Client-Profile"]=b.sa:g={"X-WebChannel-Client-Profile":b.sa}),this.g.U=g,(g=b&&b.Qb)&&!D(g)&&(this.g.u=g),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!D(b)&&(this.g.G=b,g=this.h,g!==null&&b in g&&(g=this.h,b in g&&delete g[b])),this.j=new Js(this)}E(Kn,zt),Kn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Kn.prototype.close=function(){Ll(this.g)},Kn.prototype.o=function(g){var b=this.g;if(typeof g=="string"){var A={};A.__data__=g,g=A}else this.v&&(A={},A.__data__=Xn(g),g=A);b.i.push(new At(b.Ya++,g)),b.I==3&&Ts(b)},Kn.prototype.N=function(){this.g.l=null,delete this.j,Ll(this.g),delete this.g,Kn.Z.N.call(this)};function gc(g){Ut.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var b=g.__sm__;if(b){e:{for(const A in b){g=A;break e}g=void 0}(this.i=g)&&(g=this.i,b=b!==null&&g in b?b[g]:void 0),this.data=b}else this.data=g}E(gc,Ut);function yc(){Qn.call(this),this.status=1}E(yc,Qn);function Js(g){this.g=g}E(Js,mc),Js.prototype.ra=function(){Rt(this.g,"a")},Js.prototype.qa=function(g){Rt(this.g,new gc(g))},Js.prototype.pa=function(g){Rt(this.g,new yc)},Js.prototype.oa=function(){Rt(this.g,"b")},Nr.prototype.createWebChannel=Nr.prototype.g,Kn.prototype.send=Kn.prototype.o,Kn.prototype.open=Kn.prototype.m,Kn.prototype.close=Kn.prototype.close,D1=function(){return new Nr},P1=function(){return wr()},M1=wt,Rm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ms.NO_ERROR=0,ms.TIMEOUT=8,ms.HTTP_ERROR=6,Ud=ms,Ar.COMPLETE="complete",N1=Ar,Hs.EventType=hi,hi.OPEN="a",hi.CLOSE="b",hi.ERROR="c",hi.MESSAGE="d",zt.prototype.listen=zt.prototype.J,Cu=Hs,Et.prototype.listenOnce=Et.prototype.K,Et.prototype.getLastError=Et.prototype.Ha,Et.prototype.getLastErrorCode=Et.prototype.ya,Et.prototype.getStatus=Et.prototype.ca,Et.prototype.getResponseJson=Et.prototype.La,Et.prototype.getResponseText=Et.prototype.la,Et.prototype.send=Et.prototype.ea,Et.prototype.setWithCredentials=Et.prototype.Fa,R1=Et}).apply(typeof bd<"u"?bd:typeof self<"u"?self:typeof window<"u"?window:{});const XT="@firebase/firestore",QT="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Fn.UNAUTHENTICATED=new Fn(null),Fn.GOOGLE_CREDENTIALS=new Fn("google-credentials-uid"),Fn.FIRST_PARTY=new Fn("first-party-uid"),Fn.MOCK_USER=new Fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Il="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la=new hg("@firebase/firestore");function el(){return la.logLevel}function me(n,...e){if(la.logLevel<=Qe.DEBUG){const t=e.map(Ag);la.debug(`Firestore (${Il}): ${n}`,...t)}}function vr(n,...e){if(la.logLevel<=Qe.ERROR){const t=e.map(Ag);la.error(`Firestore (${Il}): ${n}`,...t)}}function ml(n,...e){if(la.logLevel<=Qe.WARN){const t=e.map(Ag);la.warn(`Firestore (${Il}): ${n}`,...t)}}function Ag(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pe(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,k1(n,i,t)}function k1(n,e,t){let i=`FIRESTORE (${Il}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw vr(i),new Error(i)}function mt(n,e,t,i){let o="Unexpected state";typeof t=="string"?o=t:i=t,n||k1(e,o,i)}function Fe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ee extends Fs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class NU{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Fn.UNAUTHENTICATED)))}shutdown(){}}class MU{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class PU{constructor(e){this.t=e,this.currentUser=Fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){mt(this.o===void 0,42304);let i=this.i;const o=f=>this.i!==i?(i=this.i,t(f)):Promise.resolve();let a=new lo;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new lo,e.enqueueRetryable((()=>o(this.currentUser)))};const u=()=>{const f=a;e.enqueueRetryable((async()=>{await f.promise,await o(this.currentUser)}))},d=f=>{me("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(me("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new lo)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(me("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(mt(typeof i.accessToken=="string",31837,{l:i}),new U1(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mt(e===null||typeof e=="string",2055,{h:e}),new Fn(e)}}class DU{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class kU{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new DU(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Fn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class WT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class UU{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,li(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){mt(this.o===void 0,3512);const i=a=>{a.error!=null&&me("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const u=a.token!==this.m;return this.m=a.token,me("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>i(a)))};const o=a=>{me("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>o(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?o(a):me("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new WT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(mt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new WT(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LU(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const o=LU(40);for(let a=0;a<o.length;++a)i.length<20&&o[a]<t&&(i+=e.charAt(o[a]%62))}return i}}function We(n,e){return n<e?-1:n>e?1:0}function Nm(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const o=n.charAt(i),a=e.charAt(i);if(o!==a)return Zp(o)===Zp(a)?We(o,a):Zp(o)?1:-1}return We(n.length,e.length)}const VU=55296,OU=57343;function Zp(n){const e=n.charCodeAt(0);return e>=VU&&e<=OU}function gl(n,e,t){return n.length===e.length&&n.every(((i,o)=>t(i,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT="__name__";class Rs{constructor(e,t,i){t===void 0?t=0:t>e.length&&Pe(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Pe(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Rs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Rs?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let o=0;o<i;o++){const a=Rs.compareSegments(e.get(o),t.get(o));if(a!==0)return a}return We(e.length,t.length)}static compareSegments(e,t){const i=Rs.isNumericId(e),o=Rs.isNumericId(t);return i&&!o?-1:!i&&o?1:i&&o?Rs.extractNumericId(e).compare(Rs.extractNumericId(t)):Nm(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ao.fromString(e.substring(4,e.length-2))}}class Ht extends Rs{construct(e,t,i){return new Ht(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ee(le.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((o=>o.length>0)))}return new Ht(t)}static emptyPath(){return new Ht([])}}const zU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Mn extends Rs{construct(e,t,i){return new Mn(e,t,i)}static isValidIdentifier(e){return zU.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Mn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ZT}static keyField(){return new Mn([ZT])}static fromServerFormat(e){const t=[];let i="",o=0;const a=()=>{if(i.length===0)throw new Ee(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let u=!1;for(;o<e.length;){const d=e[o];if(d==="\\"){if(o+1===e.length)throw new Ee(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[o+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Ee(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,o+=2}else d==="`"?(u=!u,o++):d!=="."||u?(i+=d,o++):(a(),o++)}if(a(),u)throw new Ee(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Mn(t)}static emptyPath(){return new Mn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.path=e}static fromPath(e){return new xe(Ht.fromString(e))}static fromName(e){return new xe(Ht.fromString(e).popFirst(5))}static empty(){return new xe(Ht.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ht.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ht.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new xe(new Ht(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FU(n,e,t){if(!t)throw new Ee(le.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function BU(n,e,t,i){if(e===!0&&i===!0)throw new Ee(le.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function eS(n){if(!xe.isDocumentKey(n))throw new Ee(le.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function L1(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function xg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Pe(12329,{type:typeof n})}function Ps(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ee(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=xg(n);throw new Ee(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(n,e){const t={typeString:n};return e&&(t.value=e),t}function ec(n,e){if(!L1(n))throw new Ee(le.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const o=e[i].typeString,a="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const u=n[i];if(o&&typeof u!==o){t=`JSON field '${i}' must be a ${o}.`;break}if(a!==void 0&&u!==a.value){t=`Expected '${i}' field to equal '${a.value}'`;break}}if(t)throw new Ee(le.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS=-62135596800,nS=1e6;class kt{static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*nS);return new kt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ee(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ee(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<tS)throw new Ee(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ee(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/nS}_compareTo(e){return this.seconds===e.seconds?We(this.nanoseconds,e.nanoseconds):We(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ec(e,kt._jsonSchema))return new kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-tS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}kt._jsonSchemaVersion="firestore/timestamp/1.0",kt._jsonSchema={type:dn("string",kt._jsonSchemaVersion),seconds:dn("number"),nanoseconds:dn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{static fromTimestamp(e){return new Le(e)}static min(){return new Le(new kt(0,0))}static max(){return new Le(new kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fu=-1;function qU(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,o=Le.fromTimestamp(i===1e9?new kt(t+1,0):new kt(t,i));return new ho(o,xe.empty(),e)}function HU(n){return new ho(n.readTime,n.key,Fu)}class ho{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ho(Le.min(),xe.empty(),Fu)}static max(){return new ho(Le.max(),xe.empty(),Fu)}}function GU(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=xe.comparator(n.documentKey,e.documentKey),t!==0?t:We(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YU="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $U{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rl(n){if(n.code!==le.FAILED_PRECONDITION||n.message!==YU)throw n;me("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new re(((i,o)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(i,o)},this.catchCallback=a=>{this.wrapFailure(t,a).next(i,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof re?t:re.resolve(t)}catch(t){return re.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):re.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):re.reject(t)}static resolve(e){return new re(((t,i)=>{t(e)}))}static reject(e){return new re(((t,i)=>{i(e)}))}static waitFor(e){return new re(((t,i)=>{let o=0,a=0,u=!1;e.forEach((d=>{++o,d.next((()=>{++a,u&&a===o&&t()}),(f=>i(f)))})),u=!0,a===o&&t()}))}static or(e){let t=re.resolve(!1);for(const i of e)t=t.next((o=>o?re.resolve(o):i()));return t}static forEach(e,t){const i=[];return e.forEach(((o,a)=>{i.push(t.call(this,o,a))})),this.waitFor(i)}static mapArray(e,t){return new re(((i,o)=>{const a=e.length,u=new Array(a);let d=0;for(let f=0;f<a;f++){const p=f;t(e[p]).next((_=>{u[p]=_,++d,d===a&&i(u)}),(_=>o(_)))}}))}static doWhile(e,t){return new re(((i,o)=>{const a=()=>{e()===!0?t().next((()=>{a()}),o):i()};a()}))}}function KU(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Nl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ch.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig=-1;function xh(n){return n==null}function nh(n){return n===0&&1/n==-1/0}function JU(n){return typeof n=="number"&&Number.isInteger(n)&&!nh(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V1="";function jU(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=iS(e)),e=XU(n.get(t),e);return iS(e)}function XU(n,e){let t=e;const i=n.length;for(let o=0;o<i;o++){const a=n.charAt(o);switch(a){case"\0":t+="";break;case V1:t+="";break;default:t+=a}}return t}function iS(n){return n+V1+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sS(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function bo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function O1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e,t){this.comparator=e,this.root=t||Nn.EMPTY}insert(e,t){return new Gt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Nn.BLACK,null,null))}remove(e){return new Gt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const o=this.comparator(e,i.key);if(o===0)return t+i.left.size;o<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wd(this.root,e,this.comparator,!1)}getReverseIterator(){return new wd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wd(this.root,e,this.comparator,!0)}}class wd{constructor(e,t,i,o){this.isReverse=o,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?i(e.key,t):1,t&&o&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Nn{constructor(e,t,i,o,a){this.key=e,this.value=t,this.color=i??Nn.RED,this.left=o??Nn.EMPTY,this.right=a??Nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,o,a){return new Nn(e??this.key,t??this.value,i??this.color,o??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let o=this;const a=i(e,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(e,t,i),null):a===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,i)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Nn.EMPTY;i=o.right.min(),o=o.copy(i.key,i.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Pe(27949);return e+(this.isRed()?0:1)}}Nn.EMPTY=null,Nn.RED=!0,Nn.BLACK=!1;Nn.EMPTY=new class{constructor(){this.size=0}get key(){throw Pe(57766)}get value(){throw Pe(16141)}get color(){throw Pe(16727)}get left(){throw Pe(29726)}get right(){throw Pe(36894)}copy(e,t,i,o,a){return this}insert(e,t,i){return new Nn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.comparator=e,this.data=new Gt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const o=i.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new rS(this.data.getIterator())}getIteratorFrom(e){return new rS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof gn)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,a=i.getNext().key;if(this.comparator(o,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new gn(this.comparator);return t.data=e,t}}class rS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.fields=e,e.sort(Mn.comparator)}static empty(){return new Ai([])}unionWith(e){let t=new gn(Mn.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Ai(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return gl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new z1("Invalid base64 string: "+a):a}})(e);return new Pn(t)}static fromUint8Array(e){const t=(function(o){let a="";for(let u=0;u<o.length;++u)a+=String.fromCharCode(o[u]);return a})(e);return new Pn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return We(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Pn.EMPTY_BYTE_STRING=new Pn("");const QU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fo(n){if(mt(!!n,39018),typeof n=="string"){let e=0;const t=QU.exec(n);if(mt(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:sn(n.seconds),nanos:sn(n.nanos)}}function sn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function po(n){return typeof n=="string"?Pn.fromBase64String(n):Pn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1="server_timestamp",B1="__type__",q1="__previous_value__",H1="__local_write_time__";function Rg(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[B1])==null?void 0:i.stringValue)===F1}function Ih(n){const e=n.mapValue.fields[q1];return Rg(e)?Ih(e):e}function Bu(n){const e=fo(n.mapValue.fields[H1].timestampValue);return new kt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e,t,i,o,a,u,d,f,p,_){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=o,this.ssl=a,this.forceLongPolling=u,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=_}}const ih="(default)";class qu{constructor(e,t){this.projectId=e,this.database=t||ih}static empty(){return new qu("","")}get isDefaultDatabase(){return this.database===ih}isEqual(e){return e instanceof qu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1="__type__",ZU="__max__",Ad={mapValue:{}},Y1="__vector__",sh="value";function mo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Rg(n)?4:tL(n)?9007199254740991:eL(n)?10:11:Pe(28295,{value:n})}function Os(n,e){if(n===e)return!0;const t=mo(n);if(t!==mo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Bu(n).isEqual(Bu(e));case 3:return(function(o,a){if(typeof o.timestampValue=="string"&&typeof a.timestampValue=="string"&&o.timestampValue.length===a.timestampValue.length)return o.timestampValue===a.timestampValue;const u=fo(o.timestampValue),d=fo(a.timestampValue);return u.seconds===d.seconds&&u.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,a){return po(o.bytesValue).isEqual(po(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,a){return sn(o.geoPointValue.latitude)===sn(a.geoPointValue.latitude)&&sn(o.geoPointValue.longitude)===sn(a.geoPointValue.longitude)})(n,e);case 2:return(function(o,a){if("integerValue"in o&&"integerValue"in a)return sn(o.integerValue)===sn(a.integerValue);if("doubleValue"in o&&"doubleValue"in a){const u=sn(o.doubleValue),d=sn(a.doubleValue);return u===d?nh(u)===nh(d):isNaN(u)&&isNaN(d)}return!1})(n,e);case 9:return gl(n.arrayValue.values||[],e.arrayValue.values||[],Os);case 10:case 11:return(function(o,a){const u=o.mapValue.fields||{},d=a.mapValue.fields||{};if(sS(u)!==sS(d))return!1;for(const f in u)if(u.hasOwnProperty(f)&&(d[f]===void 0||!Os(u[f],d[f])))return!1;return!0})(n,e);default:return Pe(52216,{left:n})}}function Hu(n,e){return(n.values||[]).find((t=>Os(t,e)))!==void 0}function yl(n,e){if(n===e)return 0;const t=mo(n),i=mo(e);if(t!==i)return We(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return We(n.booleanValue,e.booleanValue);case 2:return(function(a,u){const d=sn(a.integerValue||a.doubleValue),f=sn(u.integerValue||u.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(n,e);case 3:return oS(n.timestampValue,e.timestampValue);case 4:return oS(Bu(n),Bu(e));case 5:return Nm(n.stringValue,e.stringValue);case 6:return(function(a,u){const d=po(a),f=po(u);return d.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(a,u){const d=a.split("/"),f=u.split("/");for(let p=0;p<d.length&&p<f.length;p++){const _=We(d[p],f[p]);if(_!==0)return _}return We(d.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,u){const d=We(sn(a.latitude),sn(u.latitude));return d!==0?d:We(sn(a.longitude),sn(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return aS(n.arrayValue,e.arrayValue);case 10:return(function(a,u){var S,C,k,V;const d=a.fields||{},f=u.fields||{},p=(S=d[sh])==null?void 0:S.arrayValue,_=(C=f[sh])==null?void 0:C.arrayValue,E=We(((k=p==null?void 0:p.values)==null?void 0:k.length)||0,((V=_==null?void 0:_.values)==null?void 0:V.length)||0);return E!==0?E:aS(p,_)})(n.mapValue,e.mapValue);case 11:return(function(a,u){if(a===Ad.mapValue&&u===Ad.mapValue)return 0;if(a===Ad.mapValue)return 1;if(u===Ad.mapValue)return-1;const d=a.fields||{},f=Object.keys(d),p=u.fields||{},_=Object.keys(p);f.sort(),_.sort();for(let E=0;E<f.length&&E<_.length;++E){const S=Nm(f[E],_[E]);if(S!==0)return S;const C=yl(d[f[E]],p[_[E]]);if(C!==0)return C}return We(f.length,_.length)})(n.mapValue,e.mapValue);default:throw Pe(23264,{he:t})}}function oS(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return We(n,e);const t=fo(n),i=fo(e),o=We(t.seconds,i.seconds);return o!==0?o:We(t.nanos,i.nanos)}function aS(n,e){const t=n.values||[],i=e.values||[];for(let o=0;o<t.length&&o<i.length;++o){const a=yl(t[o],i[o]);if(a)return a}return We(t.length,i.length)}function _l(n){return Mm(n)}function Mm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=fo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return po(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return xe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",o=!0;for(const a of t.values||[])o?o=!1:i+=",",i+=Mm(a);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let o="{",a=!0;for(const u of i)a?a=!1:o+=",",o+=`${u}:${Mm(t.fields[u])}`;return o+"}"})(n.mapValue):Pe(61005,{value:n})}function Ld(n){switch(mo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ih(n);return e?16+Ld(e):16;case 5:return 2*n.stringValue.length;case 6:return po(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((o,a)=>o+Ld(a)),0)})(n.arrayValue);case 10:case 11:return(function(i){let o=0;return bo(i.fields,((a,u)=>{o+=a.length+Ld(u)})),o})(n.mapValue);default:throw Pe(13486,{value:n})}}function Pm(n){return!!n&&"integerValue"in n}function Ng(n){return!!n&&"arrayValue"in n}function lS(n){return!!n&&"nullValue"in n}function uS(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Vd(n){return!!n&&"mapValue"in n}function eL(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[G1])==null?void 0:i.stringValue)===Y1}function Du(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return bo(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=Du(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Du(n.arrayValue.values[t]);return e}return{...n}}function tL(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===ZU}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e){this.value=e}static empty(){return new ui({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Vd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Du(t)}setAll(e){let t=Mn.emptyPath(),i={},o=[];e.forEach(((u,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,i,o),i={},o=[],t=d.popLast()}u?i[d.lastSegment()]=Du(u):o.push(d.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,i,o)}delete(e){const t=this.field(e.popLast());Vd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Os(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let o=t.mapValue.fields[e.get(i)];Vd(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,i){bo(t,((o,a)=>e[o]=a));for(const o of i)delete e[o]}clone(){return new ui(Du(this.value))}}function $1(n){const e=[];return bo(n.fields,((t,i)=>{const o=new Mn([t]);if(Vd(i)){const a=$1(i.mapValue).fields;if(a.length===0)e.push(o);else for(const u of a)e.push(o.child(u))}else e.push(o)})),new Ai(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e,t,i,o,a,u,d){this.key=e,this.documentType=t,this.version=i,this.readTime=o,this.createTime=a,this.data=u,this.documentState=d}static newInvalidDocument(e){return new Bn(e,0,Le.min(),Le.min(),Le.min(),ui.empty(),0)}static newFoundDocument(e,t,i,o){return new Bn(e,1,t,Le.min(),i,o,0)}static newNoDocument(e,t){return new Bn(e,2,t,Le.min(),Le.min(),ui.empty(),0)}static newUnknownDocument(e,t){return new Bn(e,3,t,Le.min(),Le.min(),ui.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Le.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ui.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ui.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Le.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,t){this.position=e,this.inclusive=t}}function cS(n,e,t){let i=0;for(let o=0;o<n.position.length;o++){const a=e[o],u=n.position[o];if(a.field.isKeyField()?i=xe.comparator(xe.fromName(u.referenceValue),t.key):i=yl(u,t.data.field(a.field)),a.dir==="desc"&&(i*=-1),i!==0)break}return i}function dS(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Os(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(e,t="asc"){this.field=e,this.dir=t}}function nL(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{}class mn extends K1{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new sL(e,t,i):t==="array-contains"?new aL(e,i):t==="in"?new lL(e,i):t==="not-in"?new uL(e,i):t==="array-contains-any"?new cL(e,i):new mn(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new rL(e,i):new oL(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(yl(t,this.value)):t!==null&&mo(this.value)===mo(t)&&this.matchesComparison(yl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zs extends K1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new zs(e,t)}matches(e){return J1(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function J1(n){return n.op==="and"}function j1(n){return iL(n)&&J1(n)}function iL(n){for(const e of n.filters)if(e instanceof zs)return!1;return!0}function Dm(n){if(n instanceof mn)return n.field.canonicalString()+n.op.toString()+_l(n.value);if(j1(n))return n.filters.map((e=>Dm(e))).join(",");{const e=n.filters.map((t=>Dm(t))).join(",");return`${n.op}(${e})`}}function X1(n,e){return n instanceof mn?(function(i,o){return o instanceof mn&&i.op===o.op&&i.field.isEqual(o.field)&&Os(i.value,o.value)})(n,e):n instanceof zs?(function(i,o){return o instanceof zs&&i.op===o.op&&i.filters.length===o.filters.length?i.filters.reduce(((a,u,d)=>a&&X1(u,o.filters[d])),!0):!1})(n,e):void Pe(19439)}function Q1(n){return n instanceof mn?(function(t){return`${t.field.canonicalString()} ${t.op} ${_l(t.value)}`})(n):n instanceof zs?(function(t){return t.op.toString()+" {"+t.getFilters().map(Q1).join(" ,")+"}"})(n):"Filter"}class sL extends mn{constructor(e,t,i){super(e,t,i),this.key=xe.fromName(i.referenceValue)}matches(e){const t=xe.comparator(e.key,this.key);return this.matchesComparison(t)}}class rL extends mn{constructor(e,t){super(e,"in",t),this.keys=W1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class oL extends mn{constructor(e,t){super(e,"not-in",t),this.keys=W1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function W1(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>xe.fromName(i.referenceValue)))}class aL extends mn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ng(t)&&Hu(t.arrayValue,this.value)}}class lL extends mn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Hu(this.value.arrayValue,t)}}class uL extends mn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Hu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Hu(this.value.arrayValue,t)}}class cL extends mn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ng(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Hu(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{constructor(e,t=null,i=[],o=[],a=null,u=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=o,this.limit=a,this.startAt=u,this.endAt=d,this.Te=null}}function hS(n,e=null,t=[],i=[],o=null,a=null,u=null){return new dL(n,e,t,i,o,a,u)}function Mg(n){const e=Fe(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>Dm(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(a){return a.field.canonicalString()+a.dir})(i))).join(","),xh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>_l(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>_l(i))).join(",")),e.Te=t}return e.Te}function Pg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!nL(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!X1(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!dS(n.startAt,e.startAt)&&dS(n.endAt,e.endAt)}function km(n){return xe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,t=null,i=[],o=[],a=null,u="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=o,this.limit=a,this.limitType=u,this.startAt=d,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function hL(n,e,t,i,o,a,u,d){return new Rh(n,e,t,i,o,a,u,d)}function Nh(n){return new Rh(n)}function fS(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function fL(n){return n.collectionGroup!==null}function ku(n){const e=Fe(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let d=new gn(Mn.comparator);return u.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(d=d.add(p.field))}))})),d})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new oh(a,i))})),t.has(Mn.keyField().canonicalString())||e.Ie.push(new oh(Mn.keyField(),i))}return e.Ie}function Ds(n){const e=Fe(n);return e.Ee||(e.Ee=pL(e,ku(n))),e.Ee}function pL(n,e){if(n.limitType==="F")return hS(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const a=o.dir==="desc"?"asc":"desc";return new oh(o.field,a)}));const t=n.endAt?new rh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new rh(n.startAt.position,n.startAt.inclusive):null;return hS(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Um(n,e,t){return new Rh(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Mh(n,e){return Pg(Ds(n),Ds(e))&&n.limitType===e.limitType}function Z1(n){return`${Mg(Ds(n))}|lt:${n.limitType}`}function tl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((o=>Q1(o))).join(", ")}]`),xh(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((o=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(o))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((o=>_l(o))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((o=>_l(o))).join(",")),`Target(${i})`})(Ds(n))}; limitType=${n.limitType})`}function Ph(n,e){return e.isFoundDocument()&&(function(i,o){const a=o.key.path;return i.collectionGroup!==null?o.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(a):xe.isDocumentKey(i.path)?i.path.isEqual(a):i.path.isImmediateParentOf(a)})(n,e)&&(function(i,o){for(const a of ku(i))if(!a.field.isKeyField()&&o.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(i,o){for(const a of i.filters)if(!a.matches(o))return!1;return!0})(n,e)&&(function(i,o){return!(i.startAt&&!(function(u,d,f){const p=cS(u,d,f);return u.inclusive?p<=0:p<0})(i.startAt,ku(i),o)||i.endAt&&!(function(u,d,f){const p=cS(u,d,f);return u.inclusive?p>=0:p>0})(i.endAt,ku(i),o))})(n,e)}function mL(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ew(n){return(e,t)=>{let i=!1;for(const o of ku(n)){const a=gL(o,e,t);if(a!==0)return a;i=i||o.field.isKeyField()}return 0}}function gL(n,e,t){const i=n.field.isKeyField()?xe.comparator(e.key,t.key):(function(a,u,d){const f=u.data.field(a),p=d.data.field(a);return f!==null&&p!==null?yl(f,p):Pe(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Pe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[o,a]of i)if(this.equalsFn(o,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),o=this.inner[i];if(o===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let a=0;a<o.length;a++)if(this.equalsFn(o[a][0],e))return void(o[a]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return i.length===1?delete this.inner[t]:i.splice(o,1),this.innerSize--,!0;return!1}forEach(e){bo(this.inner,((t,i)=>{for(const[o,a]of i)e(o,a)}))}isEmpty(){return O1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yL=new Gt(xe.comparator);function Er(){return yL}const tw=new Gt(xe.comparator);function xu(...n){let e=tw;for(const t of n)e=e.insert(t.key,t);return e}function nw(n){let e=tw;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function ta(){return Uu()}function iw(){return Uu()}function Uu(){return new da((n=>n.toString()),((n,e)=>n.isEqual(e)))}const _L=new Gt(xe.comparator),vL=new gn(xe.comparator);function Ze(...n){let e=vL;for(const t of n)e=e.add(t);return e}const EL=new gn(We);function TL(){return EL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nh(e)?"-0":e}}function sw(n){return{integerValue:""+n}}function SL(n,e){return JU(e)?sw(e):Dg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(){this._=void 0}}function bL(n,e,t){return n instanceof Gu?(function(o,a){const u={fields:{[B1]:{stringValue:F1},[H1]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return a&&Rg(a)&&(a=Ih(a)),a&&(u.fields[q1]=a),{mapValue:u}})(t,e):n instanceof Yu?ow(n,e):n instanceof $u?aw(n,e):(function(o,a){const u=rw(o,a),d=pS(u)+pS(o.Ae);return Pm(u)&&Pm(o.Ae)?sw(d):Dg(o.serializer,d)})(n,e)}function wL(n,e,t){return n instanceof Yu?ow(n,e):n instanceof $u?aw(n,e):t}function rw(n,e){return n instanceof ah?(function(i){return Pm(i)||(function(a){return!!a&&"doubleValue"in a})(i)})(e)?e:{integerValue:0}:null}class Gu extends Dh{}class Yu extends Dh{constructor(e){super(),this.elements=e}}function ow(n,e){const t=lw(e);for(const i of n.elements)t.some((o=>Os(o,i)))||t.push(i);return{arrayValue:{values:t}}}class $u extends Dh{constructor(e){super(),this.elements=e}}function aw(n,e){let t=lw(e);for(const i of n.elements)t=t.filter((o=>!Os(o,i)));return{arrayValue:{values:t}}}class ah extends Dh{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function pS(n){return sn(n.integerValue||n.doubleValue)}function lw(n){return Ng(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AL{constructor(e,t){this.field=e,this.transform=t}}function CL(n,e){return n.field.isEqual(e.field)&&(function(i,o){return i instanceof Yu&&o instanceof Yu||i instanceof $u&&o instanceof $u?gl(i.elements,o.elements,Os):i instanceof ah&&o instanceof ah?Os(i.Ae,o.Ae):i instanceof Gu&&o instanceof Gu})(n.transform,e.transform)}class xL{constructor(e,t){this.version=e,this.transformResults=t}}class ks{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ks}static exists(e){return new ks(void 0,e)}static updateTime(e){return new ks(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Od(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class kh{}function uw(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new dw(n.key,ks.none()):new tc(n.key,n.data,ks.none());{const t=n.data,i=ui.empty();let o=new gn(Mn.comparator);for(let a of e.fields)if(!o.has(a)){let u=t.field(a);u===null&&a.length>1&&(a=a.popLast(),u=t.field(a)),u===null?i.delete(a):i.set(a,u),o=o.add(a)}return new wo(n.key,i,new Ai(o.toArray()),ks.none())}}function IL(n,e,t){n instanceof tc?(function(o,a,u){const d=o.value.clone(),f=gS(o.fieldTransforms,a,u.transformResults);d.setAll(f),a.convertToFoundDocument(u.version,d).setHasCommittedMutations()})(n,e,t):n instanceof wo?(function(o,a,u){if(!Od(o.precondition,a))return void a.convertToUnknownDocument(u.version);const d=gS(o.fieldTransforms,a,u.transformResults),f=a.data;f.setAll(cw(o)),f.setAll(d),a.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(n,e,t):(function(o,a,u){a.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function Lu(n,e,t,i){return n instanceof tc?(function(a,u,d,f){if(!Od(a.precondition,u))return d;const p=a.value.clone(),_=yS(a.fieldTransforms,f,u);return p.setAll(_),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),null})(n,e,t,i):n instanceof wo?(function(a,u,d,f){if(!Od(a.precondition,u))return d;const p=yS(a.fieldTransforms,f,u),_=u.data;return _.setAll(cw(a)),_.setAll(p),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((E=>E.field)))})(n,e,t,i):(function(a,u,d){return Od(a.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):d})(n,e,t)}function RL(n,e){let t=null;for(const i of n.fieldTransforms){const o=e.data.field(i.field),a=rw(i.transform,o||null);a!=null&&(t===null&&(t=ui.empty()),t.set(i.field,a))}return t||null}function mS(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,o){return i===void 0&&o===void 0||!(!i||!o)&&gl(i,o,((a,u)=>CL(a,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class tc extends kh{constructor(e,t,i,o=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class wo extends kh{constructor(e,t,i,o,a=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=o,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function cw(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function gS(n,e,t){const i=new Map;mt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let o=0;o<t.length;o++){const a=n[o],u=a.transform,d=e.data.field(a.field);i.set(a.field,wL(u,d,t[o]))}return i}function yS(n,e,t){const i=new Map;for(const o of n){const a=o.transform,u=t.data.field(o.field);i.set(o.field,bL(a,u,e))}return i}class dw extends kh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class NL extends kh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ML{constructor(e,t,i,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=o}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const a=this.mutations[o];a.key.isEqual(e.key)&&IL(a,e,i[o])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Lu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Lu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=iw();return this.mutations.forEach((o=>{const a=e.get(o.key),u=a.overlayedDocument;let d=this.applyToLocalView(u,a.mutatedFields);d=t.has(o.key)?null:d;const f=uw(u,d);f!==null&&i.set(o.key,f),u.isValidDocument()||u.convertToNoDocument(Le.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ze())}isEqual(e){return this.batchId===e.batchId&&gl(this.mutations,e.mutations,((t,i)=>mS(t,i)))&&gl(this.baseMutations,e.baseMutations,((t,i)=>mS(t,i)))}}class kg{constructor(e,t,i,o){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=o}static from(e,t,i){mt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let o=(function(){return _L})();const a=e.mutations;for(let u=0;u<a.length;u++)o=o.insert(a[u].key,i[u].version);return new kg(e,t,i,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PL{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DL{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cn,nt;function kL(n){switch(n){case le.OK:return Pe(64938);case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0;default:return Pe(15467,{code:n})}}function hw(n){if(n===void 0)return vr("GRPC error has no .code"),le.UNKNOWN;switch(n){case cn.OK:return le.OK;case cn.CANCELLED:return le.CANCELLED;case cn.UNKNOWN:return le.UNKNOWN;case cn.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case cn.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case cn.INTERNAL:return le.INTERNAL;case cn.UNAVAILABLE:return le.UNAVAILABLE;case cn.UNAUTHENTICATED:return le.UNAUTHENTICATED;case cn.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case cn.NOT_FOUND:return le.NOT_FOUND;case cn.ALREADY_EXISTS:return le.ALREADY_EXISTS;case cn.PERMISSION_DENIED:return le.PERMISSION_DENIED;case cn.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case cn.ABORTED:return le.ABORTED;case cn.OUT_OF_RANGE:return le.OUT_OF_RANGE;case cn.UNIMPLEMENTED:return le.UNIMPLEMENTED;case cn.DATA_LOSS:return le.DATA_LOSS;default:return Pe(39323,{code:n})}}(nt=cn||(cn={}))[nt.OK=0]="OK",nt[nt.CANCELLED=1]="CANCELLED",nt[nt.UNKNOWN=2]="UNKNOWN",nt[nt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nt[nt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nt[nt.NOT_FOUND=5]="NOT_FOUND",nt[nt.ALREADY_EXISTS=6]="ALREADY_EXISTS",nt[nt.PERMISSION_DENIED=7]="PERMISSION_DENIED",nt[nt.UNAUTHENTICATED=16]="UNAUTHENTICATED",nt[nt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nt[nt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nt[nt.ABORTED=10]="ABORTED",nt[nt.OUT_OF_RANGE=11]="OUT_OF_RANGE",nt[nt.UNIMPLEMENTED=12]="UNIMPLEMENTED",nt[nt.INTERNAL=13]="INTERNAL",nt[nt.UNAVAILABLE=14]="UNAVAILABLE",nt[nt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UL(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LL=new ao([4294967295,4294967295],0);function _S(n){const e=UL().encode(n),t=new I1;return t.update(e),new Uint8Array(t.digest())}function vS(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),o=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new ao([t,i],0),new ao([o,a],0)]}class Ug{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Iu(`Invalid padding: ${t}`);if(i<0)throw new Iu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Iu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Iu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ao.fromNumber(this.ge)}ye(e,t,i){let o=e.add(t.multiply(ao.fromNumber(i)));return o.compare(LL)===1&&(o=new ao([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=_S(e),[i,o]=vS(t);for(let a=0;a<this.hashCount;a++){const u=this.ye(i,o,a);if(!this.we(u))return!1}return!0}static create(e,t,i){const o=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),u=new Ug(a,o,t);return i.forEach((d=>u.insert(d))),u}insert(e){if(this.ge===0)return;const t=_S(e),[i,o]=vS(t);for(let a=0;a<this.hashCount;a++){const u=this.ye(i,o,a);this.Se(u)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Iu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,t,i,o,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=o,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const o=new Map;return o.set(e,nc.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Uh(Le.min(),o,new Gt(We),Er(),Ze())}}class nc{constructor(e,t,i,o,a){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=o,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new nc(i,t,Ze(),Ze(),Ze())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(e,t,i,o){this.be=e,this.removedTargetIds=t,this.key=i,this.De=o}}class fw{constructor(e,t){this.targetId=e,this.Ce=t}}class pw{constructor(e,t,i=Pn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=o}}class ES{constructor(){this.ve=0,this.Fe=TS(),this.Me=Pn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ze(),t=Ze(),i=Ze();return this.Fe.forEach(((o,a)=>{switch(a){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:i=i.add(o);break;default:Pe(38017,{changeType:a})}})),new nc(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=TS()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,mt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class VL{constructor(e){this.Ge=e,this.ze=new Map,this.je=Er(),this.Je=Cd(),this.He=Cd(),this.Ye=new Gt(We)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:Pe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,i=e.Ce.count,o=this.ot(t);if(o){const a=o.target;if(km(a))if(i===0){const u=new xe(a.path);this.et(t,u,Bn.newNoDocument(u,Le.min()))}else mt(i===1,20013,{expectedCount:i});else{const u=this._t(t);if(u!==i){const d=this.ut(e),f=d?this.ct(d,e,u):1;if(f!==0){this.it(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:o=0},hashCount:a=0}=t;let u,d;try{u=po(i).toUint8Array()}catch(f){if(f instanceof z1)return ml("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new Ug(u,o,a)}catch(f){return ml(f instanceof Iu?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.ge===0?null:d}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let o=0;return i.forEach((a=>{const u=this.Ge.ht(),d=`projects/${u.projectId}/databases/${u.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.et(t,a,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((a,u)=>{const d=this.ot(u);if(d){if(a.current&&km(d.target)){const f=new xe(d.target.path);this.It(f).has(u)||this.Et(u,f)||this.et(u,f,Bn.newNoDocument(f,e))}a.Be&&(t.set(u,a.ke()),a.qe())}}));let i=Ze();this.He.forEach(((a,u)=>{let d=!0;u.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(a))})),this.je.forEach(((a,u)=>u.setReadTime(e)));const o=new Uh(e,t,this.Ye,this.je,i);return this.je=Er(),this.Je=Cd(),this.He=Cd(),this.Ye=new Gt(We),o}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.Qe(t,1):o.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new ES,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new gn(We),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new gn(We),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||me("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ES),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Cd(){return new Gt(xe.comparator)}function TS(){return new Gt(xe.comparator)}const OL={asc:"ASCENDING",desc:"DESCENDING"},zL={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},FL={and:"AND",or:"OR"};class BL{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Lm(n,e){return n.useProto3Json||xh(e)?e:{value:e}}function lh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function mw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function qL(n,e){return lh(n,e.toTimestamp())}function Us(n){return mt(!!n,49232),Le.fromTimestamp((function(t){const i=fo(t);return new kt(i.seconds,i.nanos)})(n))}function Lg(n,e){return Vm(n,e).canonicalString()}function Vm(n,e){const t=(function(o){return new Ht(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?t:t.child(e)}function gw(n){const e=Ht.fromString(n);return mt(Tw(e),10190,{key:e.toString()}),e}function Om(n,e){return Lg(n.databaseId,e.path)}function em(n,e){const t=gw(e);if(t.get(1)!==n.databaseId.projectId)throw new Ee(le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ee(le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new xe(_w(t))}function yw(n,e){return Lg(n.databaseId,e)}function HL(n){const e=gw(n);return e.length===4?Ht.emptyPath():_w(e)}function zm(n){return new Ht(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function _w(n){return mt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function SS(n,e,t){return{name:Om(n,e),fields:t.value.mapValue.fields}}function GL(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Pe(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],a=(function(p,_){return p.useProto3Json?(mt(_===void 0||typeof _=="string",58123),Pn.fromBase64String(_||"")):(mt(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),Pn.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,d=u&&(function(p){const _=p.code===void 0?le.UNKNOWN:hw(p.code);return new Ee(_,p.message||"")})(u);t=new pw(i,o,a,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const o=em(n,i.document.name),a=Us(i.document.updateTime),u=i.document.createTime?Us(i.document.createTime):Le.min(),d=new ui({mapValue:{fields:i.document.fields}}),f=Bn.newFoundDocument(o,a,u,d),p=i.targetIds||[],_=i.removedTargetIds||[];t=new zd(p,_,f.key,f)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const o=em(n,i.document),a=i.readTime?Us(i.readTime):Le.min(),u=Bn.newNoDocument(o,a),d=i.removedTargetIds||[];t=new zd([],d,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const o=em(n,i.document),a=i.removedTargetIds||[];t=new zd([],a,o,null)}else{if(!("filter"in e))return Pe(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:o=0,unchangedNames:a}=i,u=new DL(o,a),d=i.targetId;t=new fw(d,u)}}return t}function YL(n,e){let t;if(e instanceof tc)t={update:SS(n,e.key,e.value)};else if(e instanceof dw)t={delete:Om(n,e.key)};else if(e instanceof wo)t={update:SS(n,e.key,e.data),updateMask:eV(e.fieldMask)};else{if(!(e instanceof NL))return Pe(16599,{Vt:e.type});t={verify:Om(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(a,u){const d=u.transform;if(d instanceof Gu)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Yu)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof $u)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof ah)return{fieldPath:u.field.canonicalString(),increment:d.Ae};throw Pe(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(o,a){return a.updateTime!==void 0?{updateTime:qL(o,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Pe(27497)})(n,e.precondition)),t}function $L(n,e){return n&&n.length>0?(mt(e!==void 0,14353),n.map((t=>(function(o,a){let u=o.updateTime?Us(o.updateTime):Us(a);return u.isEqual(Le.min())&&(u=Us(a)),new xL(u,o.transformResults||[])})(t,e)))):[]}function KL(n,e){return{documents:[yw(n,e.path)]}}function JL(n,e){const t={structuredQuery:{}},i=e.path;let o;e.collectionGroup!==null?(o=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=yw(n,o);const a=(function(p){if(p.length!==0)return Ew(zs.create(p,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const u=(function(p){if(p.length!==0)return p.map((_=>(function(S){return{field:nl(S.field),direction:QL(S.dir)}})(_)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const d=Lm(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:o}}function jL(n){let e=HL(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let o=null;if(i>0){mt(i===1,65062);const _=t.from[0];_.allDescendants?o=_.collectionId:e=e.child(_.collectionId)}let a=[];t.where&&(a=(function(E){const S=vw(E);return S instanceof zs&&j1(S)?S.getFilters():[S]})(t.where));let u=[];t.orderBy&&(u=(function(E){return E.map((S=>(function(k){return new oh(il(k.field),(function(z){switch(z){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(S)))})(t.orderBy));let d=null;t.limit&&(d=(function(E){let S;return S=typeof E=="object"?E.value:E,xh(S)?null:S})(t.limit));let f=null;t.startAt&&(f=(function(E){const S=!!E.before,C=E.values||[];return new rh(C,S)})(t.startAt));let p=null;return t.endAt&&(p=(function(E){const S=!E.before,C=E.values||[];return new rh(C,S)})(t.endAt)),hL(e,o,u,a,d,"F",f,p)}function XL(n,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pe(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function vw(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=il(t.unaryFilter.field);return mn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const o=il(t.unaryFilter.field);return mn.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=il(t.unaryFilter.field);return mn.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=il(t.unaryFilter.field);return mn.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Pe(61313);default:return Pe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return mn.create(il(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Pe(58110);default:return Pe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return zs.create(t.compositeFilter.filters.map((i=>vw(i))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Pe(1026)}})(t.compositeFilter.op))})(n):Pe(30097,{filter:n})}function QL(n){return OL[n]}function WL(n){return zL[n]}function ZL(n){return FL[n]}function nl(n){return{fieldPath:n.canonicalString()}}function il(n){return Mn.fromServerFormat(n.fieldPath)}function Ew(n){return n instanceof mn?(function(t){if(t.op==="=="){if(uS(t.value))return{unaryFilter:{field:nl(t.field),op:"IS_NAN"}};if(lS(t.value))return{unaryFilter:{field:nl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(uS(t.value))return{unaryFilter:{field:nl(t.field),op:"IS_NOT_NAN"}};if(lS(t.value))return{unaryFilter:{field:nl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:nl(t.field),op:WL(t.op),value:t.value}}})(n):n instanceof zs?(function(t){const i=t.getFilters().map((o=>Ew(o)));return i.length===1?i[0]:{compositeFilter:{op:ZL(t.op),filters:i}}})(n):Pe(54877,{filter:n})}function eV(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Tw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(e,t,i,o,a=Le.min(),u=Le.min(),d=Pn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=o,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new io(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new io(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new io(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new io(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tV{constructor(e){this.yt=e}}function nV(n){const e=jL({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Um(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iV{constructor(){this.Cn=new sV}addToCollectionParentIndex(e,t){return this.Cn.add(t),re.resolve()}getCollectionParents(e,t){return re.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return re.resolve()}deleteFieldIndex(e,t){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,t){return re.resolve()}getDocumentsMatchingTarget(e,t){return re.resolve(null)}getIndexType(e,t){return re.resolve(0)}getFieldIndexes(e,t){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,t){return re.resolve(ho.min())}getMinOffsetFromCollectionGroup(e,t){return re.resolve(ho.min())}updateCollectionGroup(e,t,i){return re.resolve()}updateIndexEntries(e,t){return re.resolve()}}class sV{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t]||new gn(Ht.comparator),a=!o.has(i);return this.index[t]=o.add(i),a}has(e){const t=e.lastSegment(),i=e.popLast(),o=this.index[t];return o&&o.has(i)}getEntries(e){return(this.index[e]||new gn(Ht.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Sw=41943040;class ai{static withCacheSize(e){return new ai(e,ai.DEFAULT_COLLECTION_PERCENTILE,ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ai.DEFAULT_COLLECTION_PERCENTILE=10,ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ai.DEFAULT=new ai(Sw,ai.DEFAULT_COLLECTION_PERCENTILE,ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ai.DISABLED=new ai(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new vl(0)}static cr(){return new vl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wS="LruGarbageCollector",rV=1048576;function AS([n,e],[t,i]){const o=We(n,t);return o===0?We(e,i):o}class oV{constructor(e){this.Ir=e,this.buffer=new gn(AS),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();AS(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class aV{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){me(wS,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Nl(t)?me(wS,"Ignoring IndexedDB error during garbage collection: ",t):await Rl(t)}await this.Vr(3e5)}))}}class lV{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return re.resolve(Ch.ce);const i=new oV(t);return this.mr.forEachTarget(e,(o=>i.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>i.Ar(o))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(me("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(bS)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(me("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bS):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,o,a,u,d,f,p;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(me("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),o=this.params.maximumSequenceNumbersToCollect):o=E,u=Date.now(),this.nthSequenceNumber(e,o)))).next((E=>(i=E,d=Date.now(),this.removeTargets(e,i,t)))).next((E=>(a=E,f=Date.now(),this.removeOrphanedDocuments(e,i)))).next((E=>(p=Date.now(),el()<=Qe.DEBUG&&me("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${o} in `+(d-u)+`ms
	Removed ${a} targets in `+(f-d)+`ms
	Removed ${E} documents in `+(p-f)+`ms
Total Duration: ${p-_}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:a,documentsRemoved:E}))))}}function uV(n,e){return new lV(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(){this.changes=new da((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Bn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?re.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{constructor(e,t,i,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=o}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(i=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(i!==null&&Lu(i.mutation,o,Ai.empty(),kt.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Ze()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Ze()){const o=ta();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,i).next((a=>{let u=xu();return a.forEach(((d,f)=>{u=u.insert(d,f.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const i=ta();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Ze())))}populateOverlays(e,t,i){const o=[];return i.forEach((a=>{t.has(a)||o.push(a)})),this.documentOverlayCache.getOverlays(e,o).next((a=>{a.forEach(((u,d)=>{t.set(u,d)}))}))}computeViews(e,t,i,o){let a=Er();const u=Uu(),d=(function(){return Uu()})();return t.forEach(((f,p)=>{const _=i.get(p.key);o.has(p.key)&&(_===void 0||_.mutation instanceof wo)?a=a.insert(p.key,p):_!==void 0?(u.set(p.key,_.mutation.getFieldMask()),Lu(_.mutation,p,_.mutation.getFieldMask(),kt.now())):u.set(p.key,Ai.empty())})),this.recalculateAndSaveOverlays(e,a).next((f=>(f.forEach(((p,_)=>u.set(p,_))),t.forEach(((p,_)=>d.set(p,new dV(_,u.get(p)??null)))),d)))}recalculateAndSaveOverlays(e,t){const i=Uu();let o=new Gt(((u,d)=>u-d)),a=Ze();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const d of u)d.keys().forEach((f=>{const p=t.get(f);if(p===null)return;let _=i.get(f)||Ai.empty();_=d.applyToLocalView(p,_),i.set(f,_);const E=(o.get(d.batchId)||Ze()).add(f);o=o.insert(d.batchId,E)}))})).next((()=>{const u=[],d=o.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),p=f.key,_=f.value,E=iw();_.forEach((S=>{if(!a.has(S)){const C=uw(t.get(S),i.get(S));C!==null&&E.set(S,C),a=a.add(S)}})),u.push(this.documentOverlayCache.saveOverlays(e,p,E))}return re.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,o){return(function(u){return xe.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):fL(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,o):this.getDocumentsMatchingCollectionQuery(e,t,i,o)}getNextDocuments(e,t,i,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,o).next((a=>{const u=o-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,o-a.size):re.resolve(ta());let d=Fu,f=a;return u.next((p=>re.forEach(p,((_,E)=>(d<E.largestBatchId&&(d=E.largestBatchId),a.get(_)?re.resolve():this.remoteDocumentCache.getEntry(e,_).next((S=>{f=f.insert(_,S)}))))).next((()=>this.populateOverlays(e,p,a))).next((()=>this.computeViews(e,f,p,Ze()))).next((_=>({batchId:d,changes:nw(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new xe(t)).next((i=>{let o=xu();return i.isFoundDocument()&&(o=o.insert(i.key,i)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,o){const a=t.collectionGroup;let u=xu();return this.indexManager.getCollectionParents(e,a).next((d=>re.forEach(d,(f=>{const p=(function(E,S){return new Rh(S,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,i,o).next((_=>{_.forEach(((E,S)=>{u=u.insert(E,S)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,i,o){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((u=>(a=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,a,o)))).next((u=>{a.forEach(((f,p)=>{const _=p.getKey();u.get(_)===null&&(u=u.insert(_,Bn.newInvalidDocument(_)))}));let d=xu();return u.forEach(((f,p)=>{const _=a.get(f);_!==void 0&&Lu(_.mutation,p,Ai.empty(),kt.now()),Ph(t,p)&&(d=d.insert(f,p))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fV{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return re.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:Us(o.createTime)}})(t)),re.resolve()}getNamedQuery(e,t){return re.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(o){return{name:o.name,query:nV(o.bundledQuery),readTime:Us(o.readTime)}})(t)),re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pV{constructor(){this.overlays=new Gt(xe.comparator),this.qr=new Map}getOverlay(e,t){return re.resolve(this.overlays.get(t))}getOverlays(e,t){const i=ta();return re.forEach(t,(o=>this.getOverlay(e,o).next((a=>{a!==null&&i.set(o,a)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((o,a)=>{this.St(e,t,a)})),re.resolve()}removeOverlaysForBatchId(e,t,i){const o=this.qr.get(i);return o!==void 0&&(o.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(i)),re.resolve()}getOverlaysForCollection(e,t,i){const o=ta(),a=t.length+1,u=new xe(t.child("")),d=this.overlays.getIteratorFrom(u);for(;d.hasNext();){const f=d.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&f.largestBatchId>i&&o.set(f.getKey(),f)}return re.resolve(o)}getOverlaysForCollectionGroup(e,t,i,o){let a=new Gt(((p,_)=>p-_));const u=this.overlays.getIterator();for(;u.hasNext();){const p=u.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let _=a.get(p.largestBatchId);_===null&&(_=ta(),a=a.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const d=ta(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,_)=>d.set(p,_))),!(d.size()>=o)););return re.resolve(d)}St(e,t,i){const o=this.overlays.get(i.key);if(o!==null){const u=this.qr.get(o.largestBatchId).delete(i.key);this.qr.set(o.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new PL(t,i));let a=this.qr.get(t);a===void 0&&(a=Ze(),this.qr.set(t,a)),this.qr.set(t,a.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mV{constructor(){this.sessionToken=Pn.EMPTY_BYTE_STRING}getSessionToken(e){return re.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(){this.Qr=new gn(En.$r),this.Ur=new gn(En.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new En(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new En(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new xe(new Ht([])),i=new En(t,e),o=new En(t,e+1),a=[];return this.Ur.forEachInRange([i,o],(u=>{this.Gr(u),a.push(u.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new xe(new Ht([])),i=new En(t,e),o=new En(t,e+1);let a=Ze();return this.Ur.forEachInRange([i,o],(u=>{a=a.add(u.key)})),a}containsKey(e){const t=new En(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class En{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return xe.comparator(e.key,t.key)||We(e.Yr,t.Yr)}static Kr(e,t){return We(e.Yr,t.Yr)||xe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gV{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new gn(En.$r)}checkEmpty(e){return re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,o){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new ML(a,t,i,o);this.mutationQueue.push(u);for(const d of o)this.Zr=this.Zr.add(new En(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return re.resolve(u)}lookupMutationBatch(e,t){return re.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,o=this.ei(i),a=o<0?0:o;return re.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(this.mutationQueue.length===0?Ig:this.tr-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new En(t,0),o=new En(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([i,o],(u=>{const d=this.Xr(u.Yr);a.push(d)})),re.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new gn(We);return t.forEach((o=>{const a=new En(o,0),u=new En(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,u],(d=>{i=i.add(d.Yr)}))})),re.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,o=i.length+1;let a=i;xe.isDocumentKey(a)||(a=a.child(""));const u=new En(new xe(a),0);let d=new gn(We);return this.Zr.forEachWhile((f=>{const p=f.key.path;return!!i.isPrefixOf(p)&&(p.length===o&&(d=d.add(f.Yr)),!0)}),u),re.resolve(this.ti(d))}ti(e){const t=[];return e.forEach((i=>{const o=this.Xr(i);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){mt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return re.forEach(t.mutations,(o=>{const a=new En(o.key,t.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new En(t,0),o=this.Zr.firstAfterOrEqual(i);return re.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV{constructor(e){this.ri=e,this.docs=(function(){return new Gt(xe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,o=this.docs.get(i),a=o?o.size:0,u=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:u}),this.size+=u-a,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return re.resolve(i?i.document.mutableCopy():Bn.newInvalidDocument(t))}getEntries(e,t){let i=Er();return t.forEach((o=>{const a=this.docs.get(o);i=i.insert(o,a?a.document.mutableCopy():Bn.newInvalidDocument(o))})),re.resolve(i)}getDocumentsMatchingQuery(e,t,i,o){let a=Er();const u=t.path,d=new xe(u.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:p,value:{document:_}}=f.getNext();if(!u.isPrefixOf(p.path))break;p.path.length>u.length+1||GU(HU(_),i)<=0||(o.has(_.key)||Ph(t,_))&&(a=a.insert(_.key,_.mutableCopy()))}return re.resolve(a)}getAllFromCollectionGroup(e,t,i,o){Pe(9500)}ii(e,t){return re.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new _V(this)}getSize(e){return re.resolve(this.size)}}class _V extends cV{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,o)=>{o.isValidDocument()?t.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(i)})),re.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vV{constructor(e){this.persistence=e,this.si=new da((t=>Mg(t)),Pg),this.lastRemoteSnapshotVersion=Le.min(),this.highestTargetId=0,this.oi=0,this._i=new Vg,this.targetCount=0,this.ai=vl.ur()}forEachTarget(e,t){return this.si.forEach(((i,o)=>t(o))),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),re.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new vl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,re.resolve()}updateTargetData(e,t){return this.Pr(t),re.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,t,i){let o=0;const a=[];return this.si.forEach(((u,d)=>{d.sequenceNumber<=t&&i.get(d.targetId)===null&&(this.si.delete(u),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),o++)})),re.waitFor(a).next((()=>o))}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return re.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),re.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const o=this.persistence.referenceDelegate,a=[];return o&&t.forEach((u=>{a.push(o.markPotentiallyOrphaned(e,u))})),re.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),re.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return re.resolve(i)}containsKey(e,t){return re.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ch(0),this.li=!1,this.li=!0,this.hi=new mV,this.referenceDelegate=e(this),this.Pi=new vV(this),this.indexManager=new iV,this.remoteDocumentCache=(function(o){return new yV(o)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new tV(t),this.Ii=new fV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new pV,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new gV(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){me("MemoryPersistence","Starting transaction:",e);const o=new EV(this.ci.next());return this.referenceDelegate.Ei(),i(o).next((a=>this.referenceDelegate.di(o).next((()=>a)))).toPromise().then((a=>(o.raiseOnCommittedEvent(),a)))}Ai(e,t){return re.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class EV extends $U{constructor(e){super(),this.currentSequenceNumber=e}}class Og{constructor(e){this.persistence=e,this.Ri=new Vg,this.Vi=null}static mi(e){return new Og(e)}get fi(){if(this.Vi)return this.Vi;throw Pe(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),re.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),re.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),re.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((o=>this.fi.add(o.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((a=>this.fi.add(a.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.fi,(i=>{const o=xe.fromPath(i);return this.gi(e,o).next((a=>{a||t.removeEntry(o,Le.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return re.or([()=>re.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class uh{constructor(e,t){this.persistence=e,this.pi=new da((i=>jU(i.path)),((i,o)=>i.isEqual(o))),this.garbageCollector=uV(this,t)}static mi(e,t){return new uh(e,t)}Ei(){}di(e){return re.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((o=>i+o))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return re.forEach(this.pi,((i,o)=>this.br(e,i,o).next((a=>a?re.resolve():t(o)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const o=this.persistence.getRemoteDocumentCache(),a=o.newChangeBuffer();return o.ii(e,(u=>this.br(e,u,t).next((d=>{d||(i++,a.removeEntry(u,Le.min()))})))).next((()=>a.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),re.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),re.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),re.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),re.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ld(e.data.value)),t}br(e,t,i){return re.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.pi.get(t);return re.resolve(o!==void 0&&o>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,t,i,o){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=o}static As(e,t){let i=Ze(),o=Ze();for(const a of t.docChanges)switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:o=o.add(a.doc.key)}return new zg(e,t.fromCache,i,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TV{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SV{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return jk()?8:KU(Hn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,o){const a={result:null};return this.ys(e,t).next((u=>{a.result=u})).next((()=>{if(!a.result)return this.ws(e,t,o,i).next((u=>{a.result=u}))})).next((()=>{if(a.result)return;const u=new TV;return this.Ss(e,t,u).next((d=>{if(a.result=d,this.Vs)return this.bs(e,t,u,d.size)}))})).next((()=>a.result))}bs(e,t,i,o){return i.documentReadCount<this.fs?(el()<=Qe.DEBUG&&me("QueryEngine","SDK will not create cache indexes for query:",tl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),re.resolve()):(el()<=Qe.DEBUG&&me("QueryEngine","Query:",tl(t),"scans",i.documentReadCount,"local documents and returns",o,"documents as results."),i.documentReadCount>this.gs*o?(el()<=Qe.DEBUG&&me("QueryEngine","The SDK decides to create cache indexes for query:",tl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ds(t))):re.resolve())}ys(e,t){if(fS(t))return re.resolve(null);let i=Ds(t);return this.indexManager.getIndexType(e,i).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=Um(t,null,"F"),i=Ds(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((a=>{const u=Ze(...a);return this.ps.getDocuments(e,u).next((d=>this.indexManager.getMinOffset(e,i).next((f=>{const p=this.Ds(t,d);return this.Cs(t,p,u,f.readTime)?this.ys(e,Um(t,null,"F")):this.vs(e,p,t,f)}))))})))))}ws(e,t,i,o){return fS(t)||o.isEqual(Le.min())?re.resolve(null):this.ps.getDocuments(e,i).next((a=>{const u=this.Ds(t,a);return this.Cs(t,u,i,o)?re.resolve(null):(el()<=Qe.DEBUG&&me("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),tl(t)),this.vs(e,u,t,qU(o,Fu)).next((d=>d)))}))}Ds(e,t){let i=new gn(ew(e));return t.forEach(((o,a)=>{Ph(e,a)&&(i=i.add(a))})),i}Cs(e,t,i,o){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(o)>0)}Ss(e,t,i){return el()<=Qe.DEBUG&&me("QueryEngine","Using full collection scan to execute query:",tl(t)),this.ps.getDocumentsMatchingQuery(e,t,ho.min(),i)}vs(e,t,i,o){return this.ps.getDocumentsMatchingQuery(e,i,o).next((a=>(t.forEach((u=>{a=a.insert(u.key,u)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg="LocalStore",bV=3e8;class wV{constructor(e,t,i,o){this.persistence=e,this.Fs=t,this.serializer=o,this.Ms=new Gt(We),this.xs=new da((a=>Mg(a)),Pg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hV(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function AV(n,e,t,i){return new wV(n,e,t,i)}async function ww(n,e){const t=Fe(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let o;return t.mutationQueue.getAllMutationBatches(i).next((a=>(o=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((a=>{const u=[],d=[];let f=Ze();for(const p of o){u.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}for(const p of a){d.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}return t.localDocuments.getDocuments(i,f).next((p=>({Ls:p,removedBatchIds:u,addedBatchIds:d})))}))}))}function CV(n,e){const t=Fe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const o=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,f,p,_){const E=p.batch,S=E.keys();let C=re.resolve();return S.forEach((k=>{C=C.next((()=>_.getEntry(f,k))).next((V=>{const z=p.docVersions.get(k);mt(z!==null,48541),V.version.compareTo(z)<0&&(E.applyToRemoteDocument(V,p),V.isValidDocument()&&(V.setReadTime(p.commitVersion),_.addEntry(V)))}))})),C.next((()=>d.mutationQueue.removeMutationBatch(f,E)))})(t,i,e,a).next((()=>a.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let f=Ze();for(let p=0;p<d.mutationResults.length;++p)d.mutationResults[p].transformResults.length>0&&(f=f.add(d.batch.mutations[p].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(i,o)))}))}function Aw(n){const e=Fe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function xV(n,e){const t=Fe(n),i=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const u=t.Ns.newChangeBuffer({trackRemovals:!0});o=t.Ms;const d=[];e.targetChanges.forEach(((_,E)=>{const S=o.get(E);if(!S)return;d.push(t.Pi.removeMatchingKeys(a,_.removedDocuments,E).next((()=>t.Pi.addMatchingKeys(a,_.addedDocuments,E))));let C=S.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(E)!==null?C=C.withResumeToken(Pn.EMPTY_BYTE_STRING,Le.min()).withLastLimboFreeSnapshotVersion(Le.min()):_.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(_.resumeToken,i)),o=o.insert(E,C),(function(V,z,J){return V.resumeToken.approximateByteSize()===0||z.snapshotVersion.toMicroseconds()-V.snapshotVersion.toMicroseconds()>=bV?!0:J.addedDocuments.size+J.modifiedDocuments.size+J.removedDocuments.size>0})(S,C,_)&&d.push(t.Pi.updateTargetData(a,C))}));let f=Er(),p=Ze();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,_))})),d.push(IV(a,u,e.documentUpdates).next((_=>{f=_.ks,p=_.qs}))),!i.isEqual(Le.min())){const _=t.Pi.getLastRemoteSnapshotVersion(a).next((E=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,i)));d.push(_)}return re.waitFor(d).next((()=>u.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,f,p))).next((()=>f))})).then((a=>(t.Ms=o,a)))}function IV(n,e,t){let i=Ze(),o=Ze();return t.forEach((a=>i=i.add(a))),e.getEntries(n,i).next((a=>{let u=Er();return t.forEach(((d,f)=>{const p=a.get(d);f.isFoundDocument()!==p.isFoundDocument()&&(o=o.add(d)),f.isNoDocument()&&f.version.isEqual(Le.min())?(e.removeEntry(d,f.readTime),u=u.insert(d,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),u=u.insert(d,f)):me(Fg,"Ignoring outdated watch update for ",d,". Current version:",p.version," Watch version:",f.version)})),{ks:u,qs:o}}))}function RV(n,e){const t=Fe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Ig),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function NV(n,e){const t=Fe(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let o;return t.Pi.getTargetData(i,e).next((a=>a?(o=a,re.resolve(o)):t.Pi.allocateTargetId(i).next((u=>(o=new io(e,u,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,o).next((()=>o)))))))})).then((i=>{const o=t.Ms.get(i.targetId);return(o===null||i.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function Fm(n,e,t){const i=Fe(n),o=i.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",a,(u=>i.persistence.referenceDelegate.removeTarget(u,o)))}catch(u){if(!Nl(u))throw u;me(Fg,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Ms=i.Ms.remove(e),i.xs.delete(o.target)}function CS(n,e,t){const i=Fe(n);let o=Le.min(),a=Ze();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(f,p,_){const E=Fe(f),S=E.xs.get(_);return S!==void 0?re.resolve(E.Ms.get(S)):E.Pi.getTargetData(p,_)})(i,u,Ds(e)).next((d=>{if(d)return o=d.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(u,d.targetId).next((f=>{a=f}))})).next((()=>i.Fs.getDocumentsMatchingQuery(u,e,t?o:Le.min(),t?a:Ze()))).next((d=>(MV(i,mL(e),d),{documents:d,Qs:a})))))}function MV(n,e,t){let i=n.Os.get(e)||Le.min();t.forEach(((o,a)=>{a.readTime.compareTo(i)>0&&(i=a.readTime)})),n.Os.set(e,i)}class xS{constructor(){this.activeTargetIds=TL()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class PV{constructor(){this.Mo=new xS,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new xS,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DV{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IS="ConnectivityMonitor";class RS{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){me(IS,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){me(IS,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xd=null;function Bm(){return xd===null?xd=(function(){return 268435456+Math.round(2147483648*Math.random())})():xd++,"0x"+xd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tm="RestConnection",kV={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class UV{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${o}`,this.Wo=this.databaseId.database===ih?`project_id=${i}`:`project_id=${i}&database_id=${o}`}Go(e,t,i,o,a){const u=Bm(),d=this.zo(e,t.toUriEncodedString());me(tm,`Sending RPC '${e}' ${u}:`,d,i);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,o,a);const{host:p}=new URL(d),_=vo(p);return this.Jo(e,d,f,i,_).then((E=>(me(tm,`Received RPC '${e}' ${u}: `,E),E)),(E=>{throw ml(tm,`RPC '${e}' ${u} failed with error: `,E,"url: ",d,"request:",i),E}))}Ho(e,t,i,o,a,u){return this.Go(e,t,i,o,a)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Il})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,a)=>e[a]=o)),i&&i.headers.forEach(((o,a)=>e[a]=o))}zo(e,t){const i=kV[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LV{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn="WebChannelConnection";class VV extends UV{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,o,a){const u=Bm();return new Promise(((d,f)=>{const p=new R1;p.setWithCredentials(!0),p.listenOnce(N1.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Ud.NO_ERROR:const E=p.getResponseJson();me(Vn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(E)),d(E);break;case Ud.TIMEOUT:me(Vn,`RPC '${e}' ${u} timed out`),f(new Ee(le.DEADLINE_EXCEEDED,"Request time out"));break;case Ud.HTTP_ERROR:const S=p.getStatus();if(me(Vn,`RPC '${e}' ${u} failed with status:`,S,"response text:",p.getResponseText()),S>0){let C=p.getResponseJson();Array.isArray(C)&&(C=C[0]);const k=C==null?void 0:C.error;if(k&&k.status&&k.message){const V=(function(J){const j=J.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(j)>=0?j:le.UNKNOWN})(k.status);f(new Ee(V,k.message))}else f(new Ee(le.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new Ee(le.UNAVAILABLE,"Connection failed."));break;default:Pe(9055,{l_:e,streamId:u,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{me(Vn,`RPC '${e}' ${u} completed.`)}}));const _=JSON.stringify(o);me(Vn,`RPC '${e}' ${u} sending request:`,o),p.send(t,"POST",_,i,15)}))}T_(e,t,i){const o=Bm(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=D1(),d=P1(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,i),f.encodeInitMessageHeaders=!0;const _=a.join("");me(Vn,`Creating RPC '${e}' stream ${o}: ${_}`,f);const E=u.createWebChannel(_,f);this.I_(E);let S=!1,C=!1;const k=new LV({Yo:z=>{C?me(Vn,`Not sending because RPC '${e}' stream ${o} is closed:`,z):(S||(me(Vn,`Opening RPC '${e}' stream ${o} transport.`),E.open(),S=!0),me(Vn,`RPC '${e}' stream ${o} sending:`,z),E.send(z))},Zo:()=>E.close()}),V=(z,J,j)=>{z.listen(J,(Z=>{try{j(Z)}catch(H){setTimeout((()=>{throw H}),0)}}))};return V(E,Cu.EventType.OPEN,(()=>{C||(me(Vn,`RPC '${e}' stream ${o} transport opened.`),k.o_())})),V(E,Cu.EventType.CLOSE,(()=>{C||(C=!0,me(Vn,`RPC '${e}' stream ${o} transport closed`),k.a_(),this.E_(E))})),V(E,Cu.EventType.ERROR,(z=>{C||(C=!0,ml(Vn,`RPC '${e}' stream ${o} transport errored. Name:`,z.name,"Message:",z.message),k.a_(new Ee(le.UNAVAILABLE,"The operation could not be completed")))})),V(E,Cu.EventType.MESSAGE,(z=>{var J;if(!C){const j=z.data[0];mt(!!j,16349);const Z=j,H=(Z==null?void 0:Z.error)||((J=Z[0])==null?void 0:J.error);if(H){me(Vn,`RPC '${e}' stream ${o} received error:`,H);const ae=H.status;let oe=(function(N){const P=cn[N];if(P!==void 0)return hw(P)})(ae),x=H.message;oe===void 0&&(oe=le.INTERNAL,x="Unknown error status: "+ae+" with message "+H.message),C=!0,k.a_(new Ee(oe,x)),E.close()}else me(Vn,`RPC '${e}' stream ${o} received:`,j),k.u_(j)}})),V(d,M1.STAT_EVENT,(z=>{z.stat===Rm.PROXY?me(Vn,`RPC '${e}' stream ${o} detected buffering proxy`):z.stat===Rm.NOPROXY&&me(Vn,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{k.__()}),0),k}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function nm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lh(n){return new BL(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cw{constructor(e,t,i=1e3,o=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=o,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-i);o>0&&me("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS="PersistentStream";class xw{constructor(e,t,i,o,a,u,d,f){this.Mi=e,this.S_=i,this.b_=o,this.connection=a,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Cw(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===le.RESOURCE_EXHAUSTED?(vr(t.toString()),vr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,o])=>{this.D_===t&&this.G_(i,o)}),(i=>{e((()=>{const o=new Ee(le.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(o)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{i((()=>this.z_(o)))})),this.stream.onMessage((o=>{i((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return me(NS,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(me(NS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class OV extends xw{constructor(e,t,i,o,a,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,o,u),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=GL(this.serializer,e),i=(function(a){if(!("targetChange"in a))return Le.min();const u=a.targetChange;return u.targetIds&&u.targetIds.length?Le.min():u.readTime?Us(u.readTime):Le.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=zm(this.serializer),t.addTarget=(function(a,u){let d;const f=u.target;if(d=km(f)?{documents:KL(a,f)}:{query:JL(a,f).ft},d.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){d.resumeToken=mw(a,u.resumeToken);const p=Lm(a,u.expectedCount);p!==null&&(d.expectedCount=p)}else if(u.snapshotVersion.compareTo(Le.min())>0){d.readTime=lh(a,u.snapshotVersion.toTimestamp());const p=Lm(a,u.expectedCount);p!==null&&(d.expectedCount=p)}return d})(this.serializer,e);const i=XL(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=zm(this.serializer),t.removeTarget=e,this.q_(t)}}class zV extends xw{constructor(e,t,i,o,a,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,o,u),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return mt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,mt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){mt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=$L(e.writeResults,e.commitTime),i=Us(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=zm(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>YL(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{}class BV extends FV{constructor(e,t,i,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Ee(le.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,u])=>this.connection.Go(e,Vm(t,i),o,a,u))).catch((a=>{throw a.name==="FirebaseError"?(a.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ee(le.UNKNOWN,a.toString())}))}Ho(e,t,i,o,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,d])=>this.connection.Ho(e,Vm(t,i),o,u,d,a))).catch((u=>{throw u.name==="FirebaseError"?(u.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ee(le.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class qV{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(vr(t),this.aa=!1):me("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua="RemoteStore";class HV{constructor(e,t,i,o,a){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((u=>{i.enqueueAndForget((async()=>{ha(this)&&(me(ua,"Restarting streams for network reachability change."),await(async function(f){const p=Fe(f);p.Ea.add(4),await ic(p),p.Ra.set("Unknown"),p.Ea.delete(4),await Vh(p)})(this))}))})),this.Ra=new qV(i,o)}}async function Vh(n){if(ha(n))for(const e of n.da)await e(!0)}async function ic(n){for(const e of n.da)await e(!1)}function Iw(n,e){const t=Fe(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Gg(t)?Hg(t):Ml(t).O_()&&qg(t,e))}function Bg(n,e){const t=Fe(n),i=Ml(t);t.Ia.delete(e),i.O_()&&Rw(t,e),t.Ia.size===0&&(i.O_()?i.L_():ha(t)&&t.Ra.set("Unknown"))}function qg(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Le.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ml(n).Y_(e)}function Rw(n,e){n.Va.Ue(e),Ml(n).Z_(e)}function Hg(n){n.Va=new VL({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ml(n).start(),n.Ra.ua()}function Gg(n){return ha(n)&&!Ml(n).x_()&&n.Ia.size>0}function ha(n){return Fe(n).Ea.size===0}function Nw(n){n.Va=void 0}async function GV(n){n.Ra.set("Online")}async function YV(n){n.Ia.forEach(((e,t)=>{qg(n,e)}))}async function $V(n,e){Nw(n),Gg(n)?(n.Ra.ha(e),Hg(n)):n.Ra.set("Unknown")}async function KV(n,e,t){if(n.Ra.set("Online"),e instanceof pw&&e.state===2&&e.cause)try{await(async function(o,a){const u=a.cause;for(const d of a.targetIds)o.Ia.has(d)&&(await o.remoteSyncer.rejectListen(d,u),o.Ia.delete(d),o.Va.removeTarget(d))})(n,e)}catch(i){me(ua,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await ch(n,i)}else if(e instanceof zd?n.Va.Ze(e):e instanceof fw?n.Va.st(e):n.Va.tt(e),!t.isEqual(Le.min()))try{const i=await Aw(n.localStore);t.compareTo(i)>=0&&await(function(a,u){const d=a.Va.Tt(u);return d.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const _=a.Ia.get(p);_&&a.Ia.set(p,_.withResumeToken(f.resumeToken,u))}})),d.targetMismatches.forEach(((f,p)=>{const _=a.Ia.get(f);if(!_)return;a.Ia.set(f,_.withResumeToken(Pn.EMPTY_BYTE_STRING,_.snapshotVersion)),Rw(a,f);const E=new io(_.target,f,p,_.sequenceNumber);qg(a,E)})),a.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(i){me(ua,"Failed to raise snapshot:",i),await ch(n,i)}}async function ch(n,e,t){if(!Nl(e))throw e;n.Ea.add(1),await ic(n),n.Ra.set("Offline"),t||(t=()=>Aw(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{me(ua,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Vh(n)}))}function Mw(n,e){return e().catch((t=>ch(n,t,e)))}async function Oh(n){const e=Fe(n),t=go(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Ig;for(;JV(e);)try{const o=await RV(e.localStore,i);if(o===null){e.Ta.length===0&&t.L_();break}i=o.batchId,jV(e,o)}catch(o){await ch(e,o)}Pw(e)&&Dw(e)}function JV(n){return ha(n)&&n.Ta.length<10}function jV(n,e){n.Ta.push(e);const t=go(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Pw(n){return ha(n)&&!go(n).x_()&&n.Ta.length>0}function Dw(n){go(n).start()}async function XV(n){go(n).ra()}async function QV(n){const e=go(n);for(const t of n.Ta)e.ea(t.mutations)}async function WV(n,e,t){const i=n.Ta.shift(),o=kg.from(i,e,t);await Mw(n,(()=>n.remoteSyncer.applySuccessfulWrite(o))),await Oh(n)}async function ZV(n,e){e&&go(n).X_&&await(async function(i,o){if((function(u){return kL(u)&&u!==le.ABORTED})(o.code)){const a=i.Ta.shift();go(i).B_(),await Mw(i,(()=>i.remoteSyncer.rejectFailedWrite(a.batchId,o))),await Oh(i)}})(n,e),Pw(n)&&Dw(n)}async function MS(n,e){const t=Fe(n);t.asyncQueue.verifyOperationInProgress(),me(ua,"RemoteStore received new credentials");const i=ha(t);t.Ea.add(3),await ic(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Vh(t)}async function e6(n,e){const t=Fe(n);e?(t.Ea.delete(2),await Vh(t)):e||(t.Ea.add(2),await ic(t),t.Ra.set("Unknown"))}function Ml(n){return n.ma||(n.ma=(function(t,i,o){const a=Fe(t);return a.sa(),new OV(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)})(n.datastore,n.asyncQueue,{Xo:GV.bind(null,n),t_:YV.bind(null,n),r_:$V.bind(null,n),H_:KV.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Gg(n)?Hg(n):n.Ra.set("Unknown")):(await n.ma.stop(),Nw(n))}))),n.ma}function go(n){return n.fa||(n.fa=(function(t,i,o){const a=Fe(t);return a.sa(),new zV(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:XV.bind(null,n),r_:ZV.bind(null,n),ta:QV.bind(null,n),na:WV.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Oh(n)):(await n.fa.stop(),n.Ta.length>0&&(me(ua,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg{constructor(e,t,i,o,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=o,this.removalCallback=a,this.deferred=new lo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,o,a){const u=Date.now()+i,d=new Yg(e,t,u,o,a);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ee(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $g(n,e){if(vr("AsyncQueue",`${e}: ${n}`),Nl(n))return new Ee(le.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{static emptySet(e){return new dl(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||xe.comparator(t.key,i.key):(t,i)=>xe.comparator(t.key,i.key),this.keyedMap=xu(),this.sortedSet=new Gt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof dl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,a=i.getNext().key;if(!o.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new dl;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(){this.ga=new Gt(xe.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Pe(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class El{constructor(e,t,i,o,a,u,d,f,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=o,this.mutatedKeys=a,this.fromCache=u,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,o,a){const u=[];return t.forEach((d=>{u.push({type:0,doc:d})})),new El(e,t,dl.emptySet(t),u,i,o,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Mh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==i[o].type||!t[o].doc.isEqual(i[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class n6{constructor(){this.queries=DS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const o=Fe(t),a=o.queries;o.queries=DS(),a.forEach(((u,d)=>{for(const f of d.Sa)f.onError(i)}))})(this,new Ee(le.ABORTED,"Firestore shutting down"))}}function DS(){return new da((n=>Z1(n)),Mh)}async function kw(n,e){const t=Fe(n);let i=3;const o=e.query;let a=t.queries.get(o);a?!a.ba()&&e.Da()&&(i=2):(a=new t6,i=e.Da()?0:1);try{switch(i){case 0:a.wa=await t.onListen(o,!0);break;case 1:a.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(u){const d=$g(u,`Initialization of query '${tl(e.query)}' failed`);return void e.onError(d)}t.queries.set(o,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&Kg(t)}async function Uw(n,e){const t=Fe(n),i=e.query;let o=3;const a=t.queries.get(i);if(a){const u=a.Sa.indexOf(e);u>=0&&(a.Sa.splice(u,1),a.Sa.length===0?o=e.Da()?0:1:!a.ba()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function i6(n,e){const t=Fe(n);let i=!1;for(const o of e){const a=o.query,u=t.queries.get(a);if(u){for(const d of u.Sa)d.Fa(o)&&(i=!0);u.wa=o}}i&&Kg(t)}function s6(n,e,t){const i=Fe(n),o=i.queries.get(e);if(o)for(const a of o.Sa)a.onError(t);i.queries.delete(e)}function Kg(n){n.Ca.forEach((e=>{e.next()}))}var qm,kS;(kS=qm||(qm={})).Ma="default",kS.Cache="cache";class Lw{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const o of e.docChanges)o.type!==3&&i.push(o);e=new El(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=El.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==qm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{constructor(e){this.key=e}}class Ow{constructor(e){this.key=e}}class r6{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ze(),this.mutatedKeys=Ze(),this.eu=ew(e),this.tu=new dl(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new PS,o=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,u=o,d=!1;const f=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,p=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((_,E)=>{const S=o.get(_),C=Ph(this.query,E)?E:null,k=!!S&&this.mutatedKeys.has(S.key),V=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let z=!1;S&&C?S.data.isEqual(C.data)?k!==V&&(i.track({type:3,doc:C}),z=!0):this.su(S,C)||(i.track({type:2,doc:C}),z=!0,(f&&this.eu(C,f)>0||p&&this.eu(C,p)<0)&&(d=!0)):!S&&C?(i.track({type:0,doc:C}),z=!0):S&&!C&&(i.track({type:1,doc:S}),z=!0,(f||p)&&(d=!0)),z&&(C?(u=u.add(C),a=V?a.add(_):a.delete(_)):(u=u.delete(_),a=a.delete(_)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),a=a.delete(_.key),i.track({type:1,doc:_})}return{tu:u,iu:i,Cs:d,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,o){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((_,E)=>(function(C,k){const V=z=>{switch(z){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pe(20277,{Rt:z})}};return V(C)-V(k)})(_.type,E.type)||this.eu(_.doc,E.doc))),this.ou(i),o=o??!1;const d=t&&!o?this._u():[],f=this.Xa.size===0&&this.current&&!o?1:0,p=f!==this.Za;return this.Za=f,u.length!==0||p?{snapshot:new El(this.query,e.tu,a,u,e.mutatedKeys,f===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new PS,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ze(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new Ow(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new Vw(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=Ze();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return El.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Jg="SyncEngine";class o6{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class a6{constructor(e){this.key=e,this.hu=!1}}class l6{constructor(e,t,i,o,a,u){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=o,this.currentUser=a,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new da((d=>Z1(d)),Mh),this.Iu=new Map,this.Eu=new Set,this.du=new Gt(xe.comparator),this.Au=new Map,this.Ru=new Vg,this.Vu={},this.mu=new Map,this.fu=vl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function u6(n,e,t=!0){const i=Gw(n);let o;const a=i.Tu.get(e);return a?(i.sharedClientState.addLocalQueryTarget(a.targetId),o=a.view.lu()):o=await zw(i,e,t,!0),o}async function c6(n,e){const t=Gw(n);await zw(t,e,!0,!1)}async function zw(n,e,t,i){const o=await NV(n.localStore,Ds(e)),a=o.targetId,u=n.sharedClientState.addLocalQueryTarget(a,t);let d;return i&&(d=await d6(n,e,a,u==="current",o.resumeToken)),n.isPrimaryClient&&t&&Iw(n.remoteStore,o),d}async function d6(n,e,t,i,o){n.pu=(E,S,C)=>(async function(V,z,J,j){let Z=z.view.ru(J);Z.Cs&&(Z=await CS(V.localStore,z.query,!1).then((({documents:x})=>z.view.ru(x,Z))));const H=j&&j.targetChanges.get(z.targetId),ae=j&&j.targetMismatches.get(z.targetId)!=null,oe=z.view.applyChanges(Z,V.isPrimaryClient,H,ae);return LS(V,z.targetId,oe.au),oe.snapshot})(n,E,S,C);const a=await CS(n.localStore,e,!0),u=new r6(e,a.Qs),d=u.ru(a.documents),f=nc.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",o),p=u.applyChanges(d,n.isPrimaryClient,f);LS(n,t,p.au);const _=new o6(e,t,u);return n.Tu.set(e,_),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function h6(n,e,t){const i=Fe(n),o=i.Tu.get(e),a=i.Iu.get(o.targetId);if(a.length>1)return i.Iu.set(o.targetId,a.filter((u=>!Mh(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(o.targetId),i.sharedClientState.isActiveQueryTarget(o.targetId)||await Fm(i.localStore,o.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(o.targetId),t&&Bg(i.remoteStore,o.targetId),Hm(i,o.targetId)})).catch(Rl)):(Hm(i,o.targetId),await Fm(i.localStore,o.targetId,!0))}async function f6(n,e){const t=Fe(n),i=t.Tu.get(e),o=t.Iu.get(i.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Bg(t.remoteStore,i.targetId))}async function p6(n,e,t){const i=T6(n);try{const o=await(function(u,d){const f=Fe(u),p=kt.now(),_=d.reduce(((C,k)=>C.add(k.key)),Ze());let E,S;return f.persistence.runTransaction("Locally write mutations","readwrite",(C=>{let k=Er(),V=Ze();return f.Ns.getEntries(C,_).next((z=>{k=z,k.forEach(((J,j)=>{j.isValidDocument()||(V=V.add(J))}))})).next((()=>f.localDocuments.getOverlayedDocuments(C,k))).next((z=>{E=z;const J=[];for(const j of d){const Z=RL(j,E.get(j.key).overlayedDocument);Z!=null&&J.push(new wo(j.key,Z,$1(Z.value.mapValue),ks.exists(!0)))}return f.mutationQueue.addMutationBatch(C,p,J,d)})).next((z=>{S=z;const J=z.applyToLocalDocumentSet(E,V);return f.documentOverlayCache.saveOverlays(C,z.batchId,J)}))})).then((()=>({batchId:S.batchId,changes:nw(E)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(o.batchId),(function(u,d,f){let p=u.Vu[u.currentUser.toKey()];p||(p=new Gt(We)),p=p.insert(d,f),u.Vu[u.currentUser.toKey()]=p})(i,o.batchId,t),await sc(i,o.changes),await Oh(i.remoteStore)}catch(o){const a=$g(o,"Failed to persist write");t.reject(a)}}async function Fw(n,e){const t=Fe(n);try{const i=await xV(t.localStore,e);e.targetChanges.forEach(((o,a)=>{const u=t.Au.get(a);u&&(mt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?u.hu=!0:o.modifiedDocuments.size>0?mt(u.hu,14607):o.removedDocuments.size>0&&(mt(u.hu,42227),u.hu=!1))})),await sc(t,i,e)}catch(i){await Rl(i)}}function US(n,e,t){const i=Fe(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const o=[];i.Tu.forEach(((a,u)=>{const d=u.view.va(e);d.snapshot&&o.push(d.snapshot)})),(function(u,d){const f=Fe(u);f.onlineState=d;let p=!1;f.queries.forEach(((_,E)=>{for(const S of E.Sa)S.va(d)&&(p=!0)})),p&&Kg(f)})(i.eventManager,e),o.length&&i.Pu.H_(o),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function m6(n,e,t){const i=Fe(n);i.sharedClientState.updateQueryState(e,"rejected",t);const o=i.Au.get(e),a=o&&o.key;if(a){let u=new Gt(xe.comparator);u=u.insert(a,Bn.newNoDocument(a,Le.min()));const d=Ze().add(a),f=new Uh(Le.min(),new Map,new Gt(We),u,d);await Fw(i,f),i.du=i.du.remove(a),i.Au.delete(e),jg(i)}else await Fm(i.localStore,e,!1).then((()=>Hm(i,e,t))).catch(Rl)}async function g6(n,e){const t=Fe(n),i=e.batch.batchId;try{const o=await CV(t.localStore,e);qw(t,i,null),Bw(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await sc(t,o)}catch(o){await Rl(o)}}async function y6(n,e,t){const i=Fe(n);try{const o=await(function(u,d){const f=Fe(u);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let _;return f.mutationQueue.lookupMutationBatch(p,d).next((E=>(mt(E!==null,37113),_=E.keys(),f.mutationQueue.removeMutationBatch(p,E)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,_,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_))).next((()=>f.localDocuments.getDocuments(p,_)))}))})(i.localStore,e);qw(i,e,t),Bw(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await sc(i,o)}catch(o){await Rl(o)}}function Bw(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function qw(n,e,t){const i=Fe(n);let o=i.Vu[i.currentUser.toKey()];if(o){const a=o.get(e);a&&(t?a.reject(t):a.resolve(),o=o.remove(e)),i.Vu[i.currentUser.toKey()]=o}}function Hm(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||Hw(n,i)}))}function Hw(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Bg(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),jg(n))}function LS(n,e,t){for(const i of t)i instanceof Vw?(n.Ru.addReference(i.key,e),_6(n,i)):i instanceof Ow?(me(Jg,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||Hw(n,i.key)):Pe(19791,{wu:i})}function _6(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(me(Jg,"New document in limbo: "+t),n.Eu.add(i),jg(n))}function jg(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new xe(Ht.fromString(e)),i=n.fu.next();n.Au.set(i,new a6(t)),n.du=n.du.insert(t,i),Iw(n.remoteStore,new io(Ds(Nh(t.path)),i,"TargetPurposeLimboResolution",Ch.ce))}}async function sc(n,e,t){const i=Fe(n),o=[],a=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,f)=>{u.push(i.pu(f,e,t).then((p=>{var _;if((p||t)&&i.isPrimaryClient){const E=p?!p.fromCache:(_=t==null?void 0:t.targetChanges.get(f.targetId))==null?void 0:_.current;i.sharedClientState.updateQueryState(f.targetId,E?"current":"not-current")}if(p){o.push(p);const E=zg.As(f.targetId,p);a.push(E)}})))})),await Promise.all(u),i.Pu.H_(o),await(async function(f,p){const _=Fe(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>re.forEach(p,(S=>re.forEach(S.Es,(C=>_.persistence.referenceDelegate.addReference(E,S.targetId,C))).next((()=>re.forEach(S.ds,(C=>_.persistence.referenceDelegate.removeReference(E,S.targetId,C)))))))))}catch(E){if(!Nl(E))throw E;me(Fg,"Failed to update sequence numbers: "+E)}for(const E of p){const S=E.targetId;if(!E.fromCache){const C=_.Ms.get(S),k=C.snapshotVersion,V=C.withLastLimboFreeSnapshotVersion(k);_.Ms=_.Ms.insert(S,V)}}})(i.localStore,a))}async function v6(n,e){const t=Fe(n);if(!t.currentUser.isEqual(e)){me(Jg,"User change. New user:",e.toKey());const i=await ww(t.localStore,e);t.currentUser=e,(function(a,u){a.mu.forEach((d=>{d.forEach((f=>{f.reject(new Ee(le.CANCELLED,u))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await sc(t,i.Ls)}}function E6(n,e){const t=Fe(n),i=t.Au.get(e);if(i&&i.hu)return Ze().add(i.key);{let o=Ze();const a=t.Iu.get(e);if(!a)return o;for(const u of a){const d=t.Tu.get(u);o=o.unionWith(d.view.nu)}return o}}function Gw(n){const e=Fe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Fw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=E6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=m6.bind(null,e),e.Pu.H_=i6.bind(null,e.eventManager),e.Pu.yu=s6.bind(null,e.eventManager),e}function T6(n){const e=Fe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=g6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=y6.bind(null,e),e}class dh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Lh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return AV(this.persistence,new SV,e.initialUser,this.serializer)}Cu(e){return new bw(Og.mi,this.serializer)}Du(e){return new PV}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}dh.provider={build:()=>new dh};class S6 extends dh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){mt(this.persistence.referenceDelegate instanceof uh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new aV(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ai.withCacheSize(this.cacheSizeBytes):ai.DEFAULT;return new bw((i=>uh.mi(i,t)),this.serializer)}}class Gm{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>US(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=v6.bind(null,this.syncEngine),await e6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new n6})()}createDatastore(e){const t=Lh(e.databaseInfo.databaseId),i=(function(a){return new VV(a)})(e.databaseInfo);return(function(a,u,d,f){return new BV(a,u,d,f)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,o,a,u,d){return new HV(i,o,a,u,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>US(this.syncEngine,t,0)),(function(){return RS.v()?new RS:new DV})())}createSyncEngine(e,t){return(function(o,a,u,d,f,p,_){const E=new l6(o,a,u,d,f,p);return _&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(o){const a=Fe(o);me(ua,"RemoteStore shutting down."),a.Ea.add(5),await ic(a),a.Aa.shutdown(),a.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Gm.provider={build:()=>new Gm};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):vr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yo="FirestoreClient";class b6{constructor(e,t,i,o,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=o,this.user=Fn.UNAUTHENTICATED,this.clientId=Cg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(i,(async u=>{me(yo,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(me(yo,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new lo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=$g(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function im(n,e){n.asyncQueue.verifyOperationInProgress(),me(yo,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async o=>{i.isEqual(o)||(await ww(e.localStore,o),i=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function VS(n,e){n.asyncQueue.verifyOperationInProgress();const t=await w6(n);me(yo,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>MS(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,o)=>MS(e.remoteStore,o))),n._onlineComponents=e}async function w6(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){me(yo,"Using user provided OfflineComponentProvider");try{await im(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===le.FAILED_PRECONDITION||o.code===le.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;ml("Error using user provided cache. Falling back to memory cache: "+t),await im(n,new dh)}}else me(yo,"Using default OfflineComponentProvider"),await im(n,new S6(void 0));return n._offlineComponents}async function $w(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(me(yo,"Using user provided OnlineComponentProvider"),await VS(n,n._uninitializedComponentsProvider._online)):(me(yo,"Using default OnlineComponentProvider"),await VS(n,new Gm))),n._onlineComponents}function A6(n){return $w(n).then((e=>e.syncEngine))}async function Ym(n){const e=await $w(n),t=e.eventManager;return t.onListen=u6.bind(null,e.syncEngine),t.onUnlisten=h6.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=c6.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=f6.bind(null,e.syncEngine),t}function C6(n,e,t={}){const i=new lo;return n.asyncQueue.enqueueAndForget((async()=>(function(a,u,d,f,p){const _=new Yw({next:S=>{_.Nu(),u.enqueueAndForget((()=>Uw(a,E)));const C=S.docs.has(d);!C&&S.fromCache?p.reject(new Ee(le.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&S.fromCache&&f&&f.source==="server"?p.reject(new Ee(le.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(S)},error:S=>p.reject(S)}),E=new Lw(Nh(d.path),_,{includeMetadataChanges:!0,qa:!0});return kw(a,E)})(await Ym(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="firestore.googleapis.com",zS=!0;class FS{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ee(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Jw,this.ssl=zS}else this.host=e.host,this.ssl=e.ssl??zS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Sw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<rV)throw new Ee(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}BU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Kw(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Ee(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Ee(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Ee(le.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,o){return i.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Xg{constructor(e,t,i,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ee(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ee(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new NU;switch(i.type){case"firstParty":return new kU(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ee(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=OS.get(t);i&&(me("ComponentProvider","Removing Datastore"),OS.delete(t),i.terminate())})(this),Promise.resolve()}}function x6(n,e,t,i={}){var p;n=Ps(n,Xg);const o=vo(e),a=n._getSettings(),u={...a,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;o&&(cg(`https://${d}`),dg("Firestore",!0)),a.host!==Jw&&a.host!==d&&ml("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...a,host:d,ssl:o,emulatorOptions:i};if(!sa(f,u)&&(n._setSettings(f),i.mockUserToken)){let _,E;if(typeof i.mockUserToken=="string")_=i.mockUserToken,E=Fn.MOCK_USER;else{_=Fk(i.mockUserToken,(p=n._app)==null?void 0:p.options.projectId);const S=i.mockUserToken.sub||i.mockUserToken.user_id;if(!S)throw new Ee(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");E=new Fn(S)}n._authCredentials=new MU(new U1(_,E))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new zh(this.firestore,e,this._query)}}class hn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ku(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hn(this.firestore,e,this._key)}toJSON(){return{type:hn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(ec(t,hn._jsonSchema))return new hn(e,i||null,new xe(Ht.fromString(t.referencePath)))}}hn._jsonSchemaVersion="firestore/documentReference/1.0",hn._jsonSchema={type:dn("string",hn._jsonSchemaVersion),referencePath:dn("string")};class Ku extends zh{constructor(e,t,i){super(e,t,Nh(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new hn(this.firestore,null,new xe(e))}withConverter(e){return new Ku(this.firestore,e,this._path)}}function rc(n,e,...t){if(n=yn(n),arguments.length===1&&(e=Cg.newId()),FU("doc","path",e),n instanceof Xg){const i=Ht.fromString(e,...t);return eS(i),new hn(n,null,new xe(i))}{if(!(n instanceof hn||n instanceof Ku))throw new Ee(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Ht.fromString(e,...t));return eS(i),new hn(n.firestore,n instanceof Ku?n.converter:null,new xe(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS="AsyncQueue";class qS{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Cw(this,"async_queue_retry"),this._c=()=>{const i=nm();i&&me(BS,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=nm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=nm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new lo;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Nl(e))throw e;me(BS,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,vr("INTERNAL UNHANDLED ERROR: ",HS(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=Yg.createAndSchedule(this,e,t,i,(a=>this.hc(a)));return this.tc.push(o),o}uc(){this.nc&&Pe(47125,{Pc:HS(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function HS(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(n){return(function(t,i){if(typeof t!="object"||t===null)return!1;const o=t;for(const a of i)if(a in o&&typeof o[a]=="function")return!0;return!1})(n,["next","error","complete"])}class Tl extends Xg{constructor(e,t,i,o){super(e,t,i,o),this.type="firestore",this._queue=new qS,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new qS(e),this._firestoreClient=void 0,await e}}}function I6(n,e){const t=typeof n=="object"?n:pg(),i=typeof n=="string"?n:ih,o=Sh(t,"firestore").getImmediate({identifier:i});if(!o._initialized){const a=Bb("firestore");a&&x6(o,...a)}return o}function Qg(n){if(n._terminated)throw new Ee(le.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||R6(n),n._firestoreClient}function R6(n){var i,o,a;const e=n._freezeSettings(),t=(function(d,f,p,_){return new WU(d,f,p,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,Kw(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(o=e.localCache)!=null&&o._offlineComponentProvider&&((a=e.localCache)!=null&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new b6(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(d){const f=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(f),_online:f}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qi(Pn.fromBase64String(e))}catch(t){throw new Ee(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new qi(Pn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:qi._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ec(e,qi._jsonSchema))return qi.fromBase64String(e.bytes)}}qi._jsonSchemaVersion="firestore/bytes/1.0",qi._jsonSchema={type:dn("string",qi._jsonSchemaVersion),bytes:dn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ee(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Mn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ee(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ee(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return We(this._lat,e._lat)||We(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ls._jsonSchemaVersion}}static fromJSON(e){if(ec(e,Ls._jsonSchema))return new Ls(e.latitude,e.longitude)}}Ls._jsonSchemaVersion="firestore/geoPoint/1.0",Ls._jsonSchema={type:dn("string",Ls._jsonSchemaVersion),latitude:dn("number"),longitude:dn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,o){if(i.length!==o.length)return!1;for(let a=0;a<i.length;++a)if(i[a]!==o[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Vs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ec(e,Vs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Vs(e.vectorValues);throw new Ee(le.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Vs._jsonSchemaVersion="firestore/vectorValue/1.0",Vs._jsonSchema={type:dn("string",Vs._jsonSchemaVersion),vectorValues:dn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N6=/^__.*__$/;class M6{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new wo(e,this.data,this.fieldMask,t,this.fieldTransforms):new tc(e,this.data,t,this.fieldTransforms)}}class jw{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new wo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Xw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pe(40011,{Ac:n})}}class Wg{constructor(e,t,i,o,a,u){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=o,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Wg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var o;const t=(o=this.path)==null?void 0:o.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return hh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Xw(this.Ac)&&N6.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class P6{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Lh(e)}Cc(e,t,i,o=!1){return new Wg({Ac:e,methodName:t,Dc:i,path:Mn.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Qw(n){const e=n._freezeSettings(),t=Lh(n._databaseId);return new P6(n._databaseId,!!e.ignoreUndefinedProperties,t)}function D6(n,e,t,i,o,a={}){const u=n.Cc(a.merge||a.mergeFields?2:0,e,t,o);ey("Data must be an object, but it was:",u,i);const d=Ww(i,u);let f,p;if(a.merge)f=new Ai(u.fieldMask),p=u.fieldTransforms;else if(a.mergeFields){const _=[];for(const E of a.mergeFields){const S=$m(e,E,t);if(!u.contains(S))throw new Ee(le.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);eA(_,S)||_.push(S)}f=new Ai(_),p=u.fieldTransforms.filter((E=>f.covers(E.field)))}else f=null,p=u.fieldTransforms;return new M6(new ui(d),f,p)}class qh extends Bh{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof qh}}class Zg extends Bh{_toFieldTransform(e){return new AL(e.path,new Gu)}isEqual(e){return e instanceof Zg}}function k6(n,e,t,i){const o=n.Cc(1,e,t);ey("Data must be an object, but it was:",o,i);const a=[],u=ui.empty();bo(i,((f,p)=>{const _=ty(e,f,t);p=yn(p);const E=o.yc(_);if(p instanceof qh)a.push(_);else{const S=Hh(p,E);S!=null&&(a.push(_),u.set(_,S))}}));const d=new Ai(a);return new jw(u,d,o.fieldTransforms)}function U6(n,e,t,i,o,a){const u=n.Cc(1,e,t),d=[$m(e,i,t)],f=[o];if(a.length%2!=0)throw new Ee(le.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<a.length;S+=2)d.push($m(e,a[S])),f.push(a[S+1]);const p=[],_=ui.empty();for(let S=d.length-1;S>=0;--S)if(!eA(p,d[S])){const C=d[S];let k=f[S];k=yn(k);const V=u.yc(C);if(k instanceof qh)p.push(C);else{const z=Hh(k,V);z!=null&&(p.push(C),_.set(C,z))}}const E=new Ai(p);return new jw(_,E,u.fieldTransforms)}function Hh(n,e){if(Zw(n=yn(n)))return ey("Unsupported field value:",e,n),Ww(n,e);if(n instanceof Bh)return(function(i,o){if(!Xw(o.Ac))throw o.Sc(`${i._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${i._methodName}() is not currently supported inside arrays`);const a=i._toFieldTransform(o);a&&o.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,o){const a=[];let u=0;for(const d of i){let f=Hh(d,o.wc(u));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),u++}return{arrayValue:{values:a}}})(n,e)}return(function(i,o){if((i=yn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return SL(o.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const a=kt.fromDate(i);return{timestampValue:lh(o.serializer,a)}}if(i instanceof kt){const a=new kt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:lh(o.serializer,a)}}if(i instanceof Ls)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof qi)return{bytesValue:mw(o.serializer,i._byteString)};if(i instanceof hn){const a=o.databaseId,u=i.firestore._databaseId;if(!u.isEqual(a))throw o.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Lg(i.firestore._databaseId||o.databaseId,i._key.path)}}if(i instanceof Vs)return(function(u,d){return{mapValue:{fields:{[G1]:{stringValue:Y1},[sh]:{arrayValue:{values:u.toArray().map((p=>{if(typeof p!="number")throw d.Sc("VectorValues must only contain numeric values.");return Dg(d.serializer,p)}))}}}}}})(i,o);throw o.Sc(`Unsupported field value: ${xg(i)}`)})(n,e)}function Ww(n,e){const t={};return O1(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bo(n,((i,o)=>{const a=Hh(o,e.mc(i));a!=null&&(t[i]=a)})),{mapValue:{fields:t}}}function Zw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof kt||n instanceof Ls||n instanceof qi||n instanceof hn||n instanceof Bh||n instanceof Vs)}function ey(n,e,t){if(!Zw(t)||!L1(t)){const i=xg(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function $m(n,e,t){if((e=yn(e))instanceof Fh)return e._internalPath;if(typeof e=="string")return ty(n,e);throw hh("Field path arguments must be of type string or ",n,!1,void 0,t)}const L6=new RegExp("[~\\*/\\[\\]]");function ty(n,e,t){if(e.search(L6)>=0)throw hh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Fh(...e.split("."))._internalPath}catch{throw hh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function hh(n,e,t,i,o){const a=i&&!i.isEmpty(),u=o!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(a||u)&&(f+=" (found",a&&(f+=` in field ${i}`),u&&(f+=` in document ${o}`),f+=")"),new Ee(le.INVALID_ARGUMENT,d+n+f)}function eA(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(e,t,i,o,a){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=o,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new hn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new V6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(nA("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class V6 extends tA{data(){return super.data()}}function nA(n,e){return typeof e=="string"?ty(n,e):e instanceof Fh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O6(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ee(le.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class z6{convertValue(e,t="none"){switch(mo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return sn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(po(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Pe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return bo(e,((o,a)=>{i[o]=this.convertValue(a,t)})),i}convertVectorValue(e){var i,o,a;const t=(a=(o=(i=e.fields)==null?void 0:i[sh].arrayValue)==null?void 0:o.values)==null?void 0:a.map((u=>sn(u.doubleValue)));return new Vs(t)}convertGeoPoint(e){return new Ls(sn(e.latitude),sn(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Ih(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(Bu(e));default:return null}}convertTimestamp(e){const t=fo(e);return new kt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Ht.fromString(e);mt(Tw(i),9688,{name:e});const o=new qu(i.get(1),i.get(3)),a=new xe(i.popFirst(5));return o.isEqual(t)||vr(`Document ${a} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F6(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class Ru{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ia extends tA{constructor(e,t,i,o,a,u){super(e,t,i,o,u),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Fd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(nA("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(le.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ia._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ia._jsonSchemaVersion="firestore/documentSnapshot/1.0",ia._jsonSchema={type:dn("string",ia._jsonSchemaVersion),bundleSource:dn("string","DocumentSnapshot"),bundleName:dn("string"),bundle:dn("string")};class Fd extends ia{data(e={}){return super.data(e)}}class hl{constructor(e,t,i,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new Ru(o.hasPendingWrites,o.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Fd(this._firestore,this._userDataWriter,i.key,i,new Ru(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ee(le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,a){if(o._snapshot.oldDocs.isEmpty()){let u=0;return o._snapshot.docChanges.map((d=>{const f=new Fd(o._firestore,o._userDataWriter,d.doc.key,d.doc,new Ru(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:u++}}))}{let u=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((d=>a||d.type!==3)).map((d=>{const f=new Fd(o._firestore,o._userDataWriter,d.doc.key,d.doc,new Ru(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);let p=-1,_=-1;return d.type!==0&&(p=u.indexOf(d.doc.key),u=u.delete(d.doc.key)),d.type!==1&&(u=u.add(d.doc),_=u.indexOf(d.doc.key)),{type:B6(d.type),doc:f,oldIndex:p,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ee(le.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=hl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Cg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],o=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),i.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),o.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function B6(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pe(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iA(n){n=Ps(n,hn);const e=Ps(n.firestore,Tl);return C6(Qg(e),n._key).then((t=>oA(e,n,t)))}hl._jsonSchemaVersion="firestore/querySnapshot/1.0",hl._jsonSchema={type:dn("string",hl._jsonSchemaVersion),bundleSource:dn("string","QuerySnapshot"),bundleName:dn("string"),bundle:dn("string")};class sA extends z6{constructor(e){super(),this.firestore=e}convertBytes(e){return new qi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new hn(this.firestore,null,t)}}function q6(n,e,t){n=Ps(n,hn);const i=Ps(n.firestore,Tl),o=F6(n.converter,e);return rA(i,[D6(Qw(i),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,ks.none())])}function ny(n,e,t,...i){n=Ps(n,hn);const o=Ps(n.firestore,Tl),a=Qw(o);let u;return u=typeof(e=yn(e))=="string"||e instanceof Fh?U6(a,"updateDoc",n._key,e,t,i):k6(a,"updateDoc",n._key,e),rA(o,[u.toMutation(n._key,ks.exists(!0))])}function H6(n,...e){var f,p,_;n=yn(n);let t={includeMetadataChanges:!1,source:"default"},i=0;typeof e[i]!="object"||GS(e[i])||(t=e[i++]);const o={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(GS(e[i])){const E=e[i];e[i]=(f=E.next)==null?void 0:f.bind(E),e[i+1]=(p=E.error)==null?void 0:p.bind(E),e[i+2]=(_=E.complete)==null?void 0:_.bind(E)}let a,u,d;if(n instanceof hn)u=Ps(n.firestore,Tl),d=Nh(n._key.path),a={next:E=>{e[i]&&e[i](oA(u,n,E))},error:e[i+1],complete:e[i+2]};else{const E=Ps(n,zh);u=Ps(E.firestore,Tl),d=E._query;const S=new sA(u);a={next:C=>{e[i]&&e[i](new hl(u,S,E,C))},error:e[i+1],complete:e[i+2]},O6(n._query)}return(function(S,C,k,V){const z=new Yw(V),J=new Lw(C,z,k);return S.asyncQueue.enqueueAndForget((async()=>kw(await Ym(S),J))),()=>{z.Nu(),S.asyncQueue.enqueueAndForget((async()=>Uw(await Ym(S),J)))}})(Qg(u),d,o,a)}function rA(n,e){return(function(i,o){const a=new lo;return i.asyncQueue.enqueueAndForget((async()=>p6(await A6(i),o,a))),a.promise})(Qg(n),e)}function oA(n,e,t){const i=t.docs.get(e._key),o=new sA(n);return new ia(n,o,e._key,i,new Ru(t.hasPendingWrites,t.fromCache),e.converter)}function Bd(){return new Zg("serverTimestamp")}(function(e,t=!0){(function(o){Il=o})(Cl),ra(new co("firestore",((i,{instanceIdentifier:o,options:a})=>{const u=i.getProvider("app").getImmediate(),d=new Tl(new PU(i.getProvider("auth-internal")),new UU(u,i.getProvider("app-check-internal")),(function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Ee(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new qu(p.options.projectId,_)})(u,o),u);return a={useFetchStreams:t,...a},d._setSettings(a),d}),"PUBLIC").setMultipleInstances(!0)),Ns(XT,QT,e),Ns(XT,QT,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G6="type.googleapis.com/google.protobuf.Int64Value",Y6="type.googleapis.com/google.protobuf.UInt64Value";function aA(n,e){const t={};for(const i in n)n.hasOwnProperty(i)&&(t[i]=e(n[i]));return t}function fh(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>fh(e));if(typeof n=="function"||typeof n=="object")return aA(n,e=>fh(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Sl(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case G6:case Y6:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Sl(e)):typeof n=="function"||typeof n=="object"?aA(n,e=>Sl(e)):n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iy="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ci extends Fs{constructor(e,t,i){super(`${iy}/${e}`,t||""),this.details=i,Object.setPrototypeOf(this,ci.prototype)}}function $6(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function ph(n,e){let t=$6(n),i=t,o;try{const a=e&&e.error;if(a){const u=a.status;if(typeof u=="string"){if(!YS[u])return new ci("internal","internal");t=YS[u],i=u}const d=a.message;typeof d=="string"&&(i=d),o=a.details,o!==void 0&&(o=Sl(o))}}catch{}return t==="ok"?null:new ci(t,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K6{constructor(e,t,i,o){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,li(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=i.getImmediate({optional:!0}),this.auth||t.get().then(a=>this.auth=a,()=>{}),this.messaging||i.get().then(a=>this.messaging=a,()=>{}),this.appCheck||o==null||o.get().then(a=>this.appCheck=a,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),i=await this.getMessagingToken(),o=await this.getAppCheckToken(e);return{authToken:t,messagingToken:i,appCheckToken:o}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km="us-central1",J6=/^data: (.*?)(?:\n|$)/;function j6(n){let e=null;return{promise:new Promise((t,i)=>{e=setTimeout(()=>{i(new ci("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class X6{constructor(e,t,i,o,a=Km,u=(...d)=>fetch(...d)){this.app=e,this.fetchImpl=u,this.emulatorOrigin=null,this.contextProvider=new K6(e,t,i,o),this.cancelAllRequests=new Promise(d=>{this.deleteService=()=>Promise.resolve(d())});try{const d=new URL(a);this.customDomain=d.origin+(d.pathname==="/"?"":d.pathname),this.region=Km}catch{this.customDomain=null,this.region=a}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function Q6(n,e,t){const i=vo(e);n.emulatorOrigin=`http${i?"s":""}://${e}:${t}`,i&&(cg(n.emulatorOrigin+"/backends"),dg("Functions",!0))}function W6(n,e,t){const i=o=>eO(n,e,o,{});return i.stream=(o,a)=>nO(n,e,o,a),i}function lA(n){return n.emulatorOrigin&&vo(n.emulatorOrigin)?"include":void 0}async function Z6(n,e,t,i,o){t["Content-Type"]="application/json";let a;try{a=await i(n,{method:"POST",body:JSON.stringify(e),headers:t,credentials:lA(o)})}catch{return{status:0,json:null}}let u=null;try{u=await a.json()}catch{}return{status:a.status,json:u}}async function uA(n,e){const t={},i=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return i.authToken&&(t.Authorization="Bearer "+i.authToken),i.messagingToken&&(t["Firebase-Instance-ID-Token"]=i.messagingToken),i.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=i.appCheckToken),t}function eO(n,e,t,i){const o=n._url(e);return tO(n,o,t,i)}async function tO(n,e,t,i){t=fh(t);const o={data:t},a=await uA(n,i),u=i.timeout||7e4,d=j6(u),f=await Promise.race([Z6(e,o,a,n.fetchImpl,n),d.promise,n.cancelAllRequests]);if(d.cancel(),!f)throw new ci("cancelled","Firebase Functions instance was deleted.");const p=ph(f.status,f.json);if(p)throw p;if(!f.json)throw new ci("internal","Response is not valid JSON object.");let _=f.json.data;if(typeof _>"u"&&(_=f.json.result),typeof _>"u")throw new ci("internal","Response is missing data field.");return{data:Sl(_)}}function nO(n,e,t,i){const o=n._url(e);return iO(n,o,t,i||{})}async function iO(n,e,t,i){var S;t=fh(t);const o={data:t},a=await uA(n,i);a["Content-Type"]="application/json",a.Accept="text/event-stream";let u;try{u=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(o),headers:a,signal:i==null?void 0:i.signal,credentials:lA(n)})}catch(C){if(C instanceof Error&&C.name==="AbortError"){const V=new ci("cancelled","Request was cancelled.");return{data:Promise.reject(V),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(V)}}}}}}const k=ph(0,null);return{data:Promise.reject(k),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(k)}}}}}}let d,f;const p=new Promise((C,k)=>{d=C,f=k});(S=i==null?void 0:i.signal)==null||S.addEventListener("abort",()=>{const C=new ci("cancelled","Request was cancelled.");f(C)});const _=u.body.getReader(),E=sO(_,d,f,i==null?void 0:i.signal);return{stream:{[Symbol.asyncIterator](){const C=E.getReader();return{async next(){const{value:k,done:V}=await C.read();return{value:k,done:V}},async return(){return await C.cancel(),{done:!0,value:void 0}}}}},data:p}}function sO(n,e,t,i){const o=(u,d)=>{const f=u.match(J6);if(!f)return;const p=f[1];try{const _=JSON.parse(p);if("result"in _){e(Sl(_.result));return}if("message"in _){d.enqueue(Sl(_.message));return}if("error"in _){const E=ph(0,_);d.error(E),t(E);return}}catch(_){if(_ instanceof ci){d.error(_),t(_);return}}},a=new TextDecoder;return new ReadableStream({start(u){let d="";return f();async function f(){if(i!=null&&i.aborted){const p=new ci("cancelled","Request was cancelled");return u.error(p),t(p),Promise.resolve()}try{const{value:p,done:_}=await n.read();if(_){d.trim()&&o(d.trim(),u),u.close();return}if(i!=null&&i.aborted){const S=new ci("cancelled","Request was cancelled");u.error(S),t(S),await n.cancel();return}d+=a.decode(p,{stream:!0});const E=d.split(`
`);d=E.pop()||"";for(const S of E)S.trim()&&o(S.trim(),u);return f()}catch(p){const _=p instanceof ci?p:ph(0,null);u.error(_),t(_)}}},cancel(){return n.cancel()}})}const $S="@firebase/functions",KS="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO="auth-internal",oO="app-check-internal",aO="messaging-internal";function lO(n){const e=(t,{instanceIdentifier:i})=>{const o=t.getProvider("app").getImmediate(),a=t.getProvider(rO),u=t.getProvider(aO),d=t.getProvider(oO);return new X6(o,a,u,d,i)};ra(new co(iy,e,"PUBLIC").setMultipleInstances(!0)),Ns($S,KS,n),Ns($S,KS,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uO(n=pg(),e=Km){const i=Sh(yn(n),iy).getImmediate({identifier:e}),o=Bb("functions");return o&&cO(i,...o),i}function cO(n,e,t){Q6(yn(n),e,t)}function Jm(n,e,t){return W6(yn(n),e)}lO();const dO={apiKey:"AIzaSyBD7A7wZ6Iqs4aPqociOOXqBWmipmR8hrQ",authDomain:"jusdnce-ai.firebaseapp.com",projectId:"jusdnce-ai",storageBucket:"jusdnce-ai.firebasestorage.app",messagingSenderId:"775650569996",appId:"1:775650569996:web:098652c4cdc755bf8fe329"},sy=$b(dO),Gh=IU(sy),oc=I6(sy),jm=uO(sy),cA=new hr;cA.setCustomParameters({prompt:"select_account"});const hO=(n,e)=>p3(Gh,n,e),fO=(n,e)=>f3(Gh,n,e),pO=()=>V3(Gh,cA),mO=({onSuccess:n,compact:e=!1})=>{const[t,i]=ee.useState(""),[o,a]=ee.useState(!1),[u,d]=ee.useState(null),f=async()=>{var _,E,S,C,k,V,z;if(t.trim()){a(!0),d(null),jn("click",1);try{const j=await Jm(jm,"redeemPromoCode")({code:t.trim().toUpperCase()});d({success:!0,message:j.data.message,credits:j.data.credits}),jn("click",2),n&&n(j.data.credits,j.data.newBalance),i("")}catch(J){console.error("Promo code error:",J);let j="Failed to redeem code";(_=J.message)!=null&&_.includes("not-found")||(E=J.message)!=null&&E.includes("Invalid")?j="Invalid or expired promo code":(S=J.message)!=null&&S.includes("already-exists")||(C=J.message)!=null&&C.includes("already redeemed")?j="You already redeemed this code":(k=J.message)!=null&&k.includes("resource-exhausted")||(V=J.message)!=null&&V.includes("maximum")?j="This code has reached its limit":(z=J.message)!=null&&z.includes("unauthenticated")&&(j="Please sign in to redeem codes"),d({success:!1,message:j})}finally{a(!1)}}},p=_=>{_.key==="Enter"&&t.trim()&&f()};return e?T.jsxs("div",{className:"space-y-2",children:[T.jsxs("div",{className:"flex gap-2",children:[T.jsx("input",{type:"text",value:t,onChange:_=>i(_.target.value.toUpperCase()),onKeyDown:p,placeholder:"PROMO CODE",className:"flex-1 bg-black/30 border border-white/10 rounded-lg py-2 px-3 text-white text-sm uppercase tracking-wider focus:border-green-500/50 outline-none placeholder:text-gray-500",maxLength:20}),T.jsx("button",{onClick:f,disabled:o||!t.trim(),className:"px-4 py-2 bg-green-600 hover:bg-green-500 disabled:bg-gray-700 disabled:text-gray-500 text-white font-bold rounded-lg transition-all flex items-center gap-2",children:o?T.jsx(Hd,{size:16,className:"animate-spin"}):T.jsx(om,{size:16})})]}),u&&T.jsxs("div",{className:`text-xs flex items-center gap-1 ${u.success?"text-green-400":"text-red-400"}`,children:[u.success?T.jsx(rm,{size:12}):T.jsx(sm,{size:12}),u.message]})]}):T.jsxs("div",{className:"bg-gradient-to-br from-green-900/20 to-emerald-900/20 p-4 rounded-xl border border-green-500/20",children:[T.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[T.jsx(om,{size:18,className:"text-green-400"}),T.jsx("span",{className:"text-sm font-bold text-white",children:"Have a Promo Code?"})]}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("input",{type:"text",value:t,onChange:_=>i(_.target.value.toUpperCase()),onKeyDown:p,placeholder:"Enter code here...",className:"flex-1 bg-black/40 border border-green-500/30 rounded-lg py-2.5 px-3 text-white text-sm uppercase tracking-wider focus:border-green-400 outline-none placeholder:text-gray-500",maxLength:20}),T.jsx("button",{onClick:f,disabled:o||!t.trim(),className:"px-5 py-2.5 bg-green-600 hover:bg-green-500 disabled:bg-gray-700 disabled:text-gray-500 text-white font-bold rounded-lg transition-all flex items-center gap-2",children:o?T.jsx(Hd,{size:16,className:"animate-spin"}):"Redeem"})]}),u&&T.jsxs("div",{className:`mt-3 p-2 rounded-lg flex items-center gap-2 text-sm ${u.success?"bg-green-500/20 text-green-300 border border-green-500/30":"bg-red-500/20 text-red-300 border border-red-500/30"}`,children:[u.success?T.jsx(rm,{size:16}):T.jsx(sm,{size:16}),u.message,u.credits&&T.jsxs("span",{className:"ml-auto font-bold",children:["+",u.credits," credits!"]})]})]})},jn=(n,e=1)=>{const t=new CustomEvent("ui-interaction",{detail:{type:n,intensity:e}});window.dispatchEvent(t)},dA=({isOpen:n,onClose:e,children:t,title:i})=>(ee.useEffect(()=>{n&&jn("click",.8)},[n]),n?T.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 animate-fade-in",children:[T.jsx("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-md",onClick:()=>{jn("click",.5),e()}}),T.jsxs("div",{className:"relative bg-dark-surface border border-dark-border rounded-2xl w-full max-w-md shadow-[0_0_50px_rgba(0,0,0,0.5)] animate-zoom-out overflow-hidden",children:[T.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-dark-border bg-dark-bg/50",children:[T.jsx("h3",{className:"text-lg font-bold text-white tracking-wide",children:i}),T.jsx("button",{onClick:()=>{jn("click",.5),e()},className:"text-gray-400 hover:text-white transition-colors hover:rotate-90 duration-300",children:T.jsx(so,{size:20})})]}),T.jsx("div",{className:"p-6",children:t})]})]}):null),gO=({isOpen:n,onClose:e,onLogin:t})=>{const[i,o]=ee.useState(!1),[a,u]=ee.useState(!1),[d,f]=ee.useState(!1),[p,_]=ee.useState(""),[E,S]=ee.useState(""),[C,k]=ee.useState(""),V=()=>{jn("click",1.2),o(!0),t(),o(!1)},z=async j=>{j.preventDefault(),k(""),o(!0),jn("click",1.2);try{d?await fO(p,E):await hO(p,E),e()}catch(Z){console.error("Auth error:",Z),Z.code==="auth/user-not-found"?k("No account found. Try signing up!"):Z.code==="auth/wrong-password"?k("Incorrect password."):Z.code==="auth/email-already-in-use"?k("Email already in use. Try signing in!"):Z.code==="auth/weak-password"?k("Password must be at least 6 characters."):k(Z.message||"Authentication failed.")}finally{o(!1)}},J=()=>{u(!1),_(""),S(""),k(""),f(!1)};return T.jsx(dA,{isOpen:n,onClose:()=>{J(),e()},title:a?d?"Create Account":"Sign In":"Create Account",children:a?T.jsxs("div",{className:"space-y-4",children:[T.jsxs("button",{onClick:J,className:"flex items-center gap-2 text-gray-400 hover:text-white text-sm",children:[T.jsx(eb,{size:16})," Back"]}),T.jsxs("form",{onSubmit:z,className:"space-y-4",children:[T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Email"}),T.jsx("input",{type:"email",value:p,onChange:j=>_(j.target.value),placeholder:"you@example.com",className:"w-full bg-black/30 border border-gray-700 rounded-lg py-2.5 px-3 text-white text-sm focus:border-brand-500 outline-none",required:!0})]}),T.jsxs("div",{children:[T.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Password"}),T.jsx("input",{type:"password",value:E,onChange:j=>S(j.target.value),placeholder:"",className:"w-full bg-black/30 border border-gray-700 rounded-lg py-2.5 px-3 text-white text-sm focus:border-brand-500 outline-none",required:!0,minLength:6})]}),C&&T.jsx("p",{className:"text-red-400 text-sm text-center",children:C}),T.jsx("button",{type:"submit",disabled:i,className:"w-full bg-brand-600 hover:bg-brand-500 text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2 disabled:opacity-50",children:i?T.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):T.jsx(T.Fragment,{children:d?"Create Account":"Sign In"})}),T.jsxs("p",{className:"text-center text-sm text-gray-400",children:[d?"Already have an account?":"Don't have an account?"," ",T.jsx("button",{type:"button",onClick:()=>{f(!d),k("")},className:"text-brand-400 hover:text-brand-300",children:d?"Sign In":"Sign Up"})]})]})]}):T.jsxs("div",{className:"text-center space-y-6",children:[T.jsx("div",{className:"w-16 h-16 bg-brand-500/20 rounded-full flex items-center justify-center mx-auto text-brand-400 border border-brand-500/30 shadow-lg",children:T.jsx(CI,{size:32})}),T.jsxs("div",{children:[T.jsx("h4",{className:"text-xl font-bold text-white mb-2",children:"Save Your Masterpiece"}),T.jsxs("p",{className:"text-gray-400 text-sm",children:["Sign in to save your generated videos and claim your ",T.jsxs("span",{className:"text-brand-300 font-bold",children:[Zm.signupCredits," Free Credits"]}),"."]})]}),T.jsxs("div",{className:"space-y-3",children:[T.jsx("button",{onClick:V,disabled:i,onMouseEnter:()=>jn("hover",.2),className:"w-full bg-white text-black font-bold py-3 rounded-xl flex items-center justify-center gap-3 hover:bg-gray-100 transition-colors disabled:opacity-50 shadow-md hover:shadow-lg hover:scale-[1.02]",children:i?T.jsx("div",{className:"w-5 h-5 border-2 border-gray-400 border-t-black rounded-full animate-spin"}):T.jsxs(T.Fragment,{children:[T.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[T.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),T.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),T.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),T.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continue with Google"]})}),T.jsxs("button",{onClick:()=>u(!0),onMouseEnter:()=>jn("hover",.2),className:"w-full bg-gray-800 text-white font-medium py-3 rounded-xl hover:bg-gray-700 transition-colors border border-white/5 flex items-center justify-center gap-2",children:[T.jsx(Jx,{size:18}),"Continue with Email"]})]}),T.jsx("p",{className:"text-[10px] text-gray-500",children:"By continuing, you agree to our Terms of Service and Privacy Policy."})]})})},yO=({isOpen:n,onClose:e,onSuccess:t})=>{const[i,o]=ee.useState(!1),[a,u]=ee.useState(null),[d,f]=ee.useState("ready"),[p,_]=ee.useState("pack_10"),[E,S]=ee.useState(!1);ee.useEffect(()=>{n&&(f("ready"),u(null),o(!1),_("pack_10"),S(!1))},[n]),ee.useEffect(()=>{const z=new URLSearchParams(window.location.search),J=z.get("success"),j=z.get("canceled"),Z=z.get("session_id");J==="true"&&Z?(C(Z),window.history.replaceState({},"",window.location.pathname)):j==="true"&&window.history.replaceState({},"",window.location.pathname)},[]);const C=async z=>{try{(await Jm(jm,"verifyCheckoutSession")({sessionId:z})).data.paid&&(jn("click",3),t())}catch(J){console.error("Failed to verify session:",J)}},k=async(z,J=!1)=>{var j,Z;u(null),o(!0),f("processing"),jn("click",1.5);try{const H=Jm(jm,"createCheckoutSession"),ae=window.location.origin+window.location.pathname,oe=await H({packId:z,isSubscription:J,successUrl:ae,cancelUrl:ae}),{url:x}=oe.data;if(!x)throw new Error("No checkout URL returned");f("redirecting"),console.log("[Stripe] Redirecting to checkout:",x),window.location.href=x}catch(H){console.error("[Stripe] Checkout error:",H),o(!1),f("ready"),(j=H.message)!=null&&j.includes("unauthenticated")?u("Please sign in to purchase credits."):(Z=H.message)!=null&&Z.includes("not configured")?u("Payment system is being set up. Please try again later."):u(H.message||"Failed to start checkout. Please try again.")}},V=Hv.find(z=>z.id===p);return T.jsx(dA,{isOpen:n,onClose:e,title:"Get Credits",children:T.jsxs("div",{className:"space-y-4",children:[T.jsxs("div",{className:"flex gap-2 p-1 bg-black/30 rounded-lg",children:[T.jsxs("button",{onClick:()=>S(!1),className:`flex-1 py-2 px-3 rounded-md text-sm font-bold transition-all ${E?"text-gray-400 hover:text-white":"bg-brand-600 text-white"}`,children:[T.jsx(pl,{size:14,className:"inline mr-1"})," Credit Packs"]}),T.jsxs("button",{onClick:()=>S(!0),className:`flex-1 py-2 px-3 rounded-md text-sm font-bold transition-all ${E?"bg-gradient-to-r from-yellow-500 to-orange-500 text-black":"text-gray-400 hover:text-white"}`,children:[T.jsx(qd,{size:14,className:"inline mr-1"})," Pro Monthly"]})]}),E?T.jsxs("div",{className:"bg-gradient-to-br from-yellow-900/30 to-orange-900/30 p-5 rounded-xl border border-yellow-500/30",children:[T.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[T.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-full flex items-center justify-center",children:T.jsx(qd,{size:24,className:"text-black"})}),T.jsxs("div",{children:[T.jsx("p",{className:"text-white font-bold text-lg",children:"Pro Subscription"}),T.jsxs("p",{className:"text-yellow-300 text-sm",children:["$",Wa.price,"/month"]})]})]}),T.jsx("ul",{className:"space-y-2 mb-4",children:Wa.features.map((z,J)=>T.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-300",children:[T.jsx(rm,{size:14,className:"text-green-400"}),z]},J))}),T.jsxs("p",{className:"text-[11px] text-gray-500 mb-2",children:["Get ",Wa.dailyCredits," free credits every day, plus an ad-free experience!"]})]}):T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"grid grid-cols-3 gap-2",children:Hv.map(z=>T.jsxs("button",{onClick:()=>_(z.id),onMouseEnter:()=>jn("hover",.2),className:`relative p-3 rounded-lg border-2 transition-all ${p===z.id?"border-brand-500 bg-brand-500/20":"border-white/10 bg-black/20 hover:border-white/30"}`,children:[z.popular&&T.jsx("span",{className:"absolute -top-2 left-1/2 -translate-x-1/2 text-[9px] bg-brand-500 text-white px-2 py-0.5 rounded-full font-bold",children:"POPULAR"}),z.bestValue&&T.jsx("span",{className:"absolute -top-2 left-1/2 -translate-x-1/2 text-[9px] bg-green-500 text-white px-2 py-0.5 rounded-full font-bold",children:"BEST VALUE"}),T.jsx("div",{className:"text-lg font-bold text-white",children:z.credits}),T.jsx("div",{className:"text-[10px] text-gray-400",children:"credits"}),T.jsxs("div",{className:"text-sm font-bold text-brand-300 mt-1",children:["$",z.price]})]},z.id))}),V&&T.jsx("div",{className:"bg-gradient-to-br from-brand-900/50 to-purple-900/50 p-4 rounded-xl border border-brand-500/30",children:T.jsxs("div",{className:"flex justify-between items-center",children:[T.jsxs("div",{children:[T.jsxs("p",{className:"text-white font-bold",children:[V.credits," Credits"]}),T.jsxs("p",{className:"text-brand-300 text-xs",children:["$",(V.price/V.credits).toFixed(2)," per credit"]})]}),T.jsxs("div",{className:"text-2xl font-bold text-white",children:["$",V.price]})]})}),T.jsxs("button",{onClick:()=>jn("click",.5),className:"w-full flex items-center justify-center gap-2 py-3 rounded-lg border border-green-500/30 bg-green-500/10 text-green-400 hover:bg-green-500/20 transition-all",children:[T.jsx(mh,{size:16}),T.jsx("span",{className:"text-sm font-bold",children:"Watch Ad for Free Credit"}),T.jsx("span",{className:"text-[10px] bg-green-500/30 px-2 py-0.5 rounded",children:"Coming Soon"})]}),T.jsx(mO,{onSuccess:(z,J)=>{jn("click",2.5),t()}})]}),a&&T.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-500/10 border border-red-500/30 rounded-lg",children:[T.jsx(sm,{size:18,className:"text-red-400 flex-shrink-0 mt-0.5"}),T.jsx("p",{className:"text-red-300 text-sm",children:a})]}),T.jsxs("button",{onClick:()=>k(E?Wa.id:p,E),disabled:i,onMouseEnter:()=>!i&&jn("hover",.3),className:`w-full font-bold py-4 rounded-xl flex items-center justify-center gap-3 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:scale-[1.02] ${E?"bg-gradient-to-r from-yellow-500 to-orange-500 text-black hover:from-yellow-400 hover:to-orange-400":"bg-brand-600 hover:bg-brand-500 text-white shadow-brand-600/20 hover:shadow-brand-600/40"}`,children:[d==="ready"&&T.jsxs(T.Fragment,{children:[T.jsx(wx,{size:20}),E?`Subscribe for $${Wa.price}/mo`:`Buy ${V==null?void 0:V.credits} Credits`,T.jsx(Ix,{size:14,className:"opacity-60"})]}),d==="processing"&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"w-5 h-5 border-2 border-current/30 border-t-current rounded-full animate-spin"}),"Creating checkout session..."]}),d==="redirecting"&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"w-5 h-5 border-2 border-current/30 border-t-current rounded-full animate-spin"}),"Redirecting to Stripe..."]})]}),T.jsx("div",{className:"flex flex-col items-center gap-2",children:T.jsxs("div",{className:"flex items-center gap-2 text-[11px] text-gray-500",children:[T.jsx($x,{size:12}),T.jsx("span",{children:"Secure payment powered by"}),T.jsx("svg",{className:"h-4",viewBox:"0 0 60 25",fill:"currentColor",children:T.jsx("path",{d:"M59.64 14.28h-8.06c.19 1.93 1.6 2.55 3.2 2.55 1.64 0 2.96-.37 4.05-.95v3.32a12.12 12.12 0 0 1-4.56.83c-4.14 0-6.94-2.4-6.94-6.94 0-4.3 2.64-7.06 6.4-7.06 3.65 0 5.96 2.66 5.96 6.74 0 .5-.04 1.06-.05 1.51zm-4.38-5.18c0-.92-.39-2.4-2.05-2.4-1.49 0-2.15 1.38-2.27 2.4h4.32zM38.23 6.47c1.56 0 2.78.27 3.75.79V11a6.82 6.82 0 0 0-3.15-.78c-.98 0-1.47.32-1.47.87 0 .58.57.8 1.49 1.12l.8.27c2.58.87 3.58 2.1 3.58 4.1 0 2.97-2.35 4.66-5.94 4.66-1.62 0-3.15-.34-4.35-.99v-3.94a8.43 8.43 0 0 0 4.2 1.25c1.08 0 1.62-.32 1.62-.9 0-.55-.49-.84-1.68-1.26l-.65-.23c-2.39-.83-3.66-2.07-3.66-4.21 0-2.72 2.2-4.49 5.46-4.49zM25.64 6.47c1.56 0 2.78.27 3.75.79V11a6.82 6.82 0 0 0-3.15-.78c-.98 0-1.47.32-1.47.87 0 .58.57.8 1.49 1.12l.8.27c2.58.87 3.58 2.1 3.58 4.1 0 2.97-2.35 4.66-5.94 4.66-1.62 0-3.15-.34-4.35-.99v-3.94a8.43 8.43 0 0 0 4.2 1.25c1.08 0 1.62-.32 1.62-.9 0-.55-.49-.84-1.68-1.26l-.65-.23c-2.39-.83-3.66-2.07-3.66-4.21 0-2.72 2.2-4.49 5.46-4.49zM14.67 20.98V6.87H19v14.11h-4.33zM16.83 5.5c-1.37 0-2.47-.98-2.47-2.2 0-1.23 1.1-2.21 2.47-2.21 1.38 0 2.48.98 2.48 2.2 0 1.23-1.1 2.22-2.48 2.22zM6.39 11.42V20.98H2.06V6.87h4.16v1.75c.8-1.23 2.32-2.14 4.35-2.14v4.13c-2.25-.04-4.18.74-4.18 2.81z"})})]})})]})})},dr=(n,e,t)=>n*(1-t)+e*t,_O=({appState:n})=>{const e=ee.useRef(null),t=ee.useRef(null),i=ee.useRef({hue:200,saturation:.8,intensity:.6,geometryType:0,speed:.1,chaos:.5,morph:0,density:2,gridOpacity:0}),o=ee.useRef({isActive:0,lastActivity:0}),a=ee.useRef({hue:null});return ee.useEffect(()=>{if(e.current&&!t.current)try{t.current=new um(e.current)}catch(_){console.error("Failed to init Quantum visualizer:",_)}const u=()=>{t.current&&t.current.resize()};window.addEventListener("resize",u);const d=_=>{o.current.isActive=1,o.current.lastActivity=Date.now()},f=_=>{a.current.hue=_.detail.hue,setTimeout(()=>{a.current.hue=null},2e3)},p=()=>{o.current.isActive=1,o.current.lastActivity=Date.now()};return window.addEventListener("ui-interaction",d),window.addEventListener("color-shift",f),window.addEventListener("mousemove",p),window.addEventListener("touchmove",p),()=>{window.removeEventListener("resize",u),window.removeEventListener("ui-interaction",d),window.removeEventListener("color-shift",f),window.removeEventListener("mousemove",p),window.removeEventListener("touchmove",p)}},[]),ee.useEffect(()=>{let u;const d=()=>{if(t.current){let f={...i.current};if(n.step===xt.ASSETS)f={hue:200,saturation:.8,intensity:.6,chaos:.3,speed:.1,density:2,geometryType:0};else if(n.step===xt.DIRECTOR){const E=as.find(S=>S.id===n.selectedStyleId);if(E&&E.hologramParams&&(f={...f,...E.hologramParams}),n.secondaryStyleId){const S=as.find(C=>C.id===n.secondaryStyleId);if(S&&S.hologramParams){const C=(n.morphIntensity||0)/100,k=(V,z)=>dr(V||0,z||0,C);f.hue=k(f.hue,S.hologramParams.hue),f.saturation=k(f.saturation,S.hologramParams.saturation),f.intensity=k(f.intensity,S.hologramParams.intensity),f.speed=k(f.speed,S.hologramParams.speed),f.chaos=k(f.chaos,S.hologramParams.chaos),f.morph=k(f.morph,S.hologramParams.morph),f.density=k(f.density,S.hologramParams.density),C>.5&&S.hologramParams.geometryType!==void 0&&(f.geometryType=S.hologramParams.geometryType)}}n.isGenerating&&(f={...f,hue:40,intensity:1.5,speed:2,chaos:1})}else n.step===xt.PREVIEW&&(f={...f,intensity:.8,speed:.3});a.current.hue!==null&&(f.hue=a.current.hue),Date.now()-o.current.lastActivity>1e3&&(o.current.isActive*=.95),f.density=dr(2.5,.4,o.current.isActive);const p=.05,_=i.current;if(_.hue=dr(_.hue,f.hue,p),_.saturation=dr(_.saturation,f.saturation,p),_.intensity=dr(_.intensity,f.intensity,p),_.speed=dr(_.speed,f.speed,p),_.chaos=dr(_.chaos,f.chaos,p),_.morph=dr(_.morph,f.morph,p),_.density=dr(_.density,f.density,p),_.geometryType=f.geometryType,t.current.params=_,n.step!==xt.PREVIEW){const E=(n.reactivity??80)/100,S=Date.now()/1e3;t.current.updateAudio({bass:(Math.sin(S)*.05+.05)*E,mid:0,high:0,energy:0})}t.current.render()}u=requestAnimationFrame(d)};return d(),()=>cancelAnimationFrame(u)},[n.step,n.selectedStyleId,n.secondaryStyleId,n.morphIntensity,n.isGenerating,n.reactivity]),T.jsx("canvas",{ref:e,className:"fixed inset-0 w-full h-full z-0 pointer-events-none"})},vO=({title:n,description:e,position:t,arrowPosition:i="bottom",accentColor:o="brand",onDismiss:a,onSkipAll:u})=>{const d={brand:{border:"border-brand-500/50",bg:"bg-brand-500/20",text:"text-brand-300",glow:"shadow-brand-500/30"},cyan:{border:"border-cyan-500/50",bg:"bg-cyan-500/20",text:"text-cyan-300",glow:"shadow-cyan-500/30"},magenta:{border:"border-pink-500/50",bg:"bg-pink-500/20",text:"text-pink-300",glow:"shadow-pink-500/30"},yellow:{border:"border-yellow-500/50",bg:"bg-yellow-500/20",text:"text-yellow-300",glow:"shadow-yellow-500/30"}},f=d[o]||d.brand,p={top:"before:absolute before:-top-2 before:left-1/2 before:-translate-x-1/2 before:border-8 before:border-transparent before:border-b-white/10",bottom:"before:absolute before:-bottom-2 before:left-1/2 before:-translate-x-1/2 before:border-8 before:border-transparent before:border-t-white/10",left:"before:absolute before:-left-2 before:top-1/2 before:-translate-y-1/2 before:border-8 before:border-transparent before:border-r-white/10",right:"before:absolute before:-right-2 before:top-1/2 before:-translate-y-1/2 before:border-8 before:border-transparent before:border-l-white/10"};return T.jsx("div",{className:`absolute z-50 animate-fade-in ${p[i]}`,style:t,children:T.jsxs("div",{className:`
        relative max-w-xs p-4 rounded-2xl
        bg-black/80 backdrop-blur-xl
        border ${f.border}
        shadow-2xl ${f.glow}
      `,children:[T.jsx("div",{className:`absolute inset-0 rounded-2xl ${f.bg} blur-xl opacity-30 -z-10`}),T.jsxs("div",{className:"relative",children:[T.jsxs("h4",{className:`text-sm font-bold ${f.text} mb-2 flex items-center gap-2`,children:[T.jsx(uo,{size:14,className:"animate-pulse"}),n]}),T.jsx("p",{className:"text-xs text-gray-300 leading-relaxed mb-4",children:e}),T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsx("button",{onClick:u,className:"text-[10px] text-gray-500 hover:text-gray-300 transition-colors uppercase tracking-wider",children:"Skip All"}),T.jsxs("button",{onClick:a,className:`
                px-4 py-1.5 rounded-full text-[10px] font-bold uppercase tracking-wider
                ${f.bg} ${f.text} border ${f.border}
                hover:brightness-125 transition-all
                flex items-center gap-1
              `,children:["Got it ",T.jsx(Qm,{size:12})]})]})]}),T.jsx("button",{onClick:a,className:"absolute -top-2 -right-2 p-1.5 bg-black/80 rounded-full border border-white/10 text-gray-400 hover:text-white transition-colors",children:T.jsx(so,{size:12})})]})})},EO=({onDismiss:n,onSkipAll:e})=>T.jsx("div",{className:"absolute inset-0 z-40 flex items-center justify-center pointer-events-none",children:T.jsx("div",{className:"pointer-events-auto max-w-md animate-scale-in",children:T.jsxs("div",{className:`
          relative p-6 rounded-3xl
          bg-black/90 backdrop-blur-xl
          border border-brand-500/40
          shadow-2xl shadow-brand-500/20
        `,children:[T.jsx("div",{className:"absolute inset-0 rounded-3xl bg-gradient-to-br from-brand-500/10 via-transparent to-pink-500/10 blur-xl -z-10"}),T.jsx("div",{className:"absolute inset-0 rounded-3xl bg-gradient-to-tr from-cyan-500/5 via-transparent to-brand-500/5 -z-10"}),T.jsxs("div",{className:"text-center space-y-4",children:[T.jsx("div",{className:"inline-flex p-4 rounded-2xl bg-gradient-to-br from-brand-500/20 to-pink-500/20 border border-brand-500/30",children:T.jsx(uo,{size:32,className:"text-brand-300 animate-pulse"})}),T.jsxs("h2",{className:"text-xl font-black text-white tracking-wider",children:["Welcome to ",T.jsx("span",{className:"text-brand-300",children:"jusDNCE"})]}),T.jsxs("p",{className:"text-sm text-gray-300 leading-relaxed",children:["Transform any image into a living, audio-reactive dance animation.",T.jsx("br",{}),T.jsx("br",{}),T.jsx("span",{className:"text-brand-300 font-bold",children:"Just upload a picture"})," and we'll bring it to life!"]}),T.jsxs("div",{className:"grid grid-cols-3 gap-3 py-4",children:[T.jsxs("div",{className:"text-center",children:[T.jsx("div",{className:"w-10 h-10 mx-auto rounded-full bg-brand-500/20 border border-brand-500/30 flex items-center justify-center mb-2",children:T.jsx(Wm,{size:18,className:"text-brand-300"})}),T.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold",children:"1. Upload"})]}),T.jsxs("div",{className:"text-center",children:[T.jsx("div",{className:"w-10 h-10 mx-auto rounded-full bg-pink-500/20 border border-pink-500/30 flex items-center justify-center mb-2",children:T.jsx(na,{size:18,className:"text-pink-300"})}),T.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold",children:"2. Add Music"})]}),T.jsxs("div",{className:"text-center",children:[T.jsx("div",{className:"w-10 h-10 mx-auto rounded-full bg-cyan-500/20 border border-cyan-500/30 flex items-center justify-center mb-2",children:T.jsx(uo,{size:18,className:"text-cyan-300"})}),T.jsx("span",{className:"text-[10px] text-gray-400 uppercase font-bold",children:"3. Dance!"})]})]}),T.jsx("div",{className:"p-3 rounded-xl bg-yellow-500/10 border border-yellow-500/30 text-left",children:T.jsxs("p",{className:"text-[11px] text-yellow-300",children:[T.jsx("span",{className:"font-bold",children:"Pro tip:"})," Upload a song for the best experience, or use your ",T.jsxs("span",{className:"inline-flex items-center gap-1 font-bold",children:[T.jsx(ib,{size:12})," microphone"]})," to dance to live audio!"]})}),T.jsxs("div",{className:"flex items-center justify-between pt-2",children:[T.jsx("button",{onClick:e,className:"text-xs text-gray-500 hover:text-gray-300 transition-colors uppercase tracking-wider font-bold",children:"Skip Tutorial"}),T.jsxs("button",{onClick:n,className:`
                  px-6 py-2.5 rounded-full text-sm font-bold uppercase tracking-wider
                  bg-gradient-to-r from-brand-500 to-pink-500 text-white
                  hover:brightness-110 transition-all shadow-lg shadow-brand-500/30
                  flex items-center gap-2
                `,children:["Let's Go ",T.jsx(Qm,{size:16})]})]})]})]})})}),JS=[{id:"welcome",component:"explainer",title:"Welcome to jusDNCE",description:"Transform any image into a living, audio-reactive dance animation.",triggerAfterMs:4e3,targetStep:1},{id:"upload-image",component:"tooltip",title:"Start Here",description:"Drag and drop an image or click to browse. Characters, artwork, text - anything works!",position:{top:"50%",left:"50%"},arrowPosition:"bottom",accentColor:"brand",triggerAfterMs:1e4,targetStep:1},{id:"add-song",component:"tooltip",title:"Add Your Soundtrack",description:"Upload an MP3 or audio file. Or skip this and use your microphone for live audio!",position:{bottom:"20%",left:"50%"},arrowPosition:"top",accentColor:"magenta",triggerAfterMs:1e4,targetStep:1},{id:"choose-style",component:"tooltip",title:"Pick Your Vibe",description:"Choose an art style to set the mood. Each style has unique visual effects and motion patterns.",position:{top:"30%",left:"20px"},arrowPosition:"left",accentColor:"cyan",triggerAfterMs:1e4,targetStep:2},{id:"generate",component:"tooltip",title:"Ready to Dance!",description:"Hit Generate to create your dance animation. Choose Turbo for speed or Quality for more poses.",position:{bottom:"100px",right:"20px"},arrowPosition:"right",accentColor:"yellow",triggerAfterMs:1e4,targetStep:2}],TO=n=>{const[e,t]=ee.useState(()=>{const E=localStorage.getItem("jusdnce-onboarding-dismissed");return E?new Set(JSON.parse(E)):new Set}),[i,o]=ee.useState(null),a=ee.useRef(null),u=ee.useRef(Date.now());ee.useEffect(()=>{localStorage.setItem("jusdnce-onboarding-dismissed",JSON.stringify([...e]))},[e]);const d=()=>{u.current=Date.now(),a.current&&clearTimeout(a.current);const E=JS.find(S=>S.targetStep===n&&!e.has(S.id));E&&(a.current=setTimeout(()=>{o(E)},E.triggerAfterMs))};return ee.useEffect(()=>{const E=["mousedown","mousemove","keydown","scroll","touchstart"];return E.forEach(S=>{window.addEventListener(S,d,{passive:!0})}),d(),()=>{E.forEach(S=>{window.removeEventListener(S,d)}),a.current&&clearTimeout(a.current)}},[n,e]),{activeTooltip:i,dismissTooltip:E=>{t(S=>new Set([...S,E])),o(null),d()},skipAll:()=>{const E=JS.map(S=>S.id);t(new Set(E)),o(null)},resetOnboarding:()=>{t(new Set),localStorage.removeItem("jusdnce-onboarding-dismissed")},isFirstTimeUser:e.size===0}},SO=({currentStep:n})=>{const{activeTooltip:e,dismissTooltip:t,skipAll:i}=TO(n);return e?e.component==="explainer"?T.jsx(EO,{onDismiss:()=>t(e.id),onSkipAll:i}):T.jsx(vO,{id:e.id,title:e.title,description:e.description,position:e.position||{},arrowPosition:e.arrowPosition,accentColor:e.accentColor,onDismiss:()=>t(e.id),onSkipAll:i}):null},bO={1:{title:"Let's Get You Dancing!",subtitle:"Upload Any Image",sections:[{heading:"Drop Your Image Here",icon:T.jsx(Wm,{className:"w-5 h-5"}),content:"Any picture works! A photo, a drawing, a logo, text - we'll make it dance to your music.",tip:"Pictures with a clear subject on a dark background work best!"},{heading:"What Can Dance?",icon:T.jsx(fl,{className:"w-5 h-5"}),content:"Characters with arms and legs dance the best. Logos and text will pulse and glitch to the beat. Anything works - try it!"},{heading:"It's Easy!",icon:T.jsx(pl,{className:"w-5 h-5"}),content:"Just drag your picture into the box, or tap to browse. That's it! We handle everything else."}]},2:{title:"Pick a Look",subtitle:"Choose Your Style",sections:[{heading:"Styles Change Everything",icon:T.jsx(oI,{className:"w-5 h-5"}),content:"Each style transforms your image differently. Neon adds glow, Anime adds cartoon effects, Glitch adds distortion.",tip:"'Cinematic Realism' keeps your picture looking the same - great for photos!"},{heading:"Try Different Styles",icon:T.jsx(uo,{className:"w-5 h-5"}),content:"Don't like one? Try another! There's Cinematic (movie looks), Anime (cartoon), Digital (effects), and Artistic (painted)."}]},3:{title:"The Boogie Breakdown",subtitle:"Control the Dance",sections:[{heading:"Quality Levels",icon:T.jsx(pl,{className:"w-5 h-5"}),content:"TURBO = Fast & cheap (1 credit). QUALITY = Better moves (2 credits). SUPER MODE = Premium choreography (4 credits).",tip:"Quality mode is the best balance - smoother moves, good price."},{heading:"Motion Controls",icon:T.jsx(mh,{className:"w-5 h-5"}),content:"Smoothness = How fluid the dance is. Stutter = How much it snaps to the beat. Play with these!"},{heading:"Super Mode Extras",icon:T.jsx(qd,{className:"w-5 h-5"}),content:"Super Mode unlocks special choreography: Triplet Flow, Character Spin, Slow-Mo Impact, and more!"}],upsell:{title:"Go Pro - $8/month",features:["No watermarks on videos","2 free credits every day","Unlimited re-exports","Priority queue (faster!)","No ads"]}},4:{title:"Your Dance is Ready!",subtitle:"Download & Share",sections:[{heading:"Download Your Video",icon:T.jsx(nb,{className:"w-5 h-5"}),content:"Choose how long: 15 seconds (great for TikTok!), 30 seconds, 1 minute, or the full song.",tip:"15 second clips are perfect for social media!"},{heading:"What Does It Cost?",icon:T.jsx(fl,{className:"w-5 h-5"}),content:"Short clips = 1 credit. Full song = 2 credits. Remove watermark = double the cost (or free with Pro!)."},{heading:"Use It Again!",icon:T.jsx(na,{className:"w-5 h-5"}),content:"Same dance moves, different song? Re-export is only 1 credit. Your dancer works with any music!"}]}},jS=({onClick:n,label:e,isHighlighted:t=!1,position:i="bottom-right",variant:o="help"})=>{const[a,u]=ee.useState(0),[d,f]=ee.useState(0);ee.useEffect(()=>{const S=setInterval(()=>{u(Math.sin(Date.now()/800)*8),f(Math.sin(Date.now()/600)*3)},50);return()=>clearInterval(S)},[]);const p=i==="bottom-right"?"right-4 md:right-6":"left-4 md:left-6",_=o==="help"?"from-cyan-400 via-purple-500 to-pink-500":"from-yellow-400 via-orange-500 to-red-500",E=o==="help"?"rgba(139, 92, 246, 0.6)":"rgba(251, 146, 60, 0.6)";return T.jsxs("button",{onClick:n,className:`
        fixed ${p} z-[60]
        group flex flex-col items-center
        transition-all duration-300
        hover:scale-110
        ${t?"animate-pulse":""}
      `,style:{bottom:`${24+a}px`,transform:`rotate(${d}deg)`},children:[T.jsxs("div",{className:`
          relative w-20 h-10 md:w-24 md:h-12
          bg-gradient-to-r ${_}
          rounded-full
          shadow-2xl
          flex items-center justify-center
          border-2 border-white/30
        `,style:{boxShadow:`0 10px 40px ${E}, 0 0 60px ${E}`},children:[T.jsx("div",{className:"absolute -top-4 md:-top-5 w-10 h-6 md:w-12 md:h-7 bg-white/20 backdrop-blur-sm rounded-t-full border border-white/30"}),T.jsxs("div",{className:"absolute bottom-1 flex gap-1",children:[T.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),T.jsx("div",{className:"w-1.5 h-1.5 bg-cyan-300 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),T.jsx("div",{className:"w-1.5 h-1.5 bg-pink-300 rounded-full animate-pulse",style:{animationDelay:"0.4s"}}),T.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse",style:{animationDelay:"0.6s"}})]}),T.jsx(tb,{className:"w-5 h-5 md:w-6 md:h-6 text-white drop-shadow-lg"})]}),T.jsx("div",{className:"w-16 md:w-20 h-8 md:h-10 bg-gradient-to-b from-white/40 to-transparent rounded-b-full -mt-1 opacity-60 group-hover:opacity-100 transition-opacity",style:{clipPath:"polygon(20% 0%, 80% 0%, 100% 100%, 0% 100%)"}}),T.jsx("span",{className:`
          mt-1 px-3 py-1
          bg-black/80 backdrop-blur-sm
          rounded-full
          text-xs md:text-sm font-black text-white
          border border-white/20
          whitespace-nowrap
        `,style:{fontFamily:"Rajdhani, sans-serif"},children:e})]})},wO=({isVisible:n,onDismiss:e})=>{const[t,i]=ee.useState(0);return ee.useEffect(()=>{if(!n)return;const o=setInterval(()=>{i(Math.sin(Date.now()/500)*.5+.5)},50);return()=>clearInterval(o)},[n]),n?T.jsxs("div",{className:"fixed inset-0 z-40 pointer-events-none",children:[T.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-80 h-60 md:w-96 md:h-72 rounded-3xl pointer-events-none",style:{boxShadow:`0 0 ${40+t*40}px ${20+t*20}px rgba(139, 92, 246, ${.3+t*.3})`,border:`3px solid rgba(139, 92, 246, ${.5+t*.5})`}}),T.jsxs("div",{className:"absolute top-1/4 left-1/2 -translate-x-1/2 flex flex-col items-center animate-bounce pointer-events-auto",children:[T.jsxs("div",{className:"bg-gradient-to-r from-cyan-500 to-purple-500 px-6 py-4 rounded-2xl shadow-2xl border-2 border-white/30",children:[T.jsx("p",{className:"text-white text-lg md:text-xl font-black text-center",style:{fontFamily:"Rajdhani, sans-serif"},children:"TAP HERE TO START!"}),T.jsx("p",{className:"text-white/80 text-sm text-center mt-1",children:"Drop an image or tap to browse"})]}),T.jsx(lx,{className:"w-12 h-12 text-purple-400 mt-2 rotate-180"})]}),T.jsx("button",{onClick:e,className:"absolute bottom-8 left-1/2 -translate-x-1/2 px-4 py-2 bg-black/60 text-white/60 rounded-full text-sm hover:text-white transition-colors pointer-events-auto",children:"I got it, thanks!"})]}):null},AO=({isOpen:n,onClose:e,currentStep:t})=>{const[i,o]=ee.useState(0),a=bO[t];if(ee.useEffect(()=>{o(0)},[t,n]),!n)return null;const u=()=>{i<a.sections.length-1&&o(f=>f+1)},d=()=>{i>0&&o(f=>f-1)};return T.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4",children:[T.jsx("div",{className:"absolute inset-0 bg-black/85 backdrop-blur-md",onClick:e}),T.jsxs("div",{className:"relative w-full max-w-lg max-h-[80vh] overflow-hidden rounded-3xl bg-gradient-to-br from-gray-900 to-black border border-white/20 shadow-2xl",children:[T.jsxs("div",{className:"relative p-6 border-b border-white/10 bg-gradient-to-r from-cyan-500/20 via-purple-500/20 to-pink-500/20",children:[T.jsx("button",{onClick:e,className:"absolute top-4 right-4 p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors",children:T.jsx(so,{className:"w-5 h-5"})}),T.jsx("h2",{className:"text-3xl md:text-4xl font-black bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",style:{fontFamily:"Rajdhani, sans-serif"},children:a.title}),T.jsx("p",{className:"text-white/60 mt-1 text-lg",children:a.subtitle}),T.jsx("div",{className:"flex gap-2 mt-4",children:[1,2,3,4].map(f=>T.jsx("div",{className:`h-2 flex-1 rounded-full transition-colors ${f===t?"bg-gradient-to-r from-cyan-400 to-purple-400":f<t?"bg-white/40":"bg-white/10"}`},f))})]}),T.jsxs("div",{className:"p-6 overflow-y-auto max-h-[45vh]",children:[a.sections.length>1&&T.jsxs("div",{className:"flex items-center justify-between mb-4",children:[T.jsx("button",{onClick:d,disabled:i===0,className:"p-2 rounded-full bg-white/10 hover:bg-white/20 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:T.jsx(gx,{className:"w-5 h-5"})}),T.jsx("div",{className:"flex gap-2",children:a.sections.map((f,p)=>T.jsx("button",{onClick:()=>o(p),className:`w-3 h-3 rounded-full transition-colors ${p===i?"bg-cyan-400":"bg-white/30"}`},p))}),T.jsx("button",{onClick:u,disabled:i===a.sections.length-1,className:"p-2 rounded-full bg-white/10 hover:bg-white/20 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:T.jsx(Qm,{className:"w-5 h-5"})})]}),T.jsxs("div",{className:"bg-white/5 rounded-2xl p-5 border border-white/10",children:[T.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[T.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-cyan-500/30 to-purple-500/30",children:a.sections[i].icon}),T.jsx("h3",{className:"text-xl font-bold",children:a.sections[i].heading})]}),T.jsx("p",{className:"text-white/80 text-lg leading-relaxed",children:a.sections[i].content}),a.sections[i].tip&&T.jsx("div",{className:"mt-4 p-4 rounded-xl bg-cyan-500/10 border border-cyan-500/30",children:T.jsxs("p",{className:"text-cyan-300 flex items-start gap-2",children:[T.jsx(uo,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),T.jsx("span",{className:"text-base",children:a.sections[i].tip})]})})]}),a.upsell&&T.jsxs("div",{className:"mt-4 p-5 rounded-2xl bg-gradient-to-br from-yellow-500/10 to-orange-500/10 border border-yellow-500/30",children:[T.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[T.jsx(qd,{className:"w-6 h-6 text-yellow-400"}),T.jsx("h4",{className:"font-bold text-lg text-yellow-300",children:a.upsell.title})]}),T.jsx("ul",{className:"space-y-2",children:a.upsell.features.map((f,p)=>T.jsxs("li",{className:"flex items-center gap-2 text-white/80",children:[T.jsx(fl,{className:"w-4 h-4 text-yellow-400"}),T.jsx("span",{children:f})]},p))})]})]}),T.jsxs("div",{className:"p-4 border-t border-white/10 flex justify-between items-center bg-black/30",children:[T.jsxs("span",{className:"text-white/40 text-sm",children:["Step ",t," of 4"]}),T.jsx("button",{onClick:e,className:"px-8 py-3 rounded-full bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 font-black text-lg transition-colors",children:"Got it!"})]})]})]})},CO=({onComplete:n})=>{const[e,t]=ee.useState("logo"),[i,o]=ee.useState(0);return ee.useEffect(()=>{setTimeout(()=>o(1),100),setTimeout(()=>t("tagline"),1500),setTimeout(()=>t("fade"),3500),setTimeout(()=>{o(0),setTimeout(n,500)},4500)},[n]),T.jsxs("div",{className:"fixed inset-0 z-[200] flex items-center justify-center bg-black transition-opacity duration-500",style:{opacity:i},children:[T.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-900/50 via-black to-cyan-900/50"}),T.jsx("div",{className:"absolute inset-0 overflow-hidden",children:[...Array(20)].map((a,u)=>T.jsx("div",{className:"absolute w-2 h-2 bg-purple-500/30 rounded-full",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animation:`float ${3+Math.random()*2}s ease-in-out infinite`,animationDelay:`${Math.random()*2}s`}},u))}),T.jsxs("div",{className:"relative text-center z-10",children:[T.jsxs("h1",{className:`text-6xl md:text-8xl font-black tracking-tighter transition-all duration-1000 ${e==="logo"?"scale-100 opacity-100":"scale-95 opacity-90"}`,style:{fontFamily:"Rajdhani, sans-serif"},children:[T.jsx("span",{className:"text-white italic",children:"jus"}),T.jsx("span",{className:"bg-gradient-to-r from-cyan-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"DNCE"})]}),T.jsx("p",{className:`mt-4 text-xl md:text-2xl text-white/70 transition-all duration-500 ${e==="tagline"||e==="fade"?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:"Make anything dance to any music"}),T.jsxs("div",{className:`mt-8 flex items-center justify-center gap-2 transition-all duration-500 ${e==="tagline"||e==="fade"?"opacity-100":"opacity-0"}`,children:[T.jsx(tb,{className:"w-5 h-5 text-cyan-400"}),T.jsx("span",{className:"text-white/50 text-sm",children:"Need help? Look for the floating UFO!"})]})]}),T.jsx("button",{onClick:n,className:"absolute bottom-8 left-1/2 -translate-x-1/2 px-6 py-2 text-white/40 hover:text-white/80 transition-colors text-lg",children:"Skip "})]})},xO=({isVisible:n,onClose:e,type:t})=>{if(!n)return null;const o={audition:{title:"Your Dance is Ready!",subtitle:"Download it and share with the world!",icon:T.jsx(uo,{className:"w-8 h-8 text-cyan-400"})},reexport:{title:"New Song, Same Moves!",subtitle:"Your dancer killed it again!",icon:T.jsx(na,{className:"w-8 h-8 text-pink-400"})}}[t];return T.jsx("div",{className:"fixed top-8 left-1/2 -translate-x-1/2 z-[80] animate-bounce-in",children:T.jsxs("div",{className:"flex items-center gap-4 px-6 py-4 rounded-2xl bg-gradient-to-r from-cyan-500/20 via-purple-500/20 to-pink-500/20 border-2 border-white/30 backdrop-blur-xl shadow-2xl",children:[o.icon,T.jsxs("div",{children:[T.jsx("h3",{className:"font-black text-xl",children:o.title}),T.jsx("p",{className:"text-white/70",children:o.subtitle})]}),T.jsx("button",{onClick:e,className:"ml-4 p-2 rounded-full hover:bg-white/10 transition-colors",children:T.jsx(so,{className:"w-5 h-5"})})]})})},IO=()=>{const[n,e]=ee.useState(!1),[t,i]=ee.useState(!1),[o,a]=ee.useState(!1),[u,d]=ee.useState(!1),[f,p]=ee.useState(!1),[_,E]=ee.useState("audition");ee.useEffect(()=>{localStorage.getItem("jusdnce_hasVisited")||a(!0)},[]);const S=ee.useCallback(()=>{a(!1),i(!0),d(!0),localStorage.setItem("jusdnce_hasVisited","true"),setTimeout(()=>i(!1),3e3)},[]),C=ee.useCallback(()=>{d(!1)},[]),k=ee.useCallback(()=>{e(!0),d(!1)},[]),V=ee.useCallback(()=>{e(!1)},[]),z=ee.useCallback(()=>{E("audition"),p(!0),setTimeout(()=>p(!1),5e3)},[]),J=ee.useCallback(()=>{E("reexport"),p(!0),setTimeout(()=>p(!1),5e3)},[]),j=ee.useCallback(()=>{localStorage.removeItem("jusdnce_hasVisited"),a(!0)},[]),Z=ee.useCallback(()=>{d(!1)},[]);return{isHelpOpen:n,isHighlighted:t,showIntro:o,showUploadGuide:u,showGenerationPopup:f,popupType:_,openHelp:k,closeHelp:V,completeIntro:S,dismissUploadGuide:C,showAuditionComplete:z,showReexportComplete:J,resetIntro:j,onImageUploaded:Z}},RO=n=>{if(!n)return!0;const e=n.toDate?n.toDate():new Date(n);return(new Date().getTime()-e.getTime())/(1e3*60*60)>=24},NO=async(n,e,t,i)=>{const o=rc(oc,"users",n);if((await iA(o)).exists()){await ny(o,{lastLogin:Bd()});return}await q6(o,{uid:n,email:e,name:t,photoURL:i,credits:Zm.signupCredits,tier:"free",isSubscriber:!1,lastDailyCreditClaim:null,createdAt:Bd(),lastLogin:Bd()})},MO=async n=>{var a;const e=rc(oc,"users",n),t=await ry(n);if(!t)return{claimed:0,message:"User not found"};if(!RO(t.lastDailyCreditClaim)){const u=(a=t.lastDailyCreditClaim)!=null&&a.toDate?t.lastDailyCreditClaim.toDate():new Date(t.lastDailyCreditClaim),d=new Date(u.getTime()+1440*60*1e3);return{claimed:0,message:`Daily credit already claimed. Next credit available in ${Math.ceil((d.getTime()-Date.now())/(1e3*60*60))} hours.`}}const i=t.isSubscriber?Wa.dailyCredits:Zm.dailyCredits,o=t.credits+i;return await ny(e,{credits:o,lastDailyCreditClaim:Bd()}),{claimed:i,message:`Claimed ${i} daily credit${i>1?"s":""}!`}},ry=async n=>{const e=rc(oc,"users",n),t=await iA(e);return t.exists()?t.data():null},PO=async(n,e)=>{const t=rc(oc,"users",n),i=await ry(n);if(!i)throw new Error("User document not found");const o=Math.max(0,i.credits+e);return await ny(t,{credits:o}),o},DO=(n,e)=>{const t=rc(oc,"users",n);return H6(t,i=>{if(i.exists()){const o=i.data();e(o.credits)}})},os=(n,e=1)=>{const t=new CustomEvent("ui-interaction",{detail:{type:n,intensity:e}});window.dispatchEvent(t)},kO=()=>{const[n,e]=ee.useState(qv),[t]=ee.useState(QS.createRef()),i=IO();ee.useEffect(()=>{const H=y3(Gh,async ae=>{if(ae){const{uid:oe,displayName:x,email:M,photoURL:N}=ae;try{await NO(oe,M||"no-email@example.com",x||"Anonymous User",N||`https://ui-avatars.com/api/?name=${x||"User"}&background=random`);const P=await ry(oe),U={uid:oe,name:x||"Anonymous User",email:M||"no-email@example.com",photoURL:N||`https://ui-avatars.com/api/?name=${x||"User"}&background=random`};e(O=>({...O,user:U,credits:(P==null?void 0:P.credits)||0,showAuthModal:!1}))}catch(P){console.error("Error creating user document:",P)}}else e(oe=>({...oe,user:null,credits:0}))});return()=>H()},[]),ee.useEffect(()=>{if(!n.user)return;const H=DO(n.user.uid,ae=>{e(oe=>({...oe,credits:ae}))});return()=>H()},[n.user]);const o=async H=>{try{const ae=await Ck(H);e(oe=>({...oe,imageFile:H,imagePreviewUrl:ae,generatedFrames:[]})),i.onImageUploaded()}catch(ae){console.error("Image upload processing failed:",ae),alert(`Failed to load image: ${ae.message||"Unknown error"}`)}},a=async H=>{if(!H){e(oe=>({...oe,audioFile:null,audioPreviewUrl:null}));return}const ae=URL.createObjectURL(H);e(oe=>({...oe,audioFile:H,audioPreviewUrl:ae}))},u=(H,ae)=>{e(oe=>({...oe,[H]:ae}))},d=async()=>{try{await pO(),os("click",1)}catch(H){console.error("Login error:",H),alert(`Login failed: ${H.message||"Unknown error"}`),e(ae=>({...ae,showAuthModal:!1}))}},f=()=>{e(H=>({...H,showPaymentModal:!0}))},p=()=>{e(H=>({...H,showPaymentModal:!1}))},_=async H=>{if(!n.user)return e(ae=>({...ae,showAuthModal:!0})),!1;if(n.credits>=H)try{return await PO(n.user.uid,-H),!0}catch(ae){return console.error("Error spending credit:",ae),alert(`Failed to process credits: ${ae.message||"Database error"}. Please try again.`),!1}else return e(ae=>({...ae,showPaymentModal:!0})),!1},E=async()=>{if(!n.user){e(H=>({...H,showAuthModal:!0}));return}try{const H=await MO(n.user.uid);os("click",H.claimed>0?2:.5),H.claimed>0}catch(H){console.error("Error claiming daily credit:",H)}},S=(H=!1)=>{V(H)},C=()=>{os("click",1.5),e(H=>({...H,useTurbo:!0,motionPreset:"auto",step:xt.DIRECTOR})),setTimeout(()=>V(),100)},k=()=>n.superMode?Is.SUPER_MODE:n.useTurbo?Is.TURBO:Is.QUALITY,V=async(H=!1)=>{if(!n.imagePreviewUrl)return;if(!H&&!n.user){e(N=>({...N,showAuthModal:!0}));return}const ae=k();if(!H&&n.credits<ae){e(N=>({...N,showPaymentModal:!0}));return}if(!H&&n.user&&!await _(ae))return;e(N=>({...N,isGenerating:!0,step:xt.PREVIEW}));const oe=as.find(N=>N.id===n.selectedStyleId),x=n.imagePreviewUrl;let M=n.motionPrompt;n.motionPreset!=="custom"&&n.motionPreset!=="auto"&&(n.motionPreset==="bounce"&&(M="Bouncy, energetic, rhythmic jumping"),n.motionPreset==="flow"&&(M="Smooth, fluid, liquid motion, floating"),n.motionPreset==="glitch"&&(M="Twitchy, glitchy, rapid robotic movements")),n.superMode&&n.superModeMotionPreset&&(n.superModeMotionPreset==="triplet-flow"&&(M+=". Movements locked to triplet rhythm (1-2-3). Waltz style flows."),n.superModeMotionPreset==="vocal-chop"&&(M+=". Rapid facial expression changes. Mouth open/closed syncopation."),n.superModeMotionPreset==="char-spin"&&(M+=". Full 360 degree character rotation. Front, side, back, side views."),n.superModeMotionPreset==="slow-mo-impact"&&(M+=". Fast buildup moves leading to sudden frozen impact poses."),n.superModeMotionPreset==="liquid-morph"&&(M+=". Continuous shape-shifting fluid motion. No static poses."));try{const{frames:N,category:P}=await Nk(x,(oe==null?void 0:oe.promptModifier)||"artistic style",M,n.useTurbo,n.superMode,H);e(U=>({...U,generatedFrames:N,subjectCategory:P,isGenerating:!1})),i.showAuditionComplete()}catch(N){console.error("Generation Failed:",N);const P=N.message||"Unknown error";P.includes("403")||P.includes("PERMISSION_DENIED")?alert("API Permission Denied (403). Please ensure your API Key has access to 'gemini-2.5-flash-image'."):alert(`Generation failed: ${P}`),e(U=>({...U,isGenerating:!1,step:xt.DIRECTOR}))}},z=()=>{if(n.generatedFrames.length===0)return;const H={id:crypto.randomUUID(),name:`Rig_${Date.now()}`,createdAt:Date.now(),frames:n.generatedFrames,styleId:n.selectedStyleId,subjectCategory:n.subjectCategory},ae=new Blob([JSON.stringify(H)],{type:"application/json"}),oe=URL.createObjectURL(ae),x=document.createElement("a");x.href=oe,x.download=`${H.name}.jusdnce`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(oe)},J=H=>{var x;const ae=(x=H.target.files)==null?void 0:x[0];if(!ae)return;const oe=new FileReader;oe.onload=M=>{var N;try{const P=JSON.parse((N=M.target)==null?void 0:N.result);if(!P.frames||!P.styleId)throw new Error("Invalid Project File");e(U=>({...U,generatedFrames:P.frames,selectedStyleId:P.styleId,subjectCategory:P.subjectCategory||"CHARACTER",imagePreviewUrl:P.frames[0].url,stutterPreset:"auto",step:xt.PREVIEW})),os("click",1.5)}catch{alert("Failed to load project file.")}},oe.readAsText(ae),H.target.value=""},j=()=>{switch(n.step){case xt.ASSETS:return!!n.imagePreviewUrl;case xt.DIRECTOR:return!0;default:return!1}},Z=()=>{n.step===xt.DIRECTOR?S():e(H=>({...H,step:H.step+1}))};return T.jsxs("div",{className:"min-h-screen relative text-gray-100 font-sans overflow-hidden selection:bg-brand-500/30 selection:text-white",children:[T.jsx(_O,{appState:n}),T.jsxs("div",{className:"relative z-10 flex flex-col h-screen flex-1",children:[T.jsx(gO,{isOpen:n.showAuthModal,onClose:()=>e(H=>({...H,showAuthModal:!1})),onLogin:d}),T.jsx(yO,{isOpen:n.showPaymentModal,onClose:()=>e(H=>({...H,showPaymentModal:!1})),onSuccess:p}),T.jsx("header",{className:"border-b border-white/5 bg-black/10 backdrop-blur-md sticky top-0 z-50",children:T.jsxs("div",{className:"max-w-7xl mx-auto px-6 h-20 flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-4 cursor-pointer group",onClick:()=>window.location.reload(),onMouseEnter:()=>os("hover",.5),children:[T.jsxs("div",{className:"relative w-10 h-10 flex items-center justify-center",children:[T.jsx("div",{className:"absolute inset-0 bg-brand-500 rounded-lg blur-lg opacity-40 group-hover:opacity-100 group-hover:animate-pulse transition-opacity"}),T.jsx("div",{className:"relative bg-black border border-white/20 p-2 rounded-lg backdrop-blur-md group-hover:scale-110 transition-transform duration-300",children:T.jsx(ZS,{size:24,className:"text-white group-hover:text-brand-300 transition-colors"})})]}),T.jsxs("h1",{className:"text-4xl font-black tracking-tighter text-transparent bg-clip-text bg-gradient-to-r from-white via-brand-200 to-white animate-text-shimmer drop-shadow-[0_0_15px_rgba(139,92,246,0.3)] italic hover:scale-105 transition-transform origin-left",children:["jus",T.jsx("span",{className:"text-brand-400 not-italic font-bold",children:"DNCE"})]})]}),T.jsxs("div",{className:"flex items-center gap-4",children:[T.jsxs("button",{onClick:()=>{var H;return(H=t.current)==null?void 0:H.click()},className:"glass-button px-4 py-2 rounded-full text-xs font-bold text-white flex items-center gap-2 border border-white/10 hover:border-brand-400/50",children:[T.jsx(Px,{size:14,className:"text-brand-300"})," IMPORT RIG"]}),T.jsx("input",{ref:t,type:"file",accept:".jusdnce",onChange:J,className:"hidden"}),n.user&&T.jsxs("button",{onClick:E,onMouseEnter:()=>os("hover",.3),className:"hidden md:flex items-center gap-2 bg-gradient-to-r from-green-600/20 to-emerald-600/20 px-4 py-2 rounded-full border border-green-500/30 cursor-pointer hover:border-green-400/50 transition-all hover:bg-green-500/10 hover:scale-105 group",title:"Claim your daily free credit",children:[T.jsx(om,{size:16,className:"text-green-400 group-hover:animate-bounce"}),T.jsx("span",{className:"text-xs font-bold text-green-300 tracking-wide",children:"DAILY"})]}),T.jsxs("button",{className:"flex items-center gap-2 bg-gradient-to-r from-yellow-600/20 to-amber-600/20 px-4 md:px-5 py-2 rounded-full border border-yellow-500/30 cursor-pointer hover:border-yellow-400/50 transition-all hover:bg-yellow-500/10 hover:scale-105 group shadow-[0_0_15px_rgba(234,179,8,0.2)]",onMouseEnter:()=>os("hover",.3),onClick:()=>e(H=>({...H,showPaymentModal:!0})),title:"Click to buy more credits",children:[T.jsx(pl,{size:16,className:"text-yellow-400 fill-yellow-400 group-hover:animate-bounce"}),T.jsx("span",{className:"text-sm font-bold text-yellow-100 tracking-wide font-mono",children:n.credits}),T.jsx("span",{className:"hidden sm:inline text-xs text-yellow-300/60 font-bold",children:"CR"})]}),n.user?T.jsxs("div",{className:"flex items-center gap-3 pl-4 border-l border-white/10",children:[T.jsxs("div",{className:"text-right hidden sm:block",children:[T.jsx("p",{className:"text-sm font-bold text-white leading-tight tracking-wider",children:n.user.name}),T.jsx("p",{className:"text-[10px] text-brand-300 font-mono uppercase",children:"PRO TIER"})]}),T.jsx("img",{src:n.user.photoURL,alt:"Profile",className:"w-10 h-10 rounded-full ring-2 ring-brand-500/50 hover:ring-brand-400 transition-all cursor-pointer"})]}):T.jsxs("button",{onClick:()=>e(H=>({...H,showAuthModal:!0})),onMouseEnter:()=>os("hover",.4),className:"glass-button px-6 py-2.5 rounded-full flex items-center gap-2 text-sm font-bold text-white tracking-wide shadow-lg",children:[T.jsx(am,{size:16})," SIGN IN"]})]})]})}),!n.user&&T.jsxs("div",{className:"bg-gradient-to-r from-brand-600/80 via-purple-600/80 to-pink-600/80 backdrop-blur-md border-b border-white/10 px-4 py-3 relative overflow-hidden z-10",children:[T.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMjAgMjBMMjAgMEwyMCAyMEwwIDIwTDIwIDIwTDQwIDIwTDIwIDIwTDIwIDQwTDIwIDIwIiBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1vcGFjaXR5PSIwLjA1Ii8+PC9zdmc+')] opacity-30"}),T.jsxs("div",{className:"max-w-7xl mx-auto flex flex-col sm:flex-row items-center justify-center gap-3 relative z-10",children:[T.jsxs("div",{className:"flex items-center gap-2 text-white text-sm font-medium",children:[T.jsx(uo,{size:16,className:"animate-pulse"}),T.jsxs("span",{className:"hidden sm:inline",children:["Sign up for ",T.jsx("strong",{className:"font-black",children:"FREE credits"})," and unlock full dance generation!"]}),T.jsxs("span",{className:"sm:hidden text-center",children:[T.jsx("strong",{children:"FREE credits"})," when you sign up!"]})]}),T.jsxs("button",{onClick:()=>e(H=>({...H,showAuthModal:!0})),onMouseEnter:()=>os("hover",.5),className:"px-5 py-2 bg-white text-brand-700 rounded-full text-xs font-black tracking-wide hover:bg-brand-50 hover:scale-105 transition-all shadow-lg flex items-center gap-2",children:[T.jsx(am,{size:14})," GET STARTED FREE"]})]})]}),T.jsx(SO,{currentStep:n.step+1}),T.jsx(jS,{onClick:i.openHelp,label:"DON'T PANIC",isHighlighted:i.isHighlighted,position:"bottom-right",variant:"help"}),n.step===xt.DIRECTOR&&T.jsx(jS,{onClick:i.openHelp,label:"BOOGIE BREAKDOWN",position:"bottom-left",variant:"boogie"}),T.jsx(AO,{isOpen:i.isHelpOpen,onClose:i.closeHelp,currentStep:n.step+1}),i.showIntro&&T.jsx(CO,{onComplete:i.completeIntro}),n.step===xt.ASSETS&&!n.imagePreviewUrl&&T.jsx(wO,{isVisible:i.showUploadGuide,onDismiss:i.dismissUploadGuide}),T.jsx(xO,{isVisible:i.showGenerationPopup,onClose:()=>{},type:i.popupType}),T.jsxs("main",{className:"flex-1 p-6 overflow-y-auto scrollbar-hide relative",children:[n.step===xt.ASSETS&&T.jsx("div",{className:"animate-fade-in",children:T.jsx(NI,{state:n,onUploadImage:o,onUploadAudio:a})}),n.step===xt.DIRECTOR&&T.jsx("div",{className:"animate-fade-in",children:T.jsx(MI,{config:n,onUpdate:u,onBuyCredits:f,onTestMode:()=>S(!0),onBack:()=>e(H=>({...H,step:xt.ASSETS}))})}),n.step===xt.PREVIEW&&T.jsx("div",{className:"animate-holo-reveal",children:T.jsx(JI,{state:n,onGenerateMore:()=>S(!1),onSpendCredit:_,onUploadAudio:a,onSaveProject:z,onNewDance:()=>e(H=>({...qv,user:H.user,credits:H.credits,step:xt.ASSETS})),onBackToDirector:()=>e(H=>({...H,step:xt.DIRECTOR})),onOpenAuth:()=>e(H=>({...H,showAuthModal:!0}))})})]}),T.jsx("footer",{className:"border-t border-white/5 bg-black/20 backdrop-blur-lg p-5 z-50",children:T.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[T.jsxs("div",{className:"flex gap-4 items-center",children:[T.jsx("span",{className:"text-xs font-mono text-gray-500 font-bold hidden md:block tracking-widest",children:"PROGRESSION //"}),[xt.ASSETS,xt.DIRECTOR,xt.PREVIEW].map(H=>T.jsx("div",{className:`
                            h-2 rounded-full transition-all duration-500 shadow-[0_0_10px_rgba(0,0,0,0.5)]
                            ${n.step>=H?"w-12 bg-gradient-to-r from-brand-600 to-brand-400 shadow-[0_0_15px_rgba(139,92,246,0.5)]":"w-3 bg-white/10"}
                        `},H))]}),n.step!==xt.PREVIEW&&T.jsxs("div",{className:"flex items-center gap-4",children:[n.step===xt.ASSETS&&j()&&T.jsxs("button",{onClick:C,onMouseEnter:()=>os("hover",.6),className:"px-6 py-4 rounded-full font-black text-sm tracking-widest flex items-center gap-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-[0_0_30px_rgba(219,39,119,0.4)] hover:shadow-[0_0_50px_rgba(219,39,119,0.7)] hover:scale-105 transition-all duration-300",children:[T.jsx(Nx,{size:18,fill:"white"})," QUICK DANCE"]}),T.jsxs("button",{disabled:!j(),onClick:Z,onMouseEnter:()=>j()&&os("hover",.6),className:`
                            px-10 py-4 rounded-full font-black text-sm tracking-widest flex items-center gap-3 transition-all duration-300 backdrop-blur-md
                            ${j()?"bg-brand-600 hover:bg-brand-500 text-white shadow-[0_0_30px_rgba(124,58,237,0.4)] hover:shadow-[0_0_50px_rgba(124,58,237,0.7)] border border-brand-400/50 hover:scale-105":"bg-white/5 text-gray-600 cursor-not-allowed border border-white/5"}
                            `,children:[n.step===xt.DIRECTOR?n.isGenerating?T.jsxs("span",{className:"flex items-center gap-2",children:[T.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-ping"})," PROCESSING"]}):"INITIALIZE GENERATION":"CONTINUE SEQUENCE",n.step===xt.DIRECTOR&&!n.isGenerating&&T.jsx(pl,{size:18,className:j()?"fill-white animate-pulse":""})]})]})]})})]})]})},hA=document.getElementById("root");if(!hA)throw new Error("Could not find root element to mount to");const UO=ZC.createRoot(hA);UO.render(T.jsx(QS.StrictMode,{children:T.jsx(kO,{})}));
